1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
             Current operating system: Linux-6.1.0-30-amd64(x86_64)             
                 Created on  5/28/25 at 10:42:35 by user: charmm-gui  

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOBID=4844180528
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOBID=4844180528
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., “Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides,” Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14758): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14779): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_oxidized.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_oxidized.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_oxidized.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR OXIDIZED PHOSPHOLIPID
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR OXIDIZED PHOSPHOLIPIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. “Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix” J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. “Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data”
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    ! Custom topology and parameter files for 7V7
 CHARMM>    open read card unit 10 name 7v7/7v7.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::7v7/7v7.rtf::
 OPNLGU> Unit 10 opened for READONLY access to 7v7/7v7.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * TOPOLOGY FILE.
 TITLE> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name 7v7/7v7.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::7v7/7v7.prm::
 OPNLGU> Unit 20 opened for READONLY access to 7v7/7v7.prm
  
 CHARMM>    read para flex card unit 20 append

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * FORCE FIELD PARAMETER FILE.
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 19952): _OXA  _CXA  _C3X  _C3X is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:     5/28/25     10:30:56      CREATED BY USER: charmm-gui
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      288
         Number of atoms         =     4767   Number of groups     =     1452
         Number of bonds         =     4829   Number of angles     =     8740
         Number of dihedrals     =    12802   Number of impropers  =      726
         Number of cross-terms   =      285   Number of autogens   =        0
         Number of HB acceptors  =      388   Number of HB donors  =      488
         Number of NB exclusions =        0   Total charge =   14.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 1197.41049
 TITLE> * CALC BOTAREA = 1296.19495
 TITLE> * CALC MINRADIUS = 0
 TITLE> * CALC MINRADIUSZ = -9.4
 TITLE> * CALC MAXRADIUS = 4.61241393
 TITLE> * CALC MAXRADIUSZ = -15.8
 TITLE> * CALC XMAX = 27.394755
 TITLE> * CALC XMIN = -23.5972088
 TITLE> * CALC YMAX = 27.3692489
 TITLE> * CALC YMIN = -22.6472808
 TITLE> * CALC ZMAX = 37.8471693
 TITLE> * CALC ZMIN = -29.2915219
 TITLE> *  DATE:     5/28/25     10:35: 9      CREATED BY USER: CHARMM-GUI
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>   4767 atoms have been selected out of   4767
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 100.116666
 Parameter: A <- "100.116666"
  
 CHARMM>     SET B        = 100.116666
 Parameter: B <- "100.116666"
  
 CHARMM>     SET C        = 127.138691
 Parameter: C <- "127.138691"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 4.2778237
 Parameter: ZCEN <- "4.2778237"
  
 CHARMM>     SET NLIPTOP  = 129
 Parameter: NLIPTOP <- "129"
  
 CHARMM>     SET NLIPBOT  = 128
 Parameter: NLIPBOT <- "128"
  
 CHARMM>     SET WBOXZ    = 30
 Parameter: WBOXZ <- "30"
  
 CHARMM>     SET WATBOXZ  = 47.8471693
 Parameter: WATBOXZ <- "47.8471693"
  
 CHARMM>     SET NCHARGE  = 14
 Parameter: NCHARGE <- "14"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being appended from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     5/28/25     10:41:19      CREATED BY USER: charmm-gui
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      545
         Number of atoms         =    39205   Number of groups     =    10190
         Number of bonds         =    39010   Number of angles     =    74532
         Number of dihedrals     =   104294   Number of impropers  =     1240
         Number of cross-terms   =      285   Number of autogens   =        0
         Number of HB acceptors  =      388   Number of HB donors  =      488
         Number of NB exclusions =        0   Total charge =   14.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF 288 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     5/28/25     10:41:19      CREATED BY USER: CHARMM-GUI
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  39205
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     39205 SELECTED ATOMS:
    XMIN =  -54.207657 XMAX =   54.813112 XAVE =    1.558807
    YMIN =  -55.466611 YMAX =   55.520674 YAVE =    0.249498
    ZMIN =  -30.184757 ZMAX =   38.632262 ZAVE =    0.541855
    WMIN =    0.000000 WMAX =    0.099828 WAVE =    0.000011
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "54.8131117"
 RDCMND substituted energy or value "?XMIN" to "-54.2076574"
Evaluating: INT((54.8131117--54.2076574+5.0)/0.5)+1
 Parameter: XDIM <- "229"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "55.5206741"
 RDCMND substituted energy or value "?YMIN" to "-55.4666105"
Evaluating: INT((55.5206741--55.4666105+5.0)/0.5)+1
 Parameter: YDIM <- "232"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "38.6322618"
 RDCMND substituted energy or value "?ZMIN" to "-30.1847568"
Evaluating: INT((38.6322618--30.1847568+5.0)/0.5)+1
 Parameter: ZDIM <- "148"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "229"
 Parameter: YDIM -> "232"
 Parameter: ZDIM -> "148"
Evaluating: 229*232*148
 Parameter: SPACE <- "7862944"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "7862944" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "7862944"
 SELRPN>  39205 atoms have been selected out of  39205
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -56.8882 XMAX=     57.5531 NX= 228
   YMIN=    -58.2066 YMAX=     58.2607 NY= 232
   ZMIN=    -32.9248 ZMAX=     41.0972 NZ= 147


 A TOTAL OF    20729   VACUUM POINTS WERE FOUND
 A TOTAL OF  3797307 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  3957676 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  7754983 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  481817.630234
 TOTAL SELECTED  VOLUME =  983983.526106
 TOTAL FREE      VOLUME =    2630.179139
 FRACTIONAL FREE VOLUME =       0.542923
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "481817.63"
 Parameter: SYSVOL <- "481817.63"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "100.116666"
 Parameter: B -> "100.116666"
 Parameter: C -> "127.138691"
 Parameter: SYSVOL -> "481817.63"
Evaluating: (100.116666*100.116666*127.138691)-481817.63
 Parameter: VOLUMN <- "792537.563"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  39205
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  39205
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  39205
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = SOD
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "SOD"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "14"
Evaluating: INT(14)
 Parameter: NCHARGE <- "14"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "14"
Evaluating: 14
 Parameter: CGTOT <- "14"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "14"
 Parameter: POSCHARGE -> "1"
 Comparing "14" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "14"
 Parameter: NEGCHARGE -> "1"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(14)/1)
 Parameter: NNEG <- "14"
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "14"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "14"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(14+0*1-14*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "14"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "14"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "14"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(14+0*1-14*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "792537.563"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*792537.563)*1
 Parameter: NPOS <- "71"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "14"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "792537.563"
 Parameter: POSVAL -> "1"
Evaluating: 14+INT(0.15*6.021*0.0001*792537.563)*1
 Parameter: NNEG <- "85"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "71" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "85" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "71" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "SOD"
 Parameter: NPOS -> "71"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   4 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =      616
         Number of atoms         =    39276   Number of groups     =    10261
         Number of bonds         =    39010   Number of angles     =    74532
         Number of dihedrals     =   104294   Number of impropers  =     1240
         Number of cross-terms   =      285   Number of autogens   =        0
         Number of HB acceptors  =      388   Number of HB donors  =      488
         Number of NB exclusions =        0   Total charge =   85.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     71 atoms have been selected out of  39276
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     71 atoms have been selected out of  39276
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "85" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "85"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   5 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        5   Number of residues   =      701
         Number of atoms         =    39361   Number of groups     =    10346
         Number of bonds         =    39010   Number of angles     =    74532
         Number of dihedrals     =   104294   Number of impropers  =     1240
         Number of cross-terms   =      285   Number of autogens   =        0
         Number of HB acceptors  =      388   Number of HB donors  =      488
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     85 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     85 atoms have been selected out of  39361
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    156 atoms have been selected out of  39361
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    156 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "71"
 Parameter: NNEG -> "85"
Evaluating: 71+85
 Parameter: NION <- "156"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "71"
 Parameter: NPOSTOT <- "71"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "85"
 Parameter: NNEGTOT <- "85"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "156"
 Parameter: NIONTOT <- "156"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "156" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "100.116666"
 Parameter: B -> "100.116666"
 Parameter: C -> "127.138691"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =  100.11667 B    =  100.11667 C     =  127.13869
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOBID=4844180528
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "4.2778237"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  4.277824
 RESIDUE  389 OPERATED ON BY TRANSFORMATION N1Z0Z0R1
 RESIDUE  395 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  400 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE  501 OPERATED ON BY TRANSFORMATION Z0P1Z0R1
 RESIDUE  542 OPERATED ON BY TRANSFORMATION N1Z0Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       74.15
    2  N1Z0N1R1 has       0       0       0       72.03
    3  N1P1N1R1 has       0       0       0       73.96
    4  Z0N1N1R1 has       0       0       0       64.36
    5  Z0Z0N1R1 has       0       0       0       58.32
    6  Z0P1N1R1 has       0       0       0       73.96
    7  N1N1Z0R1 has     844     212       9        0.00
    8  N1Z0Z0R1 has    6467    1636      60        0.00
    9  N1P1Z0R1 has     573     147       9        0.00
   10  Z0N1Z0R1 has    6540    1644      60        0.00
   12  N1N1P1R1 has       0       0       0       65.90
   13  N1Z0P1R1 has       0       0       0       65.50
   14  N1P1P1R1 has       0       0       0       66.07
 Total of53785 atoms and13985 groups and  839 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  39205 atoms have been selected out of  39361
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "1" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.713660529"
Evaluating: 100.116666*(0.713660529-0.5)
 Parameter: XPOS <- "21.3909798"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.824322174"
Evaluating: 100.116666*(0.824322174-0.5)
 Parameter: YPOS <- "32.4700548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "6.418048124E-02"
Evaluating: 127.138691*(6.418048124E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-51.1316994"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.1316994" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.3909798"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.3909798-0
 Parameter: XTRAN <- "21.3909798"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.4700548"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.4700548-0
 Parameter: YTRAN <- "32.4700548"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.1316994"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.1316994-0
 Parameter: ZTRAN <- "-51.1316994"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.3909798"
 Parameter: YTRAN -> "32.4700548"
 Parameter: ZTRAN -> "-51.1316994"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    21.390980   32.470055  -51.131699
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.828921569"
Evaluating: 0.828921569*360.0
 Parameter: XPHI <- "298.411765"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.095149298E-03"
Evaluating: 6.095149298E-03*360.0
 Parameter: YPHI <- "2.19425375"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976245239"
Evaluating: 0.976245239*360.0
 Parameter: ZPHI <- "351.448286"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.3909798"
 Parameter: YPOS -> "32.4700548"
 Parameter: ZPOS -> "-51.1316994"
 Parameter: XPHI -> "298.411765"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.475805   -0.879551
    0.000000    0.879551    0.475805

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.3909798"
 Parameter: YPOS -> "32.4700548"
 Parameter: ZPOS -> "-51.1316994"
 Parameter: YPHI -> "2.19425375"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999267    0.000000   -0.038288
    0.000000    1.000000    0.000000
    0.038288    0.000000    0.999267

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    2.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.3909798"
 Parameter: YPOS -> "32.4700548"
 Parameter: ZPOS -> "-51.1316994"
 Parameter: ZPHI -> "351.448286"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.988882   -0.148702    0.000000
    0.148702    0.988882    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    8.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.390980 XMAX =   21.390980 XAVE =   21.390980
    YMIN =   32.470055 YMAX =   32.470055 YAVE =   32.470055
    ZMIN =  -51.131699 ZMAX =  -51.131699 ZAVE =  -51.131699
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.3909798"
Evaluating: 21.3909798+3.5
 Parameter: XMAX <- "24.8909798"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.4700548"
Evaluating: 32.4700548+3.5
 Parameter: YMAX <- "35.9700548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.1316994"
Evaluating: -51.1316994+3.5
 Parameter: ZMAX <- "-47.6316994"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.3909798"
Evaluating: 21.3909798-3.5
 Parameter: XMIN <- "17.8909798"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.4700548"
Evaluating: 32.4700548-3.5
 Parameter: YMIN <- "28.9700548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.1316994"
Evaluating: -51.1316994-3.5
 Parameter: ZMIN <- "-54.6316994"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.8909798"
 Parameter: XMIN -> "17.8909798"
 Parameter: YMAX -> "35.9700548"
 Parameter: YMIN -> "28.9700548"
 Parameter: ZMAX -> "-47.6316994"
 Parameter: ZMIN -> "-54.6316994"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "2" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "2" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "1.714514194E-02"
Evaluating: 100.116666*(1.714514194E-02-0.5)
 Parameter: XPOS <- "-48.3418186"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.721256451"
Evaluating: 100.116666*(0.721256451-0.5)
 Parameter: YPOS <- "22.1514582"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.513278665"
Evaluating: 127.138691*(0.513278665-0.5)+4.2778237
 Parameter: ZPOS <- "5.96605579"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.96605579" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.96605579" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "2" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.166102851"
Evaluating: 100.116666*(0.166102851-0.5)
 Parameter: XPOS <- "-33.4286693"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.23572664"
Evaluating: 100.116666*(0.23572664-0.5)
 Parameter: YPOS <- "-26.4581677"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.242032021"
Evaluating: 127.138691*(0.242032021-0.5)+4.2778237
 Parameter: ZPOS <- "-28.5198875"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.5198875" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.4286693"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.4286693-0
 Parameter: XTRAN <- "-33.4286693"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.4581677"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.4581677-0
 Parameter: YTRAN <- "-26.4581677"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.5198875"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -28.5198875-0
 Parameter: ZTRAN <- "-28.5198875"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.4286693"
 Parameter: YTRAN -> "-26.4581677"
 Parameter: ZTRAN -> "-28.5198875"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -33.428669  -26.458168  -28.519887
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236887525"
Evaluating: 0.236887525*360.0
 Parameter: XPHI <- "85.279509"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.51818841"
Evaluating: 0.51818841*360.0
 Parameter: YPHI <- "186.547828"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.380114069"
Evaluating: 0.380114069*360.0
 Parameter: ZPHI <- "136.841065"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.4286693"
 Parameter: YPOS -> "-26.4581677"
 Parameter: ZPOS -> "-28.5198875"
 Parameter: XPHI -> "85.279509"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.082295    0.996608
    0.000000   -0.996608    0.082295

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   85.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.4286693"
 Parameter: YPOS -> "-26.4581677"
 Parameter: ZPOS -> "-28.5198875"
 Parameter: YPHI -> "186.547828"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.993477    0.000000    0.114033
    0.000000    1.000000    0.000000
   -0.114033    0.000000   -0.993477

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.4286693"
 Parameter: YPOS -> "-26.4581677"
 Parameter: ZPOS -> "-28.5198875"
 Parameter: ZPHI -> "136.841065"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.729459    0.684024    0.000000
   -0.684024   -0.729459    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.428669 XMAX =  -33.428669 XAVE =  -33.428669
    YMIN =  -26.458168 YMAX =  -26.458168 YAVE =  -26.458168
    ZMIN =  -28.519887 ZMAX =  -28.519887 ZAVE =  -28.519887
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.4286693"
Evaluating: -33.4286693+3.5
 Parameter: XMAX <- "-29.9286693"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.4581677"
Evaluating: -26.4581677+3.5
 Parameter: YMAX <- "-22.9581677"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.5198875"
Evaluating: -28.5198875+3.5
 Parameter: ZMAX <- "-25.0198875"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.4286693"
Evaluating: -33.4286693-3.5
 Parameter: XMIN <- "-36.9286693"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.4581677"
Evaluating: -26.4581677-3.5
 Parameter: YMIN <- "-29.9581677"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.5198875"
Evaluating: -28.5198875-3.5
 Parameter: ZMIN <- "-32.0198875"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.9286693"
 Parameter: XMIN -> "-36.9286693"
 Parameter: YMAX -> "-22.9581677"
 Parameter: YMIN -> "-29.9581677"
 Parameter: ZMAX -> "-25.0198875"
 Parameter: ZMIN -> "-32.0198875"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "3" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "3" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.381309462"
Evaluating: 100.116666*(0.381309462-0.5)
 Parameter: XPOS <- "-11.882901"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.629955317"
Evaluating: 100.116666*(0.629955317-0.5)
 Parameter: YPOS <- "13.0106931"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "7.422022432E-03"
Evaluating: 127.138691*(7.422022432E-03-0.5)+4.2778237
 Parameter: ZPOS <- "-58.3478956"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-58.3478956" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.882901"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.882901-0
 Parameter: XTRAN <- "-11.882901"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.0106931"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.0106931-0
 Parameter: YTRAN <- "13.0106931"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-58.3478956"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -58.3478956-0
 Parameter: ZTRAN <- "-58.3478956"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.882901"
 Parameter: YTRAN -> "13.0106931"
 Parameter: ZTRAN -> "-58.3478956"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -11.882901   13.010693  -58.347896
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.952646007"
Evaluating: 0.952646007*360.0
 Parameter: XPHI <- "342.952563"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666149797"
Evaluating: 0.666149797*360.0
 Parameter: YPHI <- "239.813927"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723581147"
Evaluating: 0.723581147*360.0
 Parameter: ZPHI <- "260.489213"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.882901"
 Parameter: YPOS -> "13.0106931"
 Parameter: ZPOS -> "-58.3478956"
 Parameter: XPHI -> "342.952563"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.956062   -0.293163
    0.000000    0.293163    0.956062

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.882901"
 Parameter: YPOS -> "13.0106931"
 Parameter: ZPOS -> "-58.3478956"
 Parameter: YPHI -> "239.813927"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.502810    0.000000    0.864397
    0.000000    1.000000    0.000000
   -0.864397    0.000000   -0.502810

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.882901"
 Parameter: YPOS -> "13.0106931"
 Parameter: ZPOS -> "-58.3478956"
 Parameter: ZPHI -> "260.489213"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.165233   -0.986255    0.000000
    0.986255   -0.165233    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.882901 XMAX =  -11.882901 XAVE =  -11.882901
    YMIN =   13.010693 YMAX =   13.010693 YAVE =   13.010693
    ZMIN =  -58.347896 ZMAX =  -58.347896 ZAVE =  -58.347896
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.882901"
Evaluating: -11.882901+3.5
 Parameter: XMAX <- "-8.382901"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.0106931"
Evaluating: 13.0106931+3.5
 Parameter: YMAX <- "16.5106931"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-58.3478956"
Evaluating: -58.3478956+3.5
 Parameter: ZMAX <- "-54.8478956"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.882901"
Evaluating: -11.882901-3.5
 Parameter: XMIN <- "-15.382901"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.0106931"
Evaluating: 13.0106931-3.5
 Parameter: YMIN <- "9.5106931"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-58.3478956"
Evaluating: -58.3478956-3.5
 Parameter: ZMIN <- "-61.8478956"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.382901"
 Parameter: XMIN -> "-15.382901"
 Parameter: YMAX -> "16.5106931"
 Parameter: YMIN -> "9.5106931"
 Parameter: ZMAX -> "-54.8478956"
 Parameter: ZMIN -> "-61.8478956"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "4" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "4" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.707481605"
Evaluating: 100.116666*(0.707481605-0.5)
 Parameter: XPOS <- "20.7723665"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.516536413"
Evaluating: 100.116666*(0.516536413-0.5)
 Parameter: YPOS <- "1.65557054"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "9.376569806E-02"
Evaluating: 127.138691*(9.376569806E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-47.3702737"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.3702737" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.7723665"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.7723665-0
 Parameter: XTRAN <- "20.7723665"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.65557054"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.65557054-0
 Parameter: YTRAN <- "1.65557054"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.3702737"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.3702737-0
 Parameter: ZTRAN <- "-47.3702737"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.7723665"
 Parameter: YTRAN -> "1.65557054"
 Parameter: ZTRAN -> "-47.3702737"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    20.772367    1.655571  -47.370274
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569196989"
Evaluating: 0.569196989*360.0
 Parameter: XPHI <- "204.910916"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18820287"
Evaluating: 0.18820287*360.0
 Parameter: YPHI <- "67.7530332"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833106353"
Evaluating: 0.833106353*360.0
 Parameter: ZPHI <- "299.918287"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.7723665"
 Parameter: YPOS -> "1.65557054"
 Parameter: ZPOS -> "-47.3702737"
 Parameter: XPHI -> "204.910916"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.906964   -0.421209
    0.000000    0.421209   -0.906964

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  155.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.7723665"
 Parameter: YPOS -> "1.65557054"
 Parameter: ZPOS -> "-47.3702737"
 Parameter: YPHI -> "67.7530332"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.378600    0.000000   -0.925561
    0.000000    1.000000    0.000000
    0.925561    0.000000    0.378600

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.7723665"
 Parameter: YPOS -> "1.65557054"
 Parameter: ZPOS -> "-47.3702737"
 Parameter: ZPHI -> "299.918287"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.498764   -0.866738    0.000000
    0.866738    0.498764    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.772367 XMAX =   20.772367 XAVE =   20.772367
    YMIN =    1.655571 YMAX =    1.655571 YAVE =    1.655571
    ZMIN =  -47.370274 ZMAX =  -47.370274 ZAVE =  -47.370274
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.7723665"
Evaluating: 20.7723665+3.5
 Parameter: XMAX <- "24.2723665"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.65557054"
Evaluating: 1.65557054+3.5
 Parameter: YMAX <- "5.15557054"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.3702737"
Evaluating: -47.3702737+3.5
 Parameter: ZMAX <- "-43.8702737"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.7723665"
Evaluating: 20.7723665-3.5
 Parameter: XMIN <- "17.2723665"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.65557054"
Evaluating: 1.65557054-3.5
 Parameter: YMIN <- "-1.84442946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.3702737"
Evaluating: -47.3702737-3.5
 Parameter: ZMIN <- "-50.8702737"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.2723665"
 Parameter: XMIN -> "17.2723665"
 Parameter: YMAX -> "5.15557054"
 Parameter: YMIN -> "-1.84442946"
 Parameter: ZMAX -> "-43.8702737"
 Parameter: ZMIN -> "-50.8702737"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "5" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "5" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.891538549"
Evaluating: 100.116666*(0.891538549-0.5)
 Parameter: XPOS <- "39.1995341"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.178158602"
Evaluating: 100.116666*(0.178158602-0.5)
 Parameter: YPOS <- "-32.2216877"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.534094635"
Evaluating: 127.138691*(0.534094635-0.5)+4.2778237
 Parameter: ZPOS <- "8.61257096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.61257096" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.61257096" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "5" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.631314781"
Evaluating: 100.116666*(0.631314781-0.5)
 Parameter: XPOS <- "13.1467981"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.641660403"
Evaluating: 100.116666*(0.641660403-0.5)
 Parameter: YPOS <- "14.1825673"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.226918379"
Evaluating: 127.138691*(0.226918379-0.5)+4.2778237
 Parameter: ZPOS <- "-30.4414161"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4414161" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.1467981"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.1467981-0
 Parameter: XTRAN <- "13.1467981"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.1825673"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.1825673-0
 Parameter: YTRAN <- "14.1825673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4414161"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4414161-0
 Parameter: ZTRAN <- "-30.4414161"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.1467981"
 Parameter: YTRAN -> "14.1825673"
 Parameter: ZTRAN -> "-30.4414161"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    13.146798   14.182567  -30.441416
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299649595"
Evaluating: 0.299649595*360.0
 Parameter: XPHI <- "107.873854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307684196"
Evaluating: 0.307684196*360.0
 Parameter: YPHI <- "110.766311"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880089733"
Evaluating: 0.880089733*360.0
 Parameter: ZPHI <- "316.832304"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.1467981"
 Parameter: YPOS -> "14.1825673"
 Parameter: ZPOS -> "-30.4414161"
 Parameter: XPHI -> "107.873854"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.306922    0.951735
    0.000000   -0.951735   -0.306922

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  107.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.1467981"
 Parameter: YPOS -> "14.1825673"
 Parameter: ZPOS -> "-30.4414161"
 Parameter: YPHI -> "110.766311"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.354557    0.000000   -0.935034
    0.000000    1.000000    0.000000
    0.935034    0.000000   -0.354557

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  110.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.1467981"
 Parameter: YPOS -> "14.1825673"
 Parameter: ZPOS -> "-30.4414161"
 Parameter: ZPHI -> "316.832304"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.729354   -0.684136    0.000000
    0.684136    0.729354    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.146798 XMAX =   13.146798 XAVE =   13.146798
    YMIN =   14.182567 YMAX =   14.182567 YAVE =   14.182567
    ZMIN =  -30.441416 ZMAX =  -30.441416 ZAVE =  -30.441416
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.1467981"
Evaluating: 13.1467981+3.5
 Parameter: XMAX <- "16.6467981"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.1825673"
Evaluating: 14.1825673+3.5
 Parameter: YMAX <- "17.6825673"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4414161"
Evaluating: -30.4414161+3.5
 Parameter: ZMAX <- "-26.9414161"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.1467981"
Evaluating: 13.1467981-3.5
 Parameter: XMIN <- "9.6467981"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.1825673"
Evaluating: 14.1825673-3.5
 Parameter: YMIN <- "10.6825673"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4414161"
Evaluating: -30.4414161-3.5
 Parameter: ZMIN <- "-33.9414161"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.6467981"
 Parameter: XMIN -> "9.6467981"
 Parameter: YMAX -> "17.6825673"
 Parameter: YMIN -> "10.6825673"
 Parameter: ZMAX -> "-26.9414161"
 Parameter: ZMIN -> "-33.9414161"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "6" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "6" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.427566726"
Evaluating: 100.116666*(0.427566726-0.5)
 Parameter: XPOS <- "-7.2517779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.823854968"
Evaluating: 100.116666*(0.823854968-0.5)
 Parameter: YPOS <- "32.4232797"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.879229273"
Evaluating: 127.138691*(0.879229273-0.5)+4.2778237
 Parameter: ZPOS <- "52.4925371"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.4925371" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.4925371" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.2517779"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.2517779-0
 Parameter: XTRAN <- "-7.2517779"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.4232797"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.4232797-0
 Parameter: YTRAN <- "32.4232797"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.4925371"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.4925371-0
 Parameter: ZTRAN <- "52.4925371"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.2517779"
 Parameter: YTRAN -> "32.4232797"
 Parameter: ZTRAN -> "52.4925371"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -7.251778   32.423280   52.492537
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.20971182E-02"
Evaluating: 3.20971182E-02*360.0
 Parameter: XPHI <- "11.5549626"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719854342"
Evaluating: 0.719854342*360.0
 Parameter: YPHI <- "259.147563"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997403466"
Evaluating: 0.997403466*360.0
 Parameter: ZPHI <- "359.065248"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.2517779"
 Parameter: YPOS -> "32.4232797"
 Parameter: ZPOS -> "52.4925371"
 Parameter: XPHI -> "11.5549626"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.979733    0.200308
    0.000000   -0.200308    0.979733

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.2517779"
 Parameter: YPOS -> "32.4232797"
 Parameter: ZPOS -> "52.4925371"
 Parameter: YPHI -> "259.147563"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.188280    0.000000    0.982115
    0.000000    1.000000    0.000000
   -0.982115    0.000000   -0.188280

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.2517779"
 Parameter: YPOS -> "32.4232797"
 Parameter: ZPOS -> "52.4925371"
 Parameter: ZPHI -> "359.065248"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999867   -0.016314    0.000000
    0.016314    0.999867    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.251778 XMAX =   -7.251778 XAVE =   -7.251778
    YMIN =   32.423280 YMAX =   32.423280 YAVE =   32.423280
    ZMIN =   52.492537 ZMAX =   52.492537 ZAVE =   52.492537
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.2517779"
Evaluating: -7.2517779+3.5
 Parameter: XMAX <- "-3.7517779"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.4232797"
Evaluating: 32.4232797+3.5
 Parameter: YMAX <- "35.9232797"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.4925371"
Evaluating: 52.4925371+3.5
 Parameter: ZMAX <- "55.9925371"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.2517779"
Evaluating: -7.2517779-3.5
 Parameter: XMIN <- "-10.7517779"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.4232797"
Evaluating: 32.4232797-3.5
 Parameter: YMIN <- "28.9232797"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.4925371"
Evaluating: 52.4925371-3.5
 Parameter: ZMIN <- "48.9925371"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.7517779"
 Parameter: XMIN -> "-10.7517779"
 Parameter: YMAX -> "35.9232797"
 Parameter: YMIN -> "28.9232797"
 Parameter: ZMAX -> "55.9925371"
 Parameter: ZMIN -> "48.9925371"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "7" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "7" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.268856776"
Evaluating: 100.116666*(0.268856776-0.5)
 Parameter: XPOS <- "-23.141289"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.34170345"
Evaluating: 100.116666*(0.34170345-0.5)
 Parameter: YPOS <- "-15.8481228"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "6.605756914E-02"
Evaluating: 127.138691*(6.605756914E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-50.8930489"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.8930489" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.141289"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.141289-0
 Parameter: XTRAN <- "-23.141289"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.8481228"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.8481228-0
 Parameter: YTRAN <- "-15.8481228"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.8930489"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.8930489-0
 Parameter: ZTRAN <- "-50.8930489"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.141289"
 Parameter: YTRAN -> "-15.8481228"
 Parameter: ZTRAN -> "-50.8930489"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -23.141289  -15.848123  -50.893049
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652644069"
Evaluating: 0.652644069*360.0
 Parameter: XPHI <- "234.951865"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759068871"
Evaluating: 0.759068871*360.0
 Parameter: YPHI <- "273.264794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873123951"
Evaluating: 0.873123951*360.0
 Parameter: ZPHI <- "314.324622"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.141289"
 Parameter: YPOS -> "-15.8481228"
 Parameter: ZPOS -> "-50.8930489"
 Parameter: XPHI -> "234.951865"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.574264   -0.818670
    0.000000    0.818670   -0.574264

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.141289"
 Parameter: YPOS -> "-15.8481228"
 Parameter: ZPOS -> "-50.8930489"
 Parameter: YPHI -> "273.264794"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.056951    0.000000    0.998377
    0.000000    1.000000    0.000000
   -0.998377    0.000000    0.056951

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   86.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.141289"
 Parameter: YPOS -> "-15.8481228"
 Parameter: ZPOS -> "-50.8930489"
 Parameter: ZPHI -> "314.324622"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.698723   -0.715393    0.000000
    0.715393    0.698723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.141289 XMAX =  -23.141289 XAVE =  -23.141289
    YMIN =  -15.848123 YMAX =  -15.848123 YAVE =  -15.848123
    ZMIN =  -50.893049 ZMAX =  -50.893049 ZAVE =  -50.893049
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.141289"
Evaluating: -23.141289+3.5
 Parameter: XMAX <- "-19.641289"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.8481228"
Evaluating: -15.8481228+3.5
 Parameter: YMAX <- "-12.3481228"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.8930489"
Evaluating: -50.8930489+3.5
 Parameter: ZMAX <- "-47.3930489"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.141289"
Evaluating: -23.141289-3.5
 Parameter: XMIN <- "-26.641289"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.8481228"
Evaluating: -15.8481228-3.5
 Parameter: YMIN <- "-19.3481228"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.8930489"
Evaluating: -50.8930489-3.5
 Parameter: ZMIN <- "-54.3930489"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.641289"
 Parameter: XMIN -> "-26.641289"
 Parameter: YMAX -> "-12.3481228"
 Parameter: YMIN -> "-19.3481228"
 Parameter: ZMAX -> "-47.3930489"
 Parameter: ZMIN -> "-54.3930489"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "8" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "8" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.490579966E-02"
Evaluating: 100.116666*(4.490579966E-02-0.5)
 Parameter: XPOS <- "-45.5625141"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.773418868"
Evaluating: 100.116666*(0.773418868-0.5)
 Parameter: YPOS <- "27.3737855"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.28751396"
Evaluating: 127.138691*(0.28751396-0.5)+4.2778237
 Parameter: ZPOS <- "-22.7373733"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-22.7373733" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.5625141"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.5625141-0
 Parameter: XTRAN <- "-45.5625141"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.3737855"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.3737855-0
 Parameter: YTRAN <- "27.3737855"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.7373733"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -22.7373733-0
 Parameter: ZTRAN <- "-22.7373733"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.5625141"
 Parameter: YTRAN -> "27.3737855"
 Parameter: ZTRAN -> "-22.7373733"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -45.562514   27.373786  -22.737373
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686394347"
Evaluating: 0.686394347*360.0
 Parameter: XPHI <- "247.101965"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355732357"
Evaluating: 0.355732357*360.0
 Parameter: YPHI <- "128.063649"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.6927577"
Evaluating: 0.6927577*360.0
 Parameter: ZPHI <- "249.392772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.5625141"
 Parameter: YPOS -> "27.3737855"
 Parameter: ZPOS -> "-22.7373733"
 Parameter: XPHI -> "247.101965"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.389092   -0.921199
    0.000000    0.921199   -0.389092

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.5625141"
 Parameter: YPOS -> "27.3737855"
 Parameter: ZPOS -> "-22.7373733"
 Parameter: YPHI -> "128.063649"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.616536    0.000000   -0.787326
    0.000000    1.000000    0.000000
    0.787326    0.000000   -0.616536

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.5625141"
 Parameter: YPOS -> "27.3737855"
 Parameter: ZPOS -> "-22.7373733"
 Parameter: ZPHI -> "249.392772"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.351960   -0.936015    0.000000
    0.936015   -0.351960    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.562514 XMAX =  -45.562514 XAVE =  -45.562514
    YMIN =   27.373786 YMAX =   27.373786 YAVE =   27.373786
    ZMIN =  -22.737373 ZMAX =  -22.737373 ZAVE =  -22.737373
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.5625141"
Evaluating: -45.5625141+3.5
 Parameter: XMAX <- "-42.0625141"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.3737855"
Evaluating: 27.3737855+3.5
 Parameter: YMAX <- "30.8737855"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.7373733"
Evaluating: -22.7373733+3.5
 Parameter: ZMAX <- "-19.2373733"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.5625141"
Evaluating: -45.5625141-3.5
 Parameter: XMIN <- "-49.0625141"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.3737855"
Evaluating: 27.3737855-3.5
 Parameter: YMIN <- "23.8737855"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.7373733"
Evaluating: -22.7373733-3.5
 Parameter: ZMIN <- "-26.2373733"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-42.0625141"
 Parameter: XMIN -> "-49.0625141"
 Parameter: YMAX -> "30.8737855"
 Parameter: YMIN -> "23.8737855"
 Parameter: ZMAX -> "-19.2373733"
 Parameter: ZMIN -> "-26.2373733"
 SELRPN>      8 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      3 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39213 POS      SOD      8        SOD     -**** MEMB     POPC     242      C13           3.2130
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "8" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.317834871"
Evaluating: 100.116666*(0.317834871-0.5)
 Parameter: XPOS <- "-18.2377654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.422460266"
Evaluating: 100.116666*(0.422460266-0.5)
 Parameter: YPOS <- "-7.76301965"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.92857962"
Evaluating: 127.138691*(0.92857962-0.5)+4.2778237
 Parameter: ZPOS <- "58.7668756"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.7668756" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.7668756" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.562514 XMAX =  -45.562514 XAVE =  -45.562514
    YMIN =   27.373786 YMAX =   27.373786 YAVE =   27.373786
    ZMIN =  -22.737373 ZMAX =  -22.737373 ZAVE =  -22.737373
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.2377654"
 RDCMND substituted energy or value "?XAVE" to "-45.5625141"
Evaluating: -18.2377654--45.5625141
 Parameter: XTRAN <- "27.3247487"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.76301965"
 RDCMND substituted energy or value "?YAVE" to "27.3737855"
Evaluating: -7.76301965-27.3737855
 Parameter: YTRAN <- "-35.1368052"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.7668756"
 RDCMND substituted energy or value "?ZAVE" to "-22.7373733"
Evaluating: 58.7668756--22.7373733
 Parameter: ZTRAN <- "81.5042489"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.3247487"
 Parameter: YTRAN -> "-35.1368052"
 Parameter: ZTRAN -> "81.5042489"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    27.324749  -35.136805   81.504249
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.161253935"
Evaluating: 0.161253935*360.0
 Parameter: XPHI <- "58.0514166"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.443870155"
Evaluating: 0.443870155*360.0
 Parameter: YPHI <- "159.793256"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166723928"
Evaluating: 0.166723928*360.0
 Parameter: ZPHI <- "60.0206141"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.2377654"
 Parameter: YPOS -> "-7.76301965"
 Parameter: ZPOS -> "58.7668756"
 Parameter: XPHI -> "58.0514166"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.529158    0.848523
    0.000000   -0.848523    0.529158

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   58.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.2377654"
 Parameter: YPOS -> "-7.76301965"
 Parameter: ZPOS -> "58.7668756"
 Parameter: YPHI -> "159.793256"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.938452    0.000000   -0.345409
    0.000000    1.000000    0.000000
    0.345409    0.000000   -0.938452

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.2377654"
 Parameter: YPOS -> "-7.76301965"
 Parameter: ZPOS -> "58.7668756"
 Parameter: ZPHI -> "60.0206141"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.499688    0.866205    0.000000
   -0.866205    0.499688    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.237765 XMAX =  -18.237765 XAVE =  -18.237765
    YMIN =   -7.763020 YMAX =   -7.763020 YAVE =   -7.763020
    ZMIN =   58.766876 ZMAX =   58.766876 ZAVE =   58.766876
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.2377654"
Evaluating: -18.2377654+3.5
 Parameter: XMAX <- "-14.7377654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.76301965"
Evaluating: -7.76301965+3.5
 Parameter: YMAX <- "-4.26301965"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.7668756"
Evaluating: 58.7668756+3.5
 Parameter: ZMAX <- "62.2668756"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.2377654"
Evaluating: -18.2377654-3.5
 Parameter: XMIN <- "-21.7377654"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.76301965"
Evaluating: -7.76301965-3.5
 Parameter: YMIN <- "-11.2630197"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.7668756"
Evaluating: 58.7668756-3.5
 Parameter: ZMIN <- "55.2668756"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.7377654"
 Parameter: XMIN -> "-21.7377654"
 Parameter: YMAX -> "-4.26301965"
 Parameter: YMIN -> "-11.2630197"
 Parameter: ZMAX -> "62.2668756"
 Parameter: ZMIN -> "55.2668756"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "9" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "9" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.324900764"
Evaluating: 100.116666*(0.324900764-0.5)
 Parameter: XPOS <- "-17.5303517"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.847906853"
Evaluating: 100.116666*(0.847906853-0.5)
 Parameter: YPOS <- "34.8312742"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.148430744"
Evaluating: 127.138691*(0.148430744-0.5)+4.2778237
 Parameter: ZPOS <- "-40.4202313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.4202313" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.5303517"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.5303517-0
 Parameter: XTRAN <- "-17.5303517"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.8312742"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.8312742-0
 Parameter: YTRAN <- "34.8312742"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.4202313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.4202313-0
 Parameter: ZTRAN <- "-40.4202313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.5303517"
 Parameter: YTRAN -> "34.8312742"
 Parameter: ZTRAN -> "-40.4202313"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -17.530352   34.831274  -40.420231
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.529969975"
Evaluating: 0.529969975*360.0
 Parameter: XPHI <- "190.789191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.460907091"
Evaluating: 0.460907091*360.0
 Parameter: YPHI <- "165.926553"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.500387898"
Evaluating: 0.500387898*360.0
 Parameter: ZPHI <- "180.139643"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.5303517"
 Parameter: YPOS -> "34.8312742"
 Parameter: ZPOS -> "-40.4202313"
 Parameter: XPHI -> "190.789191"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.982323   -0.187196
    0.000000    0.187196   -0.982323

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.5303517"
 Parameter: YPOS -> "34.8312742"
 Parameter: ZPOS -> "-40.4202313"
 Parameter: YPHI -> "165.926553"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.969985    0.000000   -0.243166
    0.000000    1.000000    0.000000
    0.243166    0.000000   -0.969985

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.5303517"
 Parameter: YPOS -> "34.8312742"
 Parameter: ZPOS -> "-40.4202313"
 Parameter: ZPHI -> "180.139643"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999997   -0.002437    0.000000
    0.002437   -0.999997    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.530352 XMAX =  -17.530352 XAVE =  -17.530352
    YMIN =   34.831274 YMAX =   34.831274 YAVE =   34.831274
    ZMIN =  -40.420231 ZMAX =  -40.420231 ZAVE =  -40.420231
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.5303517"
Evaluating: -17.5303517+3.5
 Parameter: XMAX <- "-14.0303517"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.8312742"
Evaluating: 34.8312742+3.5
 Parameter: YMAX <- "38.3312742"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.4202313"
Evaluating: -40.4202313+3.5
 Parameter: ZMAX <- "-36.9202313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.5303517"
Evaluating: -17.5303517-3.5
 Parameter: XMIN <- "-21.0303517"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.8312742"
Evaluating: 34.8312742-3.5
 Parameter: YMIN <- "31.3312742"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.4202313"
Evaluating: -40.4202313-3.5
 Parameter: ZMIN <- "-43.9202313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.0303517"
 Parameter: XMIN -> "-21.0303517"
 Parameter: YMAX -> "38.3312742"
 Parameter: YMIN -> "31.3312742"
 Parameter: ZMAX -> "-36.9202313"
 Parameter: ZMIN -> "-43.9202313"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "10" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "10" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.795168469E-02"
Evaluating: 100.116666*(4.795168469E-02-0.5)
 Parameter: XPOS <- "-45.2575702"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.396231362"
Evaluating: 100.116666*(0.396231362-0.5)
 Parameter: YPOS <- "-10.3889701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.123816208"
Evaluating: 127.138691*(0.123816208-0.5)+4.2778237
 Parameter: ZPOS <- "-43.5496912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.5496912" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.2575702"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.2575702-0
 Parameter: XTRAN <- "-45.2575702"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.3889701"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.3889701-0
 Parameter: YTRAN <- "-10.3889701"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.5496912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.5496912-0
 Parameter: ZTRAN <- "-43.5496912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.2575702"
 Parameter: YTRAN -> "-10.3889701"
 Parameter: ZTRAN -> "-43.5496912"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -45.257570  -10.388970  -43.549691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.564073103"
Evaluating: 0.564073103*360.0
 Parameter: XPHI <- "203.066317"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592841035"
Evaluating: 0.592841035*360.0
 Parameter: YPHI <- "213.422773"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.954882668E-02"
Evaluating: 8.954882668E-02*360.0
 Parameter: ZPHI <- "32.2375776"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.2575702"
 Parameter: YPOS -> "-10.3889701"
 Parameter: ZPOS -> "-43.5496912"
 Parameter: XPHI -> "203.066317"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.920052   -0.391796
    0.000000    0.391796   -0.920052

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.2575702"
 Parameter: YPOS -> "-10.3889701"
 Parameter: ZPOS -> "-43.5496912"
 Parameter: YPHI -> "213.422773"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.834629    0.000000    0.550813
    0.000000    1.000000    0.000000
   -0.550813    0.000000   -0.834629

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.2575702"
 Parameter: YPOS -> "-10.3889701"
 Parameter: ZPOS -> "-43.5496912"
 Parameter: ZPHI -> "32.2375776"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.845843    0.533431    0.000000
   -0.533431    0.845843    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.257570 XMAX =  -45.257570 XAVE =  -45.257570
    YMIN =  -10.388970 YMAX =  -10.388970 YAVE =  -10.388970
    ZMIN =  -43.549691 ZMAX =  -43.549691 ZAVE =  -43.549691
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.2575702"
Evaluating: -45.2575702+3.5
 Parameter: XMAX <- "-41.7575702"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.3889701"
Evaluating: -10.3889701+3.5
 Parameter: YMAX <- "-6.8889701"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.5496912"
Evaluating: -43.5496912+3.5
 Parameter: ZMAX <- "-40.0496912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.2575702"
Evaluating: -45.2575702-3.5
 Parameter: XMIN <- "-48.7575702"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.3889701"
Evaluating: -10.3889701-3.5
 Parameter: YMIN <- "-13.8889701"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.5496912"
Evaluating: -43.5496912-3.5
 Parameter: ZMIN <- "-47.0496912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.7575702"
 Parameter: XMIN -> "-48.7575702"
 Parameter: YMAX -> "-6.8889701"
 Parameter: YMIN -> "-13.8889701"
 Parameter: ZMAX -> "-40.0496912"
 Parameter: ZMIN -> "-47.0496912"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "11" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "11" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.111311163"
Evaluating: 100.116666*(0.111311163-0.5)
 Parameter: XPOS <- "-38.9142305"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.226980004"
Evaluating: 100.116666*(0.226980004-0.5)
 Parameter: YPOS <- "-27.3338518"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "6.417336447E-02"
Evaluating: 127.138691*(6.417336447E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-51.1326042"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.1326042" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.9142305"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.9142305-0
 Parameter: XTRAN <- "-38.9142305"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.3338518"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.3338518-0
 Parameter: YTRAN <- "-27.3338518"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.1326042"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.1326042-0
 Parameter: ZTRAN <- "-51.1326042"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.9142305"
 Parameter: YTRAN -> "-27.3338518"
 Parameter: ZTRAN -> "-51.1326042"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -38.914231  -27.333852  -51.132604
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.951779298E-02"
Evaluating: 2.951779298E-02*360.0
 Parameter: XPHI <- "10.6264055"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446302617"
Evaluating: 0.446302617*360.0
 Parameter: YPHI <- "160.668942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89432639"
Evaluating: 0.89432639*360.0
 Parameter: ZPHI <- "321.9575"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.9142305"
 Parameter: YPOS -> "-27.3338518"
 Parameter: ZPOS -> "-51.1326042"
 Parameter: XPHI -> "10.6264055"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.982850    0.184404
    0.000000   -0.184404    0.982850

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   10.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.9142305"
 Parameter: YPOS -> "-27.3338518"
 Parameter: ZPOS -> "-51.1326042"
 Parameter: YPHI -> "160.668942"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.943622    0.000000   -0.331026
    0.000000    1.000000    0.000000
    0.331026    0.000000   -0.943622

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.9142305"
 Parameter: YPOS -> "-27.3338518"
 Parameter: ZPOS -> "-51.1326042"
 Parameter: ZPHI -> "321.9575"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.787554   -0.616246    0.000000
    0.616246    0.787554    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.914231 XMAX =  -38.914231 XAVE =  -38.914231
    YMIN =  -27.333852 YMAX =  -27.333852 YAVE =  -27.333852
    ZMIN =  -51.132604 ZMAX =  -51.132604 ZAVE =  -51.132604
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.9142305"
Evaluating: -38.9142305+3.5
 Parameter: XMAX <- "-35.4142305"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.3338518"
Evaluating: -27.3338518+3.5
 Parameter: YMAX <- "-23.8338518"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.1326042"
Evaluating: -51.1326042+3.5
 Parameter: ZMAX <- "-47.6326042"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.9142305"
Evaluating: -38.9142305-3.5
 Parameter: XMIN <- "-42.4142305"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.3338518"
Evaluating: -27.3338518-3.5
 Parameter: YMIN <- "-30.8338518"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.1326042"
Evaluating: -51.1326042-3.5
 Parameter: ZMIN <- "-54.6326042"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.4142305"
 Parameter: XMIN -> "-42.4142305"
 Parameter: YMAX -> "-23.8338518"
 Parameter: YMIN -> "-30.8338518"
 Parameter: ZMAX -> "-47.6326042"
 Parameter: ZMIN -> "-54.6326042"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "12" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "12" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.259048436"
Evaluating: 100.116666*(0.259048436-0.5)
 Parameter: XPOS <- "-24.1232673"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.218190924"
Evaluating: 100.116666*(0.218190924-0.5)
 Parameter: YPOS <- "-28.2137851"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.588367304"
Evaluating: 127.138691*(0.588367304-0.5)+4.2778237
 Parameter: ZPOS <- "15.5127271"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.5127271" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.5127271" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.1232673"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.1232673-0
 Parameter: XTRAN <- "-24.1232673"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.2137851"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.2137851-0
 Parameter: YTRAN <- "-28.2137851"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.5127271"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.5127271-0
 Parameter: ZTRAN <- "15.5127271"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.1232673"
 Parameter: YTRAN -> "-28.2137851"
 Parameter: ZTRAN -> "15.5127271"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -24.123267  -28.213785   15.512727
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473085607"
Evaluating: 0.473085607*360.0
 Parameter: XPHI <- "170.310819"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17409526"
Evaluating: 0.17409526*360.0
 Parameter: YPHI <- "62.6742936"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.281127611E-04"
Evaluating: 3.281127611E-04*360.0
 Parameter: ZPHI <- "0.118120594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.1232673"
 Parameter: YPOS -> "-28.2137851"
 Parameter: ZPOS -> "15.5127271"
 Parameter: XPHI -> "170.310819"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.985735    0.168303
    0.000000   -0.168303   -0.985735

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.1232673"
 Parameter: YPOS -> "-28.2137851"
 Parameter: ZPOS -> "15.5127271"
 Parameter: YPHI -> "62.6742936"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.459048    0.000000   -0.888411
    0.000000    1.000000    0.000000
    0.888411    0.000000    0.459048

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.1232673"
 Parameter: YPOS -> "-28.2137851"
 Parameter: ZPOS -> "15.5127271"
 Parameter: ZPHI -> "0.118120594"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999998    0.002062    0.000000
   -0.002062    0.999998    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.123267 XMAX =  -24.123267 XAVE =  -24.123267
    YMIN =  -28.213785 YMAX =  -28.213785 YAVE =  -28.213785
    ZMIN =   15.512727 ZMAX =   15.512727 ZAVE =   15.512727
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.1232673"
Evaluating: -24.1232673+3.5
 Parameter: XMAX <- "-20.6232673"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.2137851"
Evaluating: -28.2137851+3.5
 Parameter: YMAX <- "-24.7137851"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.5127271"
Evaluating: 15.5127271+3.5
 Parameter: ZMAX <- "19.0127271"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.1232673"
Evaluating: -24.1232673-3.5
 Parameter: XMIN <- "-27.6232673"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.2137851"
Evaluating: -28.2137851-3.5
 Parameter: YMIN <- "-31.7137851"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.5127271"
Evaluating: 15.5127271-3.5
 Parameter: ZMIN <- "12.0127271"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.6232673"
 Parameter: XMIN -> "-27.6232673"
 Parameter: YMAX -> "-24.7137851"
 Parameter: YMIN -> "-31.7137851"
 Parameter: ZMAX -> "19.0127271"
 Parameter: ZMIN -> "12.0127271"
 SELRPN>     22 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      8 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39217 POS      SOD      12       SOD     -**** MEMB     POPC     43       C14           3.9428
39217 POS      SOD      12       SOD     -**** MEMB     POPC     45       C12           3.9649
39217 POS      SOD      12       SOD     -**** MEMB     POPC     45       C13           3.5087
39217 POS      SOD      12       SOD     -**** MEMB     POPC     45       C24           3.6791
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "12" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.876138321"
Evaluating: 100.116666*(0.876138321-0.5)
 Parameter: XPOS <- "37.6577147"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.198252089"
Evaluating: 100.116666*(0.198252089-0.5)
 Parameter: YPOS <- "-30.2099948"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.43688005"
Evaluating: 127.138691*(0.43688005-0.5)+4.2778237
 Parameter: ZPOS <- "-3.74716412"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.74716412" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.74716412" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "12" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.931942803"
Evaluating: 100.116666*(0.931942803-0.5)
 Parameter: XPOS <- "43.2446733"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.528998266"
Evaluating: 100.116666*(0.528998266-0.5)
 Parameter: YPOS <- "2.90320971"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.60255112"
Evaluating: 127.138691*(0.60255112-0.5)+4.2778237
 Parameter: ZPOS <- "17.3160389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.3160389" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.3160389" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.123267 XMAX =  -24.123267 XAVE =  -24.123267
    YMIN =  -28.213785 YMAX =  -28.213785 YAVE =  -28.213785
    ZMIN =   15.512727 ZMAX =   15.512727 ZAVE =   15.512727
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.2446733"
 RDCMND substituted energy or value "?XAVE" to "-24.1232673"
Evaluating: 43.2446733--24.1232673
 Parameter: XTRAN <- "67.3679406"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.90320971"
 RDCMND substituted energy or value "?YAVE" to "-28.2137851"
Evaluating: 2.90320971--28.2137851
 Parameter: YTRAN <- "31.1169948"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.3160389"
 RDCMND substituted energy or value "?ZAVE" to "15.5127271"
Evaluating: 17.3160389-15.5127271
 Parameter: ZTRAN <- "1.8033118"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "67.3679406"
 Parameter: YTRAN -> "31.1169948"
 Parameter: ZTRAN -> "1.8033118"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    67.367941   31.116995    1.803312
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.628900031"
Evaluating: 0.628900031*360.0
 Parameter: XPHI <- "226.404011"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.124375801"
Evaluating: 0.124375801*360.0
 Parameter: YPHI <- "44.7752884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367995501"
Evaluating: 0.367995501*360.0
 Parameter: ZPHI <- "132.47838"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.2446733"
 Parameter: YPOS -> "2.90320971"
 Parameter: ZPOS -> "17.3160389"
 Parameter: XPHI -> "226.404011"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.689569   -0.724220
    0.000000    0.724220   -0.689569

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  133.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.2446733"
 Parameter: YPOS -> "2.90320971"
 Parameter: ZPOS -> "17.3160389"
 Parameter: YPHI -> "44.7752884"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.709875    0.000000   -0.704328
    0.000000    1.000000    0.000000
    0.704328    0.000000    0.709875

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.2446733"
 Parameter: YPOS -> "2.90320971"
 Parameter: ZPOS -> "17.3160389"
 Parameter: ZPHI -> "132.47838"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.675312    0.737532    0.000000
   -0.737532   -0.675312    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  132.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.244673 XMAX =   43.244673 XAVE =   43.244673
    YMIN =    2.903210 YMAX =    2.903210 YAVE =    2.903210
    ZMIN =   17.316039 ZMAX =   17.316039 ZAVE =   17.316039
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.2446733"
Evaluating: 43.2446733+3.5
 Parameter: XMAX <- "46.7446733"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.9032097"
Evaluating: 2.9032097+3.5
 Parameter: YMAX <- "6.4032097"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.3160389"
Evaluating: 17.3160389+3.5
 Parameter: ZMAX <- "20.8160389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.2446733"
Evaluating: 43.2446733-3.5
 Parameter: XMIN <- "39.7446733"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.9032097"
Evaluating: 2.9032097-3.5
 Parameter: YMIN <- "-0.5967903"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.3160389"
Evaluating: 17.3160389-3.5
 Parameter: ZMIN <- "13.8160389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.7446733"
 Parameter: XMIN -> "39.7446733"
 Parameter: YMAX -> "6.4032097"
 Parameter: YMIN -> "-0.5967903"
 Parameter: ZMAX -> "20.8160389"
 Parameter: ZMIN -> "13.8160389"
 SELRPN>     39 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     21 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39217 POS      SOD      12       SOD     -**** MEMB     POPC     68       C31           3.7361
39217 POS      SOD      12       SOD     -**** MEMB     POPC     68       O32           3.4304
39217 POS      SOD      12       SOD     -**** MEMB     POPC     68       C32           3.5442
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       N             3.4846
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C12           3.8793
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C13           2.5433
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C15           3.7004
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C11           3.8436
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       P             2.7351
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       O13           2.7752
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       O12           2.7714
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       O11           2.0825
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C1            1.0320
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C2            2.3737
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       O21           2.9680
39217 POS      SOD      12       SOD     -**** MEMB     POPC     84       C3            3.1546
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "12" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.188252632"
Evaluating: 100.116666*(0.188252632-0.5)
 Parameter: XPOS <- "-31.2111071"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.674946122E-02"
Evaluating: 100.116666*(7.674946122E-02-0.5)
 Parameter: YPOS <- "-42.3744328"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.239253654"
Evaluating: 127.138691*(0.239253654-0.5)+4.2778237
 Parameter: ZPOS <- "-28.8731254"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-28.8731254" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.244673 XMAX =   43.244673 XAVE =   43.244673
    YMIN =    2.903210 YMAX =    2.903210 YAVE =    2.903210
    ZMIN =   17.316039 ZMAX =   17.316039 ZAVE =   17.316039
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2111071"
 RDCMND substituted energy or value "?XAVE" to "43.2446733"
Evaluating: -31.2111071-43.2446733
 Parameter: XTRAN <- "-74.4557804"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.3744328"
 RDCMND substituted energy or value "?YAVE" to "2.9032097"
Evaluating: -42.3744328-2.9032097
 Parameter: YTRAN <- "-45.2776425"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.8731254"
 RDCMND substituted energy or value "?ZAVE" to "17.3160389"
Evaluating: -28.8731254-17.3160389
 Parameter: ZTRAN <- "-46.1891643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-74.4557804"
 Parameter: YTRAN -> "-45.2776425"
 Parameter: ZTRAN -> "-46.1891643"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -74.455780  -45.277642  -46.189164
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957394502"
Evaluating: 0.957394502*360.0
 Parameter: XPHI <- "344.662021"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.433610212"
Evaluating: 0.433610212*360.0
 Parameter: YPHI <- "156.099676"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.464670869"
Evaluating: 0.464670869*360.0
 Parameter: ZPHI <- "167.281513"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2111071"
 Parameter: YPOS -> "-42.3744328"
 Parameter: ZPOS -> "-28.8731254"
 Parameter: XPHI -> "344.662021"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.964382   -0.264512
    0.000000    0.264512    0.964382

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2111071"
 Parameter: YPOS -> "-42.3744328"
 Parameter: ZPOS -> "-28.8731254"
 Parameter: YPHI -> "156.099676"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.914252    0.000000   -0.405147
    0.000000    1.000000    0.000000
    0.405147    0.000000   -0.914252

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  156.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2111071"
 Parameter: YPOS -> "-42.3744328"
 Parameter: ZPOS -> "-28.8731254"
 Parameter: ZPHI -> "167.281513"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.975464    0.220161    0.000000
   -0.220161   -0.975464    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.211107 XMAX =  -31.211107 XAVE =  -31.211107
    YMIN =  -42.374433 YMAX =  -42.374433 YAVE =  -42.374433
    ZMIN =  -28.873125 ZMAX =  -28.873125 ZAVE =  -28.873125
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2111071"
Evaluating: -31.2111071+3.5
 Parameter: XMAX <- "-27.7111071"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.3744328"
Evaluating: -42.3744328+3.5
 Parameter: YMAX <- "-38.8744328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.8731254"
Evaluating: -28.8731254+3.5
 Parameter: ZMAX <- "-25.3731254"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2111071"
Evaluating: -31.2111071-3.5
 Parameter: XMIN <- "-34.7111071"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.3744328"
Evaluating: -42.3744328-3.5
 Parameter: YMIN <- "-45.8744328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.8731254"
Evaluating: -28.8731254-3.5
 Parameter: ZMIN <- "-32.3731254"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7111071"
 Parameter: XMIN -> "-34.7111071"
 Parameter: YMAX -> "-38.8744328"
 Parameter: YMIN -> "-45.8744328"
 Parameter: ZMAX -> "-25.3731254"
 Parameter: ZMIN -> "-32.3731254"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "13" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "13" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.101457038"
Evaluating: 100.116666*(0.101457038-0.5)
 Parameter: XPOS <- "-39.9007926"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.963824214"
Evaluating: 100.116666*(0.963824214-0.5)
 Parameter: YPOS <- "46.4365339"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.845899893"
Evaluating: 127.138691*(0.845899893-0.5)+4.2778237
 Parameter: ZPOS <- "48.2550833"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.2550833" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.2550833" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.9007926"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.9007926-0
 Parameter: XTRAN <- "-39.9007926"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.4365339"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.4365339-0
 Parameter: YTRAN <- "46.4365339"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.2550833"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 48.2550833-0
 Parameter: ZTRAN <- "48.2550833"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.9007926"
 Parameter: YTRAN -> "46.4365339"
 Parameter: ZTRAN -> "48.2550833"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -39.900793   46.436534   48.255083
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639632156"
Evaluating: 0.639632156*360.0
 Parameter: XPHI <- "230.267576"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374585537"
Evaluating: 0.374585537*360.0
 Parameter: YPHI <- "134.850793"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.104820954E-02"
Evaluating: 5.104820954E-02*360.0
 Parameter: ZPHI <- "18.3773554"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.9007926"
 Parameter: YPOS -> "46.4365339"
 Parameter: ZPOS -> "48.2550833"
 Parameter: XPHI -> "230.267576"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.639203   -0.769038
    0.000000    0.769038   -0.639203

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.9007926"
 Parameter: YPOS -> "46.4365339"
 Parameter: ZPOS -> "48.2550833"
 Parameter: YPHI -> "134.850793"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.705263    0.000000   -0.708946
    0.000000    1.000000    0.000000
    0.708946    0.000000   -0.705263

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.9007926"
 Parameter: YPOS -> "46.4365339"
 Parameter: ZPOS -> "48.2550833"
 Parameter: ZPHI -> "18.3773554"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.949001    0.315274    0.000000
   -0.315274    0.949001    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.900793 XMAX =  -39.900793 XAVE =  -39.900793
    YMIN =   46.436534 YMAX =   46.436534 YAVE =   46.436534
    ZMIN =   48.255083 ZMAX =   48.255083 ZAVE =   48.255083
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.9007926"
Evaluating: -39.9007926+3.5
 Parameter: XMAX <- "-36.4007926"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.4365339"
Evaluating: 46.4365339+3.5
 Parameter: YMAX <- "49.9365339"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.2550833"
Evaluating: 48.2550833+3.5
 Parameter: ZMAX <- "51.7550833"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.9007926"
Evaluating: -39.9007926-3.5
 Parameter: XMIN <- "-43.4007926"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.4365339"
Evaluating: 46.4365339-3.5
 Parameter: YMIN <- "42.9365339"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.2550833"
Evaluating: 48.2550833-3.5
 Parameter: ZMIN <- "44.7550833"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.4007926"
 Parameter: XMIN -> "-43.4007926"
 Parameter: YMAX -> "49.9365339"
 Parameter: YMIN -> "42.9365339"
 Parameter: ZMAX -> "51.7550833"
 Parameter: ZMIN -> "44.7550833"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "14" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "14" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.15658323"
Evaluating: 100.116666*(0.15658323-0.5)
 Parameter: XPOS <- "-34.3817421"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.57938987"
Evaluating: 100.116666*(0.57938987-0.5)
 Parameter: YPOS <- "7.9482491"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.320170655"
Evaluating: 127.138691*(0.320170655-0.5)+4.2778237
 Parameter: ZPOS <- "-18.5854438"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.5854438" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.3817421"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.3817421-0
 Parameter: XTRAN <- "-34.3817421"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.9482491"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.9482491-0
 Parameter: YTRAN <- "7.9482491"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.5854438"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.5854438-0
 Parameter: ZTRAN <- "-18.5854438"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.3817421"
 Parameter: YTRAN -> "7.9482491"
 Parameter: ZTRAN -> "-18.5854438"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -34.381742    7.948249  -18.585444
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.079532487E-02"
Evaluating: 4.079532487E-02*360.0
 Parameter: XPHI <- "14.686317"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631939402"
Evaluating: 0.631939402*360.0
 Parameter: YPHI <- "227.498185"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330479181"
Evaluating: 0.330479181*360.0
 Parameter: ZPHI <- "118.972505"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.3817421"
 Parameter: YPOS -> "7.9482491"
 Parameter: ZPOS -> "-18.5854438"
 Parameter: XPHI -> "14.686317"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.967328    0.253527
    0.000000   -0.253527    0.967328

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.3817421"
 Parameter: YPOS -> "7.9482491"
 Parameter: ZPOS -> "-18.5854438"
 Parameter: YPHI -> "227.498185"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.675614    0.000000    0.737256
    0.000000    1.000000    0.000000
   -0.737256    0.000000   -0.675614

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  132.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.3817421"
 Parameter: YPOS -> "7.9482491"
 Parameter: ZPOS -> "-18.5854438"
 Parameter: ZPHI -> "118.972505"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.484390    0.874852    0.000000
   -0.874852   -0.484390    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.381742 XMAX =  -34.381742 XAVE =  -34.381742
    YMIN =    7.948249 YMAX =    7.948249 YAVE =    7.948249
    ZMIN =  -18.585444 ZMAX =  -18.585444 ZAVE =  -18.585444
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.3817421"
Evaluating: -34.3817421+3.5
 Parameter: XMAX <- "-30.8817421"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.9482491"
Evaluating: 7.9482491+3.5
 Parameter: YMAX <- "11.4482491"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.5854438"
Evaluating: -18.5854438+3.5
 Parameter: ZMAX <- "-15.0854438"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.3817421"
Evaluating: -34.3817421-3.5
 Parameter: XMIN <- "-37.8817421"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.9482491"
Evaluating: 7.9482491-3.5
 Parameter: YMIN <- "4.4482491"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.5854438"
Evaluating: -18.5854438-3.5
 Parameter: ZMIN <- "-22.0854438"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.8817421"
 Parameter: XMIN -> "-37.8817421"
 Parameter: YMAX -> "11.4482491"
 Parameter: YMIN -> "4.4482491"
 Parameter: ZMAX -> "-15.0854438"
 Parameter: ZMIN -> "-22.0854438"
 SELRPN>     30 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     15 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      C1            2.8641
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      C2            2.7132
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      O21           3.9409
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      C3            1.7606
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      O31           2.3050
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      C31           2.6841
39219 POS      SOD      14       SOD     -**** MEMB     POPC     175      O32           2.7957
39219 POS      SOD      14       SOD     -**** MEMB     POPC     191      N             3.7581
39219 POS      SOD      14       SOD     -**** MEMB     POPC     191      C14           2.5663
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "14" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.878907214"
Evaluating: 100.116666*(0.878907214-0.5)
 Parameter: XPOS <- "37.934927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.37588692"
Evaluating: 100.116666*(0.37588692-0.5)
 Parameter: YPOS <- "-12.4257878"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "8.340202208E-02"
Evaluating: 127.138691*(8.340202208E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-48.6878979"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.6878979" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.381742 XMAX =  -34.381742 XAVE =  -34.381742
    YMIN =    7.948249 YMAX =    7.948249 YAVE =    7.948249
    ZMIN =  -18.585444 ZMAX =  -18.585444 ZAVE =  -18.585444
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.934927"
 RDCMND substituted energy or value "?XAVE" to "-34.3817421"
Evaluating: 37.934927--34.3817421
 Parameter: XTRAN <- "72.3166691"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4257878"
 RDCMND substituted energy or value "?YAVE" to "7.9482491"
Evaluating: -12.4257878-7.9482491
 Parameter: YTRAN <- "-20.3740369"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.6878979"
 RDCMND substituted energy or value "?ZAVE" to "-18.5854438"
Evaluating: -48.6878979--18.5854438
 Parameter: ZTRAN <- "-30.1024541"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "72.3166691"
 Parameter: YTRAN -> "-20.3740369"
 Parameter: ZTRAN -> "-30.1024541"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    72.316669  -20.374037  -30.102454
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312667701"
Evaluating: 0.312667701*360.0
 Parameter: XPHI <- "112.560372"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547870889"
Evaluating: 0.547870889*360.0
 Parameter: YPHI <- "197.23352"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.893822312"
Evaluating: 0.893822312*360.0
 Parameter: ZPHI <- "321.776032"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.934927"
 Parameter: YPOS -> "-12.4257878"
 Parameter: ZPOS -> "-48.6878979"
 Parameter: XPHI -> "112.560372"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.383657    0.923476
    0.000000   -0.923476   -0.383657

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.934927"
 Parameter: YPOS -> "-12.4257878"
 Parameter: ZPOS -> "-48.6878979"
 Parameter: YPHI -> "197.23352"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.955105    0.000000    0.296267
    0.000000    1.000000    0.000000
   -0.296267    0.000000   -0.955105

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.934927"
 Parameter: YPOS -> "-12.4257878"
 Parameter: ZPOS -> "-48.6878979"
 Parameter: ZPHI -> "321.776032"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.785598   -0.618737    0.000000
    0.618737    0.785598    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.934927 XMAX =   37.934927 XAVE =   37.934927
    YMIN =  -12.425788 YMAX =  -12.425788 YAVE =  -12.425788
    ZMIN =  -48.687898 ZMAX =  -48.687898 ZAVE =  -48.687898
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.934927"
Evaluating: 37.934927+3.5
 Parameter: XMAX <- "41.434927"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4257878"
Evaluating: -12.4257878+3.5
 Parameter: YMAX <- "-8.9257878"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.6878979"
Evaluating: -48.6878979+3.5
 Parameter: ZMAX <- "-45.1878979"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.934927"
Evaluating: 37.934927-3.5
 Parameter: XMIN <- "34.434927"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4257878"
Evaluating: -12.4257878-3.5
 Parameter: YMIN <- "-15.9257878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.6878979"
Evaluating: -48.6878979-3.5
 Parameter: ZMIN <- "-52.1878979"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.434927"
 Parameter: XMIN -> "34.434927"
 Parameter: YMAX -> "-8.9257878"
 Parameter: YMIN -> "-15.9257878"
 Parameter: ZMAX -> "-45.1878979"
 Parameter: ZMIN -> "-52.1878979"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "15" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "15" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.894179684"
Evaluating: 100.116666*(0.894179684-0.5)
 Parameter: XPOS <- "39.4639558"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.814538569"
Evaluating: 100.116666*(0.814538569-0.5)
 Parameter: YPOS <- "31.4905529"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.553681088"
Evaluating: 127.138691*(0.553681088-0.5)+4.2778237
 Parameter: ZPOS <- "11.102767"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.102767" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.102767" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "15" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.168859694"
Evaluating: 100.116666*(0.168859694-0.5)
 Parameter: XPOS <- "-33.1526634"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.810278671"
Evaluating: 100.116666*(0.810278671-0.5)
 Parameter: YPOS <- "31.0640661"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.362636504"
Evaluating: 127.138691*(0.362636504-0.5)+4.2778237
 Parameter: ZPOS <- "-13.1863914"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.1863914" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.1863914" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "15" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.208749293"
Evaluating: 100.116666*(0.208749293-0.5)
 Parameter: XPOS <- "-29.1590498"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.755492643"
Evaluating: 100.116666*(0.755492643-0.5)
 Parameter: YPOS <- "25.5790716"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.74336721"
Evaluating: 127.138691*(0.74336721-0.5)+4.2778237
 Parameter: ZPOS <- "35.2192122"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.2192122" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.2192122" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.1590498"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.1590498-0
 Parameter: XTRAN <- "-29.1590498"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.5790716"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.5790716-0
 Parameter: YTRAN <- "25.5790716"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.2192122"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.2192122-0
 Parameter: ZTRAN <- "35.2192122"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.1590498"
 Parameter: YTRAN -> "25.5790716"
 Parameter: ZTRAN -> "35.2192122"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -29.159050   25.579072   35.219212
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.861272711"
Evaluating: 0.861272711*360.0
 Parameter: XPHI <- "310.058176"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.309691802"
Evaluating: 0.309691802*360.0
 Parameter: YPHI <- "111.489049"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49129208"
Evaluating: 0.49129208*360.0
 Parameter: ZPHI <- "176.865149"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.1590498"
 Parameter: YPOS -> "25.5790716"
 Parameter: ZPOS -> "35.2192122"
 Parameter: XPHI -> "310.058176"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.643565   -0.765391
    0.000000    0.765391    0.643565

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   49.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.1590498"
 Parameter: YPOS -> "25.5790716"
 Parameter: ZPOS -> "35.2192122"
 Parameter: YPHI -> "111.489049"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.366323    0.000000   -0.930488
    0.000000    1.000000    0.000000
    0.930488    0.000000   -0.366323

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  111.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.1590498"
 Parameter: YPOS -> "25.5790716"
 Parameter: ZPOS -> "35.2192122"
 Parameter: ZPHI -> "176.865149"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.998504    0.054686    0.000000
   -0.054686   -0.998504    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.159050 XMAX =  -29.159050 XAVE =  -29.159050
    YMIN =   25.579072 YMAX =   25.579072 YAVE =   25.579072
    ZMIN =   35.219212 ZMAX =   35.219212 ZAVE =   35.219212
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.1590498"
Evaluating: -29.1590498+3.5
 Parameter: XMAX <- "-25.6590498"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.5790716"
Evaluating: 25.5790716+3.5
 Parameter: YMAX <- "29.0790716"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.2192122"
Evaluating: 35.2192122+3.5
 Parameter: ZMAX <- "38.7192122"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.1590498"
Evaluating: -29.1590498-3.5
 Parameter: XMIN <- "-32.6590498"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.5790716"
Evaluating: 25.5790716-3.5
 Parameter: YMIN <- "22.0790716"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.2192122"
Evaluating: 35.2192122-3.5
 Parameter: ZMIN <- "31.7192122"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.6590498"
 Parameter: XMIN -> "-32.6590498"
 Parameter: YMAX -> "29.0790716"
 Parameter: YMIN -> "22.0790716"
 Parameter: ZMAX -> "38.7192122"
 Parameter: ZMIN -> "31.7192122"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "16" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "16" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.985513355"
Evaluating: 100.116666*(0.985513355-0.5)
 Parameter: XPOS <- "48.6079784"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.41508122"
Evaluating: 100.116666*(0.41508122-0.5)
 Parameter: YPOS <- "-8.50178513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.143770146"
Evaluating: 127.138691*(0.143770146-0.5)+4.2778237
 Parameter: ZPOS <- "-41.0127736"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.0127736" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.6079784"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.6079784-0
 Parameter: XTRAN <- "48.6079784"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.50178513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.50178513-0
 Parameter: YTRAN <- "-8.50178513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.0127736"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.0127736-0
 Parameter: ZTRAN <- "-41.0127736"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.6079784"
 Parameter: YTRAN -> "-8.50178513"
 Parameter: ZTRAN -> "-41.0127736"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    48.607978   -8.501785  -41.012774
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387100061"
Evaluating: 0.387100061*360.0
 Parameter: XPHI <- "139.356022"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20239993"
Evaluating: 0.20239993*360.0
 Parameter: YPHI <- "72.8639748"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926657167"
Evaluating: 0.926657167*360.0
 Parameter: ZPHI <- "333.59658"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.6079784"
 Parameter: YPOS -> "-8.50178513"
 Parameter: ZPOS -> "-41.0127736"
 Parameter: XPHI -> "139.356022"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.758772    0.651357
    0.000000   -0.651357   -0.758772

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  139.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.6079784"
 Parameter: YPOS -> "-8.50178513"
 Parameter: ZPOS -> "-41.0127736"
 Parameter: YPHI -> "72.8639748"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.294641    0.000000   -0.955608
    0.000000    1.000000    0.000000
    0.955608    0.000000    0.294641

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.6079784"
 Parameter: YPOS -> "-8.50178513"
 Parameter: ZPOS -> "-41.0127736"
 Parameter: ZPHI -> "333.59658"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.895685   -0.444689    0.000000
    0.444689    0.895685    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   26.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.607978 XMAX =   48.607978 XAVE =   48.607978
    YMIN =   -8.501785 YMAX =   -8.501785 YAVE =   -8.501785
    ZMIN =  -41.012774 ZMAX =  -41.012774 ZAVE =  -41.012774
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.6079784"
Evaluating: 48.6079784+3.5
 Parameter: XMAX <- "52.1079784"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.50178513"
Evaluating: -8.50178513+3.5
 Parameter: YMAX <- "-5.00178513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.0127736"
Evaluating: -41.0127736+3.5
 Parameter: ZMAX <- "-37.5127736"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.6079784"
Evaluating: 48.6079784-3.5
 Parameter: XMIN <- "45.1079784"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.50178513"
Evaluating: -8.50178513-3.5
 Parameter: YMIN <- "-12.0017851"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.0127736"
Evaluating: -41.0127736-3.5
 Parameter: ZMIN <- "-44.5127736"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.1079784"
 Parameter: XMIN -> "45.1079784"
 Parameter: YMAX -> "-5.00178513"
 Parameter: YMIN -> "-12.0017851"
 Parameter: ZMAX -> "-37.5127736"
 Parameter: ZMIN -> "-44.5127736"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "17" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "17" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.35969827"
Evaluating: 100.116666*(0.35969827-0.5)
 Parameter: XPOS <- "-14.0465414"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.793862058"
Evaluating: 100.116666*(0.793862058-0.5)
 Parameter: YPOS <- "29.4204895"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.268847055"
Evaluating: 127.138691*(0.268847055-0.5)+4.2778237
 Parameter: ZPOS <- "-25.1106591"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.1106591" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.0465414"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.0465414-0
 Parameter: XTRAN <- "-14.0465414"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.4204895"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.4204895-0
 Parameter: YTRAN <- "29.4204895"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.1106591"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.1106591-0
 Parameter: ZTRAN <- "-25.1106591"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.0465414"
 Parameter: YTRAN -> "29.4204895"
 Parameter: ZTRAN -> "-25.1106591"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -14.046541   29.420489  -25.110659
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.258661409E-03"
Evaluating: 1.258661409E-03*360.0
 Parameter: XPHI <- "0.453118107"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299468146"
Evaluating: 0.299468146*360.0
 Parameter: YPHI <- "107.808533"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995111045"
Evaluating: 0.995111045*360.0
 Parameter: ZPHI <- "358.239976"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.0465414"
 Parameter: YPOS -> "29.4204895"
 Parameter: ZPOS -> "-25.1106591"
 Parameter: XPHI -> "0.453118107"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999969    0.007908
    0.000000   -0.007908    0.999969

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.0465414"
 Parameter: YPOS -> "29.4204895"
 Parameter: ZPOS -> "-25.1106591"
 Parameter: YPHI -> "107.808533"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.305837    0.000000   -0.952084
    0.000000    1.000000    0.000000
    0.952084    0.000000   -0.305837

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.0465414"
 Parameter: YPOS -> "29.4204895"
 Parameter: ZPOS -> "-25.1106591"
 Parameter: ZPHI -> "358.239976"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999528   -0.030713    0.000000
    0.030713    0.999528    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.046541 XMAX =  -14.046541 XAVE =  -14.046541
    YMIN =   29.420489 YMAX =   29.420489 YAVE =   29.420489
    ZMIN =  -25.110659 ZMAX =  -25.110659 ZAVE =  -25.110659
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.0465414"
Evaluating: -14.0465414+3.5
 Parameter: XMAX <- "-10.5465414"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.4204895"
Evaluating: 29.4204895+3.5
 Parameter: YMAX <- "32.9204895"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.1106591"
Evaluating: -25.1106591+3.5
 Parameter: ZMAX <- "-21.6106591"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.0465414"
Evaluating: -14.0465414-3.5
 Parameter: XMIN <- "-17.5465414"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.4204895"
Evaluating: 29.4204895-3.5
 Parameter: YMIN <- "25.9204895"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.1106591"
Evaluating: -25.1106591-3.5
 Parameter: ZMIN <- "-28.6106591"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.5465414"
 Parameter: XMIN -> "-17.5465414"
 Parameter: YMAX -> "32.9204895"
 Parameter: YMIN -> "25.9204895"
 Parameter: ZMAX -> "-21.6106591"
 Parameter: ZMIN -> "-28.6106591"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "18" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "18" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "8.828777931E-02"
Evaluating: 100.116666*(8.828777931E-02-0.5)
 Parameter: XPOS <- "-41.2192549"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.597204819"
Evaluating: 100.116666*(0.597204819-0.5)
 Parameter: YPOS <- "9.7318224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "8.772567038E-02"
Evaluating: 127.138691*(8.772567038E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-48.1381949"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.1381949" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.2192549"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.2192549-0
 Parameter: XTRAN <- "-41.2192549"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.7318224"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.7318224-0
 Parameter: YTRAN <- "9.7318224"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.1381949"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.1381949-0
 Parameter: ZTRAN <- "-48.1381949"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.2192549"
 Parameter: YTRAN -> "9.7318224"
 Parameter: ZTRAN -> "-48.1381949"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -41.219255    9.731822  -48.138195
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.151938387"
Evaluating: 0.151938387*360.0
 Parameter: XPHI <- "54.6978193"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.713234296"
Evaluating: 0.713234296*360.0
 Parameter: YPHI <- "256.764347"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491350462"
Evaluating: 0.491350462*360.0
 Parameter: ZPHI <- "176.886166"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.2192549"
 Parameter: YPOS -> "9.7318224"
 Parameter: ZPOS -> "-48.1381949"
 Parameter: XPHI -> "54.6978193"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.577889    0.816116
    0.000000   -0.816116    0.577889

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   54.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.2192549"
 Parameter: YPOS -> "9.7318224"
 Parameter: ZPOS -> "-48.1381949"
 Parameter: YPHI -> "256.764347"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.228957    0.000000    0.973437
    0.000000    1.000000    0.000000
   -0.973437    0.000000   -0.228957

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.2192549"
 Parameter: YPOS -> "9.7318224"
 Parameter: ZPOS -> "-48.1381949"
 Parameter: ZPHI -> "176.886166"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.998524    0.054320    0.000000
   -0.054320   -0.998524    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.219255 XMAX =  -41.219255 XAVE =  -41.219255
    YMIN =    9.731822 YMAX =    9.731822 YAVE =    9.731822
    ZMIN =  -48.138195 ZMAX =  -48.138195 ZAVE =  -48.138195
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.2192549"
Evaluating: -41.2192549+3.5
 Parameter: XMAX <- "-37.7192549"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.7318224"
Evaluating: 9.7318224+3.5
 Parameter: YMAX <- "13.2318224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.1381949"
Evaluating: -48.1381949+3.5
 Parameter: ZMAX <- "-44.6381949"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.2192549"
Evaluating: -41.2192549-3.5
 Parameter: XMIN <- "-44.7192549"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.7318224"
Evaluating: 9.7318224-3.5
 Parameter: YMIN <- "6.2318224"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.1381949"
Evaluating: -48.1381949-3.5
 Parameter: ZMIN <- "-51.6381949"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.7192549"
 Parameter: XMIN -> "-44.7192549"
 Parameter: YMAX -> "13.2318224"
 Parameter: YMIN -> "6.2318224"
 Parameter: ZMAX -> "-44.6381949"
 Parameter: ZMIN -> "-51.6381949"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "19" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "19" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.791829754"
Evaluating: 100.116666*(0.791829754-0.5)
 Parameter: XPOS <- "29.217022"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.605877999"
Evaluating: 100.116666*(0.605877999-0.5)
 Parameter: YPOS <- "10.6001523"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.17573313"
Evaluating: 127.138691*(0.17573313-0.5)+4.2778237
 Parameter: ZPOS <- "-36.9490417"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.9490417" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.217022"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.217022-0
 Parameter: XTRAN <- "29.217022"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.6001523"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.6001523-0
 Parameter: YTRAN <- "10.6001523"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.9490417"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.9490417-0
 Parameter: ZTRAN <- "-36.9490417"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.217022"
 Parameter: YTRAN -> "10.6001523"
 Parameter: ZTRAN -> "-36.9490417"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    29.217022   10.600152  -36.949042
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.482856245"
Evaluating: 0.482856245*360.0
 Parameter: XPHI <- "173.828248"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.844358216"
Evaluating: 0.844358216*360.0
 Parameter: YPHI <- "303.968958"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174032438"
Evaluating: 0.174032438*360.0
 Parameter: ZPHI <- "62.6516777"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.217022"
 Parameter: YPOS -> "10.6001523"
 Parameter: ZPOS -> "-36.9490417"
 Parameter: XPHI -> "173.828248"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994204    0.107509
    0.000000   -0.107509   -0.994204

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  173.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.217022"
 Parameter: YPOS -> "10.6001523"
 Parameter: ZPOS -> "-36.9490417"
 Parameter: YPHI -> "303.968958"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.558744    0.000000    0.829340
    0.000000    1.000000    0.000000
   -0.829340    0.000000    0.558744

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.217022"
 Parameter: YPOS -> "10.6001523"
 Parameter: ZPOS -> "-36.9490417"
 Parameter: ZPHI -> "62.6516777"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.459399    0.888230    0.000000
   -0.888230    0.459399    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.217022 XMAX =   29.217022 XAVE =   29.217022
    YMIN =   10.600152 YMAX =   10.600152 YAVE =   10.600152
    ZMIN =  -36.949042 ZMAX =  -36.949042 ZAVE =  -36.949042
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.217022"
Evaluating: 29.217022+3.5
 Parameter: XMAX <- "32.717022"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.6001523"
Evaluating: 10.6001523+3.5
 Parameter: YMAX <- "14.1001523"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.9490417"
Evaluating: -36.9490417+3.5
 Parameter: ZMAX <- "-33.4490417"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.217022"
Evaluating: 29.217022-3.5
 Parameter: XMIN <- "25.717022"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.6001523"
Evaluating: 10.6001523-3.5
 Parameter: YMIN <- "7.1001523"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.9490417"
Evaluating: -36.9490417-3.5
 Parameter: ZMIN <- "-40.4490417"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.717022"
 Parameter: XMIN -> "25.717022"
 Parameter: YMAX -> "14.1001523"
 Parameter: YMIN -> "7.1001523"
 Parameter: ZMAX -> "-33.4490417"
 Parameter: ZMIN -> "-40.4490417"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "20" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "20" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.648072187"
Evaluating: 100.116666*(0.648072187-0.5)
 Parameter: XPOS <- "14.8244937"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.944609176"
Evaluating: 100.116666*(0.944609176-0.5)
 Parameter: YPOS <- "44.5127884"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.679969439"
Evaluating: 127.138691*(0.679969439-0.5)+4.2778237
 Parameter: ZPOS <- "27.1589026"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.1589026" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.1589026" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.8244937"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.8244937-0
 Parameter: XTRAN <- "14.8244937"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.5127884"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.5127884-0
 Parameter: YTRAN <- "44.5127884"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.1589026"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.1589026-0
 Parameter: ZTRAN <- "27.1589026"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.8244937"
 Parameter: YTRAN -> "44.5127884"
 Parameter: ZTRAN -> "27.1589026"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    14.824494   44.512788   27.158903
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271556281"
Evaluating: 0.271556281*360.0
 Parameter: XPHI <- "97.7602612"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587246253"
Evaluating: 0.587246253*360.0
 Parameter: YPHI <- "211.408651"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.768621705"
Evaluating: 0.768621705*360.0
 Parameter: ZPHI <- "276.703814"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.8244937"
 Parameter: YPOS -> "44.5127884"
 Parameter: ZPOS -> "27.1589026"
 Parameter: XPHI -> "97.7602612"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.135028    0.990842
    0.000000   -0.990842   -0.135028

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.8244937"
 Parameter: YPOS -> "44.5127884"
 Parameter: ZPOS -> "27.1589026"
 Parameter: YPHI -> "211.408651"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.853472    0.000000    0.521139
    0.000000    1.000000    0.000000
   -0.521139    0.000000   -0.853472

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.8244937"
 Parameter: YPOS -> "44.5127884"
 Parameter: ZPOS -> "27.1589026"
 Parameter: ZPHI -> "276.703814"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.116737   -0.993163    0.000000
    0.993163    0.116737    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.824494 XMAX =   14.824494 XAVE =   14.824494
    YMIN =   44.512788 YMAX =   44.512788 YAVE =   44.512788
    ZMIN =   27.158903 ZMAX =   27.158903 ZAVE =   27.158903
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.8244937"
Evaluating: 14.8244937+3.5
 Parameter: XMAX <- "18.3244937"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.5127884"
Evaluating: 44.5127884+3.5
 Parameter: YMAX <- "48.0127884"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.1589026"
Evaluating: 27.1589026+3.5
 Parameter: ZMAX <- "30.6589026"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.8244937"
Evaluating: 14.8244937-3.5
 Parameter: XMIN <- "11.3244937"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.5127884"
Evaluating: 44.5127884-3.5
 Parameter: YMIN <- "41.0127884"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.1589026"
Evaluating: 27.1589026-3.5
 Parameter: ZMIN <- "23.6589026"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.3244937"
 Parameter: XMIN -> "11.3244937"
 Parameter: YMAX -> "48.0127884"
 Parameter: YMIN -> "41.0127884"
 Parameter: ZMAX -> "30.6589026"
 Parameter: ZMIN -> "23.6589026"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "21" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "21" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.808301686"
Evaluating: 100.116666*(0.808301686-0.5)
 Parameter: XPOS <- "30.8661369"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.452926249"
Evaluating: 100.116666*(0.452926249-0.5)
 Parameter: YPOS <- "-4.71286701"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.813742425"
Evaluating: 127.138691*(0.813742425-0.5)+4.2778237
 Parameter: ZPOS <- "44.1666249"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.1666249" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.1666249" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.8661369"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 30.8661369-0
 Parameter: XTRAN <- "30.8661369"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.71286701"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.71286701-0
 Parameter: YTRAN <- "-4.71286701"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.1666249"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.1666249-0
 Parameter: ZTRAN <- "44.1666249"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.8661369"
 Parameter: YTRAN -> "-4.71286701"
 Parameter: ZTRAN -> "44.1666249"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    30.866137   -4.712867   44.166625
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744975112"
Evaluating: 0.744975112*360.0
 Parameter: XPHI <- "268.19104"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598450239"
Evaluating: 0.598450239*360.0
 Parameter: YPHI <- "215.442086"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524528549"
Evaluating: 0.524528549*360.0
 Parameter: ZPHI <- "188.830278"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.8661369"
 Parameter: YPOS -> "-4.71286701"
 Parameter: ZPOS -> "44.1666249"
 Parameter: XPHI -> "268.19104"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.031567   -0.999502
    0.000000    0.999502   -0.031567

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   91.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.8661369"
 Parameter: YPOS -> "-4.71286701"
 Parameter: ZPOS -> "44.1666249"
 Parameter: YPHI -> "215.442086"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.814702    0.000000    0.579880
    0.000000    1.000000    0.000000
   -0.579880    0.000000   -0.814702

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.8661369"
 Parameter: YPOS -> "-4.71286701"
 Parameter: ZPOS -> "44.1666249"
 Parameter: ZPHI -> "188.830278"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.988147   -0.153508    0.000000
    0.153508   -0.988147    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.866137 XMAX =   30.866137 XAVE =   30.866137
    YMIN =   -4.712867 YMAX =   -4.712867 YAVE =   -4.712867
    ZMIN =   44.166625 ZMAX =   44.166625 ZAVE =   44.166625
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.8661369"
Evaluating: 30.8661369+3.5
 Parameter: XMAX <- "34.3661369"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.71286701"
Evaluating: -4.71286701+3.5
 Parameter: YMAX <- "-1.21286701"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.1666249"
Evaluating: 44.1666249+3.5
 Parameter: ZMAX <- "47.6666249"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.8661369"
Evaluating: 30.8661369-3.5
 Parameter: XMIN <- "27.3661369"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.71286701"
Evaluating: -4.71286701-3.5
 Parameter: YMIN <- "-8.21286701"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.1666249"
Evaluating: 44.1666249-3.5
 Parameter: ZMIN <- "40.6666249"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.3661369"
 Parameter: XMIN -> "27.3661369"
 Parameter: YMAX -> "-1.21286701"
 Parameter: YMIN -> "-8.21286701"
 Parameter: ZMAX -> "47.6666249"
 Parameter: ZMIN -> "40.6666249"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "22" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "22" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.501384785"
Evaluating: 100.116666*(0.501384785-0.5)
 Parameter: XPOS <- "0.138640057"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.53214346"
Evaluating: 100.116666*(0.53214346-0.5)
 Parameter: YPOS <- "3.21809605"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.164373365"
Evaluating: 127.138691*(0.164373365-0.5)+4.2778237
 Parameter: ZPOS <- "-38.3933073"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.3933073" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.138640057"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.138640057-0
 Parameter: XTRAN <- "0.138640057"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.21809605"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.21809605-0
 Parameter: YTRAN <- "3.21809605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.3933073"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.3933073-0
 Parameter: ZTRAN <- "-38.3933073"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.138640057"
 Parameter: YTRAN -> "3.21809605"
 Parameter: ZTRAN -> "-38.3933073"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     0.138640    3.218096  -38.393307
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271742367"
Evaluating: 0.271742367*360.0
 Parameter: XPHI <- "97.8272521"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864542776"
Evaluating: 0.864542776*360.0
 Parameter: YPHI <- "311.235399"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552917093"
Evaluating: 0.552917093*360.0
 Parameter: ZPHI <- "199.050153"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.138640057"
 Parameter: YPOS -> "3.21809605"
 Parameter: ZPOS -> "-38.3933073"
 Parameter: XPHI -> "97.8272521"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.136187    0.990683
    0.000000   -0.990683   -0.136187

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.138640057"
 Parameter: YPOS -> "3.21809605"
 Parameter: ZPOS -> "-38.3933073"
 Parameter: YPHI -> "311.235399"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.659154    0.000000    0.752008
    0.000000    1.000000    0.000000
   -0.752008    0.000000    0.659154

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.138640057"
 Parameter: YPOS -> "3.21809605"
 Parameter: ZPOS -> "-38.3933073"
 Parameter: ZPHI -> "199.050153"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.945233   -0.326396    0.000000
    0.326396   -0.945233    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.138640 XMAX =    0.138640 XAVE =    0.138640
    YMIN =    3.218096 YMAX =    3.218096 YAVE =    3.218096
    ZMIN =  -38.393307 ZMAX =  -38.393307 ZAVE =  -38.393307
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.138640057"
Evaluating: 0.138640057+3.5
 Parameter: XMAX <- "3.63864006"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.21809605"
Evaluating: 3.21809605+3.5
 Parameter: YMAX <- "6.71809605"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.3933073"
Evaluating: -38.3933073+3.5
 Parameter: ZMAX <- "-34.8933073"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.138640057"
Evaluating: 0.138640057-3.5
 Parameter: XMIN <- "-3.36135994"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.21809605"
Evaluating: 3.21809605-3.5
 Parameter: YMIN <- "-0.28190395"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.3933073"
Evaluating: -38.3933073-3.5
 Parameter: ZMIN <- "-41.8933073"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.63864006"
 Parameter: XMIN -> "-3.36135994"
 Parameter: YMAX -> "6.71809605"
 Parameter: YMIN -> "-0.28190395"
 Parameter: ZMAX -> "-34.8933073"
 Parameter: ZMIN -> "-41.8933073"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "23" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "23" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.791361029E-02"
Evaluating: 100.116666*(5.791361029E-02-0.5)
 Parameter: XPOS <- "-44.2602154"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.949232588"
Evaluating: 100.116666*(0.949232588-0.5)
 Parameter: YPOS <- "44.975669"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.273996004"
Evaluating: 127.138691*(0.273996004-0.5)+4.2778237
 Parameter: ZPOS <- "-24.4560285"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.4560285" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.2602154"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.2602154-0
 Parameter: XTRAN <- "-44.2602154"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.975669"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.975669-0
 Parameter: YTRAN <- "44.975669"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.4560285"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.4560285-0
 Parameter: ZTRAN <- "-24.4560285"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2602154"
 Parameter: YTRAN -> "44.975669"
 Parameter: ZTRAN -> "-24.4560285"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -44.260215   44.975669  -24.456028
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997203378"
Evaluating: 0.997203378*360.0
 Parameter: XPHI <- "358.993216"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746146569"
Evaluating: 0.746146569*360.0
 Parameter: YPHI <- "268.612765"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597911942"
Evaluating: 0.597911942*360.0
 Parameter: ZPHI <- "215.248299"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.2602154"
 Parameter: YPOS -> "44.975669"
 Parameter: ZPOS -> "-24.4560285"
 Parameter: XPHI -> "358.993216"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999846   -0.017571
    0.000000    0.017571    0.999846

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    1.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.2602154"
 Parameter: YPOS -> "44.975669"
 Parameter: ZPOS -> "-24.4560285"
 Parameter: YPHI -> "268.612765"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.024209    0.000000    0.999707
    0.000000    1.000000    0.000000
   -0.999707    0.000000   -0.024209

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.2602154"
 Parameter: YPOS -> "44.975669"
 Parameter: ZPOS -> "-24.4560285"
 Parameter: ZPHI -> "215.248299"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.816659   -0.577121    0.000000
    0.577121   -0.816659    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.260215 XMAX =  -44.260215 XAVE =  -44.260215
    YMIN =   44.975669 YMAX =   44.975669 YAVE =   44.975669
    ZMIN =  -24.456028 ZMAX =  -24.456028 ZAVE =  -24.456028
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.2602154"
Evaluating: -44.2602154+3.5
 Parameter: XMAX <- "-40.7602154"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.975669"
Evaluating: 44.975669+3.5
 Parameter: YMAX <- "48.475669"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.4560285"
Evaluating: -24.4560285+3.5
 Parameter: ZMAX <- "-20.9560285"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.2602154"
Evaluating: -44.2602154-3.5
 Parameter: XMIN <- "-47.7602154"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.975669"
Evaluating: 44.975669-3.5
 Parameter: YMIN <- "41.475669"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.4560285"
Evaluating: -24.4560285-3.5
 Parameter: ZMIN <- "-27.9560285"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.7602154"
 Parameter: XMIN -> "-47.7602154"
 Parameter: YMAX -> "48.475669"
 Parameter: YMIN -> "41.475669"
 Parameter: ZMAX -> "-20.9560285"
 Parameter: ZMIN -> "-27.9560285"
 SELRPN>      6 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39228 POS      SOD      23       SOD     -**** MEMB     POPC     257      C13           2.0832
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "23" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.965309569E-02"
Evaluating: 100.116666*(7.965309569E-02-0.5)
 Parameter: XPOS <- "-42.0837306"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.418723462"
Evaluating: 100.116666*(0.418723462-0.5)
 Parameter: YPOS <- "-8.13713601"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.456613679"
Evaluating: 127.138691*(0.456613679-0.5)+4.2778237
 Parameter: ZPOS <- "-1.23825636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.23825636" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.23825636" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "23" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.38997233"
Evaluating: 100.116666*(0.38997233-0.5)
 Parameter: XPOS <- "-11.0156035"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "6.465998756E-02"
Evaluating: 100.116666*(6.465998756E-02-0.5)
 Parameter: YPOS <- "-43.5847906"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.939347631"
Evaluating: 127.138691*(0.939347631-0.5)+4.2778237
 Parameter: ZPOS <- "60.1359064"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.1359064" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.1359064" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.260215 XMAX =  -44.260215 XAVE =  -44.260215
    YMIN =   44.975669 YMAX =   44.975669 YAVE =   44.975669
    ZMIN =  -24.456028 ZMAX =  -24.456028 ZAVE =  -24.456028
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.0156035"
 RDCMND substituted energy or value "?XAVE" to "-44.2602154"
Evaluating: -11.0156035--44.2602154
 Parameter: XTRAN <- "33.2446119"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.5847906"
 RDCMND substituted energy or value "?YAVE" to "44.975669"
Evaluating: -43.5847906-44.975669
 Parameter: YTRAN <- "-88.5604596"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.1359064"
 RDCMND substituted energy or value "?ZAVE" to "-24.4560285"
Evaluating: 60.1359064--24.4560285
 Parameter: ZTRAN <- "84.5919349"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.2446119"
 Parameter: YTRAN -> "-88.5604596"
 Parameter: ZTRAN -> "84.5919349"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    33.244612  -88.560460   84.591935
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956397808"
Evaluating: 0.956397808*360.0
 Parameter: XPHI <- "344.303211"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84931149"
Evaluating: 0.84931149*360.0
 Parameter: YPHI <- "305.752136"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.593738578E-02"
Evaluating: 8.593738578E-02*360.0
 Parameter: ZPHI <- "30.9374589"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.0156035"
 Parameter: YPOS -> "-43.5847906"
 Parameter: ZPOS -> "60.1359064"
 Parameter: XPHI -> "344.303211"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.962707   -0.270546
    0.000000    0.270546    0.962707

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.0156035"
 Parameter: YPOS -> "-43.5847906"
 Parameter: ZPOS -> "60.1359064"
 Parameter: YPHI -> "305.752136"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.584280    0.000000    0.811552
    0.000000    1.000000    0.000000
   -0.811552    0.000000    0.584280

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.0156035"
 Parameter: YPOS -> "-43.5847906"
 Parameter: ZPOS -> "60.1359064"
 Parameter: ZPHI -> "30.9374589"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.857729    0.514102    0.000000
   -0.514102    0.857729    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.015604 XMAX =  -11.015604 XAVE =  -11.015604
    YMIN =  -43.584791 YMAX =  -43.584791 YAVE =  -43.584791
    ZMIN =   60.135906 ZMAX =   60.135906 ZAVE =   60.135906
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.0156035"
Evaluating: -11.0156035+3.5
 Parameter: XMAX <- "-7.5156035"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.5847906"
Evaluating: -43.5847906+3.5
 Parameter: YMAX <- "-40.0847906"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.1359064"
Evaluating: 60.1359064+3.5
 Parameter: ZMAX <- "63.6359064"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.0156035"
Evaluating: -11.0156035-3.5
 Parameter: XMIN <- "-14.5156035"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.5847906"
Evaluating: -43.5847906-3.5
 Parameter: YMIN <- "-47.0847906"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.1359064"
Evaluating: 60.1359064-3.5
 Parameter: ZMIN <- "56.6359064"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.5156035"
 Parameter: XMIN -> "-14.5156035"
 Parameter: YMAX -> "-40.0847906"
 Parameter: YMIN -> "-47.0847906"
 Parameter: ZMAX -> "63.6359064"
 Parameter: ZMIN -> "56.6359064"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "24" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "24" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.883535747"
Evaluating: 100.116666*(0.883535747-0.5)
 Parameter: XPOS <- "38.3983203"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.867013087"
Evaluating: 100.116666*(0.867013087-0.5)
 Parameter: YPOS <- "36.7441266"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.23700099"
Evaluating: 127.138691*(0.23700099-0.5)+4.2778237
 Parameter: ZPOS <- "-29.1595262"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.1595262" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.3983203"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.3983203-0
 Parameter: XTRAN <- "38.3983203"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.7441266"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.7441266-0
 Parameter: YTRAN <- "36.7441266"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.1595262"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.1595262-0
 Parameter: ZTRAN <- "-29.1595262"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.3983203"
 Parameter: YTRAN -> "36.7441266"
 Parameter: ZTRAN -> "-29.1595262"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    38.398320   36.744127  -29.159526
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738292207"
Evaluating: 0.738292207*360.0
 Parameter: XPHI <- "265.785195"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.869475072"
Evaluating: 0.869475072*360.0
 Parameter: YPHI <- "313.011026"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.52525347"
Evaluating: 0.52525347*360.0
 Parameter: ZPHI <- "189.091249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.3983203"
 Parameter: YPOS -> "36.7441266"
 Parameter: ZPOS -> "-29.1595262"
 Parameter: XPHI -> "265.785195"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.073496   -0.997296
    0.000000    0.997296   -0.073496

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.3983203"
 Parameter: YPOS -> "36.7441266"
 Parameter: ZPOS -> "-29.1595262"
 Parameter: YPHI -> "313.011026"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.682139    0.000000    0.731222
    0.000000    1.000000    0.000000
   -0.731222    0.000000    0.682139

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.3983203"
 Parameter: YPOS -> "36.7441266"
 Parameter: ZPOS -> "-29.1595262"
 Parameter: ZPHI -> "189.091249"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.987438   -0.158007    0.000000
    0.158007   -0.987438    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  170.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.398320 XMAX =   38.398320 XAVE =   38.398320
    YMIN =   36.744127 YMAX =   36.744127 YAVE =   36.744127
    ZMIN =  -29.159526 ZMAX =  -29.159526 ZAVE =  -29.159526
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.3983203"
Evaluating: 38.3983203+3.5
 Parameter: XMAX <- "41.8983203"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.7441266"
Evaluating: 36.7441266+3.5
 Parameter: YMAX <- "40.2441266"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.1595262"
Evaluating: -29.1595262+3.5
 Parameter: ZMAX <- "-25.6595262"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.3983203"
Evaluating: 38.3983203-3.5
 Parameter: XMIN <- "34.8983203"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.7441266"
Evaluating: 36.7441266-3.5
 Parameter: YMIN <- "33.2441266"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.1595262"
Evaluating: -29.1595262-3.5
 Parameter: ZMIN <- "-32.6595262"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.8983203"
 Parameter: XMIN -> "34.8983203"
 Parameter: YMAX -> "40.2441266"
 Parameter: YMIN -> "33.2441266"
 Parameter: ZMAX -> "-25.6595262"
 Parameter: ZMIN -> "-32.6595262"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "25" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "25" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.457799089"
Evaluating: 100.116666*(0.457799089-0.5)
 Parameter: XPOS <- "-4.22501451"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.569068172"
Evaluating: 100.116666*(0.569068172-0.5)
 Parameter: YPOS <- "6.91487511"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.813355663"
Evaluating: 127.138691*(0.813355663-0.5)+4.2778237
 Parameter: ZPOS <- "44.1174525"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.1174525" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.1174525" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.22501451"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.22501451-0
 Parameter: XTRAN <- "-4.22501451"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.91487511"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.91487511-0
 Parameter: YTRAN <- "6.91487511"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.1174525"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.1174525-0
 Parameter: ZTRAN <- "44.1174525"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.22501451"
 Parameter: YTRAN -> "6.91487511"
 Parameter: ZTRAN -> "44.1174525"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -4.225015    6.914875   44.117452
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616998523"
Evaluating: 0.616998523*360.0
 Parameter: XPHI <- "222.119468"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801014713"
Evaluating: 0.801014713*360.0
 Parameter: YPHI <- "288.365297"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.776205063"
Evaluating: 0.776205063*360.0
 Parameter: ZPHI <- "279.433823"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.22501451"
 Parameter: YPOS -> "6.91487511"
 Parameter: ZPOS -> "44.1174525"
 Parameter: XPHI -> "222.119468"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.741748   -0.670679
    0.000000    0.670679   -0.741748

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.22501451"
 Parameter: YPOS -> "6.91487511"
 Parameter: ZPOS -> "44.1174525"
 Parameter: YPHI -> "288.365297"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.315074    0.000000    0.949067
    0.000000    1.000000    0.000000
   -0.949067    0.000000    0.315074

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.22501451"
 Parameter: YPOS -> "6.91487511"
 Parameter: ZPOS -> "44.1174525"
 Parameter: ZPHI -> "279.433823"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.163908   -0.986476    0.000000
    0.986476    0.163908    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.225015 XMAX =   -4.225015 XAVE =   -4.225015
    YMIN =    6.914875 YMAX =    6.914875 YAVE =    6.914875
    ZMIN =   44.117452 ZMAX =   44.117452 ZAVE =   44.117452
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.22501451"
Evaluating: -4.22501451+3.5
 Parameter: XMAX <- "-0.72501451"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.91487511"
Evaluating: 6.91487511+3.5
 Parameter: YMAX <- "10.4148751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.1174525"
Evaluating: 44.1174525+3.5
 Parameter: ZMAX <- "47.6174525"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.22501451"
Evaluating: -4.22501451-3.5
 Parameter: XMIN <- "-7.72501451"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.91487511"
Evaluating: 6.91487511-3.5
 Parameter: YMIN <- "3.41487511"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.1174525"
Evaluating: 44.1174525-3.5
 Parameter: ZMIN <- "40.6174525"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.72501451"
 Parameter: XMIN -> "-7.72501451"
 Parameter: YMAX -> "10.4148751"
 Parameter: YMIN -> "3.41487511"
 Parameter: ZMAX -> "47.6174525"
 Parameter: ZMIN -> "40.6174525"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "26" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "26" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "9.426737378E-03"
Evaluating: 100.116666*(9.426737378E-03-0.5)
 Parameter: XPOS <- "-49.1145595"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.44819492"
Evaluating: 100.116666*(0.44819492-0.5)
 Parameter: YPOS <- "-5.18655189"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.662979812"
Evaluating: 127.138691*(0.662979812-0.5)+4.2778237
 Parameter: ZPOS <- "24.9988637"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.9988637" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.9988637" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.1145595"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.1145595-0
 Parameter: XTRAN <- "-49.1145595"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.18655189"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.18655189-0
 Parameter: YTRAN <- "-5.18655189"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.9988637"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.9988637-0
 Parameter: ZTRAN <- "24.9988637"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.1145595"
 Parameter: YTRAN -> "-5.18655189"
 Parameter: ZTRAN -> "24.9988637"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -49.114559   -5.186552   24.998864
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877362364"
Evaluating: 0.877362364*360.0
 Parameter: XPHI <- "315.850451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797917139"
Evaluating: 0.797917139*360.0
 Parameter: YPHI <- "287.25017"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418577441"
Evaluating: 0.418577441*360.0
 Parameter: ZPHI <- "150.687879"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.1145595"
 Parameter: YPOS -> "-5.18655189"
 Parameter: ZPOS -> "24.9988637"
 Parameter: XPHI -> "315.850451"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.717524   -0.696534
    0.000000    0.696534    0.717524

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.1145595"
 Parameter: YPOS -> "-5.18655189"
 Parameter: ZPOS -> "24.9988637"
 Parameter: YPHI -> "287.25017"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.296544    0.000000    0.955019
    0.000000    1.000000    0.000000
   -0.955019    0.000000    0.296544

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.1145595"
 Parameter: YPOS -> "-5.18655189"
 Parameter: ZPOS -> "24.9988637"
 Parameter: ZPHI -> "150.687879"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.871966    0.489567    0.000000
   -0.489567   -0.871966    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  150.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.114559 XMAX =  -49.114559 XAVE =  -49.114559
    YMIN =   -5.186552 YMAX =   -5.186552 YAVE =   -5.186552
    ZMIN =   24.998864 ZMAX =   24.998864 ZAVE =   24.998864
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.1145595"
Evaluating: -49.1145595+3.5
 Parameter: XMAX <- "-45.6145595"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.18655189"
Evaluating: -5.18655189+3.5
 Parameter: YMAX <- "-1.68655189"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.9988637"
Evaluating: 24.9988637+3.5
 Parameter: ZMAX <- "28.4988637"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.1145595"
Evaluating: -49.1145595-3.5
 Parameter: XMIN <- "-52.6145595"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.18655189"
Evaluating: -5.18655189-3.5
 Parameter: YMIN <- "-8.68655189"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.9988637"
Evaluating: 24.9988637-3.5
 Parameter: ZMIN <- "21.4988637"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-45.6145595"
 Parameter: XMIN -> "-52.6145595"
 Parameter: YMAX -> "-1.68655189"
 Parameter: YMIN -> "-8.68655189"
 Parameter: ZMAX -> "28.4988637"
 Parameter: ZMIN -> "21.4988637"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "27" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "27" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.132275202"
Evaluating: 100.116666*(0.132275202-0.5)
 Parameter: XPOS <- "-36.8153808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.999982305"
Evaluating: 100.116666*(0.999982305-0.5)
 Parameter: YPOS <- "50.0565614"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "5.322777077E-02"
Evaluating: 127.138691*(5.322777077E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-52.5242127"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.5242127" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.8153808"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.8153808-0
 Parameter: XTRAN <- "-36.8153808"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "50.0565614"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 50.0565614-0
 Parameter: YTRAN <- "50.0565614"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.5242127"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.5242127-0
 Parameter: ZTRAN <- "-52.5242127"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.8153808"
 Parameter: YTRAN -> "50.0565614"
 Parameter: ZTRAN -> "-52.5242127"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -36.815381   50.056561  -52.524213
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111824358"
Evaluating: 0.111824358*360.0
 Parameter: XPHI <- "40.2567689"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.139514935E-02"
Evaluating: 7.139514935E-02*360.0
 Parameter: YPHI <- "25.7022538"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489437332"
Evaluating: 0.489437332*360.0
 Parameter: ZPHI <- "176.19744"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.8153808"
 Parameter: YPOS -> "50.0565614"
 Parameter: ZPOS -> "-52.5242127"
 Parameter: XPHI -> "40.2567689"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.763156    0.646214
    0.000000   -0.646214    0.763156

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.8153808"
 Parameter: YPOS -> "50.0565614"
 Parameter: ZPOS -> "-52.5242127"
 Parameter: YPHI -> "25.7022538"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.901060    0.000000   -0.433695
    0.000000    1.000000    0.000000
    0.433695    0.000000    0.901060

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.8153808"
 Parameter: YPOS -> "50.0565614"
 Parameter: ZPOS -> "-52.5242127"
 Parameter: ZPHI -> "176.19744"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.997799    0.066318    0.000000
   -0.066318   -0.997799    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.815381 XMAX =  -36.815381 XAVE =  -36.815381
    YMIN =   50.056561 YMAX =   50.056561 YAVE =   50.056561
    ZMIN =  -52.524213 ZMAX =  -52.524213 ZAVE =  -52.524213
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.8153808"
Evaluating: -36.8153808+3.5
 Parameter: XMAX <- "-33.3153808"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "50.0565614"
Evaluating: 50.0565614+3.5
 Parameter: YMAX <- "53.5565614"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.5242127"
Evaluating: -52.5242127+3.5
 Parameter: ZMAX <- "-49.0242127"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.8153808"
Evaluating: -36.8153808-3.5
 Parameter: XMIN <- "-40.3153808"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "50.0565614"
Evaluating: 50.0565614-3.5
 Parameter: YMIN <- "46.5565614"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.5242127"
Evaluating: -52.5242127-3.5
 Parameter: ZMIN <- "-56.0242127"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.3153808"
 Parameter: XMIN -> "-40.3153808"
 Parameter: YMAX -> "53.5565614"
 Parameter: YMIN -> "46.5565614"
 Parameter: ZMAX -> "-49.0242127"
 Parameter: ZMIN -> "-56.0242127"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "28" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "28" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.413063639"
Evaluating: 100.116666*(0.413063639-0.5)
 Parameter: XPOS <- "-8.70377862"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.574563717"
Evaluating: 100.116666*(0.574563717-0.5)
 Parameter: YPOS <- "7.46507075"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.250075602"
Evaluating: 127.138691*(0.250075602-0.5)+4.2778237
 Parameter: ZPOS <- "-27.4972371"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.4972371" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.70377862"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.70377862-0
 Parameter: XTRAN <- "-8.70377862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.46507075"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.46507075-0
 Parameter: YTRAN <- "7.46507075"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.4972371"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.4972371-0
 Parameter: ZTRAN <- "-27.4972371"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.70377862"
 Parameter: YTRAN -> "7.46507075"
 Parameter: ZTRAN -> "-27.4972371"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -8.703779    7.465071  -27.497237
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973779268"
Evaluating: 0.973779268*360.0
 Parameter: XPHI <- "350.560536"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.537638317E-02"
Evaluating: 2.537638317E-02*360.0
 Parameter: YPHI <- "9.13549794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.583500467"
Evaluating: 0.583500467*360.0
 Parameter: ZPHI <- "210.060168"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.70377862"
 Parameter: YPOS -> "7.46507075"
 Parameter: ZPOS -> "-27.4972371"
 Parameter: XPHI -> "350.560536"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986459   -0.164005
    0.000000    0.164005    0.986459

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    9.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.70377862"
 Parameter: YPOS -> "7.46507075"
 Parameter: ZPOS -> "-27.4972371"
 Parameter: YPHI -> "9.13549794"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.987316    0.000000   -0.158770
    0.000000    1.000000    0.000000
    0.158770    0.000000    0.987316

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.70377862"
 Parameter: YPOS -> "7.46507075"
 Parameter: ZPOS -> "-27.4972371"
 Parameter: ZPHI -> "210.060168"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.865500   -0.500909    0.000000
    0.500909   -0.865500    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  149.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.703779 XMAX =   -8.703779 XAVE =   -8.703779
    YMIN =    7.465071 YMAX =    7.465071 YAVE =    7.465071
    ZMIN =  -27.497237 ZMAX =  -27.497237 ZAVE =  -27.497237
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.70377862"
Evaluating: -8.70377862+3.5
 Parameter: XMAX <- "-5.20377862"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.46507075"
Evaluating: 7.46507075+3.5
 Parameter: YMAX <- "10.9650707"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.4972371"
Evaluating: -27.4972371+3.5
 Parameter: ZMAX <- "-23.9972371"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.70377862"
Evaluating: -8.70377862-3.5
 Parameter: XMIN <- "-12.2037786"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.46507075"
Evaluating: 7.46507075-3.5
 Parameter: YMIN <- "3.96507075"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.4972371"
Evaluating: -27.4972371-3.5
 Parameter: ZMIN <- "-30.9972371"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.20377862"
 Parameter: XMIN -> "-12.2037786"
 Parameter: YMAX -> "10.9650707"
 Parameter: YMIN -> "3.96507075"
 Parameter: ZMAX -> "-23.9972371"
 Parameter: ZMIN -> "-30.9972371"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "29" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "29" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.59251911"
Evaluating: 100.116666*(0.59251911-0.5)
 Parameter: XPOS <- "9.26270483"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.463795622"
Evaluating: 100.116666*(0.463795622-0.5)
 Parameter: YPOS <- "-3.62466162"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.471434818"
Evaluating: 127.138691*(0.471434818-0.5)+4.2778237
 Parameter: ZPOS <- "0.646083852"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.646083852" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.646083852" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "29" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.90293311"
Evaluating: 100.116666*(0.90293311-0.5)
 Parameter: XPOS <- "40.3403196"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.474489442"
Evaluating: 100.116666*(0.474489442-0.5)
 Parameter: YPOS <- "-2.55403201"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.147943897"
Evaluating: 127.138691*(0.147943897-0.5)+4.2778237
 Parameter: ZPOS <- "-40.4821284"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.4821284" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.3403196"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.3403196-0
 Parameter: XTRAN <- "40.3403196"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.55403201"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.55403201-0
 Parameter: YTRAN <- "-2.55403201"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.4821284"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.4821284-0
 Parameter: ZTRAN <- "-40.4821284"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.3403196"
 Parameter: YTRAN -> "-2.55403201"
 Parameter: ZTRAN -> "-40.4821284"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    40.340320   -2.554032  -40.482128
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.168761192"
Evaluating: 0.168761192*360.0
 Parameter: XPHI <- "60.7540291"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835974394"
Evaluating: 0.835974394*360.0
 Parameter: YPHI <- "300.950782"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719312472"
Evaluating: 0.719312472*360.0
 Parameter: ZPHI <- "258.95249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.3403196"
 Parameter: YPOS -> "-2.55403201"
 Parameter: ZPOS -> "-40.4821284"
 Parameter: XPHI -> "60.7540291"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.488560    0.872530
    0.000000   -0.872530    0.488560

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.3403196"
 Parameter: YPOS -> "-2.55403201"
 Parameter: ZPOS -> "-40.4821284"
 Parameter: YPHI -> "300.950782"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.514302    0.000000    0.857609
    0.000000    1.000000    0.000000
   -0.857609    0.000000    0.514302

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.3403196"
 Parameter: YPOS -> "-2.55403201"
 Parameter: ZPOS -> "-40.4821284"
 Parameter: ZPHI -> "258.95249"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.191623   -0.981469    0.000000
    0.981469   -0.191623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  101.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.340320 XMAX =   40.340320 XAVE =   40.340320
    YMIN =   -2.554032 YMAX =   -2.554032 YAVE =   -2.554032
    ZMIN =  -40.482128 ZMAX =  -40.482128 ZAVE =  -40.482128
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.3403196"
Evaluating: 40.3403196+3.5
 Parameter: XMAX <- "43.8403196"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.55403201"
Evaluating: -2.55403201+3.5
 Parameter: YMAX <- "0.94596799"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.4821284"
Evaluating: -40.4821284+3.5
 Parameter: ZMAX <- "-36.9821284"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.3403196"
Evaluating: 40.3403196-3.5
 Parameter: XMIN <- "36.8403196"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.55403201"
Evaluating: -2.55403201-3.5
 Parameter: YMIN <- "-6.05403201"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.4821284"
Evaluating: -40.4821284-3.5
 Parameter: ZMIN <- "-43.9821284"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.8403196"
 Parameter: XMIN -> "36.8403196"
 Parameter: YMAX -> "0.94596799"
 Parameter: YMIN -> "-6.05403201"
 Parameter: ZMAX -> "-36.9821284"
 Parameter: ZMIN -> "-43.9821284"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "30" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "30" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.718301017"
Evaluating: 100.116666*(0.718301017-0.5)
 Parameter: XPOS <- "21.85557"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.85538347E-02"
Evaluating: 100.116666*(7.85538347E-02-0.5)
 Parameter: YPOS <- "-42.193785"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.469281976"
Evaluating: 127.138691*(0.469281976-0.5)+4.2778237
 Parameter: ZPOS <- "0.372374339"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.372374339" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.372374339" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "30" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.187700121"
Evaluating: 100.116666*(0.187700121-0.5)
 Parameter: XPOS <- "-31.2664227"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.232064359"
Evaluating: 100.116666*(0.232064359-0.5)
 Parameter: YPOS <- "-26.8248231"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.269305019"
Evaluating: 127.138691*(0.269305019-0.5)+4.2778237
 Parameter: ZPOS <- "-25.0524342"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.0524342" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2664227"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.2664227-0
 Parameter: XTRAN <- "-31.2664227"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.8248231"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.8248231-0
 Parameter: YTRAN <- "-26.8248231"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.0524342"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.0524342-0
 Parameter: ZTRAN <- "-25.0524342"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.2664227"
 Parameter: YTRAN -> "-26.8248231"
 Parameter: ZTRAN -> "-25.0524342"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -31.266423  -26.824823  -25.052434
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515543245"
Evaluating: 0.515543245*360.0
 Parameter: XPHI <- "185.595568"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.190129529E-02"
Evaluating: 5.190129529E-02*360.0
 Parameter: YPHI <- "18.6844663"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980904376"
Evaluating: 0.980904376*360.0
 Parameter: ZPHI <- "353.125575"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2664227"
 Parameter: YPOS -> "-26.8248231"
 Parameter: ZPOS -> "-25.0524342"
 Parameter: XPHI -> "185.595568"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995235   -0.097506
    0.000000    0.097506   -0.995235

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2664227"
 Parameter: YPOS -> "-26.8248231"
 Parameter: ZPOS -> "-25.0524342"
 Parameter: YPHI -> "18.6844663"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.947297    0.000000   -0.320356
    0.000000    1.000000    0.000000
    0.320356    0.000000    0.947297

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   18.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2664227"
 Parameter: YPOS -> "-26.8248231"
 Parameter: ZPOS -> "-25.0524342"
 Parameter: ZPHI -> "353.125575"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.992811   -0.119694    0.000000
    0.119694    0.992811    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    6.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.266423 XMAX =  -31.266423 XAVE =  -31.266423
    YMIN =  -26.824823 YMAX =  -26.824823 YAVE =  -26.824823
    ZMIN =  -25.052434 ZMAX =  -25.052434 ZAVE =  -25.052434
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2664227"
Evaluating: -31.2664227+3.5
 Parameter: XMAX <- "-27.7664227"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.8248231"
Evaluating: -26.8248231+3.5
 Parameter: YMAX <- "-23.3248231"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.0524342"
Evaluating: -25.0524342+3.5
 Parameter: ZMAX <- "-21.5524342"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2664227"
Evaluating: -31.2664227-3.5
 Parameter: XMIN <- "-34.7664227"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.8248231"
Evaluating: -26.8248231-3.5
 Parameter: YMIN <- "-30.3248231"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.0524342"
Evaluating: -25.0524342-3.5
 Parameter: ZMIN <- "-28.5524342"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7664227"
 Parameter: XMIN -> "-34.7664227"
 Parameter: YMAX -> "-23.3248231"
 Parameter: YMIN -> "-30.3248231"
 Parameter: ZMAX -> "-21.5524342"
 Parameter: ZMIN -> "-28.5524342"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "31" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "31" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.84894507"
Evaluating: 100.116666*(0.84894507-0.5)
 Parameter: XPOS <- "34.935217"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.745998237"
Evaluating: 100.116666*(0.745998237-0.5)
 Parameter: YPOS <- "24.6285233"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.483178647"
Evaluating: 127.138691*(0.483178647-0.5)+4.2778237
 Parameter: ZPOS <- "2.1391789"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.1391789" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.1391789" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "31" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.474241583"
Evaluating: 100.116666*(0.474241583-0.5)
 Parameter: XPOS <- "-2.57884683"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.66589538"
Evaluating: 100.116666*(0.66589538-0.5)
 Parameter: YPOS <- "16.6088924"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.265114845"
Evaluating: 127.138691*(0.265114845-0.5)+4.2778237
 Parameter: ZPOS <- "-25.5851674"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.5851674" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.57884683"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.57884683-0
 Parameter: XTRAN <- "-2.57884683"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.6088924"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.6088924-0
 Parameter: YTRAN <- "16.6088924"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.5851674"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.5851674-0
 Parameter: ZTRAN <- "-25.5851674"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.57884683"
 Parameter: YTRAN -> "16.6088924"
 Parameter: ZTRAN -> "-25.5851674"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -2.578847   16.608892  -25.585167
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919243459"
Evaluating: 0.919243459*360.0
 Parameter: XPHI <- "330.927645"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.425383731"
Evaluating: 0.425383731*360.0
 Parameter: YPHI <- "153.138143"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.690861844"
Evaluating: 0.690861844*360.0
 Parameter: ZPHI <- "248.710264"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.57884683"
 Parameter: YPOS -> "16.6088924"
 Parameter: ZPOS -> "-25.5851674"
 Parameter: XPHI -> "330.927645"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.874007   -0.485914
    0.000000    0.485914    0.874007

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.57884683"
 Parameter: YPOS -> "16.6088924"
 Parameter: ZPOS -> "-25.5851674"
 Parameter: YPHI -> "153.138143"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.892099    0.000000   -0.451841
    0.000000    1.000000    0.000000
    0.451841    0.000000   -0.892099

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.57884683"
 Parameter: YPOS -> "16.6088924"
 Parameter: ZPOS -> "-25.5851674"
 Parameter: ZPHI -> "248.710264"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.363084   -0.931756    0.000000
    0.931756   -0.363084    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.578847 XMAX =   -2.578847 XAVE =   -2.578847
    YMIN =   16.608892 YMAX =   16.608892 YAVE =   16.608892
    ZMIN =  -25.585167 ZMAX =  -25.585167 ZAVE =  -25.585167
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.57884683"
Evaluating: -2.57884683+3.5
 Parameter: XMAX <- "0.92115317"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.6088924"
Evaluating: 16.6088924+3.5
 Parameter: YMAX <- "20.1088924"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.5851674"
Evaluating: -25.5851674+3.5
 Parameter: ZMAX <- "-22.0851674"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.57884683"
Evaluating: -2.57884683-3.5
 Parameter: XMIN <- "-6.07884683"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.6088924"
Evaluating: 16.6088924-3.5
 Parameter: YMIN <- "13.1088924"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.5851674"
Evaluating: -25.5851674-3.5
 Parameter: ZMIN <- "-29.0851674"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.92115317"
 Parameter: XMIN -> "-6.07884683"
 Parameter: YMAX -> "20.1088924"
 Parameter: YMIN -> "13.1088924"
 Parameter: ZMAX -> "-22.0851674"
 Parameter: ZMIN -> "-29.0851674"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "32" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "32" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.910252748"
Evaluating: 100.116666*(0.910252748-0.5)
 Parameter: XPOS <- "41.0731373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.726177427"
Evaluating: 100.116666*(0.726177427-0.5)
 Parameter: YPOS <- "22.6441299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "5.558996649E-02"
Evaluating: 127.138691*(5.558996649E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-52.2238862"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.2238862" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.0731373"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.0731373-0
 Parameter: XTRAN <- "41.0731373"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.6441299"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.6441299-0
 Parameter: YTRAN <- "22.6441299"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.2238862"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.2238862-0
 Parameter: ZTRAN <- "-52.2238862"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.0731373"
 Parameter: YTRAN -> "22.6441299"
 Parameter: ZTRAN -> "-52.2238862"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    41.073137   22.644130  -52.223886
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.104153422"
Evaluating: 0.104153422*360.0
 Parameter: XPHI <- "37.4952319"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767268619"
Evaluating: 0.767268619*360.0
 Parameter: YPHI <- "276.216703"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.730375334"
Evaluating: 0.730375334*360.0
 Parameter: ZPHI <- "262.93512"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.0731373"
 Parameter: YPOS -> "22.6441299"
 Parameter: ZPOS -> "-52.2238862"
 Parameter: XPHI -> "37.4952319"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.793404    0.608695
    0.000000   -0.608695    0.793404

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.0731373"
 Parameter: YPOS -> "22.6441299"
 Parameter: ZPOS -> "-52.2238862"
 Parameter: YPHI -> "276.216703"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.108289    0.000000    0.994119
    0.000000    1.000000    0.000000
   -0.994119    0.000000    0.108289

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.0731373"
 Parameter: YPOS -> "22.6441299"
 Parameter: ZPOS -> "-52.2238862"
 Parameter: ZPHI -> "262.93512"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.122993   -0.992408    0.000000
    0.992408   -0.122993    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.073137 XMAX =   41.073137 XAVE =   41.073137
    YMIN =   22.644130 YMAX =   22.644130 YAVE =   22.644130
    ZMIN =  -52.223886 ZMAX =  -52.223886 ZAVE =  -52.223886
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.0731373"
Evaluating: 41.0731373+3.5
 Parameter: XMAX <- "44.5731373"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.6441299"
Evaluating: 22.6441299+3.5
 Parameter: YMAX <- "26.1441299"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.2238862"
Evaluating: -52.2238862+3.5
 Parameter: ZMAX <- "-48.7238862"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.0731373"
Evaluating: 41.0731373-3.5
 Parameter: XMIN <- "37.5731373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.6441299"
Evaluating: 22.6441299-3.5
 Parameter: YMIN <- "19.1441299"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.2238862"
Evaluating: -52.2238862-3.5
 Parameter: ZMIN <- "-55.7238862"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.5731373"
 Parameter: XMIN -> "37.5731373"
 Parameter: YMAX -> "26.1441299"
 Parameter: YMIN -> "19.1441299"
 Parameter: ZMAX -> "-48.7238862"
 Parameter: ZMIN -> "-55.7238862"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "33" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "33" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.766230777"
Evaluating: 100.116666*(0.766230777-0.5)
 Parameter: XPOS <- "26.6541378"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.245965727"
Evaluating: 100.116666*(0.245965727-0.5)
 Parameter: YPOS <- "-25.4330645"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.236605149"
Evaluating: 127.138691*(0.236605149-0.5)+4.2778237
 Parameter: ZPOS <- "-29.2098529"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.2098529" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.6541378"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.6541378-0
 Parameter: XTRAN <- "26.6541378"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4330645"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.4330645-0
 Parameter: YTRAN <- "-25.4330645"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.2098529"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.2098529-0
 Parameter: ZTRAN <- "-29.2098529"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.6541378"
 Parameter: YTRAN -> "-25.4330645"
 Parameter: ZTRAN -> "-29.2098529"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    26.654138  -25.433065  -29.209853
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.528648619"
Evaluating: 0.528648619*360.0
 Parameter: XPHI <- "190.313503"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254842413"
Evaluating: 0.254842413*360.0
 Parameter: YPHI <- "91.7432687"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.198042536E-02"
Evaluating: 2.198042536E-02*360.0
 Parameter: ZPHI <- "7.91295313"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.6541378"
 Parameter: YPOS -> "-25.4330645"
 Parameter: ZPOS -> "-29.2098529"
 Parameter: XPHI -> "190.313503"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983843   -0.179034
    0.000000    0.179034   -0.983843

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.6541378"
 Parameter: YPOS -> "-25.4330645"
 Parameter: ZPOS -> "-29.2098529"
 Parameter: YPHI -> "91.7432687"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.030421    0.000000   -0.999537
    0.000000    1.000000    0.000000
    0.999537    0.000000   -0.030421

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.6541378"
 Parameter: YPOS -> "-25.4330645"
 Parameter: ZPOS -> "-29.2098529"
 Parameter: ZPHI -> "7.91295313"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.990478    0.137668    0.000000
   -0.137668    0.990478    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.654138 XMAX =   26.654138 XAVE =   26.654138
    YMIN =  -25.433065 YMAX =  -25.433065 YAVE =  -25.433065
    ZMIN =  -29.209853 ZMAX =  -29.209853 ZAVE =  -29.209853
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.6541378"
Evaluating: 26.6541378+3.5
 Parameter: XMAX <- "30.1541378"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4330645"
Evaluating: -25.4330645+3.5
 Parameter: YMAX <- "-21.9330645"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.2098529"
Evaluating: -29.2098529+3.5
 Parameter: ZMAX <- "-25.7098529"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.6541378"
Evaluating: 26.6541378-3.5
 Parameter: XMIN <- "23.1541378"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4330645"
Evaluating: -25.4330645-3.5
 Parameter: YMIN <- "-28.9330645"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.2098529"
Evaluating: -29.2098529-3.5
 Parameter: ZMIN <- "-32.7098529"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.1541378"
 Parameter: XMIN -> "23.1541378"
 Parameter: YMAX -> "-21.9330645"
 Parameter: YMIN -> "-28.9330645"
 Parameter: ZMAX -> "-25.7098529"
 Parameter: ZMIN -> "-32.7098529"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "34" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "34" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.161789555"
Evaluating: 100.116666*(0.161789555-0.5)
 Parameter: XPOS <- "-33.8605022"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.167204145"
Evaluating: 100.116666*(0.167204145-0.5)
 Parameter: YPOS <- "-33.3184115"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.22300309"
Evaluating: 127.138691*(0.22300309-0.5)+4.2778237
 Parameter: ZPOS <- "-30.9392008"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.9392008" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.8605022"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -33.8605022-0
 Parameter: XTRAN <- "-33.8605022"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.3184115"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.3184115-0
 Parameter: YTRAN <- "-33.3184115"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.9392008"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.9392008-0
 Parameter: ZTRAN <- "-30.9392008"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.8605022"
 Parameter: YTRAN -> "-33.3184115"
 Parameter: ZTRAN -> "-30.9392008"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -33.860502  -33.318412  -30.939201
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.488534093"
Evaluating: 0.488534093*360.0
 Parameter: XPHI <- "175.872273"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115004031"
Evaluating: 0.115004031*360.0
 Parameter: YPHI <- "41.4014512"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.855794239E-02"
Evaluating: 2.855794239E-02*360.0
 Parameter: ZPHI <- "10.2808593"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.8605022"
 Parameter: YPOS -> "-33.3184115"
 Parameter: ZPOS -> "-30.9392008"
 Parameter: XPHI -> "175.872273"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.997406    0.071980
    0.000000   -0.071980   -0.997406

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.8605022"
 Parameter: YPOS -> "-33.3184115"
 Parameter: ZPOS -> "-30.9392008"
 Parameter: YPHI -> "41.4014512"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.750094    0.000000   -0.661331
    0.000000    1.000000    0.000000
    0.661331    0.000000    0.750094

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.8605022"
 Parameter: YPOS -> "-33.3184115"
 Parameter: ZPOS -> "-30.9392008"
 Parameter: ZPHI -> "10.2808593"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.983945    0.178474    0.000000
   -0.178474    0.983945    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   10.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.860502 XMAX =  -33.860502 XAVE =  -33.860502
    YMIN =  -33.318412 YMAX =  -33.318412 YAVE =  -33.318412
    ZMIN =  -30.939201 ZMAX =  -30.939201 ZAVE =  -30.939201
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.8605022"
Evaluating: -33.8605022+3.5
 Parameter: XMAX <- "-30.3605022"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.3184115"
Evaluating: -33.3184115+3.5
 Parameter: YMAX <- "-29.8184115"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.9392008"
Evaluating: -30.9392008+3.5
 Parameter: ZMAX <- "-27.4392008"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.8605022"
Evaluating: -33.8605022-3.5
 Parameter: XMIN <- "-37.3605022"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.3184115"
Evaluating: -33.3184115-3.5
 Parameter: YMIN <- "-36.8184115"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.9392008"
Evaluating: -30.9392008-3.5
 Parameter: ZMIN <- "-34.4392008"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.3605022"
 Parameter: XMIN -> "-37.3605022"
 Parameter: YMAX -> "-29.8184115"
 Parameter: YMIN -> "-36.8184115"
 Parameter: ZMAX -> "-27.4392008"
 Parameter: ZMIN -> "-34.4392008"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "35" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "35" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.584671897"
Evaluating: 100.116666*(0.584671897-0.5)
 Parameter: XPOS <- "8.47706803"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.183097616"
Evaluating: 100.116666*(0.183097616-0.5)
 Parameter: YPOS <- "-31.7272101"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.990824035"
Evaluating: 127.138691*(0.990824035-0.5)+4.2778237
 Parameter: ZPOS <- "66.680549"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "66.680549" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "66.680549" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.47706803"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.47706803-0
 Parameter: XTRAN <- "8.47706803"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7272101"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.7272101-0
 Parameter: YTRAN <- "-31.7272101"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "66.680549"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 66.680549-0
 Parameter: ZTRAN <- "66.680549"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.47706803"
 Parameter: YTRAN -> "-31.7272101"
 Parameter: ZTRAN -> "66.680549"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     8.477068  -31.727210   66.680549
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.45464731E-02"
Evaluating: 9.45464731E-02*360.0
 Parameter: XPHI <- "34.0367303"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538426388"
Evaluating: 0.538426388*360.0
 Parameter: YPHI <- "193.8335"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216652678"
Evaluating: 0.216652678*360.0
 Parameter: ZPHI <- "77.9949641"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.47706803"
 Parameter: YPOS -> "-31.7272101"
 Parameter: ZPOS -> "66.680549"
 Parameter: XPHI -> "34.0367303"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.828679    0.559724
    0.000000   -0.559724    0.828679

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.47706803"
 Parameter: YPOS -> "-31.7272101"
 Parameter: ZPOS -> "66.680549"
 Parameter: YPHI -> "193.8335"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.970995    0.000000    0.239101
    0.000000    1.000000    0.000000
   -0.239101    0.000000   -0.970995

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.47706803"
 Parameter: YPOS -> "-31.7272101"
 Parameter: ZPOS -> "66.680549"
 Parameter: ZPHI -> "77.9949641"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.207998    0.978129    0.000000
   -0.978129    0.207998    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   77.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.477068 XMAX =    8.477068 XAVE =    8.477068
    YMIN =  -31.727210 YMAX =  -31.727210 YAVE =  -31.727210
    ZMIN =   66.680549 ZMAX =   66.680549 ZAVE =   66.680549
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.47706803"
Evaluating: 8.47706803+3.5
 Parameter: XMAX <- "11.977068"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7272101"
Evaluating: -31.7272101+3.5
 Parameter: YMAX <- "-28.2272101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "66.680549"
Evaluating: 66.680549+3.5
 Parameter: ZMAX <- "70.180549"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.47706803"
Evaluating: 8.47706803-3.5
 Parameter: XMIN <- "4.97706803"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7272101"
Evaluating: -31.7272101-3.5
 Parameter: YMIN <- "-35.2272101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "66.680549"
Evaluating: 66.680549-3.5
 Parameter: ZMIN <- "63.180549"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.977068"
 Parameter: XMIN -> "4.97706803"
 Parameter: YMAX -> "-28.2272101"
 Parameter: YMIN -> "-35.2272101"
 Parameter: ZMAX -> "70.180549"
 Parameter: ZMIN -> "63.180549"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "36" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "36" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.16166739"
Evaluating: 100.116666*(0.16166739-0.5)
 Parameter: XPOS <- "-33.8727329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.961798055"
Evaluating: 100.116666*(0.961798055-0.5)
 Parameter: YPOS <- "46.2336816"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.45792752"
Evaluating: 127.138691*(0.45792752-0.5)+4.2778237
 Parameter: ZPOS <- "-1.07121633"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.07121633" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.07121633" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "36" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.869782742"
Evaluating: 100.116666*(0.869782742-0.5)
 Parameter: XPOS <- "37.0214153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "8.63086333E-02"
Evaluating: 100.116666*(8.63086333E-02-0.5)
 Parameter: YPOS <- "-41.4174004"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.384298956"
Evaluating: 127.138691*(0.384298956-0.5)+4.2778237
 Parameter: ZPOS <- "-10.4322556"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.4322556" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.4322556" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "36" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.753750773"
Evaluating: 100.116666*(0.753750773-0.5)
 Parameter: XPOS <- "25.4046814"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.997303315"
Evaluating: 100.116666*(0.997303315-0.5)
 Parameter: YPOS <- "49.7883499"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.266577172"
Evaluating: 127.138691*(0.266577172-0.5)+4.2778237
 Parameter: ZPOS <- "-25.3992491"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.3992491" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.4046814"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.4046814-0
 Parameter: XTRAN <- "25.4046814"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "49.7883499"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 49.7883499-0
 Parameter: YTRAN <- "49.7883499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.3992491"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.3992491-0
 Parameter: ZTRAN <- "-25.3992491"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.4046814"
 Parameter: YTRAN -> "49.7883499"
 Parameter: ZTRAN -> "-25.3992491"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    25.404681   49.788350  -25.399249
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101684428"
Evaluating: 0.101684428*360.0
 Parameter: XPHI <- "36.6063941"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.458637115"
Evaluating: 0.458637115*360.0
 Parameter: YPHI <- "165.109361"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.480530199"
Evaluating: 0.480530199*360.0
 Parameter: ZPHI <- "172.990872"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.4046814"
 Parameter: YPOS -> "49.7883499"
 Parameter: ZPOS -> "-25.3992491"
 Parameter: XPHI -> "36.6063941"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.802751    0.596314
    0.000000   -0.596314    0.802751

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.4046814"
 Parameter: YPOS -> "49.7883499"
 Parameter: ZPOS -> "-25.3992491"
 Parameter: YPHI -> "165.109361"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.966418    0.000000   -0.256975
    0.000000    1.000000    0.000000
    0.256975    0.000000   -0.966418

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.4046814"
 Parameter: YPOS -> "49.7883499"
 Parameter: ZPOS -> "-25.3992491"
 Parameter: ZPHI -> "172.990872"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.992527    0.122027    0.000000
   -0.122027   -0.992527    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.404681 XMAX =   25.404681 XAVE =   25.404681
    YMIN =   49.788350 YMAX =   49.788350 YAVE =   49.788350
    ZMIN =  -25.399249 ZMAX =  -25.399249 ZAVE =  -25.399249
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.4046814"
Evaluating: 25.4046814+3.5
 Parameter: XMAX <- "28.9046814"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "49.7883499"
Evaluating: 49.7883499+3.5
 Parameter: YMAX <- "53.2883499"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.3992491"
Evaluating: -25.3992491+3.5
 Parameter: ZMAX <- "-21.8992491"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.4046814"
Evaluating: 25.4046814-3.5
 Parameter: XMIN <- "21.9046814"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "49.7883499"
Evaluating: 49.7883499-3.5
 Parameter: YMIN <- "46.2883499"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.3992491"
Evaluating: -25.3992491-3.5
 Parameter: ZMIN <- "-28.8992491"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.9046814"
 Parameter: XMIN -> "21.9046814"
 Parameter: YMAX -> "53.2883499"
 Parameter: YMIN -> "46.2883499"
 Parameter: ZMAX -> "-21.8992491"
 Parameter: ZMIN -> "-28.8992491"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "37" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "37" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.465400767"
Evaluating: 100.116666*(0.465400767-0.5)
 Parameter: XPOS <- "-3.46395985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.600122857"
Evaluating: 100.116666*(0.600122857-0.5)
 Parameter: YPOS <- "10.0239666"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.430020329"
Evaluating: 127.138691*(0.430020329-0.5)+4.2778237
 Parameter: ZPOS <- "-4.61930007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.61930007" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.61930007" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "37" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.135499064"
Evaluating: 100.116666*(0.135499064-0.5)
 Parameter: XPOS <- "-36.4926185"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.15877974"
Evaluating: 100.116666*(0.15877974-0.5)
 Parameter: YPOS <- "-34.1618348"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.302415809"
Evaluating: 127.138691*(0.302415809-0.5)+4.2778237
 Parameter: ZPOS <- "-20.8427717"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.8427717" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.4926185"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.4926185-0
 Parameter: XTRAN <- "-36.4926185"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.1618348"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.1618348-0
 Parameter: YTRAN <- "-34.1618348"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.8427717"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.8427717-0
 Parameter: ZTRAN <- "-20.8427717"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.4926185"
 Parameter: YTRAN -> "-34.1618348"
 Parameter: ZTRAN -> "-20.8427717"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -36.492618  -34.161835  -20.842772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407693384"
Evaluating: 0.407693384*360.0
 Parameter: XPHI <- "146.769618"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810159898"
Evaluating: 0.810159898*360.0
 Parameter: YPHI <- "291.657563"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.922795971"
Evaluating: 0.922795971*360.0
 Parameter: ZPHI <- "332.20655"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.4926185"
 Parameter: YPOS -> "-34.1618348"
 Parameter: ZPOS -> "-20.8427717"
 Parameter: XPHI -> "146.769618"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.836474    0.548007
    0.000000   -0.548007   -0.836474

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  146.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.4926185"
 Parameter: YPOS -> "-34.1618348"
 Parameter: ZPOS -> "-20.8427717"
 Parameter: YPHI -> "291.657563"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.369058    0.000000    0.929406
    0.000000    1.000000    0.000000
   -0.929406    0.000000    0.369058

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   68.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.4926185"
 Parameter: YPOS -> "-34.1618348"
 Parameter: ZPOS -> "-20.8427717"
 Parameter: ZPHI -> "332.20655"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.884634   -0.466286    0.000000
    0.466286    0.884634    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   27.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.492618 XMAX =  -36.492618 XAVE =  -36.492618
    YMIN =  -34.161835 YMAX =  -34.161835 YAVE =  -34.161835
    ZMIN =  -20.842772 ZMAX =  -20.842772 ZAVE =  -20.842772
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.4926185"
Evaluating: -36.4926185+3.5
 Parameter: XMAX <- "-32.9926185"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.1618348"
Evaluating: -34.1618348+3.5
 Parameter: YMAX <- "-30.6618348"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.8427717"
Evaluating: -20.8427717+3.5
 Parameter: ZMAX <- "-17.3427717"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.4926185"
Evaluating: -36.4926185-3.5
 Parameter: XMIN <- "-39.9926185"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.1618348"
Evaluating: -34.1618348-3.5
 Parameter: YMIN <- "-37.6618348"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.8427717"
Evaluating: -20.8427717-3.5
 Parameter: ZMIN <- "-24.3427717"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.9926185"
 Parameter: XMIN -> "-39.9926185"
 Parameter: YMAX -> "-30.6618348"
 Parameter: YMIN -> "-37.6618348"
 Parameter: ZMAX -> "-17.3427717"
 Parameter: ZMIN -> "-24.3427717"
 SELRPN>     21 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      8 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      N             0.9456
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      C12           1.5120
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      C13           2.3331
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      C14           1.9061
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      C15           0.9659
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      C11           2.5699
39242 POS      SOD      37       SOD     -**** MEMB     POPC     222      O12           2.7024
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "37" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.521409008"
Evaluating: 100.116666*(0.521409008-0.5)
 Parameter: XPOS <- "2.1433985"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.544559829"
Evaluating: 100.116666*(0.544559829-0.5)
 Parameter: YPOS <- "4.46118152"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.419184978"
Evaluating: 127.138691*(0.419184978-0.5)+4.2778237
 Parameter: ZPOS <- "-5.99689241"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.99689241" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.99689241" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "37" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.78008804"
Evaluating: 100.116666*(0.78008804-0.5)
 Parameter: XPOS <- "28.0414808"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.313116732"
Evaluating: 100.116666*(0.313116732-0.5)
 Parameter: YPOS <- "-18.7101297"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.427967583"
Evaluating: 127.138691*(0.427967583-0.5)+4.2778237
 Parameter: ZPOS <- "-4.88028351"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.88028351" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.88028351" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "37" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.510681817"
Evaluating: 100.116666*(0.510681817-0.5)
 Parameter: XPOS <- "1.0694279"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.315767803"
Evaluating: 100.116666*(0.315767803-0.5)
 Parameter: YPOS <- "-18.4447133"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.952262154"
Evaluating: 127.138691*(0.952262154-0.5)+4.2778237
 Parameter: ZPOS <- "61.7778419"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.7778419" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.7778419" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.492618 XMAX =  -36.492618 XAVE =  -36.492618
    YMIN =  -34.161835 YMAX =  -34.161835 YAVE =  -34.161835
    ZMIN =  -20.842772 ZMAX =  -20.842772 ZAVE =  -20.842772
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.0694279"
 RDCMND substituted energy or value "?XAVE" to "-36.4926185"
Evaluating: 1.0694279--36.4926185
 Parameter: XTRAN <- "37.5620464"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.4447133"
 RDCMND substituted energy or value "?YAVE" to "-34.1618348"
Evaluating: -18.4447133--34.1618348
 Parameter: YTRAN <- "15.7171215"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.7778419"
 RDCMND substituted energy or value "?ZAVE" to "-20.8427717"
Evaluating: 61.7778419--20.8427717
 Parameter: ZTRAN <- "82.6206136"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.5620464"
 Parameter: YTRAN -> "15.7171215"
 Parameter: ZTRAN -> "82.6206136"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    37.562046   15.717121   82.620614
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807174892"
Evaluating: 0.807174892*360.0
 Parameter: XPHI <- "290.582961"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103022773"
Evaluating: 0.103022773*360.0
 Parameter: YPHI <- "37.0881983"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499669778"
Evaluating: 0.499669778*360.0
 Parameter: ZPHI <- "179.88112"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.0694279"
 Parameter: YPOS -> "-18.4447133"
 Parameter: ZPOS -> "61.7778419"
 Parameter: XPHI -> "290.582961"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.351563   -0.936164
    0.000000    0.936164    0.351563

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   69.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.0694279"
 Parameter: YPOS -> "-18.4447133"
 Parameter: ZPOS -> "61.7778419"
 Parameter: YPHI -> "37.0881983"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.797708    0.000000   -0.603044
    0.000000    1.000000    0.000000
    0.603044    0.000000    0.797708

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   37.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.0694279"
 Parameter: YPOS -> "-18.4447133"
 Parameter: ZPOS -> "61.7778419"
 Parameter: ZPHI -> "179.88112"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999998    0.002075    0.000000
   -0.002075   -0.999998    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.069428 XMAX =    1.069428 XAVE =    1.069428
    YMIN =  -18.444713 YMAX =  -18.444713 YAVE =  -18.444713
    ZMIN =   61.777842 ZMAX =   61.777842 ZAVE =   61.777842
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.0694279"
Evaluating: 1.0694279+3.5
 Parameter: XMAX <- "4.5694279"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.4447133"
Evaluating: -18.4447133+3.5
 Parameter: YMAX <- "-14.9447133"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.7778419"
Evaluating: 61.7778419+3.5
 Parameter: ZMAX <- "65.2778419"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.0694279"
Evaluating: 1.0694279-3.5
 Parameter: XMIN <- "-2.4305721"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.4447133"
Evaluating: -18.4447133-3.5
 Parameter: YMIN <- "-21.9447133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.7778419"
Evaluating: 61.7778419-3.5
 Parameter: ZMIN <- "58.2778419"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.5694279"
 Parameter: XMIN -> "-2.4305721"
 Parameter: YMAX -> "-14.9447133"
 Parameter: YMIN -> "-21.9447133"
 Parameter: ZMAX -> "65.2778419"
 Parameter: ZMIN -> "58.2778419"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "38" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "38" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.27595738"
Evaluating: 100.116666*(0.27595738-0.5)
 Parameter: XPOS <- "-22.4304002"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.157742935"
Evaluating: 100.116666*(0.157742935-0.5)
 Parameter: YPOS <- "-34.2656363"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.653622376"
Evaluating: 127.138691*(0.653622376-0.5)+4.2778237
 Parameter: ZPOS <- "23.8091715"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.8091715" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.8091715" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.4304002"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.4304002-0
 Parameter: XTRAN <- "-22.4304002"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.2656363"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.2656363-0
 Parameter: YTRAN <- "-34.2656363"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.8091715"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.8091715-0
 Parameter: ZTRAN <- "23.8091715"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.4304002"
 Parameter: YTRAN -> "-34.2656363"
 Parameter: ZTRAN -> "23.8091715"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -22.430400  -34.265636   23.809172
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875345795"
Evaluating: 0.875345795*360.0
 Parameter: XPHI <- "315.124486"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.680096565E-02"
Evaluating: 3.680096565E-02*360.0
 Parameter: YPHI <- "13.2483476"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18287952"
Evaluating: 0.18287952*360.0
 Parameter: ZPHI <- "65.8366272"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.4304002"
 Parameter: YPOS -> "-34.2656363"
 Parameter: ZPOS -> "23.8091715"
 Parameter: XPHI -> "315.124486"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.708641   -0.705569
    0.000000    0.705569    0.708641

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.4304002"
 Parameter: YPOS -> "-34.2656363"
 Parameter: ZPOS -> "23.8091715"
 Parameter: YPHI -> "13.2483476"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.973386    0.000000   -0.229172
    0.000000    1.000000    0.000000
    0.229172    0.000000    0.973386

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.4304002"
 Parameter: YPOS -> "-34.2656363"
 Parameter: ZPOS -> "23.8091715"
 Parameter: ZPHI -> "65.8366272"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.409340    0.912382    0.000000
   -0.912382    0.409340    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.430400 XMAX =  -22.430400 XAVE =  -22.430400
    YMIN =  -34.265636 YMAX =  -34.265636 YAVE =  -34.265636
    ZMIN =   23.809172 ZMAX =   23.809172 ZAVE =   23.809172
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.4304002"
Evaluating: -22.4304002+3.5
 Parameter: XMAX <- "-18.9304002"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.2656363"
Evaluating: -34.2656363+3.5
 Parameter: YMAX <- "-30.7656363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.8091715"
Evaluating: 23.8091715+3.5
 Parameter: ZMAX <- "27.3091715"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.4304002"
Evaluating: -22.4304002-3.5
 Parameter: XMIN <- "-25.9304002"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.2656363"
Evaluating: -34.2656363-3.5
 Parameter: YMIN <- "-37.7656363"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.8091715"
Evaluating: 23.8091715-3.5
 Parameter: ZMIN <- "20.3091715"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.9304002"
 Parameter: XMIN -> "-25.9304002"
 Parameter: YMAX -> "-30.7656363"
 Parameter: YMIN -> "-37.7656363"
 Parameter: ZMAX -> "27.3091715"
 Parameter: ZMIN -> "20.3091715"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "39" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "39" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.867084708E-02"
Evaluating: 100.116666*(5.867084708E-02-0.5)
 Parameter: XPOS <- "-44.1844034"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.887257339"
Evaluating: 100.116666*(0.887257339-0.5)
 Parameter: YPOS <- "38.7709137"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.673825103"
Evaluating: 127.138691*(0.673825103-0.5)+4.2778237
 Parameter: ZPOS <- "26.3777198"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.3777198" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.3777198" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.1844034"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.1844034-0
 Parameter: XTRAN <- "-44.1844034"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.7709137"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.7709137-0
 Parameter: YTRAN <- "38.7709137"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.3777198"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.3777198-0
 Parameter: ZTRAN <- "26.3777198"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.1844034"
 Parameter: YTRAN -> "38.7709137"
 Parameter: ZTRAN -> "26.3777198"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -44.184403   38.770914   26.377720
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.255478096"
Evaluating: 0.255478096*360.0
 Parameter: XPHI <- "91.9721146"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.592690875"
Evaluating: 0.592690875*360.0
 Parameter: YPHI <- "213.368715"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1367586"
Evaluating: 0.1367586*360.0
 Parameter: ZPHI <- "49.233096"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.1844034"
 Parameter: YPOS -> "38.7709137"
 Parameter: ZPOS -> "26.3777198"
 Parameter: XPHI -> "91.9721146"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.034413    0.999408
    0.000000   -0.999408   -0.034413

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   91.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.1844034"
 Parameter: YPOS -> "38.7709137"
 Parameter: ZPOS -> "26.3777198"
 Parameter: YPHI -> "213.368715"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.835148    0.000000    0.550025
    0.000000    1.000000    0.000000
   -0.550025    0.000000   -0.835148

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.1844034"
 Parameter: YPOS -> "38.7709137"
 Parameter: ZPOS -> "26.3777198"
 Parameter: ZPHI -> "49.233096"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.652983    0.757372    0.000000
   -0.757372    0.652983    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.184403 XMAX =  -44.184403 XAVE =  -44.184403
    YMIN =   38.770914 YMAX =   38.770914 YAVE =   38.770914
    ZMIN =   26.377720 ZMAX =   26.377720 ZAVE =   26.377720
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.1844034"
Evaluating: -44.1844034+3.5
 Parameter: XMAX <- "-40.6844034"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.7709137"
Evaluating: 38.7709137+3.5
 Parameter: YMAX <- "42.2709137"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.3777198"
Evaluating: 26.3777198+3.5
 Parameter: ZMAX <- "29.8777198"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.1844034"
Evaluating: -44.1844034-3.5
 Parameter: XMIN <- "-47.6844034"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.7709137"
Evaluating: 38.7709137-3.5
 Parameter: YMIN <- "35.2709137"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.3777198"
Evaluating: 26.3777198-3.5
 Parameter: ZMIN <- "22.8777198"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.6844034"
 Parameter: XMIN -> "-47.6844034"
 Parameter: YMAX -> "42.2709137"
 Parameter: YMIN -> "35.2709137"
 Parameter: ZMAX -> "29.8777198"
 Parameter: ZMIN -> "22.8777198"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "40" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "40" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.609566133"
Evaluating: 100.116666*(0.609566133-0.5)
 Parameter: XPOS <- "10.9693959"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.595201138"
Evaluating: 100.116666*(0.595201138-0.5)
 Parameter: YPOS <- "9.53122054"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.543132239"
Evaluating: 127.138691*(0.543132239-0.5)+4.2778237
 Parameter: ZPOS <- "9.76160011"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.76160011" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.76160011" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "40" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.495929336"
Evaluating: 100.116666*(0.495929336-0.5)
 Parameter: XPOS <- "-0.407541308"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.525969385"
Evaluating: 100.116666*(0.525969385-0.5)
 Parameter: YPOS <- "2.59996824"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.772662801"
Evaluating: 127.138691*(0.772662801-0.5)+4.2778237
 Parameter: ZPOS <- "38.9438153"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.9438153" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.9438153" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.407541308"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.407541308-0
 Parameter: XTRAN <- "-0.407541308"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.59996824"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.59996824-0
 Parameter: YTRAN <- "2.59996824"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.9438153"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.9438153-0
 Parameter: ZTRAN <- "38.9438153"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.407541308"
 Parameter: YTRAN -> "2.59996824"
 Parameter: ZTRAN -> "38.9438153"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -0.407541    2.599968   38.943815
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.4397275"
Evaluating: 0.4397275*360.0
 Parameter: XPHI <- "158.3019"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317022965"
Evaluating: 0.317022965*360.0
 Parameter: YPHI <- "114.128267"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882181516"
Evaluating: 0.882181516*360.0
 Parameter: ZPHI <- "317.585346"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.407541308"
 Parameter: YPOS -> "2.59996824"
 Parameter: ZPOS -> "38.9438153"
 Parameter: XPHI -> "158.3019"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.929145    0.369716
    0.000000   -0.369716   -0.929145

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  158.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.407541308"
 Parameter: YPOS -> "2.59996824"
 Parameter: ZPOS -> "38.9438153"
 Parameter: YPHI -> "114.128267"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.408781    0.000000   -0.912633
    0.000000    1.000000    0.000000
    0.912633    0.000000   -0.408781

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  114.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.407541308"
 Parameter: YPOS -> "2.59996824"
 Parameter: ZPOS -> "38.9438153"
 Parameter: ZPHI -> "317.585346"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.738283   -0.674491    0.000000
    0.674491    0.738283    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.407541 XMAX =   -0.407541 XAVE =   -0.407541
    YMIN =    2.599968 YMAX =    2.599968 YAVE =    2.599968
    ZMIN =   38.943815 ZMAX =   38.943815 ZAVE =   38.943815
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.407541308"
Evaluating: -0.407541308+3.5
 Parameter: XMAX <- "3.09245869"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.59996824"
Evaluating: 2.59996824+3.5
 Parameter: YMAX <- "6.09996824"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.9438153"
Evaluating: 38.9438153+3.5
 Parameter: ZMAX <- "42.4438153"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.407541308"
Evaluating: -0.407541308-3.5
 Parameter: XMIN <- "-3.90754131"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.59996824"
Evaluating: 2.59996824-3.5
 Parameter: YMIN <- "-0.90003176"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.9438153"
Evaluating: 38.9438153-3.5
 Parameter: ZMIN <- "35.4438153"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.09245869"
 Parameter: XMIN -> "-3.90754131"
 Parameter: YMAX -> "6.09996824"
 Parameter: YMIN -> "-0.90003176"
 Parameter: ZMAX -> "42.4438153"
 Parameter: ZMIN -> "35.4438153"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "41" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "41" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.489071938"
Evaluating: 100.116666*(0.489071938-0.5)
 Parameter: XPOS <- "-1.09408113"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.518184282"
Evaluating: 100.116666*(0.518184282-0.5)
 Parameter: YPOS <- "1.82054969"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.131920026"
Evaluating: 127.138691*(0.131920026-0.5)+4.2778237
 Parameter: ZPOS <- "-42.5193824"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.5193824" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.09408113"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.09408113-0
 Parameter: XTRAN <- "-1.09408113"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.82054969"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.82054969-0
 Parameter: YTRAN <- "1.82054969"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.5193824"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.5193824-0
 Parameter: ZTRAN <- "-42.5193824"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.09408113"
 Parameter: YTRAN -> "1.82054969"
 Parameter: ZTRAN -> "-42.5193824"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -1.094081    1.820550  -42.519382
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503596904"
Evaluating: 0.503596904*360.0
 Parameter: XPHI <- "181.294885"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850265938"
Evaluating: 0.850265938*360.0
 Parameter: YPHI <- "306.095738"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720129711"
Evaluating: 0.720129711*360.0
 Parameter: ZPHI <- "259.246696"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.09408113"
 Parameter: YPOS -> "1.82054969"
 Parameter: ZPOS -> "-42.5193824"
 Parameter: XPHI -> "181.294885"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999745   -0.022598
    0.000000    0.022598   -0.999745

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  178.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.09408113"
 Parameter: YPOS -> "1.82054969"
 Parameter: ZPOS -> "-42.5193824"
 Parameter: YPHI -> "306.095738"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.589136    0.000000    0.808034
    0.000000    1.000000    0.000000
   -0.808034    0.000000    0.589136

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   53.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.09408113"
 Parameter: YPOS -> "1.82054969"
 Parameter: ZPOS -> "-42.5193824"
 Parameter: ZPHI -> "259.246696"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.186581   -0.982440    0.000000
    0.982440   -0.186581    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.094081 XMAX =   -1.094081 XAVE =   -1.094081
    YMIN =    1.820550 YMAX =    1.820550 YAVE =    1.820550
    ZMIN =  -42.519382 ZMAX =  -42.519382 ZAVE =  -42.519382
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.09408113"
Evaluating: -1.09408113+3.5
 Parameter: XMAX <- "2.40591887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.82054969"
Evaluating: 1.82054969+3.5
 Parameter: YMAX <- "5.32054969"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.5193824"
Evaluating: -42.5193824+3.5
 Parameter: ZMAX <- "-39.0193824"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.09408113"
Evaluating: -1.09408113-3.5
 Parameter: XMIN <- "-4.59408113"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.82054969"
Evaluating: 1.82054969-3.5
 Parameter: YMIN <- "-1.67945031"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.5193824"
Evaluating: -42.5193824-3.5
 Parameter: ZMIN <- "-46.0193824"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.40591887"
 Parameter: XMIN -> "-4.59408113"
 Parameter: YMAX -> "5.32054969"
 Parameter: YMIN -> "-1.67945031"
 Parameter: ZMAX -> "-39.0193824"
 Parameter: ZMIN -> "-46.0193824"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "42" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "42" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.614309886"
Evaluating: 100.116666*(0.614309886-0.5)
 Parameter: XPOS <- "11.4443247"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.871641093"
Evaluating: 100.116666*(0.871641093-0.5)
 Parameter: YPOS <- "37.2074672"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.266744162"
Evaluating: 127.138691*(0.266744162-0.5)+4.2778237
 Parameter: ZPOS <- "-25.3780182"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.3780182" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.4443247"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.4443247-0
 Parameter: XTRAN <- "11.4443247"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.2074672"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.2074672-0
 Parameter: YTRAN <- "37.2074672"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.3780182"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.3780182-0
 Parameter: ZTRAN <- "-25.3780182"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.4443247"
 Parameter: YTRAN -> "37.2074672"
 Parameter: ZTRAN -> "-25.3780182"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    11.444325   37.207467  -25.378018
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249428739"
Evaluating: 0.249428739*360.0
 Parameter: XPHI <- "89.794346"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400552909"
Evaluating: 0.400552909*360.0
 Parameter: YPHI <- "144.199047"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.230992686"
Evaluating: 0.230992686*360.0
 Parameter: ZPHI <- "83.157367"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.4443247"
 Parameter: YPOS -> "37.2074672"
 Parameter: ZPOS -> "-25.3780182"
 Parameter: XPHI -> "89.794346"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.003589    0.999994
    0.000000   -0.999994    0.003589

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   89.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.4443247"
 Parameter: YPOS -> "37.2074672"
 Parameter: ZPOS -> "-25.3780182"
 Parameter: YPHI -> "144.199047"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.811054    0.000000   -0.584971
    0.000000    1.000000    0.000000
    0.584971    0.000000   -0.811054

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.4443247"
 Parameter: YPOS -> "37.2074672"
 Parameter: ZPOS -> "-25.3780182"
 Parameter: ZPHI -> "83.157367"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.119143    0.992877    0.000000
   -0.992877    0.119143    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   83.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.444325 XMAX =   11.444325 XAVE =   11.444325
    YMIN =   37.207467 YMAX =   37.207467 YAVE =   37.207467
    ZMIN =  -25.378018 ZMAX =  -25.378018 ZAVE =  -25.378018
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.4443247"
Evaluating: 11.4443247+3.5
 Parameter: XMAX <- "14.9443247"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.2074672"
Evaluating: 37.2074672+3.5
 Parameter: YMAX <- "40.7074672"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.3780182"
Evaluating: -25.3780182+3.5
 Parameter: ZMAX <- "-21.8780182"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.4443247"
Evaluating: 11.4443247-3.5
 Parameter: XMIN <- "7.9443247"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.2074672"
Evaluating: 37.2074672-3.5
 Parameter: YMIN <- "33.7074672"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.3780182"
Evaluating: -25.3780182-3.5
 Parameter: ZMIN <- "-28.8780182"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.9443247"
 Parameter: XMIN -> "7.9443247"
 Parameter: YMAX -> "40.7074672"
 Parameter: YMIN -> "33.7074672"
 Parameter: ZMAX -> "-21.8780182"
 Parameter: ZMIN -> "-28.8780182"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "43" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "43" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.714110768"
Evaluating: 100.116666*(0.714110768-0.5)
 Parameter: XPOS <- "21.4360562"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.411931329"
Evaluating: 100.116666*(0.411931329-0.5)
 Parameter: YPOS <- "-8.81714172"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.922300065"
Evaluating: 127.138691*(0.922300065-0.5)+4.2778237
 Parameter: ZPOS <- "57.9685012"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.9685012" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.9685012" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.4360562"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 21.4360562-0
 Parameter: XTRAN <- "21.4360562"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.81714172"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.81714172-0
 Parameter: YTRAN <- "-8.81714172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.9685012"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.9685012-0
 Parameter: ZTRAN <- "57.9685012"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "21.4360562"
 Parameter: YTRAN -> "-8.81714172"
 Parameter: ZTRAN -> "57.9685012"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    21.436056   -8.817142   57.968501
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.50782822"
Evaluating: 0.50782822*360.0
 Parameter: XPHI <- "182.818159"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668354554"
Evaluating: 0.668354554*360.0
 Parameter: YPHI <- "240.607639"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166505167"
Evaluating: 0.166505167*360.0
 Parameter: ZPHI <- "59.9418601"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.4360562"
 Parameter: YPOS -> "-8.81714172"
 Parameter: ZPOS -> "57.9685012"
 Parameter: XPHI -> "182.818159"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998791   -0.049166
    0.000000    0.049166   -0.998791

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.4360562"
 Parameter: YPOS -> "-8.81714172"
 Parameter: ZPOS -> "57.9685012"
 Parameter: YPHI -> "240.607639"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.490788    0.000000    0.871279
    0.000000    1.000000    0.000000
   -0.871279    0.000000   -0.490788

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.4360562"
 Parameter: YPOS -> "-8.81714172"
 Parameter: ZPOS -> "57.9685012"
 Parameter: ZPHI -> "59.9418601"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.500879    0.865518    0.000000
   -0.865518    0.500879    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.436056 XMAX =   21.436056 XAVE =   21.436056
    YMIN =   -8.817142 YMAX =   -8.817142 YAVE =   -8.817142
    ZMIN =   57.968501 ZMAX =   57.968501 ZAVE =   57.968501
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.4360562"
Evaluating: 21.4360562+3.5
 Parameter: XMAX <- "24.9360562"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.81714172"
Evaluating: -8.81714172+3.5
 Parameter: YMAX <- "-5.31714172"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.9685012"
Evaluating: 57.9685012+3.5
 Parameter: ZMAX <- "61.4685012"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.4360562"
Evaluating: 21.4360562-3.5
 Parameter: XMIN <- "17.9360562"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.81714172"
Evaluating: -8.81714172-3.5
 Parameter: YMIN <- "-12.3171417"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.9685012"
Evaluating: 57.9685012-3.5
 Parameter: ZMIN <- "54.4685012"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.9360562"
 Parameter: XMIN -> "17.9360562"
 Parameter: YMAX -> "-5.31714172"
 Parameter: YMIN -> "-12.3171417"
 Parameter: ZMAX -> "61.4685012"
 Parameter: ZMIN -> "54.4685012"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "44" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "44" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.514996194"
Evaluating: 100.116666*(0.514996194-0.5)
 Parameter: XPOS <- "1.50136895"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.423196987"
Evaluating: 100.116666*(0.423196987-0.5)
 Parameter: YPOS <- "-7.6892616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.364978023"
Evaluating: 127.138691*(0.364978023-0.5)+4.2778237
 Parameter: ZPOS <- "-12.8886937"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.8886937" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.8886937" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "44" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.659536393"
Evaluating: 100.116666*(0.659536393-0.5)
 Parameter: XPOS <- "15.9722518"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.498405035"
Evaluating: 100.116666*(0.498405035-0.5)
 Parameter: YPOS <- "-0.159682578"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.739097474"
Evaluating: 127.138691*(0.739097474-0.5)+4.2778237
 Parameter: ZPOS <- "34.6763636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.6763636" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.6763636" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.9722518"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.9722518-0
 Parameter: XTRAN <- "15.9722518"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.159682578"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.159682578-0
 Parameter: YTRAN <- "-0.159682578"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.6763636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.6763636-0
 Parameter: ZTRAN <- "34.6763636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.9722518"
 Parameter: YTRAN -> "-0.159682578"
 Parameter: ZTRAN -> "34.6763636"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    15.972252   -0.159683   34.676364
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.570278741E-02"
Evaluating: 5.570278741E-02*360.0
 Parameter: XPHI <- "20.0530035"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454573093"
Evaluating: 0.454573093*360.0
 Parameter: YPHI <- "163.646313"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726429907"
Evaluating: 0.726429907*360.0
 Parameter: ZPHI <- "261.514767"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.9722518"
 Parameter: YPOS -> "-0.159682578"
 Parameter: ZPOS -> "34.6763636"
 Parameter: XPHI -> "20.0530035"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.939376    0.342889
    0.000000   -0.342889    0.939376

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   20.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.9722518"
 Parameter: YPOS -> "-0.159682578"
 Parameter: ZPOS -> "34.6763636"
 Parameter: YPHI -> "163.646313"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.959542    0.000000   -0.281566
    0.000000    1.000000    0.000000
    0.281566    0.000000   -0.959542

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.9722518"
 Parameter: YPOS -> "-0.159682578"
 Parameter: ZPOS -> "34.6763636"
 Parameter: ZPHI -> "261.514767"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.147555   -0.989054    0.000000
    0.989054   -0.147555    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.972252 XMAX =   15.972252 XAVE =   15.972252
    YMIN =   -0.159683 YMAX =   -0.159683 YAVE =   -0.159683
    ZMIN =   34.676364 ZMAX =   34.676364 ZAVE =   34.676364
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.9722518"
Evaluating: 15.9722518+3.5
 Parameter: XMAX <- "19.4722518"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.159682578"
Evaluating: -0.159682578+3.5
 Parameter: YMAX <- "3.34031742"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.6763636"
Evaluating: 34.6763636+3.5
 Parameter: ZMAX <- "38.1763636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.9722518"
Evaluating: 15.9722518-3.5
 Parameter: XMIN <- "12.4722518"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.159682578"
Evaluating: -0.159682578-3.5
 Parameter: YMIN <- "-3.65968258"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.6763636"
Evaluating: 34.6763636-3.5
 Parameter: ZMIN <- "31.1763636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.4722518"
 Parameter: XMIN -> "12.4722518"
 Parameter: YMAX -> "3.34031742"
 Parameter: YMIN -> "-3.65968258"
 Parameter: ZMAX -> "38.1763636"
 Parameter: ZMIN -> "31.1763636"
 SELRPN>      2 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      2 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39249 POS      SOD      44       SOD     -4688 PROA     GLU      351      CD            5.2306
39249 POS      SOD      44       SOD     -4690 PROA     GLU      351      OE2           4.4490
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "44" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.13360553"
Evaluating: 100.116666*(0.13360553-0.5)
 Parameter: XPOS <- "-36.6821928"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.773220103"
Evaluating: 100.116666*(0.773220103-0.5)
 Parameter: YPOS <- "27.3538858"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.83769299"
Evaluating: 127.138691*(0.83769299-0.5)+4.2778237
 Parameter: ZPOS <- "47.2116684"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.2116684" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.2116684" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.972252 XMAX =   15.972252 XAVE =   15.972252
    YMIN =   -0.159683 YMAX =   -0.159683 YAVE =   -0.159683
    ZMIN =   34.676364 ZMAX =   34.676364 ZAVE =   34.676364
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.6821928"
 RDCMND substituted energy or value "?XAVE" to "15.9722518"
Evaluating: -36.6821928-15.9722518
 Parameter: XTRAN <- "-52.6544446"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.3538858"
 RDCMND substituted energy or value "?YAVE" to "-0.159682578"
Evaluating: 27.3538858--0.159682578
 Parameter: YTRAN <- "27.5135684"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.2116684"
 RDCMND substituted energy or value "?ZAVE" to "34.6763636"
Evaluating: 47.2116684-34.6763636
 Parameter: ZTRAN <- "12.5353048"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.6544446"
 Parameter: YTRAN -> "27.5135684"
 Parameter: ZTRAN -> "12.5353048"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -52.654445   27.513568   12.535305
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364546052"
Evaluating: 0.364546052*360.0
 Parameter: XPHI <- "131.236579"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129229951"
Evaluating: 0.129229951*360.0
 Parameter: YPHI <- "46.5227824"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.116518289"
Evaluating: 0.116518289*360.0
 Parameter: ZPHI <- "41.946584"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.6821928"
 Parameter: YPOS -> "27.3538858"
 Parameter: ZPOS -> "47.2116684"
 Parameter: XPHI -> "131.236579"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.659170    0.751994
    0.000000   -0.751994   -0.659170

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  131.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.6821928"
 Parameter: YPOS -> "27.3538858"
 Parameter: ZPOS -> "47.2116684"
 Parameter: YPHI -> "46.5227824"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.688066    0.000000   -0.725648
    0.000000    1.000000    0.000000
    0.725648    0.000000    0.688066

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   46.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.6821928"
 Parameter: YPOS -> "27.3538858"
 Parameter: ZPOS -> "47.2116684"
 Parameter: ZPHI -> "41.946584"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.743768    0.668437    0.000000
   -0.668437    0.743768    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   41.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.682193 XMAX =  -36.682193 XAVE =  -36.682193
    YMIN =   27.353886 YMAX =   27.353886 YAVE =   27.353886
    ZMIN =   47.211668 ZMAX =   47.211668 ZAVE =   47.211668
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.6821928"
Evaluating: -36.6821928+3.5
 Parameter: XMAX <- "-33.1821928"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.3538858"
Evaluating: 27.3538858+3.5
 Parameter: YMAX <- "30.8538858"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.2116684"
Evaluating: 47.2116684+3.5
 Parameter: ZMAX <- "50.7116684"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.6821928"
Evaluating: -36.6821928-3.5
 Parameter: XMIN <- "-40.1821928"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.3538858"
Evaluating: 27.3538858-3.5
 Parameter: YMIN <- "23.8538858"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.2116684"
Evaluating: 47.2116684-3.5
 Parameter: ZMIN <- "43.7116684"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.1821928"
 Parameter: XMIN -> "-40.1821928"
 Parameter: YMAX -> "30.8538858"
 Parameter: YMIN -> "23.8538858"
 Parameter: ZMAX -> "50.7116684"
 Parameter: ZMIN -> "43.7116684"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "45" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "45" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.102602386"
Evaluating: 100.116666*(0.102602386-0.5)
 Parameter: XPOS <- "-39.7861242"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.645512975"
Evaluating: 100.116666*(0.645512975-0.5)
 Parameter: YPOS <- "14.5682739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.11358579"
Evaluating: 127.138691*(0.11358579-0.5)+4.2778237
 Parameter: ZPOS <- "-44.8503731"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.8503731" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.7861242"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.7861242-0
 Parameter: XTRAN <- "-39.7861242"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.5682739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.5682739-0
 Parameter: YTRAN <- "14.5682739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.8503731"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.8503731-0
 Parameter: ZTRAN <- "-44.8503731"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.7861242"
 Parameter: YTRAN -> "14.5682739"
 Parameter: ZTRAN -> "-44.8503731"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -39.786124   14.568274  -44.850373
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175622412"
Evaluating: 0.175622412*360.0
 Parameter: XPHI <- "63.2240683"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.975566038"
Evaluating: 0.975566038*360.0
 Parameter: YPHI <- "351.203774"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.295107669"
Evaluating: 0.295107669*360.0
 Parameter: ZPHI <- "106.238761"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.7861242"
 Parameter: YPOS -> "14.5682739"
 Parameter: ZPOS -> "-44.8503731"
 Parameter: XPHI -> "63.2240683"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.450503    0.892775
    0.000000   -0.892775    0.450503

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.7861242"
 Parameter: YPOS -> "14.5682739"
 Parameter: ZPOS -> "-44.8503731"
 Parameter: YPHI -> "351.203774"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.988238    0.000000    0.152921
    0.000000    1.000000    0.000000
   -0.152921    0.000000    0.988238

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.7861242"
 Parameter: YPOS -> "14.5682739"
 Parameter: ZPOS -> "-44.8503731"
 Parameter: ZPHI -> "106.238761"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.279641    0.960105    0.000000
   -0.960105   -0.279641    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.786124 XMAX =  -39.786124 XAVE =  -39.786124
    YMIN =   14.568274 YMAX =   14.568274 YAVE =   14.568274
    ZMIN =  -44.850373 ZMAX =  -44.850373 ZAVE =  -44.850373
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.7861242"
Evaluating: -39.7861242+3.5
 Parameter: XMAX <- "-36.2861242"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.5682739"
Evaluating: 14.5682739+3.5
 Parameter: YMAX <- "18.0682739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.8503731"
Evaluating: -44.8503731+3.5
 Parameter: ZMAX <- "-41.3503731"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.7861242"
Evaluating: -39.7861242-3.5
 Parameter: XMIN <- "-43.2861242"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.5682739"
Evaluating: 14.5682739-3.5
 Parameter: YMIN <- "11.0682739"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.8503731"
Evaluating: -44.8503731-3.5
 Parameter: ZMIN <- "-48.3503731"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.2861242"
 Parameter: XMIN -> "-43.2861242"
 Parameter: YMAX -> "18.0682739"
 Parameter: YMIN -> "11.0682739"
 Parameter: ZMAX -> "-41.3503731"
 Parameter: ZMIN -> "-48.3503731"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "46" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "46" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.141514992"
Evaluating: 100.116666*(0.141514992-0.5)
 Parameter: XPOS <- "-35.8903238"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.415974866"
Evaluating: 100.116666*(0.415974866-0.5)
 Parameter: YPOS <- "-8.41231628"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "5.499446764E-02"
Evaluating: 127.138691*(5.499446764E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-52.2995972"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.2995972" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.8903238"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.8903238-0
 Parameter: XTRAN <- "-35.8903238"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.41231628"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.41231628-0
 Parameter: YTRAN <- "-8.41231628"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.2995972"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -52.2995972-0
 Parameter: ZTRAN <- "-52.2995972"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.8903238"
 Parameter: YTRAN -> "-8.41231628"
 Parameter: ZTRAN -> "-52.2995972"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -35.890324   -8.412316  -52.299597
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.344104245"
Evaluating: 0.344104245*360.0
 Parameter: XPHI <- "123.877528"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.467919379"
Evaluating: 0.467919379*360.0
 Parameter: YPHI <- "168.450976"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131676015"
Evaluating: 0.131676015*360.0
 Parameter: ZPHI <- "47.4033654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.8903238"
 Parameter: YPOS -> "-8.41231628"
 Parameter: ZPOS -> "-52.2995972"
 Parameter: XPHI -> "123.877528"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.557420    0.830231
    0.000000   -0.830231   -0.557420

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  123.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.8903238"
 Parameter: YPOS -> "-8.41231628"
 Parameter: ZPOS -> "-52.2995972"
 Parameter: YPHI -> "168.450976"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.979754    0.000000   -0.200206
    0.000000    1.000000    0.000000
    0.200206    0.000000   -0.979754

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.8903238"
 Parameter: YPOS -> "-8.41231628"
 Parameter: ZPOS -> "-52.2995972"
 Parameter: ZPHI -> "47.4033654"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.676833    0.736137    0.000000
   -0.736137    0.676833    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   47.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.890324 XMAX =  -35.890324 XAVE =  -35.890324
    YMIN =   -8.412316 YMAX =   -8.412316 YAVE =   -8.412316
    ZMIN =  -52.299597 ZMAX =  -52.299597 ZAVE =  -52.299597
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.8903238"
Evaluating: -35.8903238+3.5
 Parameter: XMAX <- "-32.3903238"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.41231628"
Evaluating: -8.41231628+3.5
 Parameter: YMAX <- "-4.91231628"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.2995972"
Evaluating: -52.2995972+3.5
 Parameter: ZMAX <- "-48.7995972"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.8903238"
Evaluating: -35.8903238-3.5
 Parameter: XMIN <- "-39.3903238"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.41231628"
Evaluating: -8.41231628-3.5
 Parameter: YMIN <- "-11.9123163"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.2995972"
Evaluating: -52.2995972-3.5
 Parameter: ZMIN <- "-55.7995972"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.3903238"
 Parameter: XMIN -> "-39.3903238"
 Parameter: YMAX -> "-4.91231628"
 Parameter: YMIN -> "-11.9123163"
 Parameter: ZMAX -> "-48.7995972"
 Parameter: ZMIN -> "-55.7995972"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "47" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "47" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.430409316"
Evaluating: 100.116666*(0.430409316-0.5)
 Parameter: XPOS <- "-6.96718727"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.44169646"
Evaluating: 100.116666*(0.44169646-0.5)
 Parameter: YPOS <- "-5.83715604"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.970278472"
Evaluating: 127.138691*(0.970278472-0.5)+4.2778237
 Parameter: ZPOS <- "64.068413"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.068413" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.068413" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.96718727"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.96718727-0
 Parameter: XTRAN <- "-6.96718727"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.83715604"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.83715604-0
 Parameter: YTRAN <- "-5.83715604"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.068413"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.068413-0
 Parameter: ZTRAN <- "64.068413"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.96718727"
 Parameter: YTRAN -> "-5.83715604"
 Parameter: ZTRAN -> "64.068413"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -6.967187   -5.837156   64.068413
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.931441914"
Evaluating: 0.931441914*360.0
 Parameter: XPHI <- "335.319089"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882129635"
Evaluating: 0.882129635*360.0
 Parameter: YPHI <- "317.566669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101256831"
Evaluating: 0.101256831*360.0
 Parameter: ZPHI <- "36.4524592"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.96718727"
 Parameter: YPOS -> "-5.83715604"
 Parameter: ZPOS -> "64.068413"
 Parameter: XPHI -> "335.319089"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.908647   -0.417564
    0.000000    0.417564    0.908647

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   24.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.96718727"
 Parameter: YPOS -> "-5.83715604"
 Parameter: ZPOS -> "64.068413"
 Parameter: YPHI -> "317.566669"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.738063    0.000000    0.674732
    0.000000    1.000000    0.000000
   -0.674732    0.000000    0.738063

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.96718727"
 Parameter: YPOS -> "-5.83715604"
 Parameter: ZPOS -> "64.068413"
 Parameter: ZPHI -> "36.4524592"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.804350    0.594156    0.000000
   -0.594156    0.804350    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.967187 XMAX =   -6.967187 XAVE =   -6.967187
    YMIN =   -5.837156 YMAX =   -5.837156 YAVE =   -5.837156
    ZMIN =   64.068413 ZMAX =   64.068413 ZAVE =   64.068413
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.96718727"
Evaluating: -6.96718727+3.5
 Parameter: XMAX <- "-3.46718727"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.83715604"
Evaluating: -5.83715604+3.5
 Parameter: YMAX <- "-2.33715604"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.068413"
Evaluating: 64.068413+3.5
 Parameter: ZMAX <- "67.568413"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.96718727"
Evaluating: -6.96718727-3.5
 Parameter: XMIN <- "-10.4671873"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.83715604"
Evaluating: -5.83715604-3.5
 Parameter: YMIN <- "-9.33715604"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.068413"
Evaluating: 64.068413-3.5
 Parameter: ZMIN <- "60.568413"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.46718727"
 Parameter: XMIN -> "-10.4671873"
 Parameter: YMAX -> "-2.33715604"
 Parameter: YMIN -> "-9.33715604"
 Parameter: ZMAX -> "67.568413"
 Parameter: ZMIN -> "60.568413"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "48" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "48" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.632551237"
Evaluating: 100.116666*(0.632551237-0.5)
 Parameter: XPOS <- "13.2705879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.100057681"
Evaluating: 100.116666*(0.100057681-0.5)
 Parameter: YPOS <- "-40.0408916"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.337966204"
Evaluating: 127.138691*(0.337966204-0.5)+4.2778237
 Parameter: ZPOS <- "-16.322941"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.322941" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.2705879"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.2705879-0
 Parameter: XTRAN <- "13.2705879"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.0408916"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.0408916-0
 Parameter: YTRAN <- "-40.0408916"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.322941"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.322941-0
 Parameter: ZTRAN <- "-16.322941"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.2705879"
 Parameter: YTRAN -> "-40.0408916"
 Parameter: ZTRAN -> "-16.322941"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    13.270588  -40.040892  -16.322941
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.859941634"
Evaluating: 0.859941634*360.0
 Parameter: XPHI <- "309.578988"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802772436"
Evaluating: 0.802772436*360.0
 Parameter: YPHI <- "288.998077"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.604285957E-02"
Evaluating: 8.604285957E-02*360.0
 Parameter: ZPHI <- "30.9754294"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.2705879"
 Parameter: YPOS -> "-40.0408916"
 Parameter: ZPOS -> "-16.322941"
 Parameter: XPHI -> "309.578988"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.637141   -0.770747
    0.000000    0.770747    0.637141

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   50.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.2705879"
 Parameter: YPOS -> "-40.0408916"
 Parameter: ZPOS -> "-16.322941"
 Parameter: YPHI -> "288.998077"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.325536    0.000000    0.945530
    0.000000    1.000000    0.000000
   -0.945530    0.000000    0.325536

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.2705879"
 Parameter: YPOS -> "-40.0408916"
 Parameter: ZPOS -> "-16.322941"
 Parameter: ZPHI -> "30.9754294"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.857388    0.514670    0.000000
   -0.514670    0.857388    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.270588 XMAX =   13.270588 XAVE =   13.270588
    YMIN =  -40.040892 YMAX =  -40.040892 YAVE =  -40.040892
    ZMIN =  -16.322941 ZMAX =  -16.322941 ZAVE =  -16.322941
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.2705879"
Evaluating: 13.2705879+3.5
 Parameter: XMAX <- "16.7705879"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.0408916"
Evaluating: -40.0408916+3.5
 Parameter: YMAX <- "-36.5408916"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.322941"
Evaluating: -16.322941+3.5
 Parameter: ZMAX <- "-12.822941"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.2705879"
Evaluating: 13.2705879-3.5
 Parameter: XMIN <- "9.7705879"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.0408916"
Evaluating: -40.0408916-3.5
 Parameter: YMIN <- "-43.5408916"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.322941"
Evaluating: -16.322941-3.5
 Parameter: ZMIN <- "-19.822941"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.7705879"
 Parameter: XMIN -> "9.7705879"
 Parameter: YMAX -> "-36.5408916"
 Parameter: YMIN -> "-43.5408916"
 Parameter: ZMAX -> "-12.822941"
 Parameter: ZMIN -> "-19.822941"
 SELRPN>     16 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      4 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39253 POS      SOD      48       SOD     -**** MEMB     POPC     182      C12           3.5055
39253 POS      SOD      48       SOD     -**** MEMB     POPC     182      C11           3.0689
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "48" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.936465194"
Evaluating: 100.116666*(0.936465194-0.5)
 Parameter: XPOS <- "43.69744"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "2.10474482E-02"
Evaluating: 100.116666*(2.10474482E-02-0.5)
 Parameter: YPOS <- "-47.9511327"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.295953827"
Evaluating: 127.138691*(0.295953827-0.5)+4.2778237
 Parameter: ZPOS <- "-21.6643396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.6643396" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.270588 XMAX =   13.270588 XAVE =   13.270588
    YMIN =  -40.040892 YMAX =  -40.040892 YAVE =  -40.040892
    ZMIN =  -16.322941 ZMAX =  -16.322941 ZAVE =  -16.322941
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.69744"
 RDCMND substituted energy or value "?XAVE" to "13.2705879"
Evaluating: 43.69744-13.2705879
 Parameter: XTRAN <- "30.4268521"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.9511327"
 RDCMND substituted energy or value "?YAVE" to "-40.0408916"
Evaluating: -47.9511327--40.0408916
 Parameter: YTRAN <- "-7.9102411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.6643396"
 RDCMND substituted energy or value "?ZAVE" to "-16.322941"
Evaluating: -21.6643396--16.322941
 Parameter: ZTRAN <- "-5.3413986"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.4268521"
 Parameter: YTRAN -> "-7.9102411"
 Parameter: ZTRAN -> "-5.3413986"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    30.426852   -7.910241   -5.341399
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542902788"
Evaluating: 0.542902788*360.0
 Parameter: XPHI <- "195.445004"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.779188452"
Evaluating: 0.779188452*360.0
 Parameter: YPHI <- "280.507843"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678990142"
Evaluating: 0.678990142*360.0
 Parameter: ZPHI <- "244.436451"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.69744"
 Parameter: YPOS -> "-47.9511327"
 Parameter: ZPOS -> "-21.6643396"
 Parameter: XPHI -> "195.445004"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.963887   -0.266313
    0.000000    0.266313   -0.963887

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  164.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.69744"
 Parameter: YPOS -> "-47.9511327"
 Parameter: ZPOS -> "-21.6643396"
 Parameter: YPHI -> "280.507843"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.182370    0.000000    0.983230
    0.000000    1.000000    0.000000
   -0.983230    0.000000    0.182370

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   79.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.69744"
 Parameter: YPOS -> "-47.9511327"
 Parameter: ZPOS -> "-21.6643396"
 Parameter: ZPHI -> "244.436451"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.431512   -0.902107    0.000000
    0.902107   -0.431512    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  115.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.697440 XMAX =   43.697440 XAVE =   43.697440
    YMIN =  -47.951133 YMAX =  -47.951133 YAVE =  -47.951133
    ZMIN =  -21.664340 ZMAX =  -21.664340 ZAVE =  -21.664340
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.69744"
Evaluating: 43.69744+3.5
 Parameter: XMAX <- "47.19744"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.9511327"
Evaluating: -47.9511327+3.5
 Parameter: YMAX <- "-44.4511327"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.6643396"
Evaluating: -21.6643396+3.5
 Parameter: ZMAX <- "-18.1643396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.69744"
Evaluating: 43.69744-3.5
 Parameter: XMIN <- "40.19744"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.9511327"
Evaluating: -47.9511327-3.5
 Parameter: YMIN <- "-51.4511327"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.6643396"
Evaluating: -21.6643396-3.5
 Parameter: ZMIN <- "-25.1643396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.19744"
 Parameter: XMIN -> "40.19744"
 Parameter: YMAX -> "-44.4511327"
 Parameter: YMIN -> "-51.4511327"
 Parameter: ZMAX -> "-18.1643396"
 Parameter: ZMIN -> "-25.1643396"
 SELRPN>     15 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      6 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39253 POS      SOD      48       SOD     -**** MEMB     POPC     251      N             3.0904
39253 POS      SOD      48       SOD     -**** MEMB     POPC     251      C12           2.9001
39253 POS      SOD      48       SOD     -**** MEMB     POPC     251      C13           3.9108
39253 POS      SOD      48       SOD     -**** MEMB     POPC     251      C15           2.2739
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "48" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.177599522"
Evaluating: 100.116666*(0.177599522-0.5)
 Parameter: XPOS <- "-32.277661"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.255594353"
Evaluating: 100.116666*(0.255594353-0.5)
 Parameter: YPOS <- "-24.4690785"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.183154616"
Evaluating: 127.138691*(0.183154616-0.5)+4.2778237
 Parameter: ZPOS <- "-36.0054837"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.0054837" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.697440 XMAX =   43.697440 XAVE =   43.697440
    YMIN =  -47.951133 YMAX =  -47.951133 YAVE =  -47.951133
    ZMIN =  -21.664340 ZMAX =  -21.664340 ZAVE =  -21.664340
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.277661"
 RDCMND substituted energy or value "?XAVE" to "43.69744"
Evaluating: -32.277661-43.69744
 Parameter: XTRAN <- "-75.975101"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.4690785"
 RDCMND substituted energy or value "?YAVE" to "-47.9511327"
Evaluating: -24.4690785--47.9511327
 Parameter: YTRAN <- "23.4820542"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.0054837"
 RDCMND substituted energy or value "?ZAVE" to "-21.6643396"
Evaluating: -36.0054837--21.6643396
 Parameter: ZTRAN <- "-14.3411441"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-75.975101"
 Parameter: YTRAN -> "23.4820542"
 Parameter: ZTRAN -> "-14.3411441"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -75.975101   23.482054  -14.341144
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.315127288"
Evaluating: 0.315127288*360.0
 Parameter: XPHI <- "113.445824"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.674785855E-02"
Evaluating: 7.674785855E-02*360.0
 Parameter: YPHI <- "27.6292291"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841599492"
Evaluating: 0.841599492*360.0
 Parameter: ZPHI <- "302.975817"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.277661"
 Parameter: YPOS -> "-24.4690785"
 Parameter: ZPOS -> "-36.0054837"
 Parameter: XPHI -> "113.445824"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.397882    0.917437
    0.000000   -0.917437   -0.397882

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.277661"
 Parameter: YPOS -> "-24.4690785"
 Parameter: ZPOS -> "-36.0054837"
 Parameter: YPHI -> "27.6292291"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.885967    0.000000   -0.463748
    0.000000    1.000000    0.000000
    0.463748    0.000000    0.885967

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   27.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.277661"
 Parameter: YPOS -> "-24.4690785"
 Parameter: ZPOS -> "-36.0054837"
 Parameter: ZPHI -> "302.975817"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.544285   -0.838900    0.000000
    0.838900    0.544285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   57.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.277661 XMAX =  -32.277661 XAVE =  -32.277661
    YMIN =  -24.469078 YMAX =  -24.469078 YAVE =  -24.469078
    ZMIN =  -36.005484 ZMAX =  -36.005484 ZAVE =  -36.005484
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.277661"
Evaluating: -32.277661+3.5
 Parameter: XMAX <- "-28.777661"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.4690785"
Evaluating: -24.4690785+3.5
 Parameter: YMAX <- "-20.9690785"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.0054837"
Evaluating: -36.0054837+3.5
 Parameter: ZMAX <- "-32.5054837"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.277661"
Evaluating: -32.277661-3.5
 Parameter: XMIN <- "-35.777661"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.4690785"
Evaluating: -24.4690785-3.5
 Parameter: YMIN <- "-27.9690785"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.0054837"
Evaluating: -36.0054837-3.5
 Parameter: ZMIN <- "-39.5054837"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.777661"
 Parameter: XMIN -> "-35.777661"
 Parameter: YMAX -> "-20.9690785"
 Parameter: YMIN -> "-27.9690785"
 Parameter: ZMAX -> "-32.5054837"
 Parameter: ZMIN -> "-39.5054837"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "49" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "49" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.59312968"
Evaluating: 100.116666*(0.59312968-0.5)
 Parameter: XPOS <- "9.32383307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.24325435"
Evaluating: 100.116666*(0.24325435-0.5)
 Parameter: YPOS <- "-25.7045185"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "1.489951866E-02"
Evaluating: 127.138691*(1.489951866E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-57.3972165"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.3972165" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.32383307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.32383307-0
 Parameter: XTRAN <- "9.32383307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.7045185"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.7045185-0
 Parameter: YTRAN <- "-25.7045185"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.3972165"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.3972165-0
 Parameter: ZTRAN <- "-57.3972165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.32383307"
 Parameter: YTRAN -> "-25.7045185"
 Parameter: ZTRAN -> "-57.3972165"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     9.323833  -25.704518  -57.397216
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954845991"
Evaluating: 0.954845991*360.0
 Parameter: XPHI <- "343.744557"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190381509"
Evaluating: 0.190381509*360.0
 Parameter: YPHI <- "68.5373432"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.903777575E-02"
Evaluating: 8.903777575E-02*360.0
 Parameter: ZPHI <- "32.0535993"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.32383307"
 Parameter: YPOS -> "-25.7045185"
 Parameter: ZPOS -> "-57.3972165"
 Parameter: XPHI -> "343.744557"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.960023   -0.279920
    0.000000    0.279920    0.960023

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.32383307"
 Parameter: YPOS -> "-25.7045185"
 Parameter: ZPOS -> "-57.3972165"
 Parameter: YPHI -> "68.5373432"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.365895    0.000000   -0.930656
    0.000000    1.000000    0.000000
    0.930656    0.000000    0.365895

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.32383307"
 Parameter: YPOS -> "-25.7045185"
 Parameter: ZPOS -> "-57.3972165"
 Parameter: ZPHI -> "32.0535993"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.847552    0.530712    0.000000
   -0.530712    0.847552    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.323833 XMAX =    9.323833 XAVE =    9.323833
    YMIN =  -25.704518 YMAX =  -25.704518 YAVE =  -25.704518
    ZMIN =  -57.397216 ZMAX =  -57.397216 ZAVE =  -57.397216
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.32383307"
Evaluating: 9.32383307+3.5
 Parameter: XMAX <- "12.8238331"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.7045185"
Evaluating: -25.7045185+3.5
 Parameter: YMAX <- "-22.2045185"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.3972165"
Evaluating: -57.3972165+3.5
 Parameter: ZMAX <- "-53.8972165"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.32383307"
Evaluating: 9.32383307-3.5
 Parameter: XMIN <- "5.82383307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.7045185"
Evaluating: -25.7045185-3.5
 Parameter: YMIN <- "-29.2045185"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.3972165"
Evaluating: -57.3972165-3.5
 Parameter: ZMIN <- "-60.8972165"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.8238331"
 Parameter: XMIN -> "5.82383307"
 Parameter: YMAX -> "-22.2045185"
 Parameter: YMIN -> "-29.2045185"
 Parameter: ZMAX -> "-53.8972165"
 Parameter: ZMIN -> "-60.8972165"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "50" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "50" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.681804617"
Evaluating: 100.116666*(0.681804617-0.5)
 Parameter: XPOS <- "18.2016721"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.311755414"
Evaluating: 100.116666*(0.311755414-0.5)
 Parameter: YPOS <- "-18.8464203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.57095068"
Evaluating: 127.138691*(0.57095068-0.5)+4.2778237
 Parameter: ZPOS <- "13.2984003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.2984003" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.2984003" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "50" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.329261778"
Evaluating: 100.116666*(0.329261778-0.5)
 Parameter: XPOS <- "-17.0937415"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.6566304"
Evaluating: 100.116666*(0.6566304-0.5)
 Parameter: YPOS <- "15.6813134"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.853803886"
Evaluating: 127.138691*(0.853803886-0.5)+4.2778237
 Parameter: ZPOS <- "49.2599866"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.2599866" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.2599866" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.0937415"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.0937415-0
 Parameter: XTRAN <- "-17.0937415"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.6813134"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.6813134-0
 Parameter: YTRAN <- "15.6813134"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.2599866"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.2599866-0
 Parameter: ZTRAN <- "49.2599866"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.0937415"
 Parameter: YTRAN -> "15.6813134"
 Parameter: ZTRAN -> "49.2599866"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -17.093742   15.681313   49.259987
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762192003"
Evaluating: 0.762192003*360.0
 Parameter: XPHI <- "274.389121"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89358619"
Evaluating: 0.89358619*360.0
 Parameter: YPHI <- "321.691028"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.41095484"
Evaluating: 0.41095484*360.0
 Parameter: ZPHI <- "147.943742"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.0937415"
 Parameter: YPOS -> "15.6813134"
 Parameter: ZPOS -> "49.2599866"
 Parameter: XPHI -> "274.389121"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.076530   -0.997067
    0.000000    0.997067    0.076530

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   85.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.0937415"
 Parameter: YPOS -> "15.6813134"
 Parameter: ZPOS -> "49.2599866"
 Parameter: YPHI -> "321.691028"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.784679    0.000000    0.619902
    0.000000    1.000000    0.000000
   -0.619902    0.000000    0.784679

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.0937415"
 Parameter: YPOS -> "15.6813134"
 Parameter: ZPOS -> "49.2599866"
 Parameter: ZPHI -> "147.943742"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.847527    0.530752    0.000000
   -0.530752   -0.847527    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.093742 XMAX =  -17.093742 XAVE =  -17.093742
    YMIN =   15.681313 YMAX =   15.681313 YAVE =   15.681313
    ZMIN =   49.259987 ZMAX =   49.259987 ZAVE =   49.259987
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.0937415"
Evaluating: -17.0937415+3.5
 Parameter: XMAX <- "-13.5937415"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.6813134"
Evaluating: 15.6813134+3.5
 Parameter: YMAX <- "19.1813134"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.2599866"
Evaluating: 49.2599866+3.5
 Parameter: ZMAX <- "52.7599866"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.0937415"
Evaluating: -17.0937415-3.5
 Parameter: XMIN <- "-20.5937415"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.6813134"
Evaluating: 15.6813134-3.5
 Parameter: YMIN <- "12.1813134"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.2599866"
Evaluating: 49.2599866-3.5
 Parameter: ZMIN <- "45.7599866"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.5937415"
 Parameter: XMIN -> "-20.5937415"
 Parameter: YMAX -> "19.1813134"
 Parameter: YMIN -> "12.1813134"
 Parameter: ZMAX -> "52.7599866"
 Parameter: ZMIN -> "45.7599866"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "51" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "51" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.559600063"
Evaluating: 100.116666*(0.559600063-0.5)
 Parameter: XPOS <- "5.9669596"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.835928819"
Evaluating: 100.116666*(0.835928819-0.5)
 Parameter: YPOS <- "33.6320734"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.743590378"
Evaluating: 127.138691*(0.743590378-0.5)+4.2778237
 Parameter: ZPOS <- "35.2475855"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.2475855" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.2475855" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.9669596"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.9669596-0
 Parameter: XTRAN <- "5.9669596"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6320734"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.6320734-0
 Parameter: YTRAN <- "33.6320734"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.2475855"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.2475855-0
 Parameter: ZTRAN <- "35.2475855"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.9669596"
 Parameter: YTRAN -> "33.6320734"
 Parameter: ZTRAN -> "35.2475855"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     5.966960   33.632073   35.247585
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.231305461"
Evaluating: 0.231305461*360.0
 Parameter: XPHI <- "83.269966"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.633942829"
Evaluating: 0.633942829*360.0
 Parameter: YPHI <- "228.219418"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767590507"
Evaluating: 0.767590507*360.0
 Parameter: ZPHI <- "276.332583"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.9669596"
 Parameter: YPOS -> "33.6320734"
 Parameter: ZPOS -> "35.2475855"
 Parameter: XPHI -> "83.269966"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.117191    0.993109
    0.000000   -0.993109    0.117191

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   83.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.9669596"
 Parameter: YPOS -> "33.6320734"
 Parameter: ZPOS -> "35.2475855"
 Parameter: YPHI -> "228.219418"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.666280    0.000000    0.745702
    0.000000    1.000000    0.000000
   -0.745702    0.000000   -0.666280

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  131.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.9669596"
 Parameter: YPOS -> "33.6320734"
 Parameter: ZPOS -> "35.2475855"
 Parameter: ZPHI -> "276.332583"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.110300   -0.993898    0.000000
    0.993898    0.110300    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.966960 XMAX =    5.966960 XAVE =    5.966960
    YMIN =   33.632073 YMAX =   33.632073 YAVE =   33.632073
    ZMIN =   35.247585 ZMAX =   35.247585 ZAVE =   35.247585
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.9669596"
Evaluating: 5.9669596+3.5
 Parameter: XMAX <- "9.4669596"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6320734"
Evaluating: 33.6320734+3.5
 Parameter: YMAX <- "37.1320734"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.2475855"
Evaluating: 35.2475855+3.5
 Parameter: ZMAX <- "38.7475855"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.9669596"
Evaluating: 5.9669596-3.5
 Parameter: XMIN <- "2.4669596"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6320734"
Evaluating: 33.6320734-3.5
 Parameter: YMIN <- "30.1320734"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.2475855"
Evaluating: 35.2475855-3.5
 Parameter: ZMIN <- "31.7475855"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.4669596"
 Parameter: XMIN -> "2.4669596"
 Parameter: YMAX -> "37.1320734"
 Parameter: YMIN -> "30.1320734"
 Parameter: ZMAX -> "38.7475855"
 Parameter: ZMIN -> "31.7475855"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "52" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "52" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.687555667"
Evaluating: 100.116666*(0.687555667-0.5)
 Parameter: XPOS <- "18.7774481"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.427338732"
Evaluating: 100.116666*(0.427338732-0.5)
 Parameter: YPOS <- "-7.2746039"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.826533377"
Evaluating: 127.138691*(0.826533377-0.5)+4.2778237
 Parameter: ZPOS <- "45.7928498"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.7928498" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.7928498" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.7774481"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.7774481-0
 Parameter: XTRAN <- "18.7774481"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.2746039"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.2746039-0
 Parameter: YTRAN <- "-7.2746039"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.7928498"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.7928498-0
 Parameter: ZTRAN <- "45.7928498"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.7774481"
 Parameter: YTRAN -> "-7.2746039"
 Parameter: ZTRAN -> "45.7928498"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    18.777448   -7.274604   45.792850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.2368903"
Evaluating: 0.2368903*360.0
 Parameter: XPHI <- "85.280508"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.163116897"
Evaluating: 0.163116897*360.0
 Parameter: YPHI <- "58.7220829"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.264590115"
Evaluating: 0.264590115*360.0
 Parameter: ZPHI <- "95.2524414"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.7774481"
 Parameter: YPOS -> "-7.2746039"
 Parameter: ZPOS -> "45.7928498"
 Parameter: XPHI -> "85.280508"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.082278    0.996609
    0.000000   -0.996609    0.082278

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   85.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.7774481"
 Parameter: YPOS -> "-7.2746039"
 Parameter: ZPOS -> "45.7928498"
 Parameter: YPHI -> "58.7220829"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.519190    0.000000   -0.854659
    0.000000    1.000000    0.000000
    0.854659    0.000000    0.519190

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   58.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.7774481"
 Parameter: YPOS -> "-7.2746039"
 Parameter: ZPOS -> "45.7928498"
 Parameter: ZPHI -> "95.2524414"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.091544    0.995801    0.000000
   -0.995801   -0.091544    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   95.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.777448 XMAX =   18.777448 XAVE =   18.777448
    YMIN =   -7.274604 YMAX =   -7.274604 YAVE =   -7.274604
    ZMIN =   45.792850 ZMAX =   45.792850 ZAVE =   45.792850
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.7774481"
Evaluating: 18.7774481+3.5
 Parameter: XMAX <- "22.2774481"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.2746039"
Evaluating: -7.2746039+3.5
 Parameter: YMAX <- "-3.7746039"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.7928498"
Evaluating: 45.7928498+3.5
 Parameter: ZMAX <- "49.2928498"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.7774481"
Evaluating: 18.7774481-3.5
 Parameter: XMIN <- "15.2774481"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.2746039"
Evaluating: -7.2746039-3.5
 Parameter: YMIN <- "-10.7746039"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.7928498"
Evaluating: 45.7928498-3.5
 Parameter: ZMIN <- "42.2928498"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.2774481"
 Parameter: XMIN -> "15.2774481"
 Parameter: YMAX -> "-3.7746039"
 Parameter: YMIN -> "-10.7746039"
 Parameter: ZMAX -> "49.2928498"
 Parameter: ZMIN -> "42.2928498"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "53" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "53" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.122334465"
Evaluating: 100.116666*(0.122334465-0.5)
 Parameter: XPOS <- "-37.8106142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.320027345"
Evaluating: 100.116666*(0.320027345-0.5)
 Parameter: YPOS <- "-18.0182622"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.43188211"
Evaluating: 127.138691*(0.43188211-0.5)+4.2778237
 Parameter: ZPOS <- "-4.38259567"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.38259567" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.38259567" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "53" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.423732395"
Evaluating: 100.116666*(0.423732395-0.5)
 Parameter: XPOS <- "-7.63565834"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.707421406"
Evaluating: 100.116666*(0.707421406-0.5)
 Parameter: YPOS <- "20.7663396"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.424308057"
Evaluating: 127.138691*(0.424308057-0.5)+4.2778237
 Parameter: ZPOS <- "-5.34555085"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.34555085" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.34555085" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "53" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.958159876"
Evaluating: 100.116666*(0.958159876-0.5)
 Parameter: XPOS <- "45.8694393"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.34206595"
Evaluating: 100.116666*(0.34206595-0.5)
 Parameter: YPOS <- "-15.8118305"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "6.74877117E-02"
Evaluating: 127.138691*(6.74877117E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-50.7112225"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.7112225" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "45.8694393"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 45.8694393-0
 Parameter: XTRAN <- "45.8694393"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.8118305"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.8118305-0
 Parameter: YTRAN <- "-15.8118305"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.7112225"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.7112225-0
 Parameter: ZTRAN <- "-50.7112225"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.8694393"
 Parameter: YTRAN -> "-15.8118305"
 Parameter: ZTRAN -> "-50.7112225"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    45.869439  -15.811830  -50.711222
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.389921747"
Evaluating: 0.389921747*360.0
 Parameter: XPHI <- "140.371829"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297255025"
Evaluating: 0.297255025*360.0
 Parameter: YPHI <- "107.011809"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486966588"
Evaluating: 0.486966588*360.0
 Parameter: ZPHI <- "175.307972"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "45.8694393"
 Parameter: YPOS -> "-15.8118305"
 Parameter: ZPOS -> "-50.7112225"
 Parameter: XPHI -> "140.371829"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.770200    0.637803
    0.000000   -0.637803   -0.770200

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "45.8694393"
 Parameter: YPOS -> "-15.8118305"
 Parameter: ZPOS -> "-50.7112225"
 Parameter: YPHI -> "107.011809"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.292569    0.000000   -0.956244
    0.000000    1.000000    0.000000
    0.956244    0.000000   -0.292569

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "45.8694393"
 Parameter: YPOS -> "-15.8118305"
 Parameter: ZPOS -> "-50.7112225"
 Parameter: ZPHI -> "175.307972"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.996649    0.081800    0.000000
   -0.081800   -0.996649    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   45.869439 XMAX =   45.869439 XAVE =   45.869439
    YMIN =  -15.811830 YMAX =  -15.811830 YAVE =  -15.811830
    ZMIN =  -50.711222 ZMAX =  -50.711222 ZAVE =  -50.711222
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "45.8694393"
Evaluating: 45.8694393+3.5
 Parameter: XMAX <- "49.3694393"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.8118305"
Evaluating: -15.8118305+3.5
 Parameter: YMAX <- "-12.3118305"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.7112225"
Evaluating: -50.7112225+3.5
 Parameter: ZMAX <- "-47.2112225"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "45.8694393"
Evaluating: 45.8694393-3.5
 Parameter: XMIN <- "42.3694393"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.8118305"
Evaluating: -15.8118305-3.5
 Parameter: YMIN <- "-19.3118305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.7112225"
Evaluating: -50.7112225-3.5
 Parameter: ZMIN <- "-54.2112225"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.3694393"
 Parameter: XMIN -> "42.3694393"
 Parameter: YMAX -> "-12.3118305"
 Parameter: YMIN -> "-19.3118305"
 Parameter: ZMAX -> "-47.2112225"
 Parameter: ZMIN -> "-54.2112225"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "54" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "54" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.29457595"
Evaluating: 100.116666*(0.29457595-0.5)
 Parameter: XPOS <- "-20.566371"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.780972713"
Evaluating: 100.116666*(0.780972713-0.5)
 Parameter: YPOS <- "28.1300513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.927110037E-02"
Evaluating: 127.138691*(2.927110037E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-55.5700324"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.5700324" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.566371"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -20.566371-0
 Parameter: XTRAN <- "-20.566371"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.1300513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.1300513-0
 Parameter: YTRAN <- "28.1300513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.5700324"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.5700324-0
 Parameter: ZTRAN <- "-55.5700324"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.566371"
 Parameter: YTRAN -> "28.1300513"
 Parameter: ZTRAN -> "-55.5700324"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -20.566371   28.130051  -55.570032
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.521647335"
Evaluating: 0.521647335*360.0
 Parameter: XPHI <- "187.793041"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513382452"
Evaluating: 0.513382452*360.0
 Parameter: YPHI <- "184.817683"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.692051166E-02"
Evaluating: 9.692051166E-02*360.0
 Parameter: ZPHI <- "34.8913842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.566371"
 Parameter: YPOS -> "28.1300513"
 Parameter: ZPOS -> "-55.5700324"
 Parameter: XPHI -> "187.793041"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.990764   -0.135595
    0.000000    0.135595   -0.990764

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  172.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.566371"
 Parameter: YPOS -> "28.1300513"
 Parameter: ZPOS -> "-55.5700324"
 Parameter: YPHI -> "184.817683"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.996467    0.000000    0.083985
    0.000000    1.000000    0.000000
   -0.083985    0.000000   -0.996467

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.566371"
 Parameter: YPOS -> "28.1300513"
 Parameter: ZPOS -> "-55.5700324"
 Parameter: ZPHI -> "34.8913842"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.820238    0.572023    0.000000
   -0.572023    0.820238    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.566371 XMAX =  -20.566371 XAVE =  -20.566371
    YMIN =   28.130051 YMAX =   28.130051 YAVE =   28.130051
    ZMIN =  -55.570032 ZMAX =  -55.570032 ZAVE =  -55.570032
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.566371"
Evaluating: -20.566371+3.5
 Parameter: XMAX <- "-17.066371"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.1300513"
Evaluating: 28.1300513+3.5
 Parameter: YMAX <- "31.6300513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.5700324"
Evaluating: -55.5700324+3.5
 Parameter: ZMAX <- "-52.0700324"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.566371"
Evaluating: -20.566371-3.5
 Parameter: XMIN <- "-24.066371"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.1300513"
Evaluating: 28.1300513-3.5
 Parameter: YMIN <- "24.6300513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.5700324"
Evaluating: -55.5700324-3.5
 Parameter: ZMIN <- "-59.0700324"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.066371"
 Parameter: XMIN -> "-24.066371"
 Parameter: YMAX -> "31.6300513"
 Parameter: YMIN -> "24.6300513"
 Parameter: ZMAX -> "-52.0700324"
 Parameter: ZMIN -> "-59.0700324"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "55" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "55" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.967082477"
Evaluating: 100.116666*(0.967082477-0.5)
 Parameter: XPOS <- "46.7627403"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.336636198"
Evaluating: 100.116666*(0.336636198-0.5)
 Parameter: YPOS <- "-16.3554392"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.210586309"
Evaluating: 127.138691*(0.210586309-0.5)+4.2778237
 Parameter: ZPOS <- "-32.5178541"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.5178541" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.7627403"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.7627403-0
 Parameter: XTRAN <- "46.7627403"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.3554392"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.3554392-0
 Parameter: YTRAN <- "-16.3554392"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.5178541"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.5178541-0
 Parameter: ZTRAN <- "-32.5178541"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.7627403"
 Parameter: YTRAN -> "-16.3554392"
 Parameter: ZTRAN -> "-32.5178541"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    46.762740  -16.355439  -32.517854
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276156702"
Evaluating: 0.276156702*360.0
 Parameter: XPHI <- "99.4164127"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.915026746E-02"
Evaluating: 3.915026746E-02*360.0
 Parameter: YPHI <- "14.0940963"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298831679"
Evaluating: 0.298831679*360.0
 Parameter: ZPHI <- "107.579404"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.7627403"
 Parameter: YPOS -> "-16.3554392"
 Parameter: ZPOS -> "-32.5178541"
 Parameter: XPHI -> "99.4164127"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.163609    0.986525
    0.000000   -0.986525   -0.163609

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   99.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.7627403"
 Parameter: YPOS -> "-16.3554392"
 Parameter: ZPOS -> "-32.5178541"
 Parameter: YPHI -> "14.0940963"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.969897    0.000000   -0.243515
    0.000000    1.000000    0.000000
    0.243515    0.000000    0.969897

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   14.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.7627403"
 Parameter: YPOS -> "-16.3554392"
 Parameter: ZPOS -> "-32.5178541"
 Parameter: ZPHI -> "107.579404"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.302027    0.953299    0.000000
   -0.953299   -0.302027    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.762740 XMAX =   46.762740 XAVE =   46.762740
    YMIN =  -16.355439 YMAX =  -16.355439 YAVE =  -16.355439
    ZMIN =  -32.517854 ZMAX =  -32.517854 ZAVE =  -32.517854
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.7627403"
Evaluating: 46.7627403+3.5
 Parameter: XMAX <- "50.2627403"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.3554392"
Evaluating: -16.3554392+3.5
 Parameter: YMAX <- "-12.8554392"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.5178541"
Evaluating: -32.5178541+3.5
 Parameter: ZMAX <- "-29.0178541"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.7627403"
Evaluating: 46.7627403-3.5
 Parameter: XMIN <- "43.2627403"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.3554392"
Evaluating: -16.3554392-3.5
 Parameter: YMIN <- "-19.8554392"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.5178541"
Evaluating: -32.5178541-3.5
 Parameter: ZMIN <- "-36.0178541"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "50.2627403"
 Parameter: XMIN -> "43.2627403"
 Parameter: YMAX -> "-12.8554392"
 Parameter: YMIN -> "-19.8554392"
 Parameter: ZMAX -> "-29.0178541"
 Parameter: ZMIN -> "-36.0178541"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "56" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "56" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.779726686"
Evaluating: 100.116666*(0.779726686-0.5)
 Parameter: XPOS <- "28.0053032"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.317419063"
Evaluating: 100.116666*(0.317419063-0.5)
 Parameter: YPOS <- "-18.2793947"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.695154415"
Evaluating: 127.138691*(0.695154415-0.5)+4.2778237
 Parameter: ZPOS <- "29.0895006"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.0895006" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.0895006" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.0053032"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.0053032-0
 Parameter: XTRAN <- "28.0053032"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.2793947"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.2793947-0
 Parameter: YTRAN <- "-18.2793947"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.0895006"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.0895006-0
 Parameter: ZTRAN <- "29.0895006"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.0053032"
 Parameter: YTRAN -> "-18.2793947"
 Parameter: ZTRAN -> "29.0895006"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    28.005303  -18.279395   29.089501
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700206748"
Evaluating: 0.700206748*360.0
 Parameter: XPHI <- "252.074429"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732091079"
Evaluating: 0.732091079*360.0
 Parameter: YPHI <- "263.552788"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897895562"
Evaluating: 0.897895562*360.0
 Parameter: ZPHI <- "323.242402"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.0053032"
 Parameter: YPOS -> "-18.2793947"
 Parameter: ZPOS -> "29.0895006"
 Parameter: XPHI -> "252.074429"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.307781   -0.951457
    0.000000    0.951457   -0.307781

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  107.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.0053032"
 Parameter: YPOS -> "-18.2793947"
 Parameter: ZPOS -> "29.0895006"
 Parameter: YPHI -> "263.552788"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.112288    0.000000    0.993676
    0.000000    1.000000    0.000000
   -0.993676    0.000000   -0.112288

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.0053032"
 Parameter: YPOS -> "-18.2793947"
 Parameter: ZPOS -> "29.0895006"
 Parameter: ZPHI -> "323.242402"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.801174   -0.598431    0.000000
    0.598431    0.801174    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.005303 XMAX =   28.005303 XAVE =   28.005303
    YMIN =  -18.279395 YMAX =  -18.279395 YAVE =  -18.279395
    ZMIN =   29.089501 ZMAX =   29.089501 ZAVE =   29.089501
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.0053032"
Evaluating: 28.0053032+3.5
 Parameter: XMAX <- "31.5053032"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.2793947"
Evaluating: -18.2793947+3.5
 Parameter: YMAX <- "-14.7793947"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.0895006"
Evaluating: 29.0895006+3.5
 Parameter: ZMAX <- "32.5895006"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.0053032"
Evaluating: 28.0053032-3.5
 Parameter: XMIN <- "24.5053032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.2793947"
Evaluating: -18.2793947-3.5
 Parameter: YMIN <- "-21.7793947"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.0895006"
Evaluating: 29.0895006-3.5
 Parameter: ZMIN <- "25.5895006"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.5053032"
 Parameter: XMIN -> "24.5053032"
 Parameter: YMAX -> "-14.7793947"
 Parameter: YMIN -> "-21.7793947"
 Parameter: ZMAX -> "32.5895006"
 Parameter: ZMIN -> "25.5895006"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "57" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "57" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.657701816"
Evaluating: 100.116666*(0.657701816-0.5)
 Parameter: XPOS <- "15.78858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.158708132"
Evaluating: 100.116666*(0.158708132-0.5)
 Parameter: YPOS <- "-34.169004"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.709510285"
Evaluating: 127.138691*(0.709510285-0.5)+4.2778237
 Parameter: ZPOS <- "30.9146871"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.9146871" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.9146871" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.78858"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.78858-0
 Parameter: XTRAN <- "15.78858"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.169004"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.169004-0
 Parameter: YTRAN <- "-34.169004"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.9146871"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.9146871-0
 Parameter: ZTRAN <- "30.9146871"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.78858"
 Parameter: YTRAN -> "-34.169004"
 Parameter: ZTRAN -> "30.9146871"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    15.788580  -34.169004   30.914687
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.87679407"
Evaluating: 0.87679407*360.0
 Parameter: XPHI <- "315.645865"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642459952"
Evaluating: 0.642459952*360.0
 Parameter: YPHI <- "231.285583"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.944703668E-02"
Evaluating: 8.944703668E-02*360.0
 Parameter: ZPHI <- "32.2009332"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.78858"
 Parameter: YPOS -> "-34.169004"
 Parameter: ZPOS -> "30.9146871"
 Parameter: XPHI -> "315.645865"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.715033   -0.699091
    0.000000    0.699091    0.715033

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.78858"
 Parameter: YPOS -> "-34.169004"
 Parameter: ZPOS -> "30.9146871"
 Parameter: YPHI -> "231.285583"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.625439    0.000000    0.780273
    0.000000    1.000000    0.000000
   -0.780273    0.000000   -0.625439

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  128.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.78858"
 Parameter: YPOS -> "-34.169004"
 Parameter: ZPOS -> "30.9146871"
 Parameter: ZPHI -> "32.2009332"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.846184    0.532890    0.000000
   -0.532890    0.846184    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.788580 XMAX =   15.788580 XAVE =   15.788580
    YMIN =  -34.169004 YMAX =  -34.169004 YAVE =  -34.169004
    ZMIN =   30.914687 ZMAX =   30.914687 ZAVE =   30.914687
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.78858"
Evaluating: 15.78858+3.5
 Parameter: XMAX <- "19.28858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.169004"
Evaluating: -34.169004+3.5
 Parameter: YMAX <- "-30.669004"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.9146871"
Evaluating: 30.9146871+3.5
 Parameter: ZMAX <- "34.4146871"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.78858"
Evaluating: 15.78858-3.5
 Parameter: XMIN <- "12.28858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.169004"
Evaluating: -34.169004-3.5
 Parameter: YMIN <- "-37.669004"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.9146871"
Evaluating: 30.9146871-3.5
 Parameter: ZMIN <- "27.4146871"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.28858"
 Parameter: XMIN -> "12.28858"
 Parameter: YMAX -> "-30.669004"
 Parameter: YMIN -> "-37.669004"
 Parameter: ZMAX -> "34.4146871"
 Parameter: ZMIN -> "27.4146871"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "58" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "58" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.445956535"
Evaluating: 100.116666*(0.445956535-0.5)
 Parameter: XPOS <- "-5.41065153"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "9.395416604E-03"
Evaluating: 100.116666*(9.395416604E-03-0.5)
 Parameter: YPOS <- "-49.1176952"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.528222714"
Evaluating: 127.138691*(0.528222714-0.5)+4.2778237
 Parameter: ZPOS <- "7.86602261"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.86602261" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.86602261" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "58" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.133548562"
Evaluating: 100.116666*(0.133548562-0.5)
 Parameter: XPOS <- "-36.6878962"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.437128557"
Evaluating: 100.116666*(0.437128557-0.5)
 Parameter: YPOS <- "-6.29447926"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.767916621"
Evaluating: 127.138691*(0.767916621-0.5)+4.2778237
 Parameter: ZPOS <- "38.3403922"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.3403922" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.3403922" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.6878962"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.6878962-0
 Parameter: XTRAN <- "-36.6878962"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.29447926"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.29447926-0
 Parameter: YTRAN <- "-6.29447926"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.3403922"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.3403922-0
 Parameter: ZTRAN <- "38.3403922"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.6878962"
 Parameter: YTRAN -> "-6.29447926"
 Parameter: ZTRAN -> "38.3403922"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -36.687896   -6.294479   38.340392
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866558004"
Evaluating: 0.866558004*360.0
 Parameter: XPHI <- "311.960881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.149341255"
Evaluating: 0.149341255*360.0
 Parameter: YPHI <- "53.7628518"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.912027518"
Evaluating: 0.912027518*360.0
 Parameter: ZPHI <- "328.329906"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.6878962"
 Parameter: YPOS -> "-6.29447926"
 Parameter: ZPOS -> "38.3403922"
 Parameter: XPHI -> "311.960881"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.668623   -0.743602
    0.000000    0.743602    0.668623

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.6878962"
 Parameter: YPOS -> "-6.29447926"
 Parameter: ZPOS -> "38.3403922"
 Parameter: YPHI -> "53.7628518"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.591129    0.000000   -0.806577
    0.000000    1.000000    0.000000
    0.806577    0.000000    0.591129

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.6878962"
 Parameter: YPOS -> "-6.29447926"
 Parameter: ZPOS -> "38.3403922"
 Parameter: ZPHI -> "328.329906"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.851085   -0.525027    0.000000
    0.525027    0.851085    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   31.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.687896 XMAX =  -36.687896 XAVE =  -36.687896
    YMIN =   -6.294479 YMAX =   -6.294479 YAVE =   -6.294479
    ZMIN =   38.340392 ZMAX =   38.340392 ZAVE =   38.340392
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.6878962"
Evaluating: -36.6878962+3.5
 Parameter: XMAX <- "-33.1878962"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.29447926"
Evaluating: -6.29447926+3.5
 Parameter: YMAX <- "-2.79447926"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.3403922"
Evaluating: 38.3403922+3.5
 Parameter: ZMAX <- "41.8403922"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.6878962"
Evaluating: -36.6878962-3.5
 Parameter: XMIN <- "-40.1878962"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.29447926"
Evaluating: -6.29447926-3.5
 Parameter: YMIN <- "-9.79447926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.3403922"
Evaluating: 38.3403922-3.5
 Parameter: ZMIN <- "34.8403922"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.1878962"
 Parameter: XMIN -> "-40.1878962"
 Parameter: YMAX -> "-2.79447926"
 Parameter: YMIN -> "-9.79447926"
 Parameter: ZMAX -> "41.8403922"
 Parameter: ZMIN -> "34.8403922"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "59" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "59" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.386958965"
Evaluating: 100.116666*(0.386958965-0.5)
 Parameter: XPOS <- "-11.3172915"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.785957053"
Evaluating: 100.116666*(0.785957053-0.5)
 Parameter: YPOS <- "28.6290668"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.150317724"
Evaluating: 127.138691*(0.150317724-0.5)+4.2778237
 Parameter: ZPOS <- "-40.1803231"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.1803231" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.3172915"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.3172915-0
 Parameter: XTRAN <- "-11.3172915"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6290668"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 28.6290668-0
 Parameter: YTRAN <- "28.6290668"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.1803231"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.1803231-0
 Parameter: ZTRAN <- "-40.1803231"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.3172915"
 Parameter: YTRAN -> "28.6290668"
 Parameter: ZTRAN -> "-40.1803231"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -11.317291   28.629067  -40.180323
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261909767"
Evaluating: 0.261909767*360.0
 Parameter: XPHI <- "94.2875161"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835219244"
Evaluating: 0.835219244*360.0
 Parameter: YPHI <- "300.678928"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.528144269"
Evaluating: 0.528144269*360.0
 Parameter: ZPHI <- "190.131937"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.3172915"
 Parameter: YPOS -> "28.6290668"
 Parameter: ZPOS -> "-40.1803231"
 Parameter: XPHI -> "94.2875161"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.074761    0.997201
    0.000000   -0.997201   -0.074761

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.3172915"
 Parameter: YPOS -> "28.6290668"
 Parameter: ZPOS -> "-40.1803231"
 Parameter: YPHI -> "300.678928"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.510227    0.000000    0.860040
    0.000000    1.000000    0.000000
   -0.860040    0.000000    0.510227

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.3172915"
 Parameter: YPOS -> "28.6290668"
 Parameter: ZPOS -> "-40.1803231"
 Parameter: ZPHI -> "190.131937"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.984405   -0.175915    0.000000
    0.175915   -0.984405    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  169.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.317291 XMAX =  -11.317291 XAVE =  -11.317291
    YMIN =   28.629067 YMAX =   28.629067 YAVE =   28.629067
    ZMIN =  -40.180323 ZMAX =  -40.180323 ZAVE =  -40.180323
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.3172915"
Evaluating: -11.3172915+3.5
 Parameter: XMAX <- "-7.8172915"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6290668"
Evaluating: 28.6290668+3.5
 Parameter: YMAX <- "32.1290668"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.1803231"
Evaluating: -40.1803231+3.5
 Parameter: ZMAX <- "-36.6803231"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.3172915"
Evaluating: -11.3172915-3.5
 Parameter: XMIN <- "-14.8172915"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6290668"
Evaluating: 28.6290668-3.5
 Parameter: YMIN <- "25.1290668"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.1803231"
Evaluating: -40.1803231-3.5
 Parameter: ZMIN <- "-43.6803231"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.8172915"
 Parameter: XMIN -> "-14.8172915"
 Parameter: YMAX -> "32.1290668"
 Parameter: YMIN -> "25.1290668"
 Parameter: ZMAX -> "-36.6803231"
 Parameter: ZMIN -> "-43.6803231"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "60" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "60" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.937663454"
Evaluating: 100.116666*(0.937663454-0.5)
 Parameter: XPOS <- "43.8174058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.144921355"
Evaluating: 100.116666*(0.144921355-0.5)
 Parameter: YPOS <- "-35.5492901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.118273301"
Evaluating: 127.138691*(0.118273301-0.5)+4.2778237
 Parameter: ZPOS <- "-44.2544091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-44.2544091" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.8174058"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.8174058-0
 Parameter: XTRAN <- "43.8174058"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.5492901"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.5492901-0
 Parameter: YTRAN <- "-35.5492901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.2544091"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -44.2544091-0
 Parameter: ZTRAN <- "-44.2544091"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.8174058"
 Parameter: YTRAN -> "-35.5492901"
 Parameter: ZTRAN -> "-44.2544091"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    43.817406  -35.549290  -44.254409
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800543556"
Evaluating: 0.800543556*360.0
 Parameter: XPHI <- "288.19568"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803321506"
Evaluating: 0.803321506*360.0
 Parameter: YPHI <- "289.195742"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602782593"
Evaluating: 0.602782593*360.0
 Parameter: ZPHI <- "217.001733"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.8174058"
 Parameter: YPOS -> "-35.5492901"
 Parameter: ZPOS -> "-44.2544091"
 Parameter: XPHI -> "288.19568"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.312263   -0.949996
    0.000000    0.949996    0.312263

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   71.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.8174058"
 Parameter: YPOS -> "-35.5492901"
 Parameter: ZPOS -> "-44.2544091"
 Parameter: YPHI -> "289.195742"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.328796    0.000000    0.944401
    0.000000    1.000000    0.000000
   -0.944401    0.000000    0.328796

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.8174058"
 Parameter: YPOS -> "-35.5492901"
 Parameter: ZPOS -> "-44.2544091"
 Parameter: ZPHI -> "217.001733"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.798617   -0.601839    0.000000
    0.601839   -0.798617    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  143.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.817406 XMAX =   43.817406 XAVE =   43.817406
    YMIN =  -35.549290 YMAX =  -35.549290 YAVE =  -35.549290
    ZMIN =  -44.254409 ZMAX =  -44.254409 ZAVE =  -44.254409
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.8174058"
Evaluating: 43.8174058+3.5
 Parameter: XMAX <- "47.3174058"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.5492901"
Evaluating: -35.5492901+3.5
 Parameter: YMAX <- "-32.0492901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.2544091"
Evaluating: -44.2544091+3.5
 Parameter: ZMAX <- "-40.7544091"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.8174058"
Evaluating: 43.8174058-3.5
 Parameter: XMIN <- "40.3174058"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.5492901"
Evaluating: -35.5492901-3.5
 Parameter: YMIN <- "-39.0492901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.2544091"
Evaluating: -44.2544091-3.5
 Parameter: ZMIN <- "-47.7544091"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.3174058"
 Parameter: XMIN -> "40.3174058"
 Parameter: YMAX -> "-32.0492901"
 Parameter: YMIN -> "-39.0492901"
 Parameter: ZMAX -> "-40.7544091"
 Parameter: ZMIN -> "-47.7544091"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "61" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "61" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.191951998"
Evaluating: 100.116666*(0.191951998-0.5)
 Parameter: XPOS <- "-30.8407389"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.111691732"
Evaluating: 100.116666*(0.111691732-0.5)
 Parameter: YPOS <- "-38.8761292"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.582285307"
Evaluating: 127.138691*(0.582285307-0.5)+4.2778237
 Parameter: ZPOS <- "14.7394699"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.7394699" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.7394699" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "61" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.744712958"
Evaluating: 100.116666*(0.744712958-0.5)
 Parameter: XPOS <- "24.4998455"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.893963162"
Evaluating: 100.116666*(0.893963162-0.5)
 Parameter: YPOS <- "39.4422783"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.510713506"
Evaluating: 127.138691*(0.510713506-0.5)+4.2778237
 Parameter: ZPOS <- "5.63992483"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.63992483" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.63992483" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "61" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.112808809"
Evaluating: 100.116666*(0.112808809-0.5)
 Parameter: XPOS <- "-38.7642911"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.490093744"
Evaluating: 100.116666*(0.490093744-0.5)
 Parameter: YPOS <- "-0.991781323"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.710024861"
Evaluating: 127.138691*(0.710024861-0.5)+4.2778237
 Parameter: ZPOS <- "30.9801096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.9801096" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.9801096" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.7642911"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.7642911-0
 Parameter: XTRAN <- "-38.7642911"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.991781323"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -0.991781323-0
 Parameter: YTRAN <- "-0.991781323"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.9801096"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.9801096-0
 Parameter: ZTRAN <- "30.9801096"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.7642911"
 Parameter: YTRAN -> "-0.991781323"
 Parameter: ZTRAN -> "30.9801096"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -38.764291   -0.991781   30.980110
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112738677"
Evaluating: 0.112738677*360.0
 Parameter: XPHI <- "40.5859237"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811954061"
Evaluating: 0.811954061*360.0
 Parameter: YPHI <- "292.303462"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.546302653"
Evaluating: 0.546302653*360.0
 Parameter: ZPHI <- "196.668955"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.7642911"
 Parameter: YPOS -> "-0.991781323"
 Parameter: ZPOS -> "30.9801096"
 Parameter: XPHI -> "40.5859237"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.759431    0.650588
    0.000000   -0.650588    0.759431

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.7642911"
 Parameter: YPOS -> "-0.991781323"
 Parameter: ZPOS -> "30.9801096"
 Parameter: YPHI -> "292.303462"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.379512    0.000000    0.925187
    0.000000    1.000000    0.000000
   -0.925187    0.000000    0.379512

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.7642911"
 Parameter: YPOS -> "-0.991781323"
 Parameter: ZPOS -> "30.9801096"
 Parameter: ZPHI -> "196.668955"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.957978   -0.286841    0.000000
    0.286841   -0.957978    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  163.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.764291 XMAX =  -38.764291 XAVE =  -38.764291
    YMIN =   -0.991781 YMAX =   -0.991781 YAVE =   -0.991781
    ZMIN =   30.980110 ZMAX =   30.980110 ZAVE =   30.980110
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.7642911"
Evaluating: -38.7642911+3.5
 Parameter: XMAX <- "-35.2642911"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.991781323"
Evaluating: -0.991781323+3.5
 Parameter: YMAX <- "2.50821868"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.9801096"
Evaluating: 30.9801096+3.5
 Parameter: ZMAX <- "34.4801096"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.7642911"
Evaluating: -38.7642911-3.5
 Parameter: XMIN <- "-42.2642911"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.991781323"
Evaluating: -0.991781323-3.5
 Parameter: YMIN <- "-4.49178132"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.9801096"
Evaluating: 30.9801096-3.5
 Parameter: ZMIN <- "27.4801096"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.2642911"
 Parameter: XMIN -> "-42.2642911"
 Parameter: YMAX -> "2.50821868"
 Parameter: YMIN -> "-4.49178132"
 Parameter: ZMAX -> "34.4801096"
 Parameter: ZMIN -> "27.4801096"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "62" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "62" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.54150695"
Evaluating: 100.116666*(0.54150695-0.5)
 Parameter: XPOS <- "4.15553745"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.967177461"
Evaluating: 100.116666*(0.967177461-0.5)
 Parameter: YPOS <- "46.7722498"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.26077576"
Evaluating: 127.138691*(0.26077576-0.5)+4.2778237
 Parameter: ZPOS <- "-26.136833"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-26.136833" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.15553745"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.15553745-0
 Parameter: XTRAN <- "4.15553745"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.7722498"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.7722498-0
 Parameter: YTRAN <- "46.7722498"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.136833"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -26.136833-0
 Parameter: ZTRAN <- "-26.136833"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.15553745"
 Parameter: YTRAN -> "46.7722498"
 Parameter: ZTRAN -> "-26.136833"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     4.155537   46.772250  -26.136833
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.443456833"
Evaluating: 0.443456833*360.0
 Parameter: XPHI <- "159.64446"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330127883"
Evaluating: 0.330127883*360.0
 Parameter: YPHI <- "118.846038"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755877565"
Evaluating: 0.755877565*360.0
 Parameter: ZPHI <- "272.115923"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.15553745"
 Parameter: YPOS -> "46.7722498"
 Parameter: ZPOS -> "-26.136833"
 Parameter: XPHI -> "159.64446"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937552    0.347845
    0.000000   -0.347845   -0.937552

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.15553745"
 Parameter: YPOS -> "46.7722498"
 Parameter: ZPOS -> "-26.136833"
 Parameter: YPHI -> "118.846038"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.482458    0.000000   -0.875919
    0.000000    1.000000    0.000000
    0.875919    0.000000   -0.482458

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.15553745"
 Parameter: YPOS -> "46.7722498"
 Parameter: ZPOS -> "-26.136833"
 Parameter: ZPHI -> "272.115923"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.036921   -0.999318    0.000000
    0.999318    0.036921    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.155537 XMAX =    4.155537 XAVE =    4.155537
    YMIN =   46.772250 YMAX =   46.772250 YAVE =   46.772250
    ZMIN =  -26.136833 ZMAX =  -26.136833 ZAVE =  -26.136833
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.15553745"
Evaluating: 4.15553745+3.5
 Parameter: XMAX <- "7.65553745"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.7722498"
Evaluating: 46.7722498+3.5
 Parameter: YMAX <- "50.2722498"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.136833"
Evaluating: -26.136833+3.5
 Parameter: ZMAX <- "-22.636833"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.15553745"
Evaluating: 4.15553745-3.5
 Parameter: XMIN <- "0.65553745"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.7722498"
Evaluating: 46.7722498-3.5
 Parameter: YMIN <- "43.2722498"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.136833"
Evaluating: -26.136833-3.5
 Parameter: ZMIN <- "-29.636833"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.65553745"
 Parameter: XMIN -> "0.65553745"
 Parameter: YMAX -> "50.2722498"
 Parameter: YMIN -> "43.2722498"
 Parameter: ZMAX -> "-22.636833"
 Parameter: ZMIN -> "-29.636833"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "63" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "63" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.189551023"
Evaluating: 100.116666*(0.189551023-0.5)
 Parameter: XPOS <- "-31.0811165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.952220101"
Evaluating: 100.116666*(0.952220101-0.5)
 Parameter: YPOS <- "45.2747688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.920524914"
Evaluating: 127.138691*(0.920524914-0.5)+4.2778237
 Parameter: ZPOS <- "57.7428108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.7428108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.7428108" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.0811165"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.0811165-0
 Parameter: XTRAN <- "-31.0811165"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.2747688"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.2747688-0
 Parameter: YTRAN <- "45.2747688"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.7428108"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.7428108-0
 Parameter: ZTRAN <- "57.7428108"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.0811165"
 Parameter: YTRAN -> "45.2747688"
 Parameter: ZTRAN -> "57.7428108"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -31.081117   45.274769   57.742811
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243927903"
Evaluating: 0.243927903*360.0
 Parameter: XPHI <- "87.8140451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575565198"
Evaluating: 0.575565198*360.0
 Parameter: YPHI <- "207.203471"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755671657"
Evaluating: 0.755671657*360.0
 Parameter: ZPHI <- "272.041797"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.0811165"
 Parameter: YPOS -> "45.2747688"
 Parameter: ZPOS -> "57.7428108"
 Parameter: XPHI -> "87.8140451"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.038143    0.999272
    0.000000   -0.999272    0.038143

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.0811165"
 Parameter: YPOS -> "45.2747688"
 Parameter: ZPOS -> "57.7428108"
 Parameter: YPHI -> "207.203471"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.889389    0.000000    0.457152
    0.000000    1.000000    0.000000
   -0.457152    0.000000   -0.889389

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.0811165"
 Parameter: YPOS -> "45.2747688"
 Parameter: ZPOS -> "57.7428108"
 Parameter: ZPHI -> "272.041797"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.035629   -0.999365    0.000000
    0.999365    0.035629    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.081117 XMAX =  -31.081117 XAVE =  -31.081117
    YMIN =   45.274769 YMAX =   45.274769 YAVE =   45.274769
    ZMIN =   57.742811 ZMAX =   57.742811 ZAVE =   57.742811
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.0811165"
Evaluating: -31.0811165+3.5
 Parameter: XMAX <- "-27.5811165"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.2747688"
Evaluating: 45.2747688+3.5
 Parameter: YMAX <- "48.7747688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.7428108"
Evaluating: 57.7428108+3.5
 Parameter: ZMAX <- "61.2428108"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.0811165"
Evaluating: -31.0811165-3.5
 Parameter: XMIN <- "-34.5811165"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.2747688"
Evaluating: 45.2747688-3.5
 Parameter: YMIN <- "41.7747688"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.7428108"
Evaluating: 57.7428108-3.5
 Parameter: ZMIN <- "54.2428108"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.5811165"
 Parameter: XMIN -> "-34.5811165"
 Parameter: YMAX -> "48.7747688"
 Parameter: YMIN -> "41.7747688"
 Parameter: ZMAX -> "61.2428108"
 Parameter: ZMIN -> "54.2428108"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "64" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "64" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.959560144"
Evaluating: 100.116666*(0.959560144-0.5)
 Parameter: XPOS <- "46.0096294"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.317428641"
Evaluating: 100.116666*(0.317428641-0.5)
 Parameter: YPOS <- "-18.2784358"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.173319183"
Evaluating: 127.138691*(0.173319183-0.5)+4.2778237
 Parameter: ZPOS <- "-37.2559477"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.2559477" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "46.0096294"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 46.0096294-0
 Parameter: XTRAN <- "46.0096294"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.2784358"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.2784358-0
 Parameter: YTRAN <- "-18.2784358"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.2559477"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.2559477-0
 Parameter: ZTRAN <- "-37.2559477"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "46.0096294"
 Parameter: YTRAN -> "-18.2784358"
 Parameter: ZTRAN -> "-37.2559477"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    46.009629  -18.278436  -37.255948
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.642978982"
Evaluating: 0.642978982*360.0
 Parameter: XPHI <- "231.472434"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.796526874"
Evaluating: 0.796526874*360.0
 Parameter: YPHI <- "286.749675"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.868645107"
Evaluating: 0.868645107*360.0
 Parameter: ZPHI <- "312.712239"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "46.0096294"
 Parameter: YPOS -> "-18.2784358"
 Parameter: ZPOS -> "-37.2559477"
 Parameter: XPHI -> "231.472434"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.622891   -0.782309
    0.000000    0.782309   -0.622891

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "46.0096294"
 Parameter: YPOS -> "-18.2784358"
 Parameter: ZPOS -> "-37.2559477"
 Parameter: YPHI -> "286.749675"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.288191    0.000000    0.957573
    0.000000    1.000000    0.000000
   -0.957573    0.000000    0.288191

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "46.0096294"
 Parameter: YPOS -> "-18.2784358"
 Parameter: ZPOS -> "-37.2559477"
 Parameter: ZPHI -> "312.712239"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.678317   -0.734770    0.000000
    0.734770    0.678317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   46.009629 XMAX =   46.009629 XAVE =   46.009629
    YMIN =  -18.278436 YMAX =  -18.278436 YAVE =  -18.278436
    ZMIN =  -37.255948 ZMAX =  -37.255948 ZAVE =  -37.255948
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "46.0096294"
Evaluating: 46.0096294+3.5
 Parameter: XMAX <- "49.5096294"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.2784358"
Evaluating: -18.2784358+3.5
 Parameter: YMAX <- "-14.7784358"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.2559477"
Evaluating: -37.2559477+3.5
 Parameter: ZMAX <- "-33.7559477"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "46.0096294"
Evaluating: 46.0096294-3.5
 Parameter: XMIN <- "42.5096294"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.2784358"
Evaluating: -18.2784358-3.5
 Parameter: YMIN <- "-21.7784358"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.2559477"
Evaluating: -37.2559477-3.5
 Parameter: ZMIN <- "-40.7559477"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "49.5096294"
 Parameter: XMIN -> "42.5096294"
 Parameter: YMAX -> "-14.7784358"
 Parameter: YMIN -> "-21.7784358"
 Parameter: ZMAX -> "-33.7559477"
 Parameter: ZMIN -> "-40.7559477"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "65" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "65" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.810993815"
Evaluating: 100.116666*(0.810993815-0.5)
 Parameter: XPOS <- "31.1356639"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.752699017E-02"
Evaluating: 100.116666*(5.752699017E-02-0.5)
 Parameter: YPOS <- "-44.2989225"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.193449002"
Evaluating: 127.138691*(0.193449002-0.5)+4.2778237
 Parameter: ZPOS <- "-34.6966689"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.6966689" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.1356639"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.1356639-0
 Parameter: XTRAN <- "31.1356639"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.2989225"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.2989225-0
 Parameter: YTRAN <- "-44.2989225"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.6966689"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.6966689-0
 Parameter: ZTRAN <- "-34.6966689"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1356639"
 Parameter: YTRAN -> "-44.2989225"
 Parameter: ZTRAN -> "-34.6966689"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    31.135664  -44.298923  -34.696669
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225780645"
Evaluating: 0.225780645*360.0
 Parameter: XPHI <- "81.2810322"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.090131601E-02"
Evaluating: 7.090131601E-02*360.0
 Parameter: YPHI <- "25.5244738"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.998953044"
Evaluating: 0.998953044*360.0
 Parameter: ZPHI <- "359.623096"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.1356639"
 Parameter: YPOS -> "-44.2989225"
 Parameter: ZPOS -> "-34.6966689"
 Parameter: XPHI -> "81.2810322"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.151588    0.988444
    0.000000   -0.988444    0.151588

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.1356639"
 Parameter: YPOS -> "-44.2989225"
 Parameter: ZPOS -> "-34.6966689"
 Parameter: YPHI -> "25.5244738"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.902401    0.000000   -0.430897
    0.000000    1.000000    0.000000
    0.430897    0.000000    0.902401

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   25.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.1356639"
 Parameter: YPOS -> "-44.2989225"
 Parameter: ZPOS -> "-34.6966689"
 Parameter: ZPHI -> "359.623096"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999978   -0.006578    0.000000
    0.006578    0.999978    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.135664 XMAX =   31.135664 XAVE =   31.135664
    YMIN =  -44.298923 YMAX =  -44.298923 YAVE =  -44.298923
    ZMIN =  -34.696669 ZMAX =  -34.696669 ZAVE =  -34.696669
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.1356639"
Evaluating: 31.1356639+3.5
 Parameter: XMAX <- "34.6356639"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.2989225"
Evaluating: -44.2989225+3.5
 Parameter: YMAX <- "-40.7989225"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.6966689"
Evaluating: -34.6966689+3.5
 Parameter: ZMAX <- "-31.1966689"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.1356639"
Evaluating: 31.1356639-3.5
 Parameter: XMIN <- "27.6356639"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.2989225"
Evaluating: -44.2989225-3.5
 Parameter: YMIN <- "-47.7989225"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.6966689"
Evaluating: -34.6966689-3.5
 Parameter: ZMIN <- "-38.1966689"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.6356639"
 Parameter: XMIN -> "27.6356639"
 Parameter: YMAX -> "-40.7989225"
 Parameter: YMIN -> "-47.7989225"
 Parameter: ZMAX -> "-31.1966689"
 Parameter: ZMIN -> "-38.1966689"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "66" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "66" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.142262277"
Evaluating: 100.116666*(0.142262277-0.5)
 Parameter: XPOS <- "-35.8155081"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.673628298"
Evaluating: 100.116666*(0.673628298-0.5)
 Parameter: YPOS <- "17.3830863"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.964456518"
Evaluating: 127.138691*(0.964456518-0.5)+4.2778237
 Parameter: ZPOS <- "63.3282174"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.3282174" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.3282174" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.8155081"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.8155081-0
 Parameter: XTRAN <- "-35.8155081"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.3830863"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.3830863-0
 Parameter: YTRAN <- "17.3830863"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.3282174"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.3282174-0
 Parameter: ZTRAN <- "63.3282174"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.8155081"
 Parameter: YTRAN -> "17.3830863"
 Parameter: ZTRAN -> "63.3282174"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -35.815508   17.383086   63.328217
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178171445"
Evaluating: 0.178171445*360.0
 Parameter: XPHI <- "64.1417202"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.942459006"
Evaluating: 0.942459006*360.0
 Parameter: YPHI <- "339.285242"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570314024"
Evaluating: 0.570314024*360.0
 Parameter: ZPHI <- "205.313049"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.8155081"
 Parameter: YPOS -> "17.3830863"
 Parameter: ZPOS -> "63.3282174"
 Parameter: XPHI -> "64.1417202"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.436147    0.899876
    0.000000   -0.899876    0.436147

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.8155081"
 Parameter: YPOS -> "17.3830863"
 Parameter: ZPOS -> "63.3282174"
 Parameter: YPHI -> "339.285242"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.935353    0.000000    0.353716
    0.000000    1.000000    0.000000
   -0.353716    0.000000    0.935353

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   20.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.8155081"
 Parameter: YPOS -> "17.3830863"
 Parameter: ZPOS -> "63.3282174"
 Parameter: ZPHI -> "205.313049"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.903985   -0.427564    0.000000
    0.427564   -0.903985    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.815508 XMAX =  -35.815508 XAVE =  -35.815508
    YMIN =   17.383086 YMAX =   17.383086 YAVE =   17.383086
    ZMIN =   63.328217 ZMAX =   63.328217 ZAVE =   63.328217
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.8155081"
Evaluating: -35.8155081+3.5
 Parameter: XMAX <- "-32.3155081"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.3830863"
Evaluating: 17.3830863+3.5
 Parameter: YMAX <- "20.8830863"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.3282174"
Evaluating: 63.3282174+3.5
 Parameter: ZMAX <- "66.8282174"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.8155081"
Evaluating: -35.8155081-3.5
 Parameter: XMIN <- "-39.3155081"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.3830863"
Evaluating: 17.3830863-3.5
 Parameter: YMIN <- "13.8830863"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.3282174"
Evaluating: 63.3282174-3.5
 Parameter: ZMIN <- "59.8282174"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.3155081"
 Parameter: XMIN -> "-39.3155081"
 Parameter: YMAX -> "20.8830863"
 Parameter: YMIN -> "13.8830863"
 Parameter: ZMAX -> "66.8282174"
 Parameter: ZMIN -> "59.8282174"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "67" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "67" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.876811599"
Evaluating: 100.116666*(0.876811599-0.5)
 Parameter: XPOS <- "37.725121"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.877793148"
Evaluating: 100.116666*(0.877793148-0.5)
 Parameter: YPOS <- "37.8233904"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.652659845"
Evaluating: 127.138691*(0.652659845-0.5)+4.2778237
 Parameter: ZPOS <- "23.6867966"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.6867966" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.6867966" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.725121"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.725121-0
 Parameter: XTRAN <- "37.725121"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.8233904"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.8233904-0
 Parameter: YTRAN <- "37.8233904"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.6867966"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.6867966-0
 Parameter: ZTRAN <- "23.6867966"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.725121"
 Parameter: YTRAN -> "37.8233904"
 Parameter: ZTRAN -> "23.6867966"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    37.725121   37.823390   23.686797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678666553"
Evaluating: 0.678666553*360.0
 Parameter: XPHI <- "244.319959"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484640057"
Evaluating: 0.484640057*360.0
 Parameter: YPHI <- "174.470421"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.156154572"
Evaluating: 0.156154572*360.0
 Parameter: ZPHI <- "56.2156459"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.725121"
 Parameter: YPOS -> "37.8233904"
 Parameter: ZPOS -> "23.6867966"
 Parameter: XPHI -> "244.319959"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.433345   -0.901228
    0.000000    0.901228   -0.433345

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.725121"
 Parameter: YPOS -> "37.8233904"
 Parameter: ZPOS -> "23.6867966"
 Parameter: YPHI -> "174.470421"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.995347    0.000000   -0.096360
    0.000000    1.000000    0.000000
    0.096360    0.000000   -0.995347

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.725121"
 Parameter: YPOS -> "37.8233904"
 Parameter: ZPOS -> "23.6867966"
 Parameter: ZPHI -> "56.2156459"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.556069    0.831136    0.000000
   -0.831136    0.556069    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   56.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.725121 XMAX =   37.725121 XAVE =   37.725121
    YMIN =   37.823390 YMAX =   37.823390 YAVE =   37.823390
    ZMIN =   23.686797 ZMAX =   23.686797 ZAVE =   23.686797
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.725121"
Evaluating: 37.725121+3.5
 Parameter: XMAX <- "41.225121"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.8233904"
Evaluating: 37.8233904+3.5
 Parameter: YMAX <- "41.3233904"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.6867966"
Evaluating: 23.6867966+3.5
 Parameter: ZMAX <- "27.1867966"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.725121"
Evaluating: 37.725121-3.5
 Parameter: XMIN <- "34.225121"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.8233904"
Evaluating: 37.8233904-3.5
 Parameter: YMIN <- "34.3233904"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.6867966"
Evaluating: 23.6867966-3.5
 Parameter: ZMIN <- "20.1867966"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.225121"
 Parameter: XMIN -> "34.225121"
 Parameter: YMAX -> "41.3233904"
 Parameter: YMIN -> "34.3233904"
 Parameter: ZMAX -> "27.1867966"
 Parameter: ZMIN -> "20.1867966"
 SELRPN>      9 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      4 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39272 POS      SOD      67       SOD     -**** MEMB     POPC     118      C13           3.7034
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "67" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "3.010016796E-02"
Evaluating: 100.116666*(3.010016796E-02-0.5)
 Parameter: XPOS <- "-47.0448045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.277458486"
Evaluating: 100.116666*(0.277458486-0.5)
 Parameter: YPOS <- "-22.2801144"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.298965609"
Evaluating: 127.138691*(0.298965609-0.5)+4.2778237
 Parameter: ZPOS <- "-21.2814256"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.2814256" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.725121 XMAX =   37.725121 XAVE =   37.725121
    YMIN =   37.823390 YMAX =   37.823390 YAVE =   37.823390
    ZMIN =   23.686797 ZMAX =   23.686797 ZAVE =   23.686797
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-47.0448045"
 RDCMND substituted energy or value "?XAVE" to "37.725121"
Evaluating: -47.0448045-37.725121
 Parameter: XTRAN <- "-84.7699255"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.2801144"
 RDCMND substituted energy or value "?YAVE" to "37.8233904"
Evaluating: -22.2801144-37.8233904
 Parameter: YTRAN <- "-60.1035048"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2814256"
 RDCMND substituted energy or value "?ZAVE" to "23.6867966"
Evaluating: -21.2814256-23.6867966
 Parameter: ZTRAN <- "-44.9682222"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-84.7699255"
 Parameter: YTRAN -> "-60.1035048"
 Parameter: ZTRAN -> "-44.9682222"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -84.769925  -60.103505  -44.968222
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.274326368E-02"
Evaluating: 6.274326368E-02*360.0
 Parameter: XPHI <- "22.5875749"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178016104"
Evaluating: 0.178016104*360.0
 Parameter: YPHI <- "64.0857974"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.035819132E-02"
Evaluating: 9.035819132E-02*360.0
 Parameter: ZPHI <- "32.5289489"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-47.0448045"
 Parameter: YPOS -> "-22.2801144"
 Parameter: ZPOS -> "-21.2814256"
 Parameter: XPHI -> "22.5875749"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.923294    0.384095
    0.000000   -0.384095    0.923294

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   22.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-47.0448045"
 Parameter: YPOS -> "-22.2801144"
 Parameter: ZPOS -> "-21.2814256"
 Parameter: YPHI -> "64.0857974"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.437025    0.000000   -0.899449
    0.000000    1.000000    0.000000
    0.899449    0.000000    0.437025

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-47.0448045"
 Parameter: YPOS -> "-22.2801144"
 Parameter: ZPOS -> "-21.2814256"
 Parameter: ZPHI -> "32.5289489"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.843120    0.537726    0.000000
   -0.537726    0.843120    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.044804 XMAX =  -47.044804 XAVE =  -47.044804
    YMIN =  -22.280114 YMAX =  -22.280114 YAVE =  -22.280114
    ZMIN =  -21.281426 ZMAX =  -21.281426 ZAVE =  -21.281426
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-47.0448045"
Evaluating: -47.0448045+3.5
 Parameter: XMAX <- "-43.5448045"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.2801144"
Evaluating: -22.2801144+3.5
 Parameter: YMAX <- "-18.7801144"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2814256"
Evaluating: -21.2814256+3.5
 Parameter: ZMAX <- "-17.7814256"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-47.0448045"
Evaluating: -47.0448045-3.5
 Parameter: XMIN <- "-50.5448045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.2801144"
Evaluating: -22.2801144-3.5
 Parameter: YMIN <- "-25.7801144"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2814256"
Evaluating: -21.2814256-3.5
 Parameter: ZMIN <- "-24.7814256"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-43.5448045"
 Parameter: XMIN -> "-50.5448045"
 Parameter: YMAX -> "-18.7801144"
 Parameter: YMIN -> "-25.7801144"
 Parameter: ZMAX -> "-17.7814256"
 Parameter: ZMIN -> "-24.7814256"
 SELRPN>     13 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      5 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39272 POS      SOD      67       SOD     -**** MEMB     POPC     221      N             2.7083
39272 POS      SOD      67       SOD     -**** MEMB     POPC     221      C12           3.4587
39272 POS      SOD      67       SOD     -**** MEMB     POPC     221      C13           3.5526
39272 POS      SOD      67       SOD     -**** MEMB     POPC     221      C14           3.4641
39272 POS      SOD      67       SOD     -**** MEMB     POPC     221      C15           1.2478
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "67" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.644848541"
Evaluating: 100.116666*(0.644848541-0.5)
 Parameter: XPOS <- "14.501753"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.136676289"
Evaluating: 100.116666*(0.136676289-0.5)
 Parameter: YPOS <- "-36.3747586"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "1.133499299E-02"
Evaluating: 127.138691*(1.133499299E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-57.8504056"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.8504056" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -47.044804 XMAX =  -47.044804 XAVE =  -47.044804
    YMIN =  -22.280114 YMAX =  -22.280114 YAVE =  -22.280114
    ZMIN =  -21.281426 ZMAX =  -21.281426 ZAVE =  -21.281426
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.501753"
 RDCMND substituted energy or value "?XAVE" to "-47.0448045"
Evaluating: 14.501753--47.0448045
 Parameter: XTRAN <- "61.5465575"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.3747586"
 RDCMND substituted energy or value "?YAVE" to "-22.2801144"
Evaluating: -36.3747586--22.2801144
 Parameter: YTRAN <- "-14.0946442"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.8504056"
 RDCMND substituted energy or value "?ZAVE" to "-21.2814256"
Evaluating: -57.8504056--21.2814256
 Parameter: ZTRAN <- "-36.56898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "61.5465575"
 Parameter: YTRAN -> "-14.0946442"
 Parameter: ZTRAN -> "-36.56898"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    61.546557  -14.094644  -36.568980
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.431829222"
Evaluating: 0.431829222*360.0
 Parameter: XPHI <- "155.45852"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.206608454"
Evaluating: 0.206608454*360.0
 Parameter: YPHI <- "74.3790434"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.144041675"
Evaluating: 0.144041675*360.0
 Parameter: ZPHI <- "51.855003"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.501753"
 Parameter: YPOS -> "-36.3747586"
 Parameter: ZPOS -> "-57.8504056"
 Parameter: XPHI -> "155.45852"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.909661    0.415352
    0.000000   -0.415352   -0.909661

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.501753"
 Parameter: YPOS -> "-36.3747586"
 Parameter: ZPOS -> "-57.8504056"
 Parameter: YPHI -> "74.3790434"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.269272    0.000000   -0.963064
    0.000000    1.000000    0.000000
    0.963064    0.000000    0.269272

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.501753"
 Parameter: YPOS -> "-36.3747586"
 Parameter: ZPOS -> "-57.8504056"
 Parameter: ZPHI -> "51.855003"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.617654    0.786450    0.000000
   -0.786450    0.617654    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.501753 XMAX =   14.501753 XAVE =   14.501753
    YMIN =  -36.374759 YMAX =  -36.374759 YAVE =  -36.374759
    ZMIN =  -57.850406 ZMAX =  -57.850406 ZAVE =  -57.850406
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.501753"
Evaluating: 14.501753+3.5
 Parameter: XMAX <- "18.001753"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.3747586"
Evaluating: -36.3747586+3.5
 Parameter: YMAX <- "-32.8747586"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.8504056"
Evaluating: -57.8504056+3.5
 Parameter: ZMAX <- "-54.3504056"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.501753"
Evaluating: 14.501753-3.5
 Parameter: XMIN <- "11.001753"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.3747586"
Evaluating: -36.3747586-3.5
 Parameter: YMIN <- "-39.8747586"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.8504056"
Evaluating: -57.8504056-3.5
 Parameter: ZMIN <- "-61.3504056"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.001753"
 Parameter: XMIN -> "11.001753"
 Parameter: YMAX -> "-32.8747586"
 Parameter: YMIN -> "-39.8747586"
 Parameter: ZMAX -> "-54.3504056"
 Parameter: ZMIN -> "-61.3504056"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "68" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "68" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.106266294"
Evaluating: 100.116666*(0.106266294-0.5)
 Parameter: XPOS <- "-39.4193059"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.442024018"
Evaluating: 100.116666*(0.442024018-0.5)
 Parameter: YPOS <- "-5.80436203"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.69536339"
Evaluating: 127.138691*(0.69536339-0.5)+4.2778237
 Parameter: ZPOS <- "29.1160694"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.1160694" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.1160694" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.4193059"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.4193059-0
 Parameter: XTRAN <- "-39.4193059"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.80436203"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.80436203-0
 Parameter: YTRAN <- "-5.80436203"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.1160694"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.1160694-0
 Parameter: ZTRAN <- "29.1160694"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.4193059"
 Parameter: YTRAN -> "-5.80436203"
 Parameter: ZTRAN -> "29.1160694"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -39.419306   -5.804362   29.116069
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876455046"
Evaluating: 0.876455046*360.0
 Parameter: XPHI <- "315.523817"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.567957386"
Evaluating: 0.567957386*360.0
 Parameter: YPHI <- "204.464659"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617961288"
Evaluating: 0.617961288*360.0
 Parameter: ZPHI <- "222.466064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.4193059"
 Parameter: YPOS -> "-5.80436203"
 Parameter: ZPOS -> "29.1160694"
 Parameter: XPHI -> "315.523817"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.713542   -0.700613
    0.000000    0.700613    0.713542

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   44.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.4193059"
 Parameter: YPOS -> "-5.80436203"
 Parameter: ZPOS -> "29.1160694"
 Parameter: YPHI -> "204.464659"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.910217    0.000000    0.414132
    0.000000    1.000000    0.000000
   -0.414132    0.000000   -0.910217

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.4193059"
 Parameter: YPOS -> "-5.80436203"
 Parameter: ZPOS -> "29.1160694"
 Parameter: ZPHI -> "222.466064"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.737677   -0.675153    0.000000
    0.675153   -0.737677    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  137.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.419306 XMAX =  -39.419306 XAVE =  -39.419306
    YMIN =   -5.804362 YMAX =   -5.804362 YAVE =   -5.804362
    ZMIN =   29.116069 ZMAX =   29.116069 ZAVE =   29.116069
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.4193059"
Evaluating: -39.4193059+3.5
 Parameter: XMAX <- "-35.9193059"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.80436203"
Evaluating: -5.80436203+3.5
 Parameter: YMAX <- "-2.30436203"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.1160694"
Evaluating: 29.1160694+3.5
 Parameter: ZMAX <- "32.6160694"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.4193059"
Evaluating: -39.4193059-3.5
 Parameter: XMIN <- "-42.9193059"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.80436203"
Evaluating: -5.80436203-3.5
 Parameter: YMIN <- "-9.30436203"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.1160694"
Evaluating: 29.1160694-3.5
 Parameter: ZMIN <- "25.6160694"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.9193059"
 Parameter: XMIN -> "-42.9193059"
 Parameter: YMAX -> "-2.30436203"
 Parameter: YMIN -> "-9.30436203"
 Parameter: ZMAX -> "32.6160694"
 Parameter: ZMIN -> "25.6160694"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "69" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "69" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.94388197"
Evaluating: 100.116666*(0.94388197-0.5)
 Parameter: XPOS <- "44.4399829"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.352508783"
Evaluating: 100.116666*(0.352508783-0.5)
 Parameter: YPOS <- "-14.7663289"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "4.658259304E-02"
Evaluating: 127.138691*(4.658259304E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-53.3690719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.3690719" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.4399829"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.4399829-0
 Parameter: XTRAN <- "44.4399829"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.7663289"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.7663289-0
 Parameter: YTRAN <- "-14.7663289"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.3690719"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.3690719-0
 Parameter: ZTRAN <- "-53.3690719"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.4399829"
 Parameter: YTRAN -> "-14.7663289"
 Parameter: ZTRAN -> "-53.3690719"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    44.439983  -14.766329  -53.369072
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588183784"
Evaluating: 0.588183784*360.0
 Parameter: XPHI <- "211.746162"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.764182372"
Evaluating: 0.764182372*360.0
 Parameter: YPHI <- "275.105654"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.039235025E-02"
Evaluating: 3.039235025E-02*360.0
 Parameter: ZPHI <- "10.9412461"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.4399829"
 Parameter: YPOS -> "-14.7663289"
 Parameter: ZPOS -> "-53.3690719"
 Parameter: XPHI -> "211.746162"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.850387   -0.526157
    0.000000    0.526157   -0.850387

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  148.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.4399829"
 Parameter: YPOS -> "-14.7663289"
 Parameter: ZPOS -> "-53.3690719"
 Parameter: YPHI -> "275.105654"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.088993    0.000000    0.996032
    0.000000    1.000000    0.000000
   -0.996032    0.000000    0.088993

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.4399829"
 Parameter: YPOS -> "-14.7663289"
 Parameter: ZPOS -> "-53.3690719"
 Parameter: ZPHI -> "10.9412461"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.981822    0.189802    0.000000
   -0.189802    0.981822    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   10.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.439983 XMAX =   44.439983 XAVE =   44.439983
    YMIN =  -14.766329 YMAX =  -14.766329 YAVE =  -14.766329
    ZMIN =  -53.369072 ZMAX =  -53.369072 ZAVE =  -53.369072
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.4399829"
Evaluating: 44.4399829+3.5
 Parameter: XMAX <- "47.9399829"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.7663289"
Evaluating: -14.7663289+3.5
 Parameter: YMAX <- "-11.2663289"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.3690719"
Evaluating: -53.3690719+3.5
 Parameter: ZMAX <- "-49.8690719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.4399829"
Evaluating: 44.4399829-3.5
 Parameter: XMIN <- "40.9399829"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.7663289"
Evaluating: -14.7663289-3.5
 Parameter: YMIN <- "-18.2663289"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.3690719"
Evaluating: -53.3690719-3.5
 Parameter: ZMIN <- "-56.8690719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.9399829"
 Parameter: XMIN -> "40.9399829"
 Parameter: YMAX -> "-11.2663289"
 Parameter: YMIN -> "-18.2663289"
 Parameter: ZMAX -> "-49.8690719"
 Parameter: ZMIN -> "-56.8690719"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39274 POS      SOD      69       SOD     -**** POS      SOD      53       SOD           3.1938
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "69" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.745822524"
Evaluating: 100.116666*(0.745822524-0.5)
 Parameter: XPOS <- "24.6109315"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.224539481"
Evaluating: 100.116666*(0.224539481-0.5)
 Parameter: YPOS <- "-27.5781888"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.366610918"
Evaluating: 127.138691*(0.366610918-0.5)+4.2778237
 Parameter: ZPOS <- "-12.6810896"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.6810896" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.6810896" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "69" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.794162454"
Evaluating: 100.116666*(0.794162454-0.5)
 Parameter: XPOS <- "29.4505642"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.886078377"
Evaluating: 100.116666*(0.886078377-0.5)
 Parameter: YPOS <- "38.6528799"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.951419334"
Evaluating: 127.138691*(0.951419334-0.5)+4.2778237
 Parameter: ZPOS <- "61.6706869"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.6706869" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.6706869" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.439983 XMAX =   44.439983 XAVE =   44.439983
    YMIN =  -14.766329 YMAX =  -14.766329 YAVE =  -14.766329
    ZMIN =  -53.369072 ZMAX =  -53.369072 ZAVE =  -53.369072
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.4505642"
 RDCMND substituted energy or value "?XAVE" to "44.4399829"
Evaluating: 29.4505642-44.4399829
 Parameter: XTRAN <- "-14.9894187"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.6528799"
 RDCMND substituted energy or value "?YAVE" to "-14.7663289"
Evaluating: 38.6528799--14.7663289
 Parameter: YTRAN <- "53.4192088"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.6706869"
 RDCMND substituted energy or value "?ZAVE" to "-53.3690719"
Evaluating: 61.6706869--53.3690719
 Parameter: ZTRAN <- "115.039759"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.9894187"
 Parameter: YTRAN -> "53.4192088"
 Parameter: ZTRAN -> "115.039759"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -14.989419   53.419209  115.039759
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.92947458"
Evaluating: 0.92947458*360.0
 Parameter: XPHI <- "334.610849"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.5731315"
Evaluating: 0.5731315*360.0
 Parameter: YPHI <- "206.32734"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723946305"
Evaluating: 0.723946305*360.0
 Parameter: ZPHI <- "260.62067"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.4505642"
 Parameter: YPOS -> "38.6528799"
 Parameter: ZPOS -> "61.6706869"
 Parameter: XPHI -> "334.610849"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.903416   -0.428764
    0.000000    0.428764    0.903416

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.4505642"
 Parameter: YPOS -> "38.6528799"
 Parameter: ZPOS -> "61.6706869"
 Parameter: YPHI -> "206.32734"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.896275    0.000000    0.443499
    0.000000    1.000000    0.000000
   -0.443499    0.000000   -0.896275

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.4505642"
 Parameter: YPOS -> "38.6528799"
 Parameter: ZPOS -> "61.6706869"
 Parameter: ZPHI -> "260.62067"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.162970   -0.986631    0.000000
    0.986631   -0.162970    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.450564 XMAX =   29.450564 XAVE =   29.450564
    YMIN =   38.652880 YMAX =   38.652880 YAVE =   38.652880
    ZMIN =   61.670687 ZMAX =   61.670687 ZAVE =   61.670687
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.4505643"
Evaluating: 29.4505643+3.5
 Parameter: XMAX <- "32.9505643"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.65288"
Evaluating: 38.65288+3.5
 Parameter: YMAX <- "42.15288"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.6706867"
Evaluating: 61.6706867+3.5
 Parameter: ZMAX <- "65.1706867"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.4505643"
Evaluating: 29.4505643-3.5
 Parameter: XMIN <- "25.9505643"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.65288"
Evaluating: 38.65288-3.5
 Parameter: YMIN <- "35.15288"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.6706867"
Evaluating: 61.6706867-3.5
 Parameter: ZMIN <- "58.1706867"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.9505643"
 Parameter: XMIN -> "25.9505643"
 Parameter: YMAX -> "42.15288"
 Parameter: YMIN -> "35.15288"
 Parameter: ZMAX -> "65.1706867"
 Parameter: ZMIN -> "58.1706867"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "70" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "70" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.884961888"
Evaluating: 100.116666*(0.884961888-0.5)
 Parameter: XPOS <- "38.5411008"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.331242802"
Evaluating: 100.116666*(0.331242802-0.5)
 Parameter: YPOS <- "-16.895408"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.854736555"
Evaluating: 127.138691*(0.854736555-0.5)+4.2778237
 Parameter: ZPOS <- "49.378565"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.378565" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.378565" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.5411008"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.5411008-0
 Parameter: XTRAN <- "38.5411008"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.895408"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.895408-0
 Parameter: YTRAN <- "-16.895408"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.378565"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.378565-0
 Parameter: ZTRAN <- "49.378565"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.5411008"
 Parameter: YTRAN -> "-16.895408"
 Parameter: ZTRAN -> "49.378565"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    38.541101  -16.895408   49.378565
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.702354176"
Evaluating: 0.702354176*360.0
 Parameter: XPHI <- "252.847503"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.941097695"
Evaluating: 0.941097695*360.0
 Parameter: YPHI <- "338.79517"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.238361416"
Evaluating: 0.238361416*360.0
 Parameter: ZPHI <- "85.8101098"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.5411008"
 Parameter: YPOS -> "-16.895408"
 Parameter: ZPOS -> "49.378565"
 Parameter: XPHI -> "252.847503"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.294916   -0.955523
    0.000000    0.955523   -0.294916

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  107.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.5411008"
 Parameter: YPOS -> "-16.895408"
 Parameter: ZPOS -> "49.378565"
 Parameter: YPHI -> "338.79517"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.932293    0.000000    0.361703
    0.000000    1.000000    0.000000
   -0.361703    0.000000    0.932293

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   21.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.5411008"
 Parameter: YPOS -> "-16.895408"
 Parameter: ZPOS -> "49.378565"
 Parameter: ZPHI -> "85.8101098"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.073062    0.997327    0.000000
   -0.997327    0.073062    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.541101 XMAX =   38.541101 XAVE =   38.541101
    YMIN =  -16.895408 YMAX =  -16.895408 YAVE =  -16.895408
    ZMIN =   49.378565 ZMAX =   49.378565 ZAVE =   49.378565
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.5411008"
Evaluating: 38.5411008+3.5
 Parameter: XMAX <- "42.0411008"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.895408"
Evaluating: -16.895408+3.5
 Parameter: YMAX <- "-13.395408"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.378565"
Evaluating: 49.378565+3.5
 Parameter: ZMAX <- "52.878565"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.5411008"
Evaluating: 38.5411008-3.5
 Parameter: XMIN <- "35.0411008"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.895408"
Evaluating: -16.895408-3.5
 Parameter: YMIN <- "-20.395408"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.378565"
Evaluating: 49.378565-3.5
 Parameter: ZMIN <- "45.878565"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.0411008"
 Parameter: XMIN -> "35.0411008"
 Parameter: YMAX -> "-13.395408"
 Parameter: YMIN -> "-20.395408"
 Parameter: ZMAX -> "52.878565"
 Parameter: ZMIN -> "45.878565"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "71" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "71" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.135244304"
Evaluating: 100.116666*(0.135244304-0.5)
 Parameter: XPOS <- "-36.5181242"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.555536756E-02"
Evaluating: 100.116666*(4.555536756E-02-0.5)
 Parameter: YPOS <- "-45.4974815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.430957053"
Evaluating: 127.138691*(0.430957053-0.5)+4.2778237
 Parameter: ZPOS <- "-4.5002062"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.5002062" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.5002062" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "71" and "71".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.784103404"
Evaluating: 100.116666*(0.784103404-0.5)
 Parameter: XPOS <- "28.4434856"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.659540587"
Evaluating: 100.116666*(0.659540587-0.5)
 Parameter: YPOS <- "15.9726717"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.979355506E-02"
Evaluating: 127.138691*(2.979355506E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-55.5036082"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.5036082" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.4434856"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.4434856-0
 Parameter: XTRAN <- "28.4434856"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.9726717"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.9726717-0
 Parameter: YTRAN <- "15.9726717"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.5036082"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.5036082-0
 Parameter: ZTRAN <- "-55.5036082"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.4434856"
 Parameter: YTRAN -> "15.9726717"
 Parameter: ZTRAN -> "-55.5036082"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    28.443486   15.972672  -55.503608
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.394798682"
Evaluating: 0.394798682*360.0
 Parameter: XPHI <- "142.127526"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.364468766"
Evaluating: 0.364468766*360.0
 Parameter: YPHI <- "131.208756"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540439775"
Evaluating: 0.540439775*360.0
 Parameter: ZPHI <- "194.558319"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.4434856"
 Parameter: YPOS -> "15.9726717"
 Parameter: ZPOS -> "-55.5036082"
 Parameter: XPHI -> "142.127526"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.789379    0.613906
    0.000000   -0.613906   -0.789379

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  142.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.4434856"
 Parameter: YPOS -> "15.9726717"
 Parameter: ZPOS -> "-55.5036082"
 Parameter: YPHI -> "131.208756"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.658804    0.000000   -0.752314
    0.000000    1.000000    0.000000
    0.752314    0.000000   -0.658804

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.4434856"
 Parameter: YPOS -> "15.9726717"
 Parameter: ZPOS -> "-55.5036082"
 Parameter: ZPHI -> "194.558319"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.967892   -0.251365    0.000000
    0.251365   -0.967892    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.443486 XMAX =   28.443486 XAVE =   28.443486
    YMIN =   15.972672 YMAX =   15.972672 YAVE =   15.972672
    ZMIN =  -55.503608 ZMAX =  -55.503608 ZAVE =  -55.503608
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.4434856"
Evaluating: 28.4434856+3.5
 Parameter: XMAX <- "31.9434856"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.9726717"
Evaluating: 15.9726717+3.5
 Parameter: YMAX <- "19.4726717"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.5036082"
Evaluating: -55.5036082+3.5
 Parameter: ZMAX <- "-52.0036082"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.4434856"
Evaluating: 28.4434856-3.5
 Parameter: XMIN <- "24.9434856"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.9726717"
Evaluating: 15.9726717-3.5
 Parameter: YMIN <- "12.4726717"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.5036082"
Evaluating: -55.5036082-3.5
 Parameter: ZMIN <- "-59.0036082"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.9434856"
 Parameter: XMIN -> "24.9434856"
 Parameter: YMAX -> "19.4726717"
 Parameter: YMIN -> "12.4726717"
 Parameter: ZMAX -> "-52.0036082"
 Parameter: ZMIN -> "-59.0036082"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "72" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "72" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "72"
 Parameter: NPOS -> "71"
Evaluating: 72-71
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.835757714"
Evaluating: 100.116666*(0.835757714-0.5)
 Parameter: XPOS <- "33.6149429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.565080977"
Evaluating: 100.116666*(0.565080977-0.5)
 Parameter: YPOS <- "6.51569044"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.921816127"
Evaluating: 127.138691*(0.921816127-0.5)+4.2778237
 Parameter: ZPOS <- "57.9069739"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.9069739" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.9069739" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.6149429"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.6149429-0
 Parameter: XTRAN <- "33.6149429"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.51569044"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.51569044-0
 Parameter: YTRAN <- "6.51569044"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.9069739"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.9069739-0
 Parameter: ZTRAN <- "57.9069739"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.6149429"
 Parameter: YTRAN -> "6.51569044"
 Parameter: ZTRAN -> "57.9069739"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    33.614943    6.515690   57.906974
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.35200443"
Evaluating: 0.35200443*360.0
 Parameter: XPHI <- "126.721595"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.207199422"
Evaluating: 0.207199422*360.0
 Parameter: YPHI <- "74.5917919"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.669500937"
Evaluating: 0.669500937*360.0
 Parameter: ZPHI <- "241.020337"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.6149429"
 Parameter: YPOS -> "6.51569044"
 Parameter: ZPOS -> "57.9069739"
 Parameter: XPHI -> "126.721595"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.597927    0.801550
    0.000000   -0.801550   -0.597927

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.6149429"
 Parameter: YPOS -> "6.51569044"
 Parameter: ZPOS -> "57.9069739"
 Parameter: YPHI -> "74.5917919"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.265694    0.000000   -0.964057
    0.000000    1.000000    0.000000
    0.964057    0.000000    0.265694

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.6149429"
 Parameter: YPOS -> "6.51569044"
 Parameter: ZPOS -> "57.9069739"
 Parameter: ZPHI -> "241.020337"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.484499   -0.874792    0.000000
    0.874792   -0.484499    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.614943 XMAX =   33.614943 XAVE =   33.614943
    YMIN =    6.515690 YMAX =    6.515690 YAVE =    6.515690
    ZMIN =   57.906974 ZMAX =   57.906974 ZAVE =   57.906974
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.6149429"
Evaluating: 33.6149429+3.5
 Parameter: XMAX <- "37.1149429"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.51569044"
Evaluating: 6.51569044+3.5
 Parameter: YMAX <- "10.0156904"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.9069739"
Evaluating: 57.9069739+3.5
 Parameter: ZMAX <- "61.4069739"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.6149429"
Evaluating: 33.6149429-3.5
 Parameter: XMIN <- "30.1149429"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.51569044"
Evaluating: 6.51569044-3.5
 Parameter: YMIN <- "3.01569044"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.9069739"
Evaluating: 57.9069739-3.5
 Parameter: ZMIN <- "54.4069739"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.1149429"
 Parameter: XMIN -> "30.1149429"
 Parameter: YMAX -> "10.0156904"
 Parameter: YMIN -> "3.01569044"
 Parameter: ZMAX -> "61.4069739"
 Parameter: ZMIN -> "54.4069739"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "73" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "73" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "73"
 Parameter: NPOS -> "71"
Evaluating: 73-71
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.340433163"
Evaluating: 100.116666*(0.340433163-0.5)
 Parameter: XPOS <- "-15.9752997"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.96757707"
Evaluating: 100.116666*(0.96757707-0.5)
 Parameter: YPOS <- "46.8122573"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.768648573"
Evaluating: 127.138691*(0.768648573-0.5)+4.2778237
 Parameter: ZPOS <- "38.4334516"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.4334516" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.4334516" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.9752997"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -15.9752997-0
 Parameter: XTRAN <- "-15.9752997"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "46.8122573"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 46.8122573-0
 Parameter: YTRAN <- "46.8122573"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.4334516"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.4334516-0
 Parameter: ZTRAN <- "38.4334516"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.9752997"
 Parameter: YTRAN -> "46.8122573"
 Parameter: ZTRAN -> "38.4334516"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -15.975300   46.812257   38.433452
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.52336335"
Evaluating: 0.52336335*360.0
 Parameter: XPHI <- "188.410806"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374750408"
Evaluating: 0.374750408*360.0
 Parameter: YPHI <- "134.910147"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390221838"
Evaluating: 0.390221838*360.0
 Parameter: ZPHI <- "140.479862"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.9752997"
 Parameter: YPOS -> "46.8122573"
 Parameter: ZPOS -> "38.4334516"
 Parameter: XPHI -> "188.410806"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.989245   -0.146270
    0.000000    0.146270   -0.989245

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  171.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.9752997"
 Parameter: YPOS -> "46.8122573"
 Parameter: ZPOS -> "38.4334516"
 Parameter: YPHI -> "134.910147"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.705997    0.000000   -0.708215
    0.000000    1.000000    0.000000
    0.708215    0.000000   -0.705997

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.9752997"
 Parameter: YPOS -> "46.8122573"
 Parameter: ZPOS -> "38.4334516"
 Parameter: ZPHI -> "140.479862"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.771401    0.636349    0.000000
   -0.636349   -0.771401    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  140.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.975300 XMAX =  -15.975300 XAVE =  -15.975300
    YMIN =   46.812257 YMAX =   46.812257 YAVE =   46.812257
    ZMIN =   38.433452 ZMAX =   38.433452 ZAVE =   38.433452
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.9752997"
Evaluating: -15.9752997+3.5
 Parameter: XMAX <- "-12.4752997"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "46.8122573"
Evaluating: 46.8122573+3.5
 Parameter: YMAX <- "50.3122573"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.4334516"
Evaluating: 38.4334516+3.5
 Parameter: ZMAX <- "41.9334516"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.9752997"
Evaluating: -15.9752997-3.5
 Parameter: XMIN <- "-19.4752997"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "46.8122573"
Evaluating: 46.8122573-3.5
 Parameter: YMIN <- "43.3122573"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.4334516"
Evaluating: 38.4334516-3.5
 Parameter: ZMIN <- "34.9334516"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.4752997"
 Parameter: XMIN -> "-19.4752997"
 Parameter: YMAX -> "50.3122573"
 Parameter: YMIN -> "43.3122573"
 Parameter: ZMAX -> "41.9334516"
 Parameter: ZMIN -> "34.9334516"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "74" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "74" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "71"
Evaluating: 74-71
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.541642521"
Evaluating: 100.116666*(0.541642521-0.5)
 Parameter: XPOS <- "4.16911037"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.659786506"
Evaluating: 100.116666*(0.659786506-0.5)
 Parameter: YPOS <- "15.9972923"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.451681995"
Evaluating: 127.138691*(0.451681995-0.5)+4.2778237
 Parameter: ZPOS <- "-1.86526421"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.86526421" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.86526421" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "74" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "71"
Evaluating: 74-71
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.700794245"
Evaluating: 100.116666*(0.700794245-0.5)
 Parameter: XPOS <- "20.1028504"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.903846253"
Evaluating: 100.116666*(0.903846253-0.5)
 Parameter: YPOS <- "40.4317404"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.619796753"
Evaluating: 127.138691*(0.619796753-0.5)+4.2778237
 Parameter: ZPOS <- "19.5086261"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.5086261" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.5086261" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.1028504"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.1028504-0
 Parameter: XTRAN <- "20.1028504"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.4317404"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.4317404-0
 Parameter: YTRAN <- "40.4317404"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.5086261"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.5086261-0
 Parameter: ZTRAN <- "19.5086261"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.1028504"
 Parameter: YTRAN -> "40.4317404"
 Parameter: ZTRAN -> "19.5086261"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    20.102850   40.431740   19.508626
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.269859798"
Evaluating: 0.269859798*360.0
 Parameter: XPHI <- "97.1495273"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.217618787"
Evaluating: 0.217618787*360.0
 Parameter: YPHI <- "78.3427633"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.163936497"
Evaluating: 0.163936497*360.0
 Parameter: ZPHI <- "59.0171389"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.1028504"
 Parameter: YPOS -> "40.4317404"
 Parameter: ZPOS -> "19.5086261"
 Parameter: XPHI -> "97.1495273"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.124459    0.992225
    0.000000   -0.992225   -0.124459

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.1028504"
 Parameter: YPOS -> "40.4317404"
 Parameter: ZPOS -> "19.5086261"
 Parameter: YPHI -> "78.3427633"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.202056    0.000000   -0.979374
    0.000000    1.000000    0.000000
    0.979374    0.000000    0.202056

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.1028504"
 Parameter: YPOS -> "40.4317404"
 Parameter: ZPOS -> "19.5086261"
 Parameter: ZPHI -> "59.0171389"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.514782    0.857321    0.000000
   -0.857321    0.514782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.102850 XMAX =   20.102850 XAVE =   20.102850
    YMIN =   40.431740 YMAX =   40.431740 YAVE =   40.431740
    ZMIN =   19.508626 ZMAX =   19.508626 ZAVE =   19.508626
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.1028504"
Evaluating: 20.1028504+3.5
 Parameter: XMAX <- "23.6028504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.4317404"
Evaluating: 40.4317404+3.5
 Parameter: YMAX <- "43.9317404"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.5086261"
Evaluating: 19.5086261+3.5
 Parameter: ZMAX <- "23.0086261"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.1028504"
Evaluating: 20.1028504-3.5
 Parameter: XMIN <- "16.6028504"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.4317404"
Evaluating: 40.4317404-3.5
 Parameter: YMIN <- "36.9317404"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.5086261"
Evaluating: 19.5086261-3.5
 Parameter: ZMIN <- "16.0086261"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.6028504"
 Parameter: XMIN -> "16.6028504"
 Parameter: YMAX -> "43.9317404"
 Parameter: YMIN -> "36.9317404"
 Parameter: ZMAX -> "23.0086261"
 Parameter: ZMIN -> "16.0086261"
 SELRPN>     16 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      8 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     62       C1            3.3552
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     62       C2            3.5792
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     62       O22           2.7042
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     91       P             3.4935
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     91       O13           2.7083
39279 NEG      CLA      3        CLA     -**** MEMB     POPC     91       O14           3.8087
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "74" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "71"
Evaluating: 74-71
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.577429047"
Evaluating: 100.116666*(0.577429047-0.5)
 Parameter: XPOS <- "7.75193804"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.326617831"
Evaluating: 100.116666*(0.326617831-0.5)
 Parameter: YPOS <- "-17.3584447"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.73781665"
Evaluating: 127.138691*(0.73781665-0.5)+4.2778237
 Parameter: ZPOS <- "34.5135213"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.5135213" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.5135213" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.102850 XMAX =   20.102850 XAVE =   20.102850
    YMIN =   40.431740 YMAX =   40.431740 YAVE =   40.431740
    ZMIN =   19.508626 ZMAX =   19.508626 ZAVE =   19.508626
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.75193804"
 RDCMND substituted energy or value "?XAVE" to "20.1028504"
Evaluating: 7.75193804-20.1028504
 Parameter: XTRAN <- "-12.3509124"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.3584447"
 RDCMND substituted energy or value "?YAVE" to "40.4317404"
Evaluating: -17.3584447-40.4317404
 Parameter: YTRAN <- "-57.7901851"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.5135213"
 RDCMND substituted energy or value "?ZAVE" to "19.5086261"
Evaluating: 34.5135213-19.5086261
 Parameter: ZTRAN <- "15.0048952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.3509124"
 Parameter: YTRAN -> "-57.7901851"
 Parameter: ZTRAN -> "15.0048952"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -12.350912  -57.790185   15.004895
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897806764"
Evaluating: 0.897806764*360.0
 Parameter: XPHI <- "323.210435"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34672929"
Evaluating: 0.34672929*360.0
 Parameter: YPHI <- "124.822544"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65922733"
Evaluating: 0.65922733*360.0
 Parameter: ZPHI <- "237.321839"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.75193804"
 Parameter: YPOS -> "-17.3584447"
 Parameter: ZPOS -> "34.5135213"
 Parameter: XPHI -> "323.210435"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.800840   -0.598878
    0.000000    0.598878    0.800840

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.75193804"
 Parameter: YPOS -> "-17.3584447"
 Parameter: ZPOS -> "34.5135213"
 Parameter: YPHI -> "124.822544"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.571037    0.000000   -0.820925
    0.000000    1.000000    0.000000
    0.820925    0.000000   -0.571037

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.75193804"
 Parameter: YPOS -> "-17.3584447"
 Parameter: ZPOS -> "34.5135213"
 Parameter: ZPHI -> "237.321839"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.539920   -0.841717    0.000000
    0.841717   -0.539920    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.751938 XMAX =    7.751938 XAVE =    7.751938
    YMIN =  -17.358445 YMAX =  -17.358445 YAVE =  -17.358445
    ZMIN =   34.513521 ZMAX =   34.513521 ZAVE =   34.513521
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.75193803"
Evaluating: 7.75193803+3.5
 Parameter: XMAX <- "11.251938"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.3584447"
Evaluating: -17.3584447+3.5
 Parameter: YMAX <- "-13.8584447"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.5135213"
Evaluating: 34.5135213+3.5
 Parameter: ZMAX <- "38.0135213"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.75193803"
Evaluating: 7.75193803-3.5
 Parameter: XMIN <- "4.25193803"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.3584447"
Evaluating: -17.3584447-3.5
 Parameter: YMIN <- "-20.8584447"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.5135213"
Evaluating: 34.5135213-3.5
 Parameter: ZMIN <- "31.0135213"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.251938"
 Parameter: XMIN -> "4.25193803"
 Parameter: YMAX -> "-13.8584447"
 Parameter: YMIN -> "-20.8584447"
 Parameter: ZMAX -> "38.0135213"
 Parameter: ZMIN -> "31.0135213"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "75" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "75" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "71"
Evaluating: 75-71
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.867718756"
Evaluating: 100.116666*(0.867718756-0.5)
 Parameter: XPOS <- "36.8147759"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.328068644"
Evaluating: 100.116666*(0.328068644-0.5)
 Parameter: YPOS <- "-17.2131941"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.781047905"
Evaluating: 127.138691*(0.781047905-0.5)+4.2778237
 Parameter: ZPOS <- "40.0098864"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.0098864" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.0098864" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.8147759"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.8147759-0
 Parameter: XTRAN <- "36.8147759"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.2131941"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.2131941-0
 Parameter: YTRAN <- "-17.2131941"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.0098864"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.0098864-0
 Parameter: ZTRAN <- "40.0098864"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.8147759"
 Parameter: YTRAN -> "-17.2131941"
 Parameter: ZTRAN -> "40.0098864"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    36.814776  -17.213194   40.009886
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.579505813"
Evaluating: 0.579505813*360.0
 Parameter: XPHI <- "208.622093"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.988103213"
Evaluating: 0.988103213*360.0
 Parameter: YPHI <- "355.717157"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815730538"
Evaluating: 0.815730538*360.0
 Parameter: ZPHI <- "293.662994"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.8147759"
 Parameter: YPOS -> "-17.2131941"
 Parameter: ZPOS -> "40.0098864"
 Parameter: XPHI -> "208.622093"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.877798   -0.479030
    0.000000    0.479030   -0.877798

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  151.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.8147759"
 Parameter: YPOS -> "-17.2131941"
 Parameter: ZPOS -> "40.0098864"
 Parameter: YPHI -> "355.717157"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.997208    0.000000    0.074680
    0.000000    1.000000    0.000000
   -0.074680    0.000000    0.997208

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.8147759"
 Parameter: YPOS -> "-17.2131941"
 Parameter: ZPOS -> "40.0098864"
 Parameter: ZPHI -> "293.662994"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.401356   -0.915922    0.000000
    0.915922    0.401356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.814776 XMAX =   36.814776 XAVE =   36.814776
    YMIN =  -17.213194 YMAX =  -17.213194 YAVE =  -17.213194
    ZMIN =   40.009886 ZMAX =   40.009886 ZAVE =   40.009886
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.8147759"
Evaluating: 36.8147759+3.5
 Parameter: XMAX <- "40.3147759"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.2131941"
Evaluating: -17.2131941+3.5
 Parameter: YMAX <- "-13.7131941"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.0098864"
Evaluating: 40.0098864+3.5
 Parameter: ZMAX <- "43.5098864"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.8147759"
Evaluating: 36.8147759-3.5
 Parameter: XMIN <- "33.3147759"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.2131941"
Evaluating: -17.2131941-3.5
 Parameter: YMIN <- "-20.7131941"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.0098864"
Evaluating: 40.0098864-3.5
 Parameter: ZMIN <- "36.5098864"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.3147759"
 Parameter: XMIN -> "33.3147759"
 Parameter: YMAX -> "-13.7131941"
 Parameter: YMIN -> "-20.7131941"
 Parameter: ZMAX -> "43.5098864"
 Parameter: ZMIN -> "36.5098864"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "76" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "76" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "71"
Evaluating: 76-71
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.354928573"
Evaluating: 100.116666*(0.354928573-0.5)
 Parameter: XPOS <- "-14.5240676"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.427540585"
Evaluating: 100.116666*(0.427540585-0.5)
 Parameter: YPOS <- "-7.25439505"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.281819951"
Evaluating: 127.138691*(0.281819951-0.5)+4.2778237
 Parameter: ZPOS <- "-23.4613021"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.4613021" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.5240676"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.5240676-0
 Parameter: XTRAN <- "-14.5240676"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.25439505"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.25439505-0
 Parameter: YTRAN <- "-7.25439505"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.4613021"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.4613021-0
 Parameter: ZTRAN <- "-23.4613021"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.5240676"
 Parameter: YTRAN -> "-7.25439505"
 Parameter: ZTRAN -> "-23.4613021"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -14.524068   -7.254395  -23.461302
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99258696"
Evaluating: 0.99258696*360.0
 Parameter: XPHI <- "357.331306"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835264112"
Evaluating: 0.835264112*360.0
 Parameter: YPHI <- "300.69508"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172501143"
Evaluating: 0.172501143*360.0
 Parameter: ZPHI <- "62.1004115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.5240676"
 Parameter: YPOS -> "-7.25439505"
 Parameter: ZPOS -> "-23.4613021"
 Parameter: XPHI -> "357.331306"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998915   -0.046561
    0.000000    0.046561    0.998915

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.5240676"
 Parameter: YPOS -> "-7.25439505"
 Parameter: ZPOS -> "-23.4613021"
 Parameter: YPHI -> "300.69508"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.510469    0.000000    0.859896
    0.000000    1.000000    0.000000
   -0.859896    0.000000    0.510469

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.5240676"
 Parameter: YPOS -> "-7.25439505"
 Parameter: ZPOS -> "-23.4613021"
 Parameter: ZPHI -> "62.1004115"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.467923    0.883769    0.000000
   -0.883769    0.467923    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.524068 XMAX =  -14.524068 XAVE =  -14.524068
    YMIN =   -7.254395 YMAX =   -7.254395 YAVE =   -7.254395
    ZMIN =  -23.461302 ZMAX =  -23.461302 ZAVE =  -23.461302
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.5240676"
Evaluating: -14.5240676+3.5
 Parameter: XMAX <- "-11.0240676"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.25439505"
Evaluating: -7.25439505+3.5
 Parameter: YMAX <- "-3.75439505"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.4613021"
Evaluating: -23.4613021+3.5
 Parameter: ZMAX <- "-19.9613021"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.5240676"
Evaluating: -14.5240676-3.5
 Parameter: XMIN <- "-18.0240676"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.25439505"
Evaluating: -7.25439505-3.5
 Parameter: YMIN <- "-10.754395"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.4613021"
Evaluating: -23.4613021-3.5
 Parameter: ZMIN <- "-26.9613021"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.0240676"
 Parameter: XMIN -> "-18.0240676"
 Parameter: YMAX -> "-3.75439505"
 Parameter: YMIN -> "-10.754395"
 Parameter: ZMAX -> "-19.9613021"
 Parameter: ZMIN -> "-26.9613021"
 SELRPN>     35 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     18 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39281 NEG      CLA      5        CLA     -2530 PROA     SER      224      CA            5.0368
39281 NEG      CLA      5        CLA     -2537 PROA     SER      224      C             3.5909
39281 NEG      CLA      5        CLA     -2538 PROA     SER      224      O             3.3309
39281 NEG      CLA      5        CLA     -2539 PROA     HSD      225      N             3.1320
39281 NEG      CLA      5        CLA     -2541 PROA     HSD      225      CA            2.0661
39281 NEG      CLA      5        CLA     -2543 PROA     HSD      225      CB            3.0052
39281 NEG      CLA      5        CLA     -2546 PROA     HSD      225      ND1           3.2605
39281 NEG      CLA      5        CLA     -2548 PROA     HSD      225      CG            3.2159
39281 NEG      CLA      5        CLA     -2554 PROA     HSD      225      C             0.8298
39281 NEG      CLA      5        CLA     -2555 PROA     HSD      225      O             1.8065
39281 NEG      CLA      5        CLA     -2556 PROA     PRO      226      N             0.5210
39281 NEG      CLA      5        CLA     -2557 PROA     PRO      226      CD            1.7777
39281 NEG      CLA      5        CLA     -2560 PROA     PRO      226      CA            1.8449
39281 NEG      CLA      5        CLA     -2562 PROA     PRO      226      CB            2.8427
39281 NEG      CLA      5        CLA     -2565 PROA     PRO      226      CG            2.8212
39281 NEG      CLA      5        CLA     -2568 PROA     PRO      226      C             2.8156
39281 NEG      CLA      5        CLA     -2569 PROA     PRO      226      O             3.1973
39281 NEG      CLA      5        CLA     -2570 PROA     THR      227      N             3.8207
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        18
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "76" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "71"
Evaluating: 76-71
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.674427159"
Evaluating: 100.116666*(0.674427159-0.5)
 Parameter: XPOS <- "17.4630656"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "2.339509346E-02"
Evaluating: 100.116666*(2.339509346E-02-0.5)
 Parameter: YPOS <- "-47.7160942"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.283705313"
Evaluating: 127.138691*(0.283705313-0.5)+4.2778237
 Parameter: ZPOS <- "-23.2215997"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.2215997" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.524068 XMAX =  -14.524068 XAVE =  -14.524068
    YMIN =   -7.254395 YMAX =   -7.254395 YAVE =   -7.254395
    ZMIN =  -23.461302 ZMAX =  -23.461302 ZAVE =  -23.461302
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.4630656"
 RDCMND substituted energy or value "?XAVE" to "-14.5240676"
Evaluating: 17.4630656--14.5240676
 Parameter: XTRAN <- "31.9871332"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.7160942"
 RDCMND substituted energy or value "?YAVE" to "-7.25439505"
Evaluating: -47.7160942--7.25439505
 Parameter: YTRAN <- "-40.4616992"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.2215997"
 RDCMND substituted energy or value "?ZAVE" to "-23.4613021"
Evaluating: -23.2215997--23.4613021
 Parameter: ZTRAN <- "0.2397024"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.9871332"
 Parameter: YTRAN -> "-40.4616992"
 Parameter: ZTRAN -> "0.2397024"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    31.987133  -40.461699    0.239702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297260599"
Evaluating: 0.297260599*360.0
 Parameter: XPHI <- "107.013816"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136956208"
Evaluating: 0.136956208*360.0
 Parameter: YPHI <- "49.3042349"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.216246712"
Evaluating: 0.216246712*360.0
 Parameter: ZPHI <- "77.8488163"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.4630656"
 Parameter: YPOS -> "-47.7160942"
 Parameter: ZPOS -> "-23.2215997"
 Parameter: XPHI -> "107.013816"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.292602    0.956234
    0.000000   -0.956234   -0.292602

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  107.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.4630656"
 Parameter: YPOS -> "-47.7160942"
 Parameter: ZPOS -> "-23.2215997"
 Parameter: YPHI -> "49.3042349"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.652042    0.000000   -0.758183
    0.000000    1.000000    0.000000
    0.758183    0.000000    0.652042

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.4630656"
 Parameter: YPOS -> "-47.7160942"
 Parameter: ZPOS -> "-23.2215997"
 Parameter: ZPHI -> "77.8488163"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.210492    0.977596    0.000000
   -0.977596    0.210492    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   77.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.463066 XMAX =   17.463066 XAVE =   17.463066
    YMIN =  -47.716094 YMAX =  -47.716094 YAVE =  -47.716094
    ZMIN =  -23.221600 ZMAX =  -23.221600 ZAVE =  -23.221600
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.4630656"
Evaluating: 17.4630656+3.5
 Parameter: XMAX <- "20.9630656"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.7160942"
Evaluating: -47.7160942+3.5
 Parameter: YMAX <- "-44.2160942"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.2215997"
Evaluating: -23.2215997+3.5
 Parameter: ZMAX <- "-19.7215997"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.4630656"
Evaluating: 17.4630656-3.5
 Parameter: XMIN <- "13.9630656"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.7160942"
Evaluating: -47.7160942-3.5
 Parameter: YMIN <- "-51.2160942"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.2215997"
Evaluating: -23.2215997-3.5
 Parameter: ZMIN <- "-26.7215997"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.9630656"
 Parameter: XMIN -> "13.9630656"
 Parameter: YMAX -> "-44.2160942"
 Parameter: YMIN -> "-51.2160942"
 Parameter: ZMAX -> "-19.7215997"
 Parameter: ZMIN -> "-26.7215997"
 SELRPN>      7 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      4 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39281 NEG      CLA      5        CLA     -**** MEMB     POPC     208      O14           3.7867
39281 NEG      CLA      5        CLA     -**** MEMB     POPC     208      O11           3.4360
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "76" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "71"
Evaluating: 76-71
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.763347804"
Evaluating: 100.116666*(0.763347804-0.5)
 Parameter: XPOS <- "26.3655041"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.801372683"
Evaluating: 100.116666*(0.801372683-0.5)
 Parameter: YPOS <- "30.1724282"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.284338417"
Evaluating: 127.138691*(0.284338417-0.5)+4.2778237
 Parameter: ZPOS <- "-23.1411077"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.1411077" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.463066 XMAX =   17.463066 XAVE =   17.463066
    YMIN =  -47.716094 YMAX =  -47.716094 YAVE =  -47.716094
    ZMIN =  -23.221600 ZMAX =  -23.221600 ZAVE =  -23.221600
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.3655041"
 RDCMND substituted energy or value "?XAVE" to "17.4630656"
Evaluating: 26.3655041-17.4630656
 Parameter: XTRAN <- "8.9024385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.1724282"
 RDCMND substituted energy or value "?YAVE" to "-47.7160942"
Evaluating: 30.1724282--47.7160942
 Parameter: YTRAN <- "77.8885224"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.1411077"
 RDCMND substituted energy or value "?ZAVE" to "-23.2215997"
Evaluating: -23.1411077--23.2215997
 Parameter: ZTRAN <- "8.0492E-02"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.9024385"
 Parameter: YTRAN -> "77.8885224"
 Parameter: ZTRAN -> "8.0492E-02"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     8.902439   77.888522    0.080492
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864148332"
Evaluating: 0.864148332*360.0
 Parameter: XPHI <- "311.0934"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67575948"
Evaluating: 0.67575948*360.0
 Parameter: YPHI <- "243.273413"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.526210966"
Evaluating: 0.526210966*360.0
 Parameter: ZPHI <- "189.435948"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.3655041"
 Parameter: YPOS -> "30.1724282"
 Parameter: ZPOS -> "-23.1411077"
 Parameter: XPHI -> "311.0934"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.657288   -0.753639
    0.000000    0.753639    0.657288

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.3655041"
 Parameter: YPOS -> "30.1724282"
 Parameter: ZPOS -> "-23.1411077"
 Parameter: YPHI -> "243.273413"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.449734    0.000000    0.893163
    0.000000    1.000000    0.000000
   -0.893163    0.000000   -0.449734

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.3655041"
 Parameter: YPOS -> "30.1724282"
 Parameter: ZPOS -> "-23.1411077"
 Parameter: ZPHI -> "189.435948"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.986469   -0.163945    0.000000
    0.163945   -0.986469    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  170.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.365504 XMAX =   26.365504 XAVE =   26.365504
    YMIN =   30.172428 YMAX =   30.172428 YAVE =   30.172428
    ZMIN =  -23.141108 ZMAX =  -23.141108 ZAVE =  -23.141108
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.3655041"
Evaluating: 26.3655041+3.5
 Parameter: XMAX <- "29.8655041"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.1724282"
Evaluating: 30.1724282+3.5
 Parameter: YMAX <- "33.6724282"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.1411077"
Evaluating: -23.1411077+3.5
 Parameter: ZMAX <- "-19.6411077"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.3655041"
Evaluating: 26.3655041-3.5
 Parameter: XMIN <- "22.8655041"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.1724282"
Evaluating: 30.1724282-3.5
 Parameter: YMIN <- "26.6724282"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.1411077"
Evaluating: -23.1411077-3.5
 Parameter: ZMIN <- "-26.6411077"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.8655041"
 Parameter: XMIN -> "22.8655041"
 Parameter: YMAX -> "33.6724282"
 Parameter: YMIN -> "26.6724282"
 Parameter: ZMAX -> "-19.6411077"
 Parameter: ZMIN -> "-26.6411077"
 SELRPN>      5 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      2 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "77" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "77" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "71"
Evaluating: 77-71
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.748998981"
Evaluating: 100.116666*(0.748998981-0.5)
 Parameter: XPOS <- "24.9289478"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.995526422"
Evaluating: 100.116666*(0.995526422-0.5)
 Parameter: YPOS <- "49.6104533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.469043418"
Evaluating: 127.138691*(0.469043418-0.5)+4.2778237
 Parameter: ZPOS <- "0.342044387"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.342044387" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.342044387" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "77" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "71"
Evaluating: 77-71
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.623714871"
Evaluating: 100.116666*(0.623714871-0.5)
 Parameter: XPOS <- "12.3859204"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.521453256"
Evaluating: 100.116666*(0.521453256-0.5)
 Parameter: YPOS <- "2.14782847"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.30547429"
Evaluating: 127.138691*(0.30547429-0.5)+4.2778237
 Parameter: ZPOS <- "-20.4539204"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.4539204" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.3859204"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.3859204-0
 Parameter: XTRAN <- "12.3859204"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.14782847"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.14782847-0
 Parameter: YTRAN <- "2.14782847"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.4539204"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.4539204-0
 Parameter: ZTRAN <- "-20.4539204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.3859204"
 Parameter: YTRAN -> "2.14782847"
 Parameter: ZTRAN -> "-20.4539204"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    12.385920    2.147828  -20.453920
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.34455822"
Evaluating: 0.34455822*360.0
 Parameter: XPHI <- "124.040959"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406964898"
Evaluating: 0.406964898*360.0
 Parameter: YPHI <- "146.507363"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541911545"
Evaluating: 0.541911545*360.0
 Parameter: ZPHI <- "195.088156"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.3859204"
 Parameter: YPOS -> "2.14782847"
 Parameter: ZPOS -> "-20.4539204"
 Parameter: XPHI -> "124.040959"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.559785    0.828638
    0.000000   -0.828638   -0.559785

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.3859204"
 Parameter: YPOS -> "2.14782847"
 Parameter: ZPOS -> "-20.4539204"
 Parameter: YPHI -> "146.507363"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.833957    0.000000   -0.551830
    0.000000    1.000000    0.000000
    0.551830    0.000000   -0.833957

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.3859204"
 Parameter: YPOS -> "2.14782847"
 Parameter: ZPOS -> "-20.4539204"
 Parameter: ZPHI -> "195.088156"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.965526   -0.260305    0.000000
    0.260305   -0.965526    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.385920 XMAX =   12.385920 XAVE =   12.385920
    YMIN =    2.147828 YMAX =    2.147828 YAVE =    2.147828
    ZMIN =  -20.453920 ZMAX =  -20.453920 ZAVE =  -20.453920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.3859204"
Evaluating: 12.3859204+3.5
 Parameter: XMAX <- "15.8859204"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.14782847"
Evaluating: 2.14782847+3.5
 Parameter: YMAX <- "5.64782847"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.4539204"
Evaluating: -20.4539204+3.5
 Parameter: ZMAX <- "-16.9539204"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.3859204"
Evaluating: 12.3859204-3.5
 Parameter: XMIN <- "8.8859204"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.14782847"
Evaluating: 2.14782847-3.5
 Parameter: YMIN <- "-1.35217153"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.4539204"
Evaluating: -20.4539204-3.5
 Parameter: ZMIN <- "-23.9539204"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.8859204"
 Parameter: XMIN -> "8.8859204"
 Parameter: YMAX -> "5.64782847"
 Parameter: YMIN -> "-1.35217153"
 Parameter: ZMAX -> "-16.9539204"
 Parameter: ZMIN -> "-23.9539204"
 SELRPN>      7 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      3 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39282 NEG      CLA      6        CLA     -4055 PROA     GLU      312      CD            4.4466
39282 NEG      CLA      6        CLA     -4057 PROA     GLU      312      OE2           3.2349
39282 NEG      CLA      6        CLA     -4133 PROA     THR      317      CG2           3.9442
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "77" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "71"
Evaluating: 77-71
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.822704607"
Evaluating: 100.116666*(0.822704607-0.5)
 Parameter: XPOS <- "32.3081094"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.470820529"
Evaluating: 100.116666*(0.470820529-0.5)
 Parameter: YPOS <- "-2.92135135"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.701406397"
Evaluating: 127.138691*(0.701406397-0.5)+4.2778237
 Parameter: ZPOS <- "29.8843694"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.8843694" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.8843694" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.385920 XMAX =   12.385920 XAVE =   12.385920
    YMIN =    2.147828 YMAX =    2.147828 YAVE =    2.147828
    ZMIN =  -20.453920 ZMAX =  -20.453920 ZAVE =  -20.453920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.3081094"
 RDCMND substituted energy or value "?XAVE" to "12.3859204"
Evaluating: 32.3081094-12.3859204
 Parameter: XTRAN <- "19.922189"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.92135135"
 RDCMND substituted energy or value "?YAVE" to "2.14782847"
Evaluating: -2.92135135-2.14782847
 Parameter: YTRAN <- "-5.06917982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.8843694"
 RDCMND substituted energy or value "?ZAVE" to "-20.4539204"
Evaluating: 29.8843694--20.4539204
 Parameter: ZTRAN <- "50.3382898"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.922189"
 Parameter: YTRAN -> "-5.06917982"
 Parameter: ZTRAN -> "50.3382898"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    19.922189   -5.069180   50.338290
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346756562"
Evaluating: 0.346756562*360.0
 Parameter: XPHI <- "124.832362"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935238243"
Evaluating: 0.935238243*360.0
 Parameter: YPHI <- "336.685767"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.311615401"
Evaluating: 0.311615401*360.0
 Parameter: ZPHI <- "112.181544"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.3081094"
 Parameter: YPOS -> "-2.92135135"
 Parameter: ZPOS -> "29.8843694"
 Parameter: XPHI -> "124.832362"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.571177    0.820827
    0.000000   -0.820827   -0.571177

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.3081094"
 Parameter: YPOS -> "-2.92135135"
 Parameter: ZPOS -> "29.8843694"
 Parameter: YPHI -> "336.685767"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.918348    0.000000    0.395774
    0.000000    1.000000    0.000000
   -0.395774    0.000000    0.918348

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   23.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.3081094"
 Parameter: YPOS -> "-2.92135135"
 Parameter: ZPOS -> "29.8843694"
 Parameter: ZPHI -> "112.181544"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.377543    0.925992    0.000000
   -0.925992   -0.377543    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.308109 XMAX =   32.308109 XAVE =   32.308109
    YMIN =   -2.921351 YMAX =   -2.921351 YAVE =   -2.921351
    ZMIN =   29.884369 ZMAX =   29.884369 ZAVE =   29.884369
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.3081094"
Evaluating: 32.3081094+3.5
 Parameter: XMAX <- "35.8081094"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.92135135"
Evaluating: -2.92135135+3.5
 Parameter: YMAX <- "0.57864865"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.8843694"
Evaluating: 29.8843694+3.5
 Parameter: ZMAX <- "33.3843694"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.3081094"
Evaluating: 32.3081094-3.5
 Parameter: XMIN <- "28.8081094"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.92135135"
Evaluating: -2.92135135-3.5
 Parameter: YMIN <- "-6.42135135"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.8843694"
Evaluating: 29.8843694-3.5
 Parameter: ZMIN <- "26.3843694"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.8081094"
 Parameter: XMIN -> "28.8081094"
 Parameter: YMAX -> "0.57864865"
 Parameter: YMIN -> "-6.42135135"
 Parameter: ZMAX -> "33.3843694"
 Parameter: ZMIN -> "26.3843694"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "78" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "78" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "71"
Evaluating: 78-71
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.263235401"
Evaluating: 100.116666*(0.263235401-0.5)
 Parameter: XPOS <- "-23.7040823"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.73256723"
Evaluating: 100.116666*(0.73256723-0.5)
 Parameter: YPOS <- "23.2838557"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.400937747"
Evaluating: 127.138691*(0.400937747-0.5)+4.2778237
 Parameter: ZPOS <- "-8.31682147"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-8.31682147" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-8.31682147" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "78" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "71"
Evaluating: 78-71
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.622953211"
Evaluating: 100.116666*(0.622953211-0.5)
 Parameter: XPOS <- "12.3096656"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.163196887"
Evaluating: 100.116666*(0.163196887-0.5)
 Parameter: YPOS <- "-33.7196048"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.639306143"
Evaluating: 127.138691*(0.639306143-0.5)+4.2778237
 Parameter: ZPOS <- "21.9890244"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.9890244" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.9890244" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.3096656"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.3096656-0
 Parameter: XTRAN <- "12.3096656"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.7196048"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.7196048-0
 Parameter: YTRAN <- "-33.7196048"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.9890244"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.9890244-0
 Parameter: ZTRAN <- "21.9890244"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.3096656"
 Parameter: YTRAN -> "-33.7196048"
 Parameter: ZTRAN -> "21.9890244"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    12.309666  -33.719605   21.989024
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31820291"
Evaluating: 0.31820291*360.0
 Parameter: XPHI <- "114.553048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982267897"
Evaluating: 0.982267897*360.0
 Parameter: YPHI <- "353.616443"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.409087576E-03"
Evaluating: 5.409087576E-03*360.0
 Parameter: ZPHI <- "1.94727153"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.3096656"
 Parameter: YPOS -> "-33.7196048"
 Parameter: ZPOS -> "21.9890244"
 Parameter: XPHI -> "114.553048"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.415536    0.909577
    0.000000   -0.909577   -0.415536

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.3096656"
 Parameter: YPOS -> "-33.7196048"
 Parameter: ZPOS -> "21.9890244"
 Parameter: YPHI -> "353.616443"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.993800    0.000000    0.111184
    0.000000    1.000000    0.000000
   -0.111184    0.000000    0.993800

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    6.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.3096656"
 Parameter: YPOS -> "-33.7196048"
 Parameter: ZPOS -> "21.9890244"
 Parameter: ZPHI -> "1.94727153"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999423    0.033980    0.000000
   -0.033980    0.999423    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    1.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.309666 XMAX =   12.309666 XAVE =   12.309666
    YMIN =  -33.719605 YMAX =  -33.719605 YAVE =  -33.719605
    ZMIN =   21.989024 ZMAX =   21.989024 ZAVE =   21.989024
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.3096656"
Evaluating: 12.3096656+3.5
 Parameter: XMAX <- "15.8096656"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.7196048"
Evaluating: -33.7196048+3.5
 Parameter: YMAX <- "-30.2196048"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.9890244"
Evaluating: 21.9890244+3.5
 Parameter: ZMAX <- "25.4890244"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.3096656"
Evaluating: 12.3096656-3.5
 Parameter: XMIN <- "8.8096656"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.7196048"
Evaluating: -33.7196048-3.5
 Parameter: YMIN <- "-37.2196048"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.9890244"
Evaluating: 21.9890244-3.5
 Parameter: ZMIN <- "18.4890244"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.8096656"
 Parameter: XMIN -> "8.8096656"
 Parameter: YMAX -> "-30.2196048"
 Parameter: YMIN -> "-37.2196048"
 Parameter: ZMAX -> "25.4890244"
 Parameter: ZMIN -> "18.4890244"
 SELRPN>     19 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      7 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39283 NEG      CLA      7        CLA     -**** MEMB     POPC     49       N             3.3981
39283 NEG      CLA      7        CLA     -**** MEMB     POPC     49       C13           3.5612
39283 NEG      CLA      7        CLA     -**** MEMB     POPC     49       C15           2.1603
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "78" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "71"
Evaluating: 78-71
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.62377916"
Evaluating: 100.116666*(0.62377916-0.5)
 Parameter: XPOS <- "12.3923568"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.784354406"
Evaluating: 100.116666*(0.784354406-0.5)
 Parameter: YPOS <- "28.4686151"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.660506308"
Evaluating: 127.138691*(0.660506308-0.5)+4.2778237
 Parameter: ZPOS <- "24.6843856"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.6843856" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.6843856" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.309666 XMAX =   12.309666 XAVE =   12.309666
    YMIN =  -33.719605 YMAX =  -33.719605 YAVE =  -33.719605
    ZMIN =   21.989024 ZMAX =   21.989024 ZAVE =   21.989024
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.3923568"
 RDCMND substituted energy or value "?XAVE" to "12.3096656"
Evaluating: 12.3923568-12.3096656
 Parameter: XTRAN <- "8.26912E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.4686151"
 RDCMND substituted energy or value "?YAVE" to "-33.7196048"
Evaluating: 28.4686151--33.7196048
 Parameter: YTRAN <- "62.1882199"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.6843856"
 RDCMND substituted energy or value "?ZAVE" to "21.9890244"
Evaluating: 24.6843856-21.9890244
 Parameter: ZTRAN <- "2.6953612"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.26912E-02"
 Parameter: YTRAN -> "62.1882199"
 Parameter: ZTRAN -> "2.6953612"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     0.082691   62.188220    2.695361
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938962293"
Evaluating: 0.938962293*360.0
 Parameter: XPHI <- "338.026425"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793213654"
Evaluating: 0.793213654*360.0
 Parameter: YPHI <- "285.556915"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.462884927"
Evaluating: 0.462884927*360.0
 Parameter: ZPHI <- "166.638574"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.3923568"
 Parameter: YPOS -> "28.4686151"
 Parameter: ZPOS -> "24.6843856"
 Parameter: XPHI -> "338.026425"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.927357   -0.374179
    0.000000    0.374179    0.927357

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   21.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.3923568"
 Parameter: YPOS -> "28.4686151"
 Parameter: ZPOS -> "24.6843856"
 Parameter: YPHI -> "285.556915"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.268195    0.000000    0.963365
    0.000000    1.000000    0.000000
   -0.963365    0.000000    0.268195

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.3923568"
 Parameter: YPOS -> "28.4686151"
 Parameter: ZPOS -> "24.6843856"
 Parameter: ZPHI -> "166.638574"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.972932    0.231093    0.000000
   -0.231093   -0.972932    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  166.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.392357 XMAX =   12.392357 XAVE =   12.392357
    YMIN =   28.468615 YMAX =   28.468615 YAVE =   28.468615
    ZMIN =   24.684386 ZMAX =   24.684386 ZAVE =   24.684386
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.3923568"
Evaluating: 12.3923568+3.5
 Parameter: XMAX <- "15.8923568"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.4686151"
Evaluating: 28.4686151+3.5
 Parameter: YMAX <- "31.9686151"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.6843856"
Evaluating: 24.6843856+3.5
 Parameter: ZMAX <- "28.1843856"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.3923568"
Evaluating: 12.3923568-3.5
 Parameter: XMIN <- "8.8923568"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.4686151"
Evaluating: 28.4686151-3.5
 Parameter: YMIN <- "24.9686151"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.6843856"
Evaluating: 24.6843856-3.5
 Parameter: ZMIN <- "21.1843856"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.8923568"
 Parameter: XMIN -> "8.8923568"
 Parameter: YMAX -> "31.9686151"
 Parameter: YMIN -> "24.9686151"
 Parameter: ZMAX -> "28.1843856"
 Parameter: ZMIN -> "21.1843856"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "79" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "79" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "71"
Evaluating: 79-71
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.721616772"
Evaluating: 100.116666*(0.721616772-0.5)
 Parameter: XPOS <- "22.1875323"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.81281986"
Evaluating: 100.116666*(0.81281986-0.5)
 Parameter: YPOS <- "31.3184814"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.358010322"
Evaluating: 127.138691*(0.358010322-0.5)+4.2778237
 Parameter: ZPOS <- "-13.7745581"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.7745581" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.7745581" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "79" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "71"
Evaluating: 79-71
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.419747471"
Evaluating: 100.116666*(0.419747471-0.5)
 Parameter: XPOS <- "-8.03461564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.928293327"
Evaluating: 100.116666*(0.928293327-0.5)
 Parameter: YPOS <- "42.8793"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.408346437"
Evaluating: 127.138691*(0.408346437-0.5)+4.2778237
 Parameter: ZPOS <- "-7.37489033"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.37489033" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.37489033" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "79" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "71"
Evaluating: 79-71
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.326713428"
Evaluating: 100.116666*(0.326713428-0.5)
 Parameter: XPOS <- "-17.3488739"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.746005645"
Evaluating: 100.116666*(0.746005645-0.5)
 Parameter: YPOS <- "24.629265"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.676599922"
Evaluating: 127.138691*(0.676599922-0.5)+4.2778237
 Parameter: ZPOS <- "26.7305066"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.7305066" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.7305066" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.3488739"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.3488739-0
 Parameter: XTRAN <- "-17.3488739"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.629265"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.629265-0
 Parameter: YTRAN <- "24.629265"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.7305066"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.7305066-0
 Parameter: ZTRAN <- "26.7305066"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.3488739"
 Parameter: YTRAN -> "24.629265"
 Parameter: ZTRAN -> "26.7305066"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -17.348874   24.629265   26.730507
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319764908"
Evaluating: 0.319764908*360.0
 Parameter: XPHI <- "115.115367"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800329555"
Evaluating: 0.800329555*360.0
 Parameter: YPHI <- "288.11864"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598021076"
Evaluating: 0.598021076*360.0
 Parameter: ZPHI <- "215.287587"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.3488739"
 Parameter: YPOS -> "24.629265"
 Parameter: ZPOS -> "26.7305066"
 Parameter: XPHI -> "115.115367"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.424442    0.905455
    0.000000   -0.905455   -0.424442

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.3488739"
 Parameter: YPOS -> "24.629265"
 Parameter: ZPOS -> "26.7305066"
 Parameter: YPHI -> "288.11864"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.310986    0.000000    0.950415
    0.000000    1.000000    0.000000
   -0.950415    0.000000    0.310986

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.3488739"
 Parameter: YPOS -> "24.629265"
 Parameter: ZPOS -> "26.7305066"
 Parameter: ZPHI -> "215.287587"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.816263   -0.577681    0.000000
    0.577681   -0.816263    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.348874 XMAX =  -17.348874 XAVE =  -17.348874
    YMIN =   24.629265 YMAX =   24.629265 YAVE =   24.629265
    ZMIN =   26.730507 ZMAX =   26.730507 ZAVE =   26.730507
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.3488739"
Evaluating: -17.3488739+3.5
 Parameter: XMAX <- "-13.8488739"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.629265"
Evaluating: 24.629265+3.5
 Parameter: YMAX <- "28.129265"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.7305066"
Evaluating: 26.7305066+3.5
 Parameter: ZMAX <- "30.2305066"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.3488739"
Evaluating: -17.3488739-3.5
 Parameter: XMIN <- "-20.8488739"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.629265"
Evaluating: 24.629265-3.5
 Parameter: YMIN <- "21.129265"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.7305066"
Evaluating: 26.7305066-3.5
 Parameter: ZMIN <- "23.2305066"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.8488739"
 Parameter: XMIN -> "-20.8488739"
 Parameter: YMAX -> "28.129265"
 Parameter: YMIN -> "21.129265"
 Parameter: ZMAX -> "30.2305066"
 Parameter: ZMIN -> "23.2305066"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "80" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "80" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "71"
Evaluating: 80-71
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.639670502"
Evaluating: 100.116666*(0.639670502-0.5)
 Parameter: XPOS <- "13.983345"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.137144659"
Evaluating: 100.116666*(0.137144659-0.5)
 Parameter: YPOS <- "-36.327867"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.188136851"
Evaluating: 127.138691*(0.188136851-0.5)+4.2778237
 Parameter: ZPOS <- "-35.3720488"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.3720488" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.983345"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.983345-0
 Parameter: XTRAN <- "13.983345"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.327867"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -36.327867-0
 Parameter: YTRAN <- "-36.327867"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.3720488"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -35.3720488-0
 Parameter: ZTRAN <- "-35.3720488"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.983345"
 Parameter: YTRAN -> "-36.327867"
 Parameter: ZTRAN -> "-35.3720488"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    13.983345  -36.327867  -35.372049
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987651863"
Evaluating: 0.987651863*360.0
 Parameter: XPHI <- "355.554671"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214424856"
Evaluating: 0.214424856*360.0
 Parameter: YPHI <- "77.1929482"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492956082"
Evaluating: 0.492956082*360.0
 Parameter: ZPHI <- "177.46419"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.983345"
 Parameter: YPOS -> "-36.327867"
 Parameter: ZPOS -> "-35.3720488"
 Parameter: XPHI -> "355.554671"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996992   -0.077508
    0.000000    0.077508    0.996992

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    4.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.983345"
 Parameter: YPOS -> "-36.327867"
 Parameter: ZPOS -> "-35.3720488"
 Parameter: YPHI -> "77.1929482"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.221669    0.000000   -0.975122
    0.000000    1.000000    0.000000
    0.975122    0.000000    0.221669

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.983345"
 Parameter: YPOS -> "-36.327867"
 Parameter: ZPOS -> "-35.3720488"
 Parameter: ZPHI -> "177.46419"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999021    0.044244    0.000000
   -0.044244   -0.999021    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  177.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.983345 XMAX =   13.983345 XAVE =   13.983345
    YMIN =  -36.327867 YMAX =  -36.327867 YAVE =  -36.327867
    ZMIN =  -35.372049 ZMAX =  -35.372049 ZAVE =  -35.372049
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.983345"
Evaluating: 13.983345+3.5
 Parameter: XMAX <- "17.483345"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.327867"
Evaluating: -36.327867+3.5
 Parameter: YMAX <- "-32.827867"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.3720488"
Evaluating: -35.3720488+3.5
 Parameter: ZMAX <- "-31.8720488"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.983345"
Evaluating: 13.983345-3.5
 Parameter: XMIN <- "10.483345"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.327867"
Evaluating: -36.327867-3.5
 Parameter: YMIN <- "-39.827867"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.3720488"
Evaluating: -35.3720488-3.5
 Parameter: ZMIN <- "-38.8720488"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.483345"
 Parameter: XMIN -> "10.483345"
 Parameter: YMAX -> "-32.827867"
 Parameter: YMIN -> "-39.827867"
 Parameter: ZMAX -> "-31.8720488"
 Parameter: ZMIN -> "-38.8720488"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "81" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "81" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "71"
Evaluating: 81-71
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.451703992"
Evaluating: 100.116666*(0.451703992-0.5)
 Parameter: XPOS <- "-4.8352353"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.471915801"
Evaluating: 100.116666*(0.471915801-0.5)
 Parameter: YPOS <- "-2.81169637"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.703359161"
Evaluating: 127.138691*(0.703359161-0.5)+4.2778237
 Parameter: ZPOS <- "30.1326412"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.1326412" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.1326412" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.8352353"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.8352353-0
 Parameter: XTRAN <- "-4.8352353"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.81169637"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.81169637-0
 Parameter: YTRAN <- "-2.81169637"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.1326412"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 30.1326412-0
 Parameter: ZTRAN <- "30.1326412"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.8352353"
 Parameter: YTRAN -> "-2.81169637"
 Parameter: ZTRAN -> "30.1326412"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -4.835235   -2.811696   30.132641
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310698754"
Evaluating: 0.310698754*360.0
 Parameter: XPHI <- "111.851551"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817373094"
Evaluating: 0.817373094*360.0
 Parameter: YPHI <- "294.254314"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744181138"
Evaluating: 0.744181138*360.0
 Parameter: ZPHI <- "267.90521"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.8352353"
 Parameter: YPOS -> "-2.81169637"
 Parameter: ZPOS -> "30.1326412"
 Parameter: XPHI -> "111.851551"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.372203    0.928151
    0.000000   -0.928151   -0.372203

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.8352353"
 Parameter: YPOS -> "-2.81169637"
 Parameter: ZPOS -> "30.1326412"
 Parameter: YPHI -> "294.254314"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.410788    0.000000    0.911731
    0.000000    1.000000    0.000000
   -0.911731    0.000000    0.410788

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.8352353"
 Parameter: YPOS -> "-2.81169637"
 Parameter: ZPOS -> "30.1326412"
 Parameter: ZPHI -> "267.90521"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.036553   -0.999332    0.000000
    0.999332   -0.036553    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.835235 XMAX =   -4.835235 XAVE =   -4.835235
    YMIN =   -2.811696 YMAX =   -2.811696 YAVE =   -2.811696
    ZMIN =   30.132641 ZMAX =   30.132641 ZAVE =   30.132641
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.8352353"
Evaluating: -4.8352353+3.5
 Parameter: XMAX <- "-1.3352353"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.81169637"
Evaluating: -2.81169637+3.5
 Parameter: YMAX <- "0.68830363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.1326412"
Evaluating: 30.1326412+3.5
 Parameter: ZMAX <- "33.6326412"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.8352353"
Evaluating: -4.8352353-3.5
 Parameter: XMIN <- "-8.3352353"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.81169637"
Evaluating: -2.81169637-3.5
 Parameter: YMIN <- "-6.31169637"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.1326412"
Evaluating: 30.1326412-3.5
 Parameter: ZMIN <- "26.6326412"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.3352353"
 Parameter: XMIN -> "-8.3352353"
 Parameter: YMAX -> "0.68830363"
 Parameter: YMIN -> "-6.31169637"
 Parameter: ZMAX -> "33.6326412"
 Parameter: ZMIN -> "26.6326412"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "82" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "82" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "71"
Evaluating: 82-71
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.440245859"
Evaluating: 100.116666*(0.440245859-0.5)
 Parameter: XPOS <- "-5.98238538"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.241622794"
Evaluating: 100.116666*(0.241622794-0.5)
 Parameter: YPOS <- "-25.8678644"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.438713424"
Evaluating: 127.138691*(0.438713424-0.5)+4.2778237
 Parameter: ZPOS <- "-3.51407135"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.51407135" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.51407135" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "82" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "71"
Evaluating: 82-71
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.00299354E-03"
Evaluating: 100.116666*(4.00299354E-03-0.5)
 Parameter: XPOS <- "-49.6575666"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.816270383"
Evaluating: 100.116666*(0.816270383-0.5)
 Parameter: YPOS <- "31.6639363"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.902126388"
Evaluating: 127.138691*(0.902126388-0.5)+4.2778237
 Parameter: ZPOS <- "55.4036463"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.4036463" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.4036463" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-49.6575666"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -49.6575666-0
 Parameter: XTRAN <- "-49.6575666"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.6639363"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.6639363-0
 Parameter: YTRAN <- "31.6639363"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.4036463"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.4036463-0
 Parameter: ZTRAN <- "55.4036463"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.6575666"
 Parameter: YTRAN -> "31.6639363"
 Parameter: ZTRAN -> "55.4036463"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -49.657567   31.663936   55.403646
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.859250418E-02"
Evaluating: 3.859250418E-02*360.0
 Parameter: XPHI <- "13.8933015"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877047859"
Evaluating: 0.877047859*360.0
 Parameter: YPHI <- "315.737229"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.804685883"
Evaluating: 0.804685883*360.0
 Parameter: ZPHI <- "289.686918"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-49.6575666"
 Parameter: YPOS -> "31.6639363"
 Parameter: ZPOS -> "55.4036463"
 Parameter: XPHI -> "13.8933015"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.970745    0.240115
    0.000000   -0.240115    0.970745

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   13.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-49.6575666"
 Parameter: YPOS -> "31.6639363"
 Parameter: ZPOS -> "55.4036463"
 Parameter: YPHI -> "315.737229"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.716146    0.000000    0.697950
    0.000000    1.000000    0.000000
   -0.697950    0.000000    0.716146

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-49.6575666"
 Parameter: YPOS -> "31.6639363"
 Parameter: ZPOS -> "55.4036463"
 Parameter: ZPHI -> "289.686918"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.336880   -0.941547    0.000000
    0.941547    0.336880    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -49.657567 XMAX =  -49.657567 XAVE =  -49.657567
    YMIN =   31.663936 YMAX =   31.663936 YAVE =   31.663936
    ZMIN =   55.403646 ZMAX =   55.403646 ZAVE =   55.403646
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-49.6575666"
Evaluating: -49.6575666+3.5
 Parameter: XMAX <- "-46.1575666"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.6639363"
Evaluating: 31.6639363+3.5
 Parameter: YMAX <- "35.1639363"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.4036463"
Evaluating: 55.4036463+3.5
 Parameter: ZMAX <- "58.9036463"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-49.6575666"
Evaluating: -49.6575666-3.5
 Parameter: XMIN <- "-53.1575666"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.6639363"
Evaluating: 31.6639363-3.5
 Parameter: YMIN <- "28.1639363"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.4036463"
Evaluating: 55.4036463-3.5
 Parameter: ZMIN <- "51.9036463"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-46.1575666"
 Parameter: XMIN -> "-53.1575666"
 Parameter: YMAX -> "35.1639363"
 Parameter: YMIN -> "28.1639363"
 Parameter: ZMAX -> "58.9036463"
 Parameter: ZMIN -> "51.9036463"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "83" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "83" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "71"
Evaluating: 83-71
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.425058586E-02"
Evaluating: 100.116666*(5.425058586E-02-0.5)
 Parameter: XPOS <- "-44.6269452"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.714096862"
Evaluating: 100.116666*(0.714096862-0.5)
 Parameter: YPOS <- "21.434664"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.951688567"
Evaluating: 127.138691*(0.951688567-0.5)+4.2778237
 Parameter: ZPOS <- "61.7049168"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.7049168" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.7049168" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.6269452"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.6269452-0
 Parameter: XTRAN <- "-44.6269452"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.434664"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.434664-0
 Parameter: YTRAN <- "21.434664"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.7049168"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.7049168-0
 Parameter: ZTRAN <- "61.7049168"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.6269452"
 Parameter: YTRAN -> "21.434664"
 Parameter: ZTRAN -> "61.7049168"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -44.626945   21.434664   61.704917
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325843101"
Evaluating: 0.325843101*360.0
 Parameter: XPHI <- "117.303516"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.527053772"
Evaluating: 0.527053772*360.0
 Parameter: YPHI <- "189.739358"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864590876"
Evaluating: 0.864590876*360.0
 Parameter: ZPHI <- "311.252715"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.6269452"
 Parameter: YPOS -> "21.434664"
 Parameter: ZPOS -> "61.7049168"
 Parameter: XPHI -> "117.303516"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.458704    0.888589
    0.000000   -0.888589   -0.458704

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.6269452"
 Parameter: YPOS -> "21.434664"
 Parameter: ZPOS -> "61.7049168"
 Parameter: YPHI -> "189.739358"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.985587    0.000000    0.169166
    0.000000    1.000000    0.000000
   -0.169166    0.000000   -0.985587

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  170.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.6269452"
 Parameter: YPOS -> "21.434664"
 Parameter: ZPOS -> "61.7049168"
 Parameter: ZPHI -> "311.252715"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.659381   -0.751809    0.000000
    0.751809    0.659381    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.626945 XMAX =  -44.626945 XAVE =  -44.626945
    YMIN =   21.434664 YMAX =   21.434664 YAVE =   21.434664
    ZMIN =   61.704917 ZMAX =   61.704917 ZAVE =   61.704917
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.6269452"
Evaluating: -44.6269452+3.5
 Parameter: XMAX <- "-41.1269452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.434664"
Evaluating: 21.434664+3.5
 Parameter: YMAX <- "24.934664"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.7049168"
Evaluating: 61.7049168+3.5
 Parameter: ZMAX <- "65.2049168"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.6269452"
Evaluating: -44.6269452-3.5
 Parameter: XMIN <- "-48.1269452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.434664"
Evaluating: 21.434664-3.5
 Parameter: YMIN <- "17.934664"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.7049168"
Evaluating: 61.7049168-3.5
 Parameter: ZMIN <- "58.2049168"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.1269452"
 Parameter: XMIN -> "-48.1269452"
 Parameter: YMAX -> "24.934664"
 Parameter: YMIN -> "17.934664"
 Parameter: ZMAX -> "65.2049168"
 Parameter: ZMIN -> "58.2049168"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "84" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "84" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "71"
Evaluating: 84-71
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.129755955"
Evaluating: 100.116666*(0.129755955-0.5)
 Parameter: XPOS <- "-37.0675994"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.754348967"
Evaluating: 100.116666*(0.754348967-0.5)
 Parameter: YPOS <- "25.4645706"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.165481486"
Evaluating: 127.138691*(0.165481486-0.5)+4.2778237
 Parameter: ZPOS <- "-38.2524223"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.2524223" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.0675994"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.0675994-0
 Parameter: XTRAN <- "-37.0675994"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.4645706"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.4645706-0
 Parameter: YTRAN <- "25.4645706"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.2524223"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.2524223-0
 Parameter: ZTRAN <- "-38.2524223"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.0675994"
 Parameter: YTRAN -> "25.4645706"
 Parameter: ZTRAN -> "-38.2524223"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -37.067599   25.464571  -38.252422
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.283889799"
Evaluating: 0.283889799*360.0
 Parameter: XPHI <- "102.200328"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.304751887"
Evaluating: 0.304751887*360.0
 Parameter: YPHI <- "109.710679"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.047269045E-02"
Evaluating: 5.047269045E-02*360.0
 Parameter: ZPHI <- "18.1701686"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.0675994"
 Parameter: YPOS -> "25.4645706"
 Parameter: ZPOS -> "-38.2524223"
 Parameter: XPHI -> "102.200328"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.211330    0.977415
    0.000000   -0.977415   -0.211330

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.0675994"
 Parameter: YPOS -> "25.4645706"
 Parameter: ZPOS -> "-38.2524223"
 Parameter: YPHI -> "109.710679"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.337271    0.000000   -0.941408
    0.000000    1.000000    0.000000
    0.941408    0.000000   -0.337271

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.0675994"
 Parameter: YPOS -> "25.4645706"
 Parameter: ZPOS -> "-38.2524223"
 Parameter: ZPHI -> "18.1701686"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.950135    0.311840    0.000000
   -0.311840    0.950135    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.067599 XMAX =  -37.067599 XAVE =  -37.067599
    YMIN =   25.464571 YMAX =   25.464571 YAVE =   25.464571
    ZMIN =  -38.252422 ZMAX =  -38.252422 ZAVE =  -38.252422
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.0675994"
Evaluating: -37.0675994+3.5
 Parameter: XMAX <- "-33.5675994"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.4645706"
Evaluating: 25.4645706+3.5
 Parameter: YMAX <- "28.9645706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.2524223"
Evaluating: -38.2524223+3.5
 Parameter: ZMAX <- "-34.7524223"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.0675994"
Evaluating: -37.0675994-3.5
 Parameter: XMIN <- "-40.5675994"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.4645706"
Evaluating: 25.4645706-3.5
 Parameter: YMIN <- "21.9645706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.2524223"
Evaluating: -38.2524223-3.5
 Parameter: ZMIN <- "-41.7524223"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.5675994"
 Parameter: XMIN -> "-40.5675994"
 Parameter: YMAX -> "28.9645706"
 Parameter: YMIN -> "21.9645706"
 Parameter: ZMAX -> "-34.7524223"
 Parameter: ZMIN -> "-41.7524223"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "85" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "85" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "71"
Evaluating: 85-71
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.491980429"
Evaluating: 100.116666*(0.491980429-0.5)
 Parameter: XPOS <- "-0.802892711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.24105818"
Evaluating: 100.116666*(0.24105818-0.5)
 Parameter: YPOS <- "-25.9243917"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.915855914"
Evaluating: 127.138691*(0.915855914-0.5)+4.2778237
 Parameter: ZPOS <- "57.1492003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.1492003" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.1492003" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.802892711"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.802892711-0
 Parameter: XTRAN <- "-0.802892711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.9243917"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.9243917-0
 Parameter: YTRAN <- "-25.9243917"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.1492003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 57.1492003-0
 Parameter: ZTRAN <- "57.1492003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.802892711"
 Parameter: YTRAN -> "-25.9243917"
 Parameter: ZTRAN -> "57.1492003"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -0.802893  -25.924392   57.149200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950858029"
Evaluating: 0.950858029*360.0
 Parameter: XPHI <- "342.30889"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.83673604"
Evaluating: 0.83673604*360.0
 Parameter: YPHI <- "301.224974"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540763279"
Evaluating: 0.540763279*360.0
 Parameter: ZPHI <- "194.67478"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.802892711"
 Parameter: YPOS -> "-25.9243917"
 Parameter: ZPOS -> "57.1492003"
 Parameter: XPHI -> "342.30889"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.952709   -0.303885
    0.000000    0.303885    0.952709

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.802892711"
 Parameter: YPOS -> "-25.9243917"
 Parameter: ZPOS -> "57.1492003"
 Parameter: YPHI -> "301.224974"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.518400    0.000000    0.855138
    0.000000    1.000000    0.000000
   -0.855138    0.000000    0.518400

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.802892711"
 Parameter: YPOS -> "-25.9243917"
 Parameter: ZPOS -> "57.1492003"
 Parameter: ZPHI -> "194.67478"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.967379   -0.253332    0.000000
    0.253332   -0.967379    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.802893 XMAX =   -0.802893 XAVE =   -0.802893
    YMIN =  -25.924392 YMAX =  -25.924392 YAVE =  -25.924392
    ZMIN =   57.149200 ZMAX =   57.149200 ZAVE =   57.149200
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.802892711"
Evaluating: -0.802892711+3.5
 Parameter: XMAX <- "2.69710729"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.9243917"
Evaluating: -25.9243917+3.5
 Parameter: YMAX <- "-22.4243917"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.1492003"
Evaluating: 57.1492003+3.5
 Parameter: ZMAX <- "60.6492003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.802892711"
Evaluating: -0.802892711-3.5
 Parameter: XMIN <- "-4.30289271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.9243917"
Evaluating: -25.9243917-3.5
 Parameter: YMIN <- "-29.4243917"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.1492003"
Evaluating: 57.1492003-3.5
 Parameter: ZMIN <- "53.6492003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.69710729"
 Parameter: XMIN -> "-4.30289271"
 Parameter: YMAX -> "-22.4243917"
 Parameter: YMIN -> "-29.4243917"
 Parameter: ZMAX -> "60.6492003"
 Parameter: ZMIN -> "53.6492003"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "86" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "86" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "86"
 Parameter: NPOS -> "71"
Evaluating: 86-71
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.849738679E-02"
Evaluating: 100.116666*(5.849738679E-02-0.5)
 Parameter: XPOS <- "-44.2017697"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.751672589"
Evaluating: 100.116666*(0.751672589-0.5)
 Parameter: YPOS <- "25.1966205"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.26523147"
Evaluating: 127.138691*(0.26523147-0.5)+4.2778237
 Parameter: ZPOS <- "-25.5703399"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.5703399" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.2017697"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.2017697-0
 Parameter: XTRAN <- "-44.2017697"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.1966205"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.1966205-0
 Parameter: YTRAN <- "25.1966205"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.5703399"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -25.5703399-0
 Parameter: ZTRAN <- "-25.5703399"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2017697"
 Parameter: YTRAN -> "25.1966205"
 Parameter: ZTRAN -> "-25.5703399"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -44.201770   25.196621  -25.570340
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678419531"
Evaluating: 0.678419531*360.0
 Parameter: XPHI <- "244.231031"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.901763865"
Evaluating: 0.901763865*360.0
 Parameter: YPHI <- "324.634991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193630209"
Evaluating: 0.193630209*360.0
 Parameter: ZPHI <- "69.7068752"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.2017697"
 Parameter: YPOS -> "25.1966205"
 Parameter: ZPOS -> "-25.5703399"
 Parameter: XPHI -> "244.231031"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.434743   -0.900554
    0.000000    0.900554   -0.434743

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.2017697"
 Parameter: YPOS -> "25.1966205"
 Parameter: ZPOS -> "-25.5703399"
 Parameter: YPHI -> "324.634991"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.815481    0.000000    0.578783
    0.000000    1.000000    0.000000
   -0.578783    0.000000    0.815481

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.2017697"
 Parameter: YPOS -> "25.1966205"
 Parameter: ZPOS -> "-25.5703399"
 Parameter: ZPHI -> "69.7068752"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.346823    0.937931    0.000000
   -0.937931    0.346823    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.201770 XMAX =  -44.201770 XAVE =  -44.201770
    YMIN =   25.196621 YMAX =   25.196621 YAVE =   25.196621
    ZMIN =  -25.570340 ZMAX =  -25.570340 ZAVE =  -25.570340
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.2017697"
Evaluating: -44.2017697+3.5
 Parameter: XMAX <- "-40.7017697"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.1966205"
Evaluating: 25.1966205+3.5
 Parameter: YMAX <- "28.6966205"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.5703399"
Evaluating: -25.5703399+3.5
 Parameter: ZMAX <- "-22.0703399"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.2017697"
Evaluating: -44.2017697-3.5
 Parameter: XMIN <- "-47.7017697"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.1966205"
Evaluating: 25.1966205-3.5
 Parameter: YMIN <- "21.6966205"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.5703399"
Evaluating: -25.5703399-3.5
 Parameter: ZMIN <- "-29.0703399"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.7017697"
 Parameter: XMIN -> "-47.7017697"
 Parameter: YMAX -> "28.6966205"
 Parameter: YMIN -> "21.6966205"
 Parameter: ZMAX -> "-22.0703399"
 Parameter: ZMIN -> "-29.0703399"
 SELRPN>      2 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "87" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "87" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "87"
 Parameter: NPOS -> "71"
Evaluating: 87-71
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.865061518"
Evaluating: 100.116666*(0.865061518-0.5)
 Parameter: XPOS <- "36.5487421"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.468282552"
Evaluating: 100.116666*(0.468282552-0.5)
 Parameter: YPOS <- "-3.17544515"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.827161592"
Evaluating: 127.138691*(0.827161592-0.5)+4.2778237
 Parameter: ZPOS <- "45.8727203"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.8727203" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.8727203" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.5487421"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.5487421-0
 Parameter: XTRAN <- "36.5487421"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.17544515"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.17544515-0
 Parameter: YTRAN <- "-3.17544515"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.8727203"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.8727203-0
 Parameter: ZTRAN <- "45.8727203"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.5487421"
 Parameter: YTRAN -> "-3.17544515"
 Parameter: ZTRAN -> "45.8727203"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    36.548742   -3.175445   45.872720
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704875312"
Evaluating: 0.704875312*360.0
 Parameter: XPHI <- "253.755112"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56466354"
Evaluating: 0.56466354*360.0
 Parameter: YPHI <- "203.278874"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.298888596"
Evaluating: 0.298888596*360.0
 Parameter: ZPHI <- "107.599895"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.5487421"
 Parameter: YPOS -> "-3.17544515"
 Parameter: ZPOS -> "45.8727203"
 Parameter: XPHI -> "253.755112"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.279743   -0.960075
    0.000000    0.960075   -0.279743

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.5487421"
 Parameter: YPOS -> "-3.17544515"
 Parameter: ZPOS -> "45.8727203"
 Parameter: YPHI -> "203.278874"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.918592    0.000000    0.395207
    0.000000    1.000000    0.000000
   -0.395207    0.000000   -0.918592

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.5487421"
 Parameter: YPOS -> "-3.17544515"
 Parameter: ZPOS -> "45.8727203"
 Parameter: ZPHI -> "107.599895"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.302368    0.953191    0.000000
   -0.953191   -0.302368    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.548742 XMAX =   36.548742 XAVE =   36.548742
    YMIN =   -3.175445 YMAX =   -3.175445 YAVE =   -3.175445
    ZMIN =   45.872720 ZMAX =   45.872720 ZAVE =   45.872720
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.5487421"
Evaluating: 36.5487421+3.5
 Parameter: XMAX <- "40.0487421"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.17544515"
Evaluating: -3.17544515+3.5
 Parameter: YMAX <- "0.32455485"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.8727203"
Evaluating: 45.8727203+3.5
 Parameter: ZMAX <- "49.3727203"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.5487421"
Evaluating: 36.5487421-3.5
 Parameter: XMIN <- "33.0487421"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.17544515"
Evaluating: -3.17544515-3.5
 Parameter: YMIN <- "-6.67544515"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.8727203"
Evaluating: 45.8727203-3.5
 Parameter: ZMIN <- "42.3727203"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.0487421"
 Parameter: XMIN -> "33.0487421"
 Parameter: YMAX -> "0.32455485"
 Parameter: YMIN -> "-6.67544515"
 Parameter: ZMAX -> "49.3727203"
 Parameter: ZMIN -> "42.3727203"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "88" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "88" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "71"
Evaluating: 88-71
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.720115305"
Evaluating: 100.116666*(0.720115305-0.5)
 Parameter: XPOS <- "22.0372105"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.834165599"
Evaluating: 100.116666*(0.834165599-0.5)
 Parameter: YPOS <- "33.4555457"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "7.282825306E-02"
Evaluating: 127.138691*(7.282825306E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-50.032233"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.032233" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.0372105"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.0372105-0
 Parameter: XTRAN <- "22.0372105"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.4555457"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.4555457-0
 Parameter: YTRAN <- "33.4555457"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.032233"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.032233-0
 Parameter: ZTRAN <- "-50.032233"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.0372105"
 Parameter: YTRAN -> "33.4555457"
 Parameter: ZTRAN -> "-50.032233"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    22.037211   33.455546  -50.032233
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.512363784"
Evaluating: 0.512363784*360.0
 Parameter: XPHI <- "184.450962"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.826220164"
Evaluating: 0.826220164*360.0
 Parameter: YPHI <- "297.439259"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.120730638"
Evaluating: 0.120730638*360.0
 Parameter: ZPHI <- "43.4630297"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.0372105"
 Parameter: YPOS -> "33.4555457"
 Parameter: ZPOS -> "-50.032233"
 Parameter: XPHI -> "184.450962"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996984   -0.077606
    0.000000    0.077606   -0.996984

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  175.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.0372105"
 Parameter: YPOS -> "33.4555457"
 Parameter: ZPOS -> "-50.032233"
 Parameter: YPHI -> "297.439259"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.460808    0.000000    0.887500
    0.000000    1.000000    0.000000
   -0.887500    0.000000    0.460808

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.0372105"
 Parameter: YPOS -> "33.4555457"
 Parameter: ZPOS -> "-50.032233"
 Parameter: ZPHI -> "43.4630297"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.725818    0.687886    0.000000
   -0.687886    0.725818    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.037211 XMAX =   22.037211 XAVE =   22.037211
    YMIN =   33.455546 YMAX =   33.455546 YAVE =   33.455546
    ZMIN =  -50.032233 ZMAX =  -50.032233 ZAVE =  -50.032233
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.0372105"
Evaluating: 22.0372105+3.5
 Parameter: XMAX <- "25.5372105"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.4555457"
Evaluating: 33.4555457+3.5
 Parameter: YMAX <- "36.9555457"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.032233"
Evaluating: -50.032233+3.5
 Parameter: ZMAX <- "-46.532233"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.0372105"
Evaluating: 22.0372105-3.5
 Parameter: XMIN <- "18.5372105"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.4555457"
Evaluating: 33.4555457-3.5
 Parameter: YMIN <- "29.9555457"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.032233"
Evaluating: -50.032233-3.5
 Parameter: ZMIN <- "-53.532233"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.5372105"
 Parameter: XMIN -> "18.5372105"
 Parameter: YMAX -> "36.9555457"
 Parameter: YMIN -> "29.9555457"
 Parameter: ZMAX -> "-46.532233"
 Parameter: ZMIN -> "-53.532233"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39293 NEG      CLA      17       CLA     -**** POS      SOD      1        SOD           1.6117
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "88" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "71"
Evaluating: 88-71
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.566484088"
Evaluating: 100.116666*(0.566484088-0.5)
 Parameter: XPOS <- "6.65616523"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.563885775"
Evaluating: 100.116666*(0.563885775-0.5)
 Parameter: YPOS <- "6.3960308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.131629565"
Evaluating: 127.138691*(0.131629565-0.5)+4.2778237
 Parameter: ZPOS <- "-42.5563112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.5563112" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.037211 XMAX =   22.037211 XAVE =   22.037211
    YMIN =   33.455546 YMAX =   33.455546 YAVE =   33.455546
    ZMIN =  -50.032233 ZMAX =  -50.032233 ZAVE =  -50.032233
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.65616523"
 RDCMND substituted energy or value "?XAVE" to "22.0372105"
Evaluating: 6.65616523-22.0372105
 Parameter: XTRAN <- "-15.3810453"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.3960308"
 RDCMND substituted energy or value "?YAVE" to "33.4555457"
Evaluating: 6.3960308-33.4555457
 Parameter: YTRAN <- "-27.0595149"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.5563112"
 RDCMND substituted energy or value "?ZAVE" to "-50.032233"
Evaluating: -42.5563112--50.032233
 Parameter: ZTRAN <- "7.4759218"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.3810453"
 Parameter: YTRAN -> "-27.0595149"
 Parameter: ZTRAN -> "7.4759218"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -15.381045  -27.059515    7.475922
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390301078"
Evaluating: 0.390301078*360.0
 Parameter: XPHI <- "140.508388"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.293345085"
Evaluating: 0.293345085*360.0
 Parameter: YPHI <- "105.604231"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.438201767"
Evaluating: 0.438201767*360.0
 Parameter: ZPHI <- "157.752636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.65616523"
 Parameter: YPOS -> "6.3960308"
 Parameter: ZPOS -> "-42.5563112"
 Parameter: XPHI -> "140.508388"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.771718    0.635965
    0.000000   -0.635965   -0.771718

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.65616523"
 Parameter: YPOS -> "6.3960308"
 Parameter: ZPOS -> "-42.5563112"
 Parameter: YPHI -> "105.604231"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.268991    0.000000   -0.963143
    0.000000    1.000000    0.000000
    0.963143    0.000000   -0.268991

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.65616523"
 Parameter: YPOS -> "6.3960308"
 Parameter: ZPOS -> "-42.5563112"
 Parameter: ZPHI -> "157.752636"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.925558    0.378606    0.000000
   -0.378606   -0.925558    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  157.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.656165 XMAX =    6.656165 XAVE =    6.656165
    YMIN =    6.396031 YMAX =    6.396031 YAVE =    6.396031
    ZMIN =  -42.556311 ZMAX =  -42.556311 ZAVE =  -42.556311
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.65616522"
Evaluating: 6.65616522+3.5
 Parameter: XMAX <- "10.1561652"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.3960308"
Evaluating: 6.3960308+3.5
 Parameter: YMAX <- "9.8960308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.5563112"
Evaluating: -42.5563112+3.5
 Parameter: ZMAX <- "-39.0563112"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.65616522"
Evaluating: 6.65616522-3.5
 Parameter: XMIN <- "3.15616522"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.3960308"
Evaluating: 6.3960308-3.5
 Parameter: YMIN <- "2.8960308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.5563112"
Evaluating: -42.5563112-3.5
 Parameter: ZMIN <- "-46.0563112"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.1561652"
 Parameter: XMIN -> "3.15616522"
 Parameter: YMAX -> "9.8960308"
 Parameter: YMIN -> "2.8960308"
 Parameter: ZMAX -> "-39.0563112"
 Parameter: ZMIN -> "-46.0563112"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "89" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "89" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "71"
Evaluating: 89-71
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.582071551E-02"
Evaluating: 100.116666*(4.582071551E-02-0.5)
 Parameter: XPOS <- "-45.4709157"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.346136244"
Evaluating: 100.116666*(0.346136244-0.5)
 Parameter: YPOS <- "-15.4043263"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.720901816"
Evaluating: 127.138691*(0.720901816-0.5)+4.2778237
 Parameter: ZPOS <- "32.3629914"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.3629914" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.3629914" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.4709157"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -45.4709157-0
 Parameter: XTRAN <- "-45.4709157"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.4043263"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.4043263-0
 Parameter: YTRAN <- "-15.4043263"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.3629914"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.3629914-0
 Parameter: ZTRAN <- "32.3629914"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.4709157"
 Parameter: YTRAN -> "-15.4043263"
 Parameter: ZTRAN -> "32.3629914"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -45.470916  -15.404326   32.362991
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42838007"
Evaluating: 0.42838007*360.0
 Parameter: XPHI <- "154.216825"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.792387074"
Evaluating: 0.792387074*360.0
 Parameter: YPHI <- "285.259347"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22452501"
Evaluating: 0.22452501*360.0
 Parameter: ZPHI <- "80.8290036"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.4709157"
 Parameter: YPOS -> "-15.4043263"
 Parameter: ZPOS -> "32.3629914"
 Parameter: XPHI -> "154.216825"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.900447    0.434967
    0.000000   -0.434967   -0.900447

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.4709157"
 Parameter: YPOS -> "-15.4043263"
 Parameter: ZPOS -> "32.3629914"
 Parameter: YPHI -> "285.259347"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.263189    0.000000    0.964744
    0.000000    1.000000    0.000000
   -0.964744    0.000000    0.263189

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.4709157"
 Parameter: YPOS -> "-15.4043263"
 Parameter: ZPOS -> "32.3629914"
 Parameter: ZPHI -> "80.8290036"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.159381    0.987217    0.000000
   -0.987217    0.159381    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.470916 XMAX =  -45.470916 XAVE =  -45.470916
    YMIN =  -15.404326 YMAX =  -15.404326 YAVE =  -15.404326
    ZMIN =   32.362991 ZMAX =   32.362991 ZAVE =   32.362991
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.4709157"
Evaluating: -45.4709157+3.5
 Parameter: XMAX <- "-41.9709157"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.4043263"
Evaluating: -15.4043263+3.5
 Parameter: YMAX <- "-11.9043263"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.3629914"
Evaluating: 32.3629914+3.5
 Parameter: ZMAX <- "35.8629914"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.4709157"
Evaluating: -45.4709157-3.5
 Parameter: XMIN <- "-48.9709157"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.4043263"
Evaluating: -15.4043263-3.5
 Parameter: YMIN <- "-18.9043263"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.3629914"
Evaluating: 32.3629914-3.5
 Parameter: ZMIN <- "28.8629914"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.9709157"
 Parameter: XMIN -> "-48.9709157"
 Parameter: YMAX -> "-11.9043263"
 Parameter: YMIN -> "-18.9043263"
 Parameter: ZMAX -> "35.8629914"
 Parameter: ZMIN -> "28.8629914"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "90" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "90" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "71"
Evaluating: 90-71
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "8.274311608E-02"
Evaluating: 100.116666*(8.274311608E-02-0.5)
 Parameter: XPOS <- "-41.7743681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.793384038"
Evaluating: 100.116666*(0.793384038-0.5)
 Parameter: YPOS <- "29.3726317"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.823252487"
Evaluating: 127.138691*(0.823252487-0.5)+4.2778237
 Parameter: ZPOS <- "45.3757218"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.3757218" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.3757218" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.7743681"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.7743681-0
 Parameter: XTRAN <- "-41.7743681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3726317"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.3726317-0
 Parameter: YTRAN <- "29.3726317"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.3757218"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.3757218-0
 Parameter: ZTRAN <- "45.3757218"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.7743681"
 Parameter: YTRAN -> "29.3726317"
 Parameter: ZTRAN -> "45.3757218"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -41.774368   29.372632   45.375722
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178190897"
Evaluating: 0.178190897*360.0
 Parameter: XPHI <- "64.1487229"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243716062"
Evaluating: 0.243716062*360.0
 Parameter: YPHI <- "87.7377823"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943435356"
Evaluating: 0.943435356*360.0
 Parameter: ZPHI <- "339.636728"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.7743681"
 Parameter: YPOS -> "29.3726317"
 Parameter: ZPOS -> "45.3757218"
 Parameter: XPHI -> "64.1487229"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.436037    0.899929
    0.000000   -0.899929    0.436037

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.7743681"
 Parameter: YPOS -> "29.3726317"
 Parameter: ZPOS -> "45.3757218"
 Parameter: YPHI -> "87.7377823"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.039473    0.000000   -0.999221
    0.000000    1.000000    0.000000
    0.999221    0.000000    0.039473

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.7743681"
 Parameter: YPOS -> "29.3726317"
 Parameter: ZPOS -> "45.3757218"
 Parameter: ZPHI -> "339.636728"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.937505   -0.347971    0.000000
    0.347971    0.937505    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.774368 XMAX =  -41.774368 XAVE =  -41.774368
    YMIN =   29.372632 YMAX =   29.372632 YAVE =   29.372632
    ZMIN =   45.375722 ZMAX =   45.375722 ZAVE =   45.375722
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.7743681"
Evaluating: -41.7743681+3.5
 Parameter: XMAX <- "-38.2743681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3726317"
Evaluating: 29.3726317+3.5
 Parameter: YMAX <- "32.8726317"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.3757218"
Evaluating: 45.3757218+3.5
 Parameter: ZMAX <- "48.8757218"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.7743681"
Evaluating: -41.7743681-3.5
 Parameter: XMIN <- "-45.2743681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3726317"
Evaluating: 29.3726317-3.5
 Parameter: YMIN <- "25.8726317"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.3757218"
Evaluating: 45.3757218-3.5
 Parameter: ZMIN <- "41.8757218"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.2743681"
 Parameter: XMIN -> "-45.2743681"
 Parameter: YMAX -> "32.8726317"
 Parameter: YMIN -> "25.8726317"
 Parameter: ZMAX -> "48.8757218"
 Parameter: ZMIN -> "41.8757218"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "91" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "91" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "91"
 Parameter: NPOS -> "71"
Evaluating: 91-71
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.319190585"
Evaluating: 100.116666*(0.319190585-0.5)
 Parameter: XPOS <- "-18.1020358"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.874619868"
Evaluating: 100.116666*(0.874619868-0.5)
 Parameter: YPOS <- "37.5056922"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.226078399"
Evaluating: 127.138691*(0.226078399-0.5)+4.2778237
 Parameter: ZPOS <- "-30.5482101"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.5482101" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.1020358"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.1020358-0
 Parameter: XTRAN <- "-18.1020358"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.5056922"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.5056922-0
 Parameter: YTRAN <- "37.5056922"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.5482101"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.5482101-0
 Parameter: ZTRAN <- "-30.5482101"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.1020358"
 Parameter: YTRAN -> "37.5056922"
 Parameter: ZTRAN -> "-30.5482101"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -18.102036   37.505692  -30.548210
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49624963"
Evaluating: 0.49624963*360.0
 Parameter: XPHI <- "178.649867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.823776894"
Evaluating: 0.823776894*360.0
 Parameter: YPHI <- "296.559682"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930180586"
Evaluating: 0.930180586*360.0
 Parameter: ZPHI <- "334.865011"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.1020358"
 Parameter: YPOS -> "37.5056922"
 Parameter: ZPOS -> "-30.5482101"
 Parameter: XPHI -> "178.649867"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999722    0.023562
    0.000000   -0.023562   -0.999722

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  178.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.1020358"
 Parameter: YPOS -> "37.5056922"
 Parameter: ZPOS -> "-30.5482101"
 Parameter: YPHI -> "296.559682"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.447130    0.000000    0.894469
    0.000000    1.000000    0.000000
   -0.894469    0.000000    0.447130

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.1020358"
 Parameter: YPOS -> "37.5056922"
 Parameter: ZPOS -> "-30.5482101"
 Parameter: ZPHI -> "334.865011"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.905310   -0.424752    0.000000
    0.424752    0.905310    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   25.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.102036 XMAX =  -18.102036 XAVE =  -18.102036
    YMIN =   37.505692 YMAX =   37.505692 YAVE =   37.505692
    ZMIN =  -30.548210 ZMAX =  -30.548210 ZAVE =  -30.548210
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.1020358"
Evaluating: -18.1020358+3.5
 Parameter: XMAX <- "-14.6020358"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.5056922"
Evaluating: 37.5056922+3.5
 Parameter: YMAX <- "41.0056922"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.5482101"
Evaluating: -30.5482101+3.5
 Parameter: ZMAX <- "-27.0482101"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.1020358"
Evaluating: -18.1020358-3.5
 Parameter: XMIN <- "-21.6020358"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.5056922"
Evaluating: 37.5056922-3.5
 Parameter: YMIN <- "34.0056922"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.5482101"
Evaluating: -30.5482101-3.5
 Parameter: ZMIN <- "-34.0482101"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.6020358"
 Parameter: XMIN -> "-21.6020358"
 Parameter: YMAX -> "41.0056922"
 Parameter: YMIN -> "34.0056922"
 Parameter: ZMAX -> "-27.0482101"
 Parameter: ZMIN -> "-34.0482101"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "92" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "92" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "71"
Evaluating: 92-71
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.31729692"
Evaluating: 100.116666*(0.31729692-0.5)
 Parameter: XPOS <- "-18.2916232"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.102870399"
Evaluating: 100.116666*(0.102870399-0.5)
 Parameter: YPOS <- "-39.7592916"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.210899963"
Evaluating: 127.138691*(0.210899963-0.5)+4.2778237
 Parameter: ZPOS <- "-32.4779766"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.4779766" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.2916232"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.2916232-0
 Parameter: XTRAN <- "-18.2916232"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.7592916"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.7592916-0
 Parameter: YTRAN <- "-39.7592916"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.4779766"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.4779766-0
 Parameter: ZTRAN <- "-32.4779766"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.2916232"
 Parameter: YTRAN -> "-39.7592916"
 Parameter: ZTRAN -> "-32.4779766"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -18.291623  -39.759292  -32.477977
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643623588"
Evaluating: 0.643623588*360.0
 Parameter: XPHI <- "231.704492"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.477399156"
Evaluating: 0.477399156*360.0
 Parameter: YPHI <- "171.863696"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986641281"
Evaluating: 0.986641281*360.0
 Parameter: ZPHI <- "355.190861"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.2916232"
 Parameter: YPOS -> "-39.7592916"
 Parameter: ZPOS -> "-32.4779766"
 Parameter: XPHI -> "231.704492"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.619718   -0.784825
    0.000000    0.784825   -0.619718

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.2916232"
 Parameter: YPOS -> "-39.7592916"
 Parameter: ZPOS -> "-32.4779766"
 Parameter: YPHI -> "171.863696"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.989934    0.000000   -0.141529
    0.000000    1.000000    0.000000
    0.141529    0.000000   -0.989934

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.2916232"
 Parameter: YPOS -> "-39.7592916"
 Parameter: ZPOS -> "-32.4779766"
 Parameter: ZPHI -> "355.190861"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.996479   -0.083837    0.000000
    0.083837    0.996479    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.291623 XMAX =  -18.291623 XAVE =  -18.291623
    YMIN =  -39.759292 YMAX =  -39.759292 YAVE =  -39.759292
    ZMIN =  -32.477977 ZMAX =  -32.477977 ZAVE =  -32.477977
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.2916232"
Evaluating: -18.2916232+3.5
 Parameter: XMAX <- "-14.7916232"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.7592916"
Evaluating: -39.7592916+3.5
 Parameter: YMAX <- "-36.2592916"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.4779766"
Evaluating: -32.4779766+3.5
 Parameter: ZMAX <- "-28.9779766"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.2916232"
Evaluating: -18.2916232-3.5
 Parameter: XMIN <- "-21.7916232"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.7592916"
Evaluating: -39.7592916-3.5
 Parameter: YMIN <- "-43.2592916"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.4779766"
Evaluating: -32.4779766-3.5
 Parameter: ZMIN <- "-35.9779766"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.7916232"
 Parameter: XMIN -> "-21.7916232"
 Parameter: YMAX -> "-36.2592916"
 Parameter: YMIN -> "-43.2592916"
 Parameter: ZMAX -> "-28.9779766"
 Parameter: ZMIN -> "-35.9779766"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "93" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "93" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "71"
Evaluating: 93-71
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.262017626"
Evaluating: 100.116666*(0.262017626-0.5)
 Parameter: XPOS <- "-23.8260019"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.798730439"
Evaluating: 100.116666*(0.798730439-0.5)
 Parameter: YPOS <- "29.9078956"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.962028611"
Evaluating: 127.138691*(0.962028611-0.5)+4.2778237
 Parameter: ZPOS <- "63.0195365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.0195365" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.0195365" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.8260019"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -23.8260019-0
 Parameter: XTRAN <- "-23.8260019"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.9078956"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.9078956-0
 Parameter: YTRAN <- "29.9078956"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.0195365"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.0195365-0
 Parameter: ZTRAN <- "63.0195365"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.8260019"
 Parameter: YTRAN -> "29.9078956"
 Parameter: ZTRAN -> "63.0195365"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -23.826002   29.907896   63.019537
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605456712"
Evaluating: 0.605456712*360.0
 Parameter: XPHI <- "217.964416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.926973511E-02"
Evaluating: 9.926973511E-02*360.0
 Parameter: YPHI <- "35.7371046"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410294296"
Evaluating: 0.410294296*360.0
 Parameter: ZPHI <- "147.705947"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.8260019"
 Parameter: YPOS -> "29.9078956"
 Parameter: ZPOS -> "63.0195365"
 Parameter: XPHI -> "217.964416"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.788393   -0.615172
    0.000000    0.615172   -0.788393

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  142.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.8260019"
 Parameter: YPOS -> "29.9078956"
 Parameter: ZPOS -> "63.0195365"
 Parameter: YPHI -> "35.7371046"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.811705    0.000000   -0.584067
    0.000000    1.000000    0.000000
    0.584067    0.000000    0.811705

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   35.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.8260019"
 Parameter: YPOS -> "29.9078956"
 Parameter: ZPOS -> "63.0195365"
 Parameter: ZPHI -> "147.705947"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.845317    0.534265    0.000000
   -0.534265   -0.845317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.826002 XMAX =  -23.826002 XAVE =  -23.826002
    YMIN =   29.907896 YMAX =   29.907896 YAVE =   29.907896
    ZMIN =   63.019537 ZMAX =   63.019537 ZAVE =   63.019537
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.8260019"
Evaluating: -23.8260019+3.5
 Parameter: XMAX <- "-20.3260019"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.9078956"
Evaluating: 29.9078956+3.5
 Parameter: YMAX <- "33.4078956"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.0195365"
Evaluating: 63.0195365+3.5
 Parameter: ZMAX <- "66.5195365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.8260019"
Evaluating: -23.8260019-3.5
 Parameter: XMIN <- "-27.3260019"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.9078956"
Evaluating: 29.9078956-3.5
 Parameter: YMIN <- "26.4078956"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.0195365"
Evaluating: 63.0195365-3.5
 Parameter: ZMIN <- "59.5195365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.3260019"
 Parameter: XMIN -> "-27.3260019"
 Parameter: YMAX -> "33.4078956"
 Parameter: YMIN -> "26.4078956"
 Parameter: ZMAX -> "66.5195365"
 Parameter: ZMIN -> "59.5195365"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "94" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "94" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "71"
Evaluating: 94-71
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.598905388E-02"
Evaluating: 100.116666*(5.598905388E-02-0.5)
 Parameter: XPOS <- "-44.4528956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.951179191"
Evaluating: 100.116666*(0.951179191-0.5)
 Parameter: YPOS <- "45.1705564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.944625288"
Evaluating: 127.138691*(0.944625288-0.5)+4.2778237
 Parameter: ZPOS <- "60.8069008"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.8069008" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.8069008" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.4528956"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.4528956-0
 Parameter: XTRAN <- "-44.4528956"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "45.1705564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 45.1705564-0
 Parameter: YTRAN <- "45.1705564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.8069008"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 60.8069008-0
 Parameter: ZTRAN <- "60.8069008"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.4528956"
 Parameter: YTRAN -> "45.1705564"
 Parameter: ZTRAN -> "60.8069008"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -44.452896   45.170556   60.806901
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.838085702"
Evaluating: 0.838085702*360.0
 Parameter: XPHI <- "301.710853"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.485138129"
Evaluating: 0.485138129*360.0
 Parameter: YPHI <- "174.649726"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.506516167"
Evaluating: 0.506516167*360.0
 Parameter: ZPHI <- "182.34582"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.4528956"
 Parameter: YPOS -> "45.1705564"
 Parameter: ZPOS -> "60.8069008"
 Parameter: XPHI -> "301.710853"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.525633   -0.850712
    0.000000    0.850712    0.525633

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.4528956"
 Parameter: YPOS -> "45.1705564"
 Parameter: ZPOS -> "60.8069008"
 Parameter: YPHI -> "174.649726"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.995643    0.000000   -0.093244
    0.000000    1.000000    0.000000
    0.093244    0.000000   -0.995643

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.4528956"
 Parameter: YPOS -> "45.1705564"
 Parameter: ZPOS -> "60.8069008"
 Parameter: ZPHI -> "182.34582"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999162   -0.040931    0.000000
    0.040931   -0.999162    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  177.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.452896 XMAX =  -44.452896 XAVE =  -44.452896
    YMIN =   45.170556 YMAX =   45.170556 YAVE =   45.170556
    ZMIN =   60.806901 ZMAX =   60.806901 ZAVE =   60.806901
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.4528956"
Evaluating: -44.4528956+3.5
 Parameter: XMAX <- "-40.9528956"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "45.1705564"
Evaluating: 45.1705564+3.5
 Parameter: YMAX <- "48.6705564"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.8069008"
Evaluating: 60.8069008+3.5
 Parameter: ZMAX <- "64.3069008"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.4528956"
Evaluating: -44.4528956-3.5
 Parameter: XMIN <- "-47.9528956"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "45.1705564"
Evaluating: 45.1705564-3.5
 Parameter: YMIN <- "41.6705564"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.8069008"
Evaluating: 60.8069008-3.5
 Parameter: ZMIN <- "57.3069008"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.9528956"
 Parameter: XMIN -> "-47.9528956"
 Parameter: YMAX -> "48.6705564"
 Parameter: YMIN -> "41.6705564"
 Parameter: ZMAX -> "64.3069008"
 Parameter: ZMIN -> "57.3069008"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "95" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "95" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "71"
Evaluating: 95-71
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.77612042"
Evaluating: 100.116666*(0.77612042-0.5)
 Parameter: XPOS <- "27.6442559"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.256106685"
Evaluating: 100.116666*(0.256106685-0.5)
 Parameter: YPOS <- "-24.4177856"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.234375065"
Evaluating: 127.138691*(0.234375065-0.5)+4.2778237
 Parameter: ZPOS <- "-29.4933828"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.4933828" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.6442559"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.6442559-0
 Parameter: XTRAN <- "27.6442559"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.4177856"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.4177856-0
 Parameter: YTRAN <- "-24.4177856"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.4933828"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.4933828-0
 Parameter: ZTRAN <- "-29.4933828"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.6442559"
 Parameter: YTRAN -> "-24.4177856"
 Parameter: ZTRAN -> "-29.4933828"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    27.644256  -24.417786  -29.493383
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853815059"
Evaluating: 0.853815059*360.0
 Parameter: XPHI <- "307.373421"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.260889425E-02"
Evaluating: 8.260889425E-02*360.0
 Parameter: YPHI <- "29.7392019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.90503529"
Evaluating: 0.90503529*360.0
 Parameter: ZPHI <- "325.812704"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.6442559"
 Parameter: YPOS -> "-24.4177856"
 Parameter: ZPOS -> "-29.4933828"
 Parameter: XPHI -> "307.373421"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.607007   -0.794696
    0.000000    0.794696    0.607007

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.6442559"
 Parameter: YPOS -> "-24.4177856"
 Parameter: ZPOS -> "-29.4933828"
 Parameter: YPHI -> "29.7392019"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.868292    0.000000   -0.496053
    0.000000    1.000000    0.000000
    0.496053    0.000000    0.868292

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   29.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.6442559"
 Parameter: YPOS -> "-24.4177856"
 Parameter: ZPOS -> "-29.4933828"
 Parameter: ZPHI -> "325.812704"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.827205   -0.561900    0.000000
    0.561900    0.827205    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.644256 XMAX =   27.644256 XAVE =   27.644256
    YMIN =  -24.417786 YMAX =  -24.417786 YAVE =  -24.417786
    ZMIN =  -29.493383 ZMAX =  -29.493383 ZAVE =  -29.493383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.6442559"
Evaluating: 27.6442559+3.5
 Parameter: XMAX <- "31.1442559"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.4177856"
Evaluating: -24.4177856+3.5
 Parameter: YMAX <- "-20.9177856"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.4933828"
Evaluating: -29.4933828+3.5
 Parameter: ZMAX <- "-25.9933828"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.6442559"
Evaluating: 27.6442559-3.5
 Parameter: XMIN <- "24.1442559"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.4177856"
Evaluating: -24.4177856-3.5
 Parameter: YMIN <- "-27.9177856"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.4933828"
Evaluating: -29.4933828-3.5
 Parameter: ZMIN <- "-32.9933828"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.1442559"
 Parameter: XMIN -> "24.1442559"
 Parameter: YMAX -> "-20.9177856"
 Parameter: YMIN -> "-27.9177856"
 Parameter: ZMAX -> "-25.9933828"
 Parameter: ZMIN -> "-32.9933828"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39300 NEG      CLA      24       CLA     -**** POS      SOD      33       SOD           1.4462
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "95" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "71"
Evaluating: 95-71
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.519307911"
Evaluating: 100.116666*(0.519307911-0.5)
 Parameter: XPOS <- "1.93304368"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.269505828"
Evaluating: 100.116666*(0.269505828-0.5)
 Parameter: YPOS <- "-23.076308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.228205733"
Evaluating: 127.138691*(0.228205733-0.5)+4.2778237
 Parameter: ZPOS <- "-30.2777436"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.2777436" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.644256 XMAX =   27.644256 XAVE =   27.644256
    YMIN =  -24.417786 YMAX =  -24.417786 YAVE =  -24.417786
    ZMIN =  -29.493383 ZMAX =  -29.493383 ZAVE =  -29.493383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.93304368"
 RDCMND substituted energy or value "?XAVE" to "27.6442559"
Evaluating: 1.93304368-27.6442559
 Parameter: XTRAN <- "-25.7112122"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.076308"
 RDCMND substituted energy or value "?YAVE" to "-24.4177856"
Evaluating: -23.076308--24.4177856
 Parameter: YTRAN <- "1.3414776"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.2777436"
 RDCMND substituted energy or value "?ZAVE" to "-29.4933828"
Evaluating: -30.2777436--29.4933828
 Parameter: ZTRAN <- "-0.7843608"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.7112122"
 Parameter: YTRAN -> "1.3414776"
 Parameter: ZTRAN -> "-0.7843608"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -25.711212    1.341478   -0.784361
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73609586"
Evaluating: 0.73609586*360.0
 Parameter: XPHI <- "264.99451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.721816931"
Evaluating: 0.721816931*360.0
 Parameter: YPHI <- "259.854095"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242789033"
Evaluating: 0.242789033*360.0
 Parameter: ZPHI <- "87.4040519"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.93304368"
 Parameter: YPOS -> "-23.076308"
 Parameter: ZPOS -> "-30.2777436"
 Parameter: XPHI -> "264.99451"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.087251   -0.996186
    0.000000    0.996186   -0.087251

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   95.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.93304368"
 Parameter: YPOS -> "-23.076308"
 Parameter: ZPOS -> "-30.2777436"
 Parameter: YPHI -> "259.854095"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.176155    0.000000    0.984362
    0.000000    1.000000    0.000000
   -0.984362    0.000000   -0.176155

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.93304368"
 Parameter: YPOS -> "-23.076308"
 Parameter: ZPOS -> "-30.2777436"
 Parameter: ZPHI -> "87.4040519"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.045292    0.998974    0.000000
   -0.998974    0.045292    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   87.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.933044 XMAX =    1.933044 XAVE =    1.933044
    YMIN =  -23.076308 YMAX =  -23.076308 YAVE =  -23.076308
    ZMIN =  -30.277744 ZMAX =  -30.277744 ZAVE =  -30.277744
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.93304368"
Evaluating: 1.93304368+3.5
 Parameter: XMAX <- "5.43304368"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.076308"
Evaluating: -23.076308+3.5
 Parameter: YMAX <- "-19.576308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.2777436"
Evaluating: -30.2777436+3.5
 Parameter: ZMAX <- "-26.7777436"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.93304368"
Evaluating: 1.93304368-3.5
 Parameter: XMIN <- "-1.56695632"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.076308"
Evaluating: -23.076308-3.5
 Parameter: YMIN <- "-26.576308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.2777436"
Evaluating: -30.2777436-3.5
 Parameter: ZMIN <- "-33.7777436"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.43304368"
 Parameter: XMIN -> "-1.56695632"
 Parameter: YMAX -> "-19.576308"
 Parameter: YMIN -> "-26.576308"
 Parameter: ZMAX -> "-26.7777436"
 Parameter: ZMIN -> "-33.7777436"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "96" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "96" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "71"
Evaluating: 96-71
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.302416398"
Evaluating: 100.116666*(0.302416398-0.5)
 Parameter: XPOS <- "-19.7814115"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.487059992"
Evaluating: 100.116666*(0.487059992-0.5)
 Parameter: YPOS <- "-1.29551046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "8.592149281E-02"
Evaluating: 127.138691*(8.592149281E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-48.3675757"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-48.3675757" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.7814115"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.7814115-0
 Parameter: XTRAN <- "-19.7814115"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.29551046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.29551046-0
 Parameter: YTRAN <- "-1.29551046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-48.3675757"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -48.3675757-0
 Parameter: ZTRAN <- "-48.3675757"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.7814115"
 Parameter: YTRAN -> "-1.29551046"
 Parameter: ZTRAN -> "-48.3675757"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -19.781412   -1.295510  -48.367576
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.757793703"
Evaluating: 0.757793703*360.0
 Parameter: XPHI <- "272.805733"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218950454"
Evaluating: 0.218950454*360.0
 Parameter: YPHI <- "78.8221634"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846668444"
Evaluating: 0.846668444*360.0
 Parameter: ZPHI <- "304.80064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.7814115"
 Parameter: YPOS -> "-1.29551046"
 Parameter: ZPOS -> "-48.3675757"
 Parameter: XPHI -> "272.805733"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.048950   -0.998801
    0.000000    0.998801    0.048950

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.7814115"
 Parameter: YPOS -> "-1.29551046"
 Parameter: ZPOS -> "-48.3675757"
 Parameter: YPHI -> "78.8221634"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.193855    0.000000   -0.981030
    0.000000    1.000000    0.000000
    0.981030    0.000000    0.193855

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   78.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.7814115"
 Parameter: YPOS -> "-1.29551046"
 Parameter: ZPOS -> "-48.3675757"
 Parameter: ZPHI -> "304.80064"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.570723   -0.821143    0.000000
    0.821143    0.570723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.781412 XMAX =  -19.781412 XAVE =  -19.781412
    YMIN =   -1.295510 YMAX =   -1.295510 YAVE =   -1.295510
    ZMIN =  -48.367576 ZMAX =  -48.367576 ZAVE =  -48.367576
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.7814115"
Evaluating: -19.7814115+3.5
 Parameter: XMAX <- "-16.2814115"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.29551046"
Evaluating: -1.29551046+3.5
 Parameter: YMAX <- "2.20448954"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-48.3675757"
Evaluating: -48.3675757+3.5
 Parameter: ZMAX <- "-44.8675757"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.7814115"
Evaluating: -19.7814115-3.5
 Parameter: XMIN <- "-23.2814115"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.29551046"
Evaluating: -1.29551046-3.5
 Parameter: YMIN <- "-4.79551046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-48.3675757"
Evaluating: -48.3675757-3.5
 Parameter: ZMIN <- "-51.8675757"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.2814115"
 Parameter: XMIN -> "-23.2814115"
 Parameter: YMAX -> "2.20448954"
 Parameter: YMIN -> "-4.79551046"
 Parameter: ZMAX -> "-44.8675757"
 Parameter: ZMIN -> "-51.8675757"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "97" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "97" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "71"
Evaluating: 97-71
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "6.626497785E-02"
Evaluating: 100.116666*(6.626497785E-02-0.5)
 Parameter: XPOS <- "-43.4241043"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.885546685"
Evaluating: 100.116666*(0.885546685-0.5)
 Parameter: YPOS <- "38.5996487"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.602106435"
Evaluating: 127.138691*(0.602106435-0.5)+4.2778237
 Parameter: ZPOS <- "17.2595022"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.2595022" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.2595022" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.4241043"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.4241043-0
 Parameter: XTRAN <- "-43.4241043"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.5996487"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.5996487-0
 Parameter: YTRAN <- "38.5996487"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.2595022"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.2595022-0
 Parameter: ZTRAN <- "17.2595022"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.4241043"
 Parameter: YTRAN -> "38.5996487"
 Parameter: ZTRAN -> "17.2595022"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -43.424104   38.599649   17.259502
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.623123005"
Evaluating: 0.623123005*360.0
 Parameter: XPHI <- "224.324282"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.50295683"
Evaluating: 0.50295683*360.0
 Parameter: YPHI <- "181.064459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475821798"
Evaluating: 0.475821798*360.0
 Parameter: ZPHI <- "171.295847"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.4241043"
 Parameter: YPOS -> "38.5996487"
 Parameter: ZPOS -> "17.2595022"
 Parameter: XPHI -> "224.324282"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.715397   -0.698719
    0.000000    0.698719   -0.715397

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.4241043"
 Parameter: YPOS -> "38.5996487"
 Parameter: ZPOS -> "17.2595022"
 Parameter: YPHI -> "181.064459"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999827    0.000000    0.018577
    0.000000    1.000000    0.000000
   -0.018577    0.000000   -0.999827

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.4241043"
 Parameter: YPOS -> "38.5996487"
 Parameter: ZPOS -> "17.2595022"
 Parameter: ZPHI -> "171.295847"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.988483    0.151332    0.000000
   -0.151332   -0.988483    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  171.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.424104 XMAX =  -43.424104 XAVE =  -43.424104
    YMIN =   38.599649 YMAX =   38.599649 YAVE =   38.599649
    ZMIN =   17.259502 ZMAX =   17.259502 ZAVE =   17.259502
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.4241043"
Evaluating: -43.4241043+3.5
 Parameter: XMAX <- "-39.9241043"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.5996487"
Evaluating: 38.5996487+3.5
 Parameter: YMAX <- "42.0996487"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.2595022"
Evaluating: 17.2595022+3.5
 Parameter: ZMAX <- "20.7595022"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.4241043"
Evaluating: -43.4241043-3.5
 Parameter: XMIN <- "-46.9241043"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.5996487"
Evaluating: 38.5996487-3.5
 Parameter: YMIN <- "35.0996487"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.2595022"
Evaluating: 17.2595022-3.5
 Parameter: ZMIN <- "13.7595022"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.9241043"
 Parameter: XMIN -> "-46.9241043"
 Parameter: YMAX -> "42.0996487"
 Parameter: YMIN -> "35.0996487"
 Parameter: ZMAX -> "20.7595022"
 Parameter: ZMIN -> "13.7595022"
 SELRPN>     25 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     10 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     111      C12           3.8965
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     111      C11           3.7678
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     120      C12           3.4648
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     120      C21           3.3862
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     120      O22           3.3324
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     120      C22           2.9905
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "97" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "71"
Evaluating: 97-71
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.428617081"
Evaluating: 100.116666*(0.428617081-0.5)
 Parameter: XPOS <- "-7.14661986"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.221217965"
Evaluating: 100.116666*(0.221217965-0.5)
 Parameter: YPOS <- "-27.9107279"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.336898877"
Evaluating: 127.138691*(0.336898877-0.5)+4.2778237
 Parameter: ZPOS <- "-16.4586396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.4586396" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.424104 XMAX =  -43.424104 XAVE =  -43.424104
    YMIN =   38.599649 YMAX =   38.599649 YAVE =   38.599649
    ZMIN =   17.259502 ZMAX =   17.259502 ZAVE =   17.259502
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.14661986"
 RDCMND substituted energy or value "?XAVE" to "-43.4241043"
Evaluating: -7.14661986--43.4241043
 Parameter: XTRAN <- "36.2774844"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.9107279"
 RDCMND substituted energy or value "?YAVE" to "38.5996487"
Evaluating: -27.9107279-38.5996487
 Parameter: YTRAN <- "-66.5103766"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4586396"
 RDCMND substituted energy or value "?ZAVE" to "17.2595022"
Evaluating: -16.4586396-17.2595022
 Parameter: ZTRAN <- "-33.7181418"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.2774844"
 Parameter: YTRAN -> "-66.5103766"
 Parameter: ZTRAN -> "-33.7181418"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    36.277484  -66.510377  -33.718142
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653312917"
Evaluating: 0.653312917*360.0
 Parameter: XPHI <- "235.19265"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594421011"
Evaluating: 0.594421011*360.0
 Parameter: YPHI <- "213.991564"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997509999"
Evaluating: 0.997509999*360.0
 Parameter: ZPHI <- "359.1036"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.14661986"
 Parameter: YPOS -> "-27.9107279"
 Parameter: ZPOS -> "-16.4586396"
 Parameter: XPHI -> "235.19265"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.570819   -0.821076
    0.000000    0.821076   -0.570819

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.14661986"
 Parameter: YPOS -> "-27.9107279"
 Parameter: ZPOS -> "-16.4586396"
 Parameter: YPHI -> "213.991564"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.829120    0.000000    0.559071
    0.000000    1.000000    0.000000
   -0.559071    0.000000   -0.829120

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.14661986"
 Parameter: YPOS -> "-27.9107279"
 Parameter: ZPOS -> "-16.4586396"
 Parameter: ZPHI -> "359.1036"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999878   -0.015644    0.000000
    0.015644    0.999878    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.146620 XMAX =   -7.146620 XAVE =   -7.146620
    YMIN =  -27.910728 YMAX =  -27.910728 YAVE =  -27.910728
    ZMIN =  -16.458640 ZMAX =  -16.458640 ZAVE =  -16.458640
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.14661983"
Evaluating: -7.14661983+3.5
 Parameter: XMAX <- "-3.64661983"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.9107279"
Evaluating: -27.9107279+3.5
 Parameter: YMAX <- "-24.4107279"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4586396"
Evaluating: -16.4586396+3.5
 Parameter: ZMAX <- "-12.9586396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.14661983"
Evaluating: -7.14661983-3.5
 Parameter: XMIN <- "-10.6466198"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.9107279"
Evaluating: -27.9107279-3.5
 Parameter: YMIN <- "-31.4107279"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4586396"
Evaluating: -16.4586396-3.5
 Parameter: ZMIN <- "-19.9586396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.64661983"
 Parameter: XMIN -> "-10.6466198"
 Parameter: YMAX -> "-24.4107279"
 Parameter: YMIN -> "-31.4107279"
 Parameter: ZMAX -> "-12.9586396"
 Parameter: ZMIN -> "-19.9586396"
 SELRPN>      7 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      3 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39302 NEG      CLA      26       CLA     -**** MEMB     POPC     142      O22           3.0439
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "97" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "71"
Evaluating: 97-71
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.943339337"
Evaluating: 100.116666*(0.943339337-0.5)
 Parameter: XPOS <- "44.3856563"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.532785363"
Evaluating: 100.116666*(0.532785363-0.5)
 Parameter: YPOS <- "3.28236124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.474859173"
Evaluating: 127.138691*(0.474859173-0.5)+4.2778237
 Parameter: ZPOS <- "1.08145186"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.08145186" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.08145186" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "97" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "71"
Evaluating: 97-71
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.873445273"
Evaluating: 100.116666*(0.873445273-0.5)
 Parameter: XPOS <- "37.3880957"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.627576684"
Evaluating: 100.116666*(0.627576684-0.5)
 Parameter: YPOS <- "12.7725523"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.684856832"
Evaluating: 127.138691*(0.684856832-0.5)+4.2778237
 Parameter: ZPOS <- "27.7802793"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.7802793" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.7802793" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.146620 XMAX =   -7.146620 XAVE =   -7.146620
    YMIN =  -27.910728 YMAX =  -27.910728 YAVE =  -27.910728
    ZMIN =  -16.458640 ZMAX =  -16.458640 ZAVE =  -16.458640
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.3880957"
 RDCMND substituted energy or value "?XAVE" to "-7.14661983"
Evaluating: 37.3880957--7.14661983
 Parameter: XTRAN <- "44.5347155"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.7725523"
 RDCMND substituted energy or value "?YAVE" to "-27.9107279"
Evaluating: 12.7725523--27.9107279
 Parameter: YTRAN <- "40.6832802"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7802793"
 RDCMND substituted energy or value "?ZAVE" to "-16.4586396"
Evaluating: 27.7802793--16.4586396
 Parameter: ZTRAN <- "44.2389189"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.5347155"
 Parameter: YTRAN -> "40.6832802"
 Parameter: ZTRAN -> "44.2389189"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    44.534715   40.683280   44.238919
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.199690727E-02"
Evaluating: 9.199690727E-02*360.0
 Parameter: XPHI <- "33.1188866"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515962067"
Evaluating: 0.515962067*360.0
 Parameter: YPHI <- "185.746344"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.695992202"
Evaluating: 0.695992202*360.0
 Parameter: ZPHI <- "250.557193"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.3880957"
 Parameter: YPOS -> "12.7725523"
 Parameter: ZPOS -> "27.7802793"
 Parameter: XPHI -> "33.1188866"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.837539    0.546378
    0.000000   -0.546378    0.837539

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.3880957"
 Parameter: YPOS -> "12.7725523"
 Parameter: ZPOS -> "27.7802793"
 Parameter: YPHI -> "185.746344"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.994975    0.000000    0.100125
    0.000000    1.000000    0.000000
   -0.100125    0.000000   -0.994975

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.3880957"
 Parameter: YPOS -> "12.7725523"
 Parameter: ZPOS -> "27.7802793"
 Parameter: ZPHI -> "250.557193"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.332866   -0.942974    0.000000
    0.942974   -0.332866    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  109.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.388096 XMAX =   37.388096 XAVE =   37.388096
    YMIN =   12.772552 YMAX =   12.772552 YAVE =   12.772552
    ZMIN =   27.780279 ZMAX =   27.780279 ZAVE =   27.780279
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.3880957"
Evaluating: 37.3880957+3.5
 Parameter: XMAX <- "40.8880957"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.7725523"
Evaluating: 12.7725523+3.5
 Parameter: YMAX <- "16.2725523"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7802793"
Evaluating: 27.7802793+3.5
 Parameter: ZMAX <- "31.2802793"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.3880957"
Evaluating: 37.3880957-3.5
 Parameter: XMIN <- "33.8880957"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.7725523"
Evaluating: 12.7725523-3.5
 Parameter: YMIN <- "9.2725523"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7802793"
Evaluating: 27.7802793-3.5
 Parameter: ZMIN <- "24.2802793"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.8880957"
 Parameter: XMIN -> "33.8880957"
 Parameter: YMAX -> "16.2725523"
 Parameter: YMIN -> "9.2725523"
 Parameter: ZMAX -> "31.2802793"
 Parameter: ZMIN -> "24.2802793"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "98" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "98" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "71"
Evaluating: 98-71
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.764862649"
Evaluating: 100.116666*(0.764862649-0.5)
 Parameter: XPOS <- "26.5171654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.852307491"
Evaluating: 100.116666*(0.852307491-0.5)
 Parameter: YPOS <- "35.2718514"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.196921207"
Evaluating: 127.138691*(0.196921207-0.5)+4.2778237
 Parameter: ZPOS <- "-34.2552173"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.2552173" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.5171654"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.5171654-0
 Parameter: XTRAN <- "26.5171654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.2718514"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.2718514-0
 Parameter: YTRAN <- "35.2718514"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.2552173"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.2552173-0
 Parameter: ZTRAN <- "-34.2552173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.5171654"
 Parameter: YTRAN -> "35.2718514"
 Parameter: ZTRAN -> "-34.2552173"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    26.517165   35.271851  -34.255217
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.590510008"
Evaluating: 0.590510008*360.0
 Parameter: XPHI <- "212.583603"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795714274"
Evaluating: 0.795714274*360.0
 Parameter: YPHI <- "286.457139"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537139387"
Evaluating: 0.537139387*360.0
 Parameter: ZPHI <- "193.370179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.5171654"
 Parameter: YPOS -> "35.2718514"
 Parameter: ZPOS -> "-34.2552173"
 Parameter: XPHI -> "212.583603"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.842607   -0.538530
    0.000000    0.538530   -0.842607

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.5171654"
 Parameter: YPOS -> "35.2718514"
 Parameter: ZPOS -> "-34.2552173"
 Parameter: YPHI -> "286.457139"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.283298    0.000000    0.959032
    0.000000    1.000000    0.000000
   -0.959032    0.000000    0.283298

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   73.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.5171654"
 Parameter: YPOS -> "35.2718514"
 Parameter: ZPOS -> "-34.2552173"
 Parameter: ZPHI -> "193.370179"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.972896   -0.231242    0.000000
    0.231242   -0.972896    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.517165 XMAX =   26.517165 XAVE =   26.517165
    YMIN =   35.271851 YMAX =   35.271851 YAVE =   35.271851
    ZMIN =  -34.255217 ZMAX =  -34.255217 ZAVE =  -34.255217
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.5171654"
Evaluating: 26.5171654+3.5
 Parameter: XMAX <- "30.0171654"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.2718514"
Evaluating: 35.2718514+3.5
 Parameter: YMAX <- "38.7718514"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.2552173"
Evaluating: -34.2552173+3.5
 Parameter: ZMAX <- "-30.7552173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.5171654"
Evaluating: 26.5171654-3.5
 Parameter: XMIN <- "23.0171654"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.2718514"
Evaluating: 35.2718514-3.5
 Parameter: YMIN <- "31.7718514"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.2552173"
Evaluating: -34.2552173-3.5
 Parameter: ZMIN <- "-37.7552173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.0171654"
 Parameter: XMIN -> "23.0171654"
 Parameter: YMAX -> "38.7718514"
 Parameter: YMIN -> "31.7718514"
 Parameter: ZMAX -> "-30.7552173"
 Parameter: ZMIN -> "-37.7552173"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "99" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "99" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "71"
Evaluating: 99-71
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.373559045"
Evaluating: 100.116666*(0.373559045-0.5)
 Parameter: XPOS <- "-12.6588469"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.731365087"
Evaluating: 100.116666*(0.731365087-0.5)
 Parameter: YPOS <- "23.1635011"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.394936446"
Evaluating: 127.138691*(0.394936446-0.5)+4.2778237
 Parameter: ZPOS <- "-9.07981903"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.07981903" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.07981903" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "99" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "71"
Evaluating: 99-71
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.980001895"
Evaluating: 100.116666*(0.980001895-0.5)
 Parameter: XPOS <- "48.0561894"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.822453943"
Evaluating: 100.116666*(0.822453943-0.5)
 Parameter: YPOS <- "32.2830137"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.667889725"
Evaluating: 127.138691*(0.667889725-0.5)+4.2778237
 Parameter: ZPOS <- "25.6231036"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.6231036" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.6231036" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.0561894"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.0561894-0
 Parameter: XTRAN <- "48.0561894"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.2830137"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.2830137-0
 Parameter: YTRAN <- "32.2830137"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.6231036"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.6231036-0
 Parameter: ZTRAN <- "25.6231036"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.0561894"
 Parameter: YTRAN -> "32.2830137"
 Parameter: ZTRAN -> "25.6231036"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    48.056189   32.283014   25.623104
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919938013"
Evaluating: 0.919938013*360.0
 Parameter: XPHI <- "331.177685"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.637974003E-03"
Evaluating: 4.637974003E-03*360.0
 Parameter: YPHI <- "1.66967064"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798422618"
Evaluating: 0.798422618*360.0
 Parameter: ZPHI <- "287.432142"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.0561894"
 Parameter: YPOS -> "32.2830137"
 Parameter: ZPOS -> "25.6231036"
 Parameter: XPHI -> "331.177685"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.876119   -0.482095
    0.000000    0.482095    0.876119

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.0561894"
 Parameter: YPOS -> "32.2830137"
 Parameter: ZPOS -> "25.6231036"
 Parameter: YPHI -> "1.66967064"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999575    0.000000   -0.029137
    0.000000    1.000000    0.000000
    0.029137    0.000000    0.999575

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.0561894"
 Parameter: YPOS -> "32.2830137"
 Parameter: ZPOS -> "25.6231036"
 Parameter: ZPHI -> "287.432142"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.299576   -0.954072    0.000000
    0.954072    0.299576    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   72.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.056189 XMAX =   48.056189 XAVE =   48.056189
    YMIN =   32.283014 YMAX =   32.283014 YAVE =   32.283014
    ZMIN =   25.623104 ZMAX =   25.623104 ZAVE =   25.623104
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.0561894"
Evaluating: 48.0561894+3.5
 Parameter: XMAX <- "51.5561894"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.2830137"
Evaluating: 32.2830137+3.5
 Parameter: YMAX <- "35.7830137"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.6231036"
Evaluating: 25.6231036+3.5
 Parameter: ZMAX <- "29.1231036"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.0561894"
Evaluating: 48.0561894-3.5
 Parameter: XMIN <- "44.5561894"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.2830137"
Evaluating: 32.2830137-3.5
 Parameter: YMIN <- "28.7830137"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.6231036"
Evaluating: 25.6231036-3.5
 Parameter: ZMIN <- "22.1231036"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "51.5561894"
 Parameter: XMIN -> "44.5561894"
 Parameter: YMAX -> "35.7830137"
 Parameter: YMIN -> "28.7830137"
 Parameter: ZMAX -> "29.1231036"
 Parameter: ZMIN -> "22.1231036"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "100" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "100" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "100"
 Parameter: NPOS -> "71"
Evaluating: 100-71
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.809829421"
Evaluating: 100.116666*(0.809829421-0.5)
 Parameter: XPOS <- "31.0190887"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.156475312"
Evaluating: 100.116666*(0.156475312-0.5)
 Parameter: YPOS <- "-34.3925465"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "4.403906783E-02"
Evaluating: 127.138691*(4.403906783E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-53.6924524"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.6924524" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.0190887"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.0190887-0
 Parameter: XTRAN <- "31.0190887"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.3925465"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.3925465-0
 Parameter: YTRAN <- "-34.3925465"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.6924524"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.6924524-0
 Parameter: ZTRAN <- "-53.6924524"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.0190887"
 Parameter: YTRAN -> "-34.3925465"
 Parameter: ZTRAN -> "-53.6924524"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    31.019089  -34.392547  -53.692452
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531338648"
Evaluating: 0.531338648*360.0
 Parameter: XPHI <- "191.281913"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.68258905"
Evaluating: 0.68258905*360.0
 Parameter: YPHI <- "245.732058"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.47664186E-02"
Evaluating: 2.47664186E-02*360.0
 Parameter: ZPHI <- "8.9159107"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.0190887"
 Parameter: YPOS -> "-34.3925465"
 Parameter: ZPOS -> "-53.6924524"
 Parameter: XPHI -> "191.281913"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980676   -0.195637
    0.000000    0.195637   -0.980676

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.0190887"
 Parameter: YPOS -> "-34.3925465"
 Parameter: ZPOS -> "-53.6924524"
 Parameter: YPHI -> "245.732058"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.411004    0.000000    0.911633
    0.000000    1.000000    0.000000
   -0.911633    0.000000   -0.411004

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  114.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.0190887"
 Parameter: YPOS -> "-34.3925465"
 Parameter: ZPOS -> "-53.6924524"
 Parameter: ZPHI -> "8.9159107"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.987917    0.154985    0.000000
   -0.154985    0.987917    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.019089 XMAX =   31.019089 XAVE =   31.019089
    YMIN =  -34.392547 YMAX =  -34.392547 YAVE =  -34.392547
    ZMIN =  -53.692452 ZMAX =  -53.692452 ZAVE =  -53.692452
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.0190887"
Evaluating: 31.0190887+3.5
 Parameter: XMAX <- "34.5190887"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.3925465"
Evaluating: -34.3925465+3.5
 Parameter: YMAX <- "-30.8925465"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.6924524"
Evaluating: -53.6924524+3.5
 Parameter: ZMAX <- "-50.1924524"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.0190887"
Evaluating: 31.0190887-3.5
 Parameter: XMIN <- "27.5190887"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.3925465"
Evaluating: -34.3925465-3.5
 Parameter: YMIN <- "-37.8925465"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.6924524"
Evaluating: -53.6924524-3.5
 Parameter: ZMIN <- "-57.1924524"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.5190887"
 Parameter: XMIN -> "27.5190887"
 Parameter: YMAX -> "-30.8925465"
 Parameter: YMIN -> "-37.8925465"
 Parameter: ZMAX -> "-50.1924524"
 Parameter: ZMIN -> "-57.1924524"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "101" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "101" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "101"
 Parameter: NPOS -> "71"
Evaluating: 101-71
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.664530023"
Evaluating: 100.116666*(0.664530023-0.5)
 Parameter: XPOS <- "16.4721974"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.58865837"
Evaluating: 100.116666*(0.58865837-0.5)
 Parameter: YPOS <- "8.87618042"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.134862756"
Evaluating: 127.138691*(0.134862756-0.5)+4.2778237
 Parameter: ZPOS <- "-42.1452475"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.1452475" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.4721974"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.4721974-0
 Parameter: XTRAN <- "16.4721974"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.87618042"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 8.87618042-0
 Parameter: YTRAN <- "8.87618042"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.1452475"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.1452475-0
 Parameter: ZTRAN <- "-42.1452475"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.4721974"
 Parameter: YTRAN -> "8.87618042"
 Parameter: ZTRAN -> "-42.1452475"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    16.472197    8.876180  -42.145248
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531632515"
Evaluating: 0.531632515*360.0
 Parameter: XPHI <- "191.387705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752365573"
Evaluating: 0.752365573*360.0
 Parameter: YPHI <- "270.851606"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.811607918E-02"
Evaluating: 3.811607918E-02*360.0
 Parameter: ZPHI <- "13.7217885"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.4721974"
 Parameter: YPOS -> "8.87618042"
 Parameter: ZPOS -> "-42.1452475"
 Parameter: XPHI -> "191.387705"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980314   -0.197447
    0.000000    0.197447   -0.980314

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.4721974"
 Parameter: YPOS -> "8.87618042"
 Parameter: ZPOS -> "-42.1452475"
 Parameter: YPHI -> "270.851606"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.014863    0.000000    0.999890
    0.000000    1.000000    0.000000
   -0.999890    0.000000    0.014863

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.4721974"
 Parameter: YPOS -> "8.87618042"
 Parameter: ZPOS -> "-42.1452475"
 Parameter: ZPHI -> "13.7217885"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.971459    0.237208    0.000000
   -0.237208    0.971459    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.472197 XMAX =   16.472197 XAVE =   16.472197
    YMIN =    8.876180 YMAX =    8.876180 YAVE =    8.876180
    ZMIN =  -42.145248 ZMAX =  -42.145248 ZAVE =  -42.145248
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.4721974"
Evaluating: 16.4721974+3.5
 Parameter: XMAX <- "19.9721974"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.87618042"
Evaluating: 8.87618042+3.5
 Parameter: YMAX <- "12.3761804"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.1452475"
Evaluating: -42.1452475+3.5
 Parameter: ZMAX <- "-38.6452475"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.4721974"
Evaluating: 16.4721974-3.5
 Parameter: XMIN <- "12.9721974"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.87618042"
Evaluating: 8.87618042-3.5
 Parameter: YMIN <- "5.37618042"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.1452475"
Evaluating: -42.1452475-3.5
 Parameter: ZMIN <- "-45.6452475"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.9721974"
 Parameter: XMIN -> "12.9721974"
 Parameter: YMAX -> "12.3761804"
 Parameter: YMIN -> "5.37618042"
 Parameter: ZMAX -> "-38.6452475"
 Parameter: ZMIN -> "-45.6452475"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "102" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "102" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "102"
 Parameter: NPOS -> "71"
Evaluating: 102-71
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.901070556"
Evaluating: 100.116666*(0.901070556-0.5)
 Parameter: XPOS <- "40.1538469"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.749625665"
Evaluating: 100.116666*(0.749625665-0.5)
 Parameter: YPOS <- "24.9916893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.345705946"
Evaluating: 127.138691*(0.345705946-0.5)+4.2778237
 Parameter: ZPOS <- "-15.3389204"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.3389204" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.1538469"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.1538469-0
 Parameter: XTRAN <- "40.1538469"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.9916893"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.9916893-0
 Parameter: YTRAN <- "24.9916893"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.3389204"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.3389204-0
 Parameter: ZTRAN <- "-15.3389204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.1538469"
 Parameter: YTRAN -> "24.9916893"
 Parameter: ZTRAN -> "-15.3389204"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    40.153847   24.991689  -15.338920
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.474798694"
Evaluating: 0.474798694*360.0
 Parameter: XPHI <- "170.92753"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666041244"
Evaluating: 0.666041244*360.0
 Parameter: YPHI <- "239.774848"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250312995"
Evaluating: 0.250312995*360.0
 Parameter: ZPHI <- "90.1126782"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.1538469"
 Parameter: YPOS -> "24.9916893"
 Parameter: ZPOS -> "-15.3389204"
 Parameter: XPHI -> "170.92753"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.987490    0.157684
    0.000000   -0.157684   -0.987490

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.1538469"
 Parameter: YPOS -> "24.9916893"
 Parameter: ZPOS -> "-15.3389204"
 Parameter: YPHI -> "239.774848"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.503399    0.000000    0.864054
    0.000000    1.000000    0.000000
   -0.864054    0.000000   -0.503399

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.1538469"
 Parameter: YPOS -> "24.9916893"
 Parameter: ZPOS -> "-15.3389204"
 Parameter: ZPHI -> "90.1126782"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.001967    0.999998    0.000000
   -0.999998   -0.001967    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   90.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.153847 XMAX =   40.153847 XAVE =   40.153847
    YMIN =   24.991689 YMAX =   24.991689 YAVE =   24.991689
    ZMIN =  -15.338920 ZMAX =  -15.338920 ZAVE =  -15.338920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.1538469"
Evaluating: 40.1538469+3.5
 Parameter: XMAX <- "43.6538469"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.9916893"
Evaluating: 24.9916893+3.5
 Parameter: YMAX <- "28.4916893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.3389204"
Evaluating: -15.3389204+3.5
 Parameter: ZMAX <- "-11.8389204"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.1538469"
Evaluating: 40.1538469-3.5
 Parameter: XMIN <- "36.6538469"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.9916893"
Evaluating: 24.9916893-3.5
 Parameter: YMIN <- "21.4916893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.3389204"
Evaluating: -15.3389204-3.5
 Parameter: ZMIN <- "-18.8389204"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.6538469"
 Parameter: XMIN -> "36.6538469"
 Parameter: YMAX -> "28.4916893"
 Parameter: YMIN -> "21.4916893"
 Parameter: ZMAX -> "-11.8389204"
 Parameter: ZMIN -> "-18.8389204"
 SELRPN>     26 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      8 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39307 NEG      CLA      31       CLA     -**** MEMB     POPC     197      N             3.7396
39307 NEG      CLA      31       CLA     -**** MEMB     POPC     197      C12           3.5774
39307 NEG      CLA      31       CLA     -**** MEMB     POPC     197      C15           2.8121
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "102" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "102"
 Parameter: NPOS -> "71"
Evaluating: 102-71
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.72247633"
Evaluating: 100.116666*(0.72247633-0.5)
 Parameter: XPOS <- "22.2735884"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.153040232"
Evaluating: 100.116666*(0.153040232-0.5)
 Parameter: YPOS <- "-34.7364552"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.175465332"
Evaluating: 127.138691*(0.175465332-0.5)+4.2778237
 Parameter: ZPOS <- "-36.9830892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.9830892" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.153847 XMAX =   40.153847 XAVE =   40.153847
    YMIN =   24.991689 YMAX =   24.991689 YAVE =   24.991689
    ZMIN =  -15.338920 ZMAX =  -15.338920 ZAVE =  -15.338920
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.2735884"
 RDCMND substituted energy or value "?XAVE" to "40.1538469"
Evaluating: 22.2735884-40.1538469
 Parameter: XTRAN <- "-17.8802585"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.7364552"
 RDCMND substituted energy or value "?YAVE" to "24.9916893"
Evaluating: -34.7364552-24.9916893
 Parameter: YTRAN <- "-59.7281445"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.9830892"
 RDCMND substituted energy or value "?ZAVE" to "-15.3389204"
Evaluating: -36.9830892--15.3389204
 Parameter: ZTRAN <- "-21.6441688"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.8802585"
 Parameter: YTRAN -> "-59.7281445"
 Parameter: ZTRAN -> "-21.6441688"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -17.880259  -59.728144  -21.644169
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930041343"
Evaluating: 0.930041343*360.0
 Parameter: XPHI <- "334.814883"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191408434"
Evaluating: 0.191408434*360.0
 Parameter: YPHI <- "68.9070362"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.868155443"
Evaluating: 0.868155443*360.0
 Parameter: ZPHI <- "312.535959"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.2735884"
 Parameter: YPOS -> "-34.7364552"
 Parameter: ZPOS -> "-36.9830892"
 Parameter: XPHI -> "334.814883"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.904938   -0.425544
    0.000000    0.425544    0.904938

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.2735884"
 Parameter: YPOS -> "-34.7364552"
 Parameter: ZPOS -> "-36.9830892"
 Parameter: YPHI -> "68.9070362"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.359882    0.000000   -0.932998
    0.000000    1.000000    0.000000
    0.932998    0.000000    0.359882

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.2735884"
 Parameter: YPOS -> "-34.7364552"
 Parameter: ZPOS -> "-36.9830892"
 Parameter: ZPHI -> "312.535959"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.676053   -0.736853    0.000000
    0.736853    0.676053    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.273588 XMAX =   22.273588 XAVE =   22.273588
    YMIN =  -34.736455 YMAX =  -34.736455 YAVE =  -34.736455
    ZMIN =  -36.983089 ZMAX =  -36.983089 ZAVE =  -36.983089
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.2735884"
Evaluating: 22.2735884+3.5
 Parameter: XMAX <- "25.7735884"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.7364552"
Evaluating: -34.7364552+3.5
 Parameter: YMAX <- "-31.2364552"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.9830892"
Evaluating: -36.9830892+3.5
 Parameter: ZMAX <- "-33.4830892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.2735884"
Evaluating: 22.2735884-3.5
 Parameter: XMIN <- "18.7735884"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.7364552"
Evaluating: -34.7364552-3.5
 Parameter: YMIN <- "-38.2364552"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.9830892"
Evaluating: -36.9830892-3.5
 Parameter: ZMIN <- "-40.4830892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.7735884"
 Parameter: XMIN -> "18.7735884"
 Parameter: YMAX -> "-31.2364552"
 Parameter: YMIN -> "-38.2364552"
 Parameter: ZMAX -> "-33.4830892"
 Parameter: ZMIN -> "-40.4830892"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "103" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "103" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "71"
Evaluating: 103-71
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.322677776"
Evaluating: 100.116666*(0.322677776-0.5)
 Parameter: XPOS <- "-17.7529099"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.427081318"
Evaluating: 100.116666*(0.427081318-0.5)
 Parameter: YPOS <- "-7.30037533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.821018611"
Evaluating: 127.138691*(0.821018611-0.5)+4.2778237
 Parameter: ZPOS <- "45.0917097"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.0917097" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.0917097" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.7529099"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.7529099-0
 Parameter: XTRAN <- "-17.7529099"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.30037533"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -7.30037533-0
 Parameter: YTRAN <- "-7.30037533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.0917097"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.0917097-0
 Parameter: ZTRAN <- "45.0917097"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.7529099"
 Parameter: YTRAN -> "-7.30037533"
 Parameter: ZTRAN -> "45.0917097"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -17.752910   -7.300375   45.091710
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.260194468"
Evaluating: 0.260194468*360.0
 Parameter: XPHI <- "93.6700085"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75192014"
Evaluating: 0.75192014*360.0
 Parameter: YPHI <- "270.69125"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.849428657"
Evaluating: 0.849428657*360.0
 Parameter: ZPHI <- "305.794317"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.7529099"
 Parameter: YPOS -> "-7.30037533"
 Parameter: ZPOS -> "45.0917097"
 Parameter: XPHI -> "93.6700085"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.064010    0.997949
    0.000000   -0.997949   -0.064010

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.7529099"
 Parameter: YPOS -> "-7.30037533"
 Parameter: ZPOS -> "45.0917097"
 Parameter: YPHI -> "270.69125"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.012064    0.000000    0.999927
    0.000000    1.000000    0.000000
   -0.999927    0.000000    0.012064

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.7529099"
 Parameter: YPOS -> "-7.30037533"
 Parameter: ZPOS -> "45.0917097"
 Parameter: ZPHI -> "305.794317"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.584877   -0.811122    0.000000
    0.811122    0.584877    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.752910 XMAX =  -17.752910 XAVE =  -17.752910
    YMIN =   -7.300375 YMAX =   -7.300375 YAVE =   -7.300375
    ZMIN =   45.091710 ZMAX =   45.091710 ZAVE =   45.091710
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.7529099"
Evaluating: -17.7529099+3.5
 Parameter: XMAX <- "-14.2529099"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.30037533"
Evaluating: -7.30037533+3.5
 Parameter: YMAX <- "-3.80037533"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.0917097"
Evaluating: 45.0917097+3.5
 Parameter: ZMAX <- "48.5917097"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.7529099"
Evaluating: -17.7529099-3.5
 Parameter: XMIN <- "-21.2529099"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.30037533"
Evaluating: -7.30037533-3.5
 Parameter: YMIN <- "-10.8003753"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.0917097"
Evaluating: 45.0917097-3.5
 Parameter: ZMIN <- "41.5917097"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.2529099"
 Parameter: XMIN -> "-21.2529099"
 Parameter: YMAX -> "-3.80037533"
 Parameter: YMIN -> "-10.8003753"
 Parameter: ZMAX -> "48.5917097"
 Parameter: ZMIN -> "41.5917097"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "104" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "104" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "104"
 Parameter: NPOS -> "71"
Evaluating: 104-71
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.878072189"
Evaluating: 100.116666*(0.878072189-0.5)
 Parameter: XPOS <- "37.8513271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.857934873"
Evaluating: 100.116666*(0.857934873-0.5)
 Parameter: YPOS <- "35.8352461"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.800659774"
Evaluating: 127.138691*(0.800659774-0.5)+4.2778237
 Parameter: ZPOS <- "42.5033138"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "42.5033138" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "42.5033138" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.8513271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.8513271-0
 Parameter: XTRAN <- "37.8513271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.8352461"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.8352461-0
 Parameter: YTRAN <- "35.8352461"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.5033138"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 42.5033138-0
 Parameter: ZTRAN <- "42.5033138"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.8513271"
 Parameter: YTRAN -> "35.8352461"
 Parameter: ZTRAN -> "42.5033138"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    37.851327   35.835246   42.503314
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684196043"
Evaluating: 0.684196043*360.0
 Parameter: XPHI <- "246.310575"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272566962"
Evaluating: 0.272566962*360.0
 Parameter: YPHI <- "98.1241063"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.257112988"
Evaluating: 0.257112988*360.0
 Parameter: ZPHI <- "92.5606757"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.8513271"
 Parameter: YPOS -> "35.8352461"
 Parameter: ZPOS -> "42.5033138"
 Parameter: XPHI -> "246.310575"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.401779   -0.915737
    0.000000    0.915737   -0.401779

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  113.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.8513271"
 Parameter: YPOS -> "35.8352461"
 Parameter: ZPOS -> "42.5033138"
 Parameter: YPHI -> "98.1241063"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.141318    0.000000   -0.989964
    0.000000    1.000000    0.000000
    0.989964    0.000000   -0.141318

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.8513271"
 Parameter: YPOS -> "35.8352461"
 Parameter: ZPOS -> "42.5033138"
 Parameter: ZPHI -> "92.5606757"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.044677    0.999001    0.000000
   -0.999001   -0.044677    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.851327 XMAX =   37.851327 XAVE =   37.851327
    YMIN =   35.835246 YMAX =   35.835246 YAVE =   35.835246
    ZMIN =   42.503314 ZMAX =   42.503314 ZAVE =   42.503314
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.8513271"
Evaluating: 37.8513271+3.5
 Parameter: XMAX <- "41.3513271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.8352461"
Evaluating: 35.8352461+3.5
 Parameter: YMAX <- "39.3352461"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.5033138"
Evaluating: 42.5033138+3.5
 Parameter: ZMAX <- "46.0033138"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.8513271"
Evaluating: 37.8513271-3.5
 Parameter: XMIN <- "34.3513271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.8352461"
Evaluating: 35.8352461-3.5
 Parameter: YMIN <- "32.3352461"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.5033138"
Evaluating: 42.5033138-3.5
 Parameter: ZMIN <- "39.0033138"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.3513271"
 Parameter: XMIN -> "34.3513271"
 Parameter: YMAX -> "39.3352461"
 Parameter: YMIN -> "32.3352461"
 Parameter: ZMAX -> "46.0033138"
 Parameter: ZMIN -> "39.0033138"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "105" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "105" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "105"
 Parameter: NPOS -> "71"
Evaluating: 105-71
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.571734325"
Evaluating: 100.116666*(0.571734325-0.5)
 Parameter: XPOS <- "7.18180146"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.318471452"
Evaluating: 100.116666*(0.318471452-0.5)
 Parameter: YPOS <- "-18.174033"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.472253307E-02"
Evaluating: 127.138691*(2.472253307E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-56.1483313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.1483313" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.18180146"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.18180146-0
 Parameter: XTRAN <- "7.18180146"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.174033"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.174033-0
 Parameter: YTRAN <- "-18.174033"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.1483313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.1483313-0
 Parameter: ZTRAN <- "-56.1483313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.18180146"
 Parameter: YTRAN -> "-18.174033"
 Parameter: ZTRAN -> "-56.1483313"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     7.181801  -18.174033  -56.148331
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.126602656E-02"
Evaluating: 9.126602656E-02*360.0
 Parameter: XPHI <- "32.8557696"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.605350005E-02"
Evaluating: 3.605350005E-02*360.0
 Parameter: YPHI <- "12.97926"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395419465"
Evaluating: 0.395419465*360.0
 Parameter: ZPHI <- "142.351007"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.18180146"
 Parameter: YPOS -> "-18.174033"
 Parameter: ZPOS -> "-56.1483313"
 Parameter: XPHI -> "32.8557696"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.840039    0.542526
    0.000000   -0.542526    0.840039

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.18180146"
 Parameter: YPOS -> "-18.174033"
 Parameter: ZPOS -> "-56.1483313"
 Parameter: YPHI -> "12.97926"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.974451    0.000000   -0.224598
    0.000000    1.000000    0.000000
    0.224598    0.000000    0.974451

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.18180146"
 Parameter: YPOS -> "-18.174033"
 Parameter: ZPOS -> "-56.1483313"
 Parameter: ZPHI -> "142.351007"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.791768    0.610822    0.000000
   -0.610822   -0.791768    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.181801 XMAX =    7.181801 XAVE =    7.181801
    YMIN =  -18.174033 YMAX =  -18.174033 YAVE =  -18.174033
    ZMIN =  -56.148331 ZMAX =  -56.148331 ZAVE =  -56.148331
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.18180146"
Evaluating: 7.18180146+3.5
 Parameter: XMAX <- "10.6818015"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.174033"
Evaluating: -18.174033+3.5
 Parameter: YMAX <- "-14.674033"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.1483313"
Evaluating: -56.1483313+3.5
 Parameter: ZMAX <- "-52.6483313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.18180146"
Evaluating: 7.18180146-3.5
 Parameter: XMIN <- "3.68180146"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.174033"
Evaluating: -18.174033-3.5
 Parameter: YMIN <- "-21.674033"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.1483313"
Evaluating: -56.1483313-3.5
 Parameter: ZMIN <- "-59.6483313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.6818015"
 Parameter: XMIN -> "3.68180146"
 Parameter: YMAX -> "-14.674033"
 Parameter: YMIN -> "-21.674033"
 Parameter: ZMAX -> "-52.6483313"
 Parameter: ZMIN -> "-59.6483313"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "106" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "106" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "71"
Evaluating: 106-71
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.649091586"
Evaluating: 100.116666*(0.649091586-0.5)
 Parameter: XPOS <- "14.9265525"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.121440645"
Evaluating: 100.116666*(0.121440645-0.5)
 Parameter: YPOS <- "-37.9001005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.179837037"
Evaluating: 127.138691*(0.179837037-0.5)+4.2778237
 Parameter: ZPOS <- "-36.4272763"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-36.4272763" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.9265525"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.9265525-0
 Parameter: XTRAN <- "14.9265525"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.9001005"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.9001005-0
 Parameter: YTRAN <- "-37.9001005"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.4272763"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -36.4272763-0
 Parameter: ZTRAN <- "-36.4272763"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.9265525"
 Parameter: YTRAN -> "-37.9001005"
 Parameter: ZTRAN -> "-36.4272763"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    14.926552  -37.900101  -36.427276
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.444370293"
Evaluating: 0.444370293*360.0
 Parameter: XPHI <- "159.973305"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846767439"
Evaluating: 0.846767439*360.0
 Parameter: YPHI <- "304.836278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59717711"
Evaluating: 0.59717711*360.0
 Parameter: ZPHI <- "214.98376"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.9265525"
 Parameter: YPOS -> "-37.9001005"
 Parameter: ZPOS -> "-36.4272763"
 Parameter: XPHI -> "159.973305"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.939533    0.342458
    0.000000   -0.342458   -0.939533

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  159.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.9265525"
 Parameter: YPOS -> "-37.9001005"
 Parameter: ZPOS -> "-36.4272763"
 Parameter: YPHI -> "304.836278"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.571233    0.000000    0.820788
    0.000000    1.000000    0.000000
   -0.820788    0.000000    0.571233

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   55.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.9265525"
 Parameter: YPOS -> "-37.9001005"
 Parameter: ZPOS -> "-36.4272763"
 Parameter: ZPHI -> "214.98376"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.819315   -0.573344    0.000000
    0.573344   -0.819315    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.926552 XMAX =   14.926552 XAVE =   14.926552
    YMIN =  -37.900101 YMAX =  -37.900101 YAVE =  -37.900101
    ZMIN =  -36.427276 ZMAX =  -36.427276 ZAVE =  -36.427276
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.9265525"
Evaluating: 14.9265525+3.5
 Parameter: XMAX <- "18.4265525"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.9001005"
Evaluating: -37.9001005+3.5
 Parameter: YMAX <- "-34.4001005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.4272763"
Evaluating: -36.4272763+3.5
 Parameter: ZMAX <- "-32.9272763"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.9265525"
Evaluating: 14.9265525-3.5
 Parameter: XMIN <- "11.4265525"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.9001005"
Evaluating: -37.9001005-3.5
 Parameter: YMIN <- "-41.4001005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.4272763"
Evaluating: -36.4272763-3.5
 Parameter: ZMIN <- "-39.9272763"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.4265525"
 Parameter: XMIN -> "11.4265525"
 Parameter: YMAX -> "-34.4001005"
 Parameter: YMIN -> "-41.4001005"
 Parameter: ZMAX -> "-32.9272763"
 Parameter: ZMIN -> "-39.9272763"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39311 NEG      CLA      35       CLA     -**** NEG      CLA      9        CLA           2.1154
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "106" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "71"
Evaluating: 106-71
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.932133712"
Evaluating: 100.116666*(0.932133712-0.5)
 Parameter: XPOS <- "43.2637865"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.457530737"
Evaluating: 100.116666*(0.457530737-0.5)
 Parameter: YPOS <- "-4.25188102"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "5.256705584E-02"
Evaluating: 127.138691*(5.256705584E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-52.6082151"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-52.6082151" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.926552 XMAX =   14.926552 XAVE =   14.926552
    YMIN =  -37.900101 YMAX =  -37.900101 YAVE =  -37.900101
    ZMIN =  -36.427276 ZMAX =  -36.427276 ZAVE =  -36.427276
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.2637865"
 RDCMND substituted energy or value "?XAVE" to "14.9265525"
Evaluating: 43.2637865-14.9265525
 Parameter: XTRAN <- "28.337234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.25188102"
 RDCMND substituted energy or value "?YAVE" to "-37.9001005"
Evaluating: -4.25188102--37.9001005
 Parameter: YTRAN <- "33.6482195"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-52.6082151"
 RDCMND substituted energy or value "?ZAVE" to "-36.4272763"
Evaluating: -52.6082151--36.4272763
 Parameter: ZTRAN <- "-16.1809388"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.337234"
 Parameter: YTRAN -> "33.6482195"
 Parameter: ZTRAN -> "-16.1809388"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    28.337234   33.648220  -16.180939
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319852999"
Evaluating: 0.319852999*360.0
 Parameter: XPHI <- "115.14708"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541006698"
Evaluating: 0.541006698*360.0
 Parameter: YPHI <- "194.762411"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.288711402"
Evaluating: 0.288711402*360.0
 Parameter: ZPHI <- "103.936105"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.2637865"
 Parameter: YPOS -> "-4.25188102"
 Parameter: ZPOS -> "-52.6082151"
 Parameter: XPHI -> "115.14708"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.424943    0.905220
    0.000000   -0.905220   -0.424943

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.2637865"
 Parameter: YPOS -> "-4.25188102"
 Parameter: ZPOS -> "-52.6082151"
 Parameter: YPHI -> "194.762411"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.966991    0.000000    0.254811
    0.000000    1.000000    0.000000
   -0.254811    0.000000   -0.966991

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  165.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.2637865"
 Parameter: YPOS -> "-4.25188102"
 Parameter: ZPOS -> "-52.6082151"
 Parameter: ZPHI -> "103.936105"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.240840    0.970565    0.000000
   -0.970565   -0.240840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  103.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.263786 XMAX =   43.263786 XAVE =   43.263786
    YMIN =   -4.251881 YMAX =   -4.251881 YAVE =   -4.251881
    ZMIN =  -52.608215 ZMAX =  -52.608215 ZAVE =  -52.608215
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.2637865"
Evaluating: 43.2637865+3.5
 Parameter: XMAX <- "46.7637865"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.25188101"
Evaluating: -4.25188101+3.5
 Parameter: YMAX <- "-0.75188101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-52.6082151"
Evaluating: -52.6082151+3.5
 Parameter: ZMAX <- "-49.1082151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.2637865"
Evaluating: 43.2637865-3.5
 Parameter: XMIN <- "39.7637865"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.25188101"
Evaluating: -4.25188101-3.5
 Parameter: YMIN <- "-7.75188101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-52.6082151"
Evaluating: -52.6082151-3.5
 Parameter: ZMIN <- "-56.1082151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.7637865"
 Parameter: XMIN -> "39.7637865"
 Parameter: YMAX -> "-0.75188101"
 Parameter: YMIN -> "-7.75188101"
 Parameter: ZMAX -> "-49.1082151"
 Parameter: ZMIN -> "-56.1082151"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "107" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "107" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "107"
 Parameter: NPOS -> "71"
Evaluating: 107-71
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.176688365"
Evaluating: 100.116666*(0.176688365-0.5)
 Parameter: XPOS <- "-32.368883"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.466382544"
Evaluating: 100.116666*(0.466382544-0.5)
 Parameter: YPOS <- "-3.36566761"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.894044753"
Evaluating: 127.138691*(0.894044753-0.5)+4.2778237
 Parameter: ZPOS <- "54.3761578"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.3761578" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.3761578" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.368883"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -32.368883-0
 Parameter: XTRAN <- "-32.368883"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.36566761"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.36566761-0
 Parameter: YTRAN <- "-3.36566761"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.3761578"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.3761578-0
 Parameter: ZTRAN <- "54.3761578"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.368883"
 Parameter: YTRAN -> "-3.36566761"
 Parameter: ZTRAN -> "54.3761578"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -32.368883   -3.365668   54.376158
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.310116238"
Evaluating: 0.310116238*360.0
 Parameter: XPHI <- "111.641846"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136244949"
Evaluating: 0.136244949*360.0
 Parameter: YPHI <- "49.0481816"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501702013"
Evaluating: 0.501702013*360.0
 Parameter: ZPHI <- "180.612725"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.368883"
 Parameter: YPOS -> "-3.36566761"
 Parameter: ZPOS -> "54.3761578"
 Parameter: XPHI -> "111.641846"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.368804    0.929507
    0.000000   -0.929507   -0.368804

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.368883"
 Parameter: YPOS -> "-3.36566761"
 Parameter: ZPOS -> "54.3761578"
 Parameter: YPHI -> "49.0481816"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.655424    0.000000   -0.755261
    0.000000    1.000000    0.000000
    0.755261    0.000000    0.655424

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.368883"
 Parameter: YPOS -> "-3.36566761"
 Parameter: ZPOS -> "54.3761578"
 Parameter: ZPHI -> "180.612725"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.999943   -0.010694    0.000000
    0.010694   -0.999943    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.368883 XMAX =  -32.368883 XAVE =  -32.368883
    YMIN =   -3.365668 YMAX =   -3.365668 YAVE =   -3.365668
    ZMIN =   54.376158 ZMAX =   54.376158 ZAVE =   54.376158
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.368883"
Evaluating: -32.368883+3.5
 Parameter: XMAX <- "-28.868883"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.36566761"
Evaluating: -3.36566761+3.5
 Parameter: YMAX <- "0.13433239"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.3761578"
Evaluating: 54.3761578+3.5
 Parameter: ZMAX <- "57.8761578"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.368883"
Evaluating: -32.368883-3.5
 Parameter: XMIN <- "-35.868883"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.36566761"
Evaluating: -3.36566761-3.5
 Parameter: YMIN <- "-6.86566761"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.3761578"
Evaluating: 54.3761578-3.5
 Parameter: ZMIN <- "50.8761578"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.868883"
 Parameter: XMIN -> "-35.868883"
 Parameter: YMAX -> "0.13433239"
 Parameter: YMIN -> "-6.86566761"
 Parameter: ZMAX -> "57.8761578"
 Parameter: ZMIN -> "50.8761578"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "108" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "108" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "108"
 Parameter: NPOS -> "71"
Evaluating: 108-71
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.204372363"
Evaluating: 100.116666*(0.204372363-0.5)
 Parameter: XPOS <- "-29.5972534"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.18423326"
Evaluating: 100.116666*(0.18423326-0.5)
 Parameter: YPOS <- "-31.6135132"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.768355933"
Evaluating: 127.138691*(0.768355933-0.5)+4.2778237
 Parameter: ZPOS <- "38.3962457"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.3962457" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.3962457" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.5972534"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.5972534-0
 Parameter: XTRAN <- "-29.5972534"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.6135132"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.6135132-0
 Parameter: YTRAN <- "-31.6135132"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.3962457"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.3962457-0
 Parameter: ZTRAN <- "38.3962457"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.5972534"
 Parameter: YTRAN -> "-31.6135132"
 Parameter: ZTRAN -> "38.3962457"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -29.597253  -31.613513   38.396246
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272852396"
Evaluating: 0.272852396*360.0
 Parameter: XPHI <- "98.2268626"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.995666089"
Evaluating: 0.995666089*360.0
 Parameter: YPHI <- "358.439792"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729472938"
Evaluating: 0.729472938*360.0
 Parameter: ZPHI <- "262.610258"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.5972534"
 Parameter: YPOS -> "-31.6135132"
 Parameter: ZPOS -> "38.3962457"
 Parameter: XPHI -> "98.2268626"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.143093    0.989709
    0.000000   -0.989709   -0.143093

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.5972534"
 Parameter: YPOS -> "-31.6135132"
 Parameter: ZPOS -> "38.3962457"
 Parameter: YPHI -> "358.439792"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999629    0.000000    0.027227
    0.000000    1.000000    0.000000
   -0.027227    0.000000    0.999629

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    1.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.5972534"
 Parameter: YPOS -> "-31.6135132"
 Parameter: ZPOS -> "38.3962457"
 Parameter: ZPHI -> "262.610258"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.128618   -0.991694    0.000000
    0.991694   -0.128618    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.597253 XMAX =  -29.597253 XAVE =  -29.597253
    YMIN =  -31.613513 YMAX =  -31.613513 YAVE =  -31.613513
    ZMIN =   38.396246 ZMAX =   38.396246 ZAVE =   38.396246
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.5972534"
Evaluating: -29.5972534+3.5
 Parameter: XMAX <- "-26.0972534"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.6135132"
Evaluating: -31.6135132+3.5
 Parameter: YMAX <- "-28.1135132"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.3962457"
Evaluating: 38.3962457+3.5
 Parameter: ZMAX <- "41.8962457"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.5972534"
Evaluating: -29.5972534-3.5
 Parameter: XMIN <- "-33.0972534"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.6135132"
Evaluating: -31.6135132-3.5
 Parameter: YMIN <- "-35.1135132"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.3962457"
Evaluating: 38.3962457-3.5
 Parameter: ZMIN <- "34.8962457"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.0972534"
 Parameter: XMIN -> "-33.0972534"
 Parameter: YMAX -> "-28.1135132"
 Parameter: YMIN -> "-35.1135132"
 Parameter: ZMAX -> "41.8962457"
 Parameter: ZMIN -> "34.8962457"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "109" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "109" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "71"
Evaluating: 109-71
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.668675858"
Evaluating: 100.116666*(0.668675858-0.5)
 Parameter: XPOS <- "16.8872645"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.430954492"
Evaluating: 100.116666*(0.430954492-0.5)
 Parameter: YPOS <- "-6.91260606"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.350799483"
Evaluating: 127.138691*(0.350799483-0.5)+4.2778237
 Parameter: ZPOS <- "-14.6913347"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.6913347" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.6913347" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "109" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "71"
Evaluating: 109-71
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.477706609"
Evaluating: 100.116666*(0.477706609-0.5)
 Parameter: XPOS <- "-2.23193998"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.595956283"
Evaluating: 100.116666*(0.595956283-0.5)
 Parameter: YPOS <- "9.60682314"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.812733993"
Evaluating: 127.138691*(0.812733993-0.5)+4.2778237
 Parameter: ZPOS <- "44.0384142"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.0384142" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.0384142" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.23193998"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.23193998-0
 Parameter: XTRAN <- "-2.23193998"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.60682314"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.60682314-0
 Parameter: YTRAN <- "9.60682314"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.0384142"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.0384142-0
 Parameter: ZTRAN <- "44.0384142"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.23193998"
 Parameter: YTRAN -> "9.60682314"
 Parameter: ZTRAN -> "44.0384142"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -2.231940    9.606823   44.038414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125078579"
Evaluating: 0.125078579*360.0
 Parameter: XPHI <- "45.0282884"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67620785"
Evaluating: 0.67620785*360.0
 Parameter: YPHI <- "243.434826"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.871354635"
Evaluating: 0.871354635*360.0
 Parameter: ZPHI <- "313.687669"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.23193998"
 Parameter: YPOS -> "9.60682314"
 Parameter: ZPOS -> "44.0384142"
 Parameter: XPHI -> "45.0282884"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.706758    0.707456
    0.000000   -0.707456    0.706758

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.23193998"
 Parameter: YPOS -> "9.60682314"
 Parameter: ZPOS -> "44.0384142"
 Parameter: YPHI -> "243.434826"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.447216    0.000000    0.894426
    0.000000    1.000000    0.000000
   -0.894426    0.000000   -0.447216

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.23193998"
 Parameter: YPOS -> "9.60682314"
 Parameter: ZPOS -> "44.0384142"
 Parameter: ZPHI -> "313.687669"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.690727   -0.723116    0.000000
    0.723116    0.690727    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.231940 XMAX =   -2.231940 XAVE =   -2.231940
    YMIN =    9.606823 YMAX =    9.606823 YAVE =    9.606823
    ZMIN =   44.038414 ZMAX =   44.038414 ZAVE =   44.038414
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.23193998"
Evaluating: -2.23193998+3.5
 Parameter: XMAX <- "1.26806002"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.60682314"
Evaluating: 9.60682314+3.5
 Parameter: YMAX <- "13.1068231"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.0384142"
Evaluating: 44.0384142+3.5
 Parameter: ZMAX <- "47.5384142"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.23193998"
Evaluating: -2.23193998-3.5
 Parameter: XMIN <- "-5.73193998"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.60682314"
Evaluating: 9.60682314-3.5
 Parameter: YMIN <- "6.10682314"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.0384142"
Evaluating: 44.0384142-3.5
 Parameter: ZMIN <- "40.5384142"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.26806002"
 Parameter: XMIN -> "-5.73193998"
 Parameter: YMAX -> "13.1068231"
 Parameter: YMIN -> "6.10682314"
 Parameter: ZMAX -> "47.5384142"
 Parameter: ZMIN -> "40.5384142"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39314 NEG      CLA      38       CLA     -**** POS      SOD      25       SOD           3.3504
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "109" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "71"
Evaluating: 109-71
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.611750814"
Evaluating: 100.116666*(0.611750814-0.5)
 Parameter: XPOS <- "11.1881189"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.509186198"
Evaluating: 100.116666*(0.509186198-0.5)
 Parameter: YPOS <- "0.919691517"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.739644648"
Evaluating: 127.138691*(0.739644648-0.5)+4.2778237
 Parameter: ZPOS <- "34.7459306"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.7459306" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.7459306" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.231940 XMAX =   -2.231940 XAVE =   -2.231940
    YMIN =    9.606823 YMAX =    9.606823 YAVE =    9.606823
    ZMIN =   44.038414 ZMAX =   44.038414 ZAVE =   44.038414
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.1881189"
 RDCMND substituted energy or value "?XAVE" to "-2.23193998"
Evaluating: 11.1881189--2.23193998
 Parameter: XTRAN <- "13.4200589"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.919691517"
 RDCMND substituted energy or value "?YAVE" to "9.60682314"
Evaluating: 0.919691517-9.60682314
 Parameter: YTRAN <- "-8.68713162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.7459306"
 RDCMND substituted energy or value "?ZAVE" to "44.0384142"
Evaluating: 34.7459306-44.0384142
 Parameter: ZTRAN <- "-9.2924836"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.4200589"
 Parameter: YTRAN -> "-8.68713162"
 Parameter: ZTRAN -> "-9.2924836"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    13.420059   -8.687132   -9.292484
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.777167122"
Evaluating: 0.777167122*360.0
 Parameter: XPHI <- "279.780164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.10092332"
Evaluating: 0.10092332*360.0
 Parameter: YPHI <- "36.3323952"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877301861"
Evaluating: 0.877301861*360.0
 Parameter: ZPHI <- "315.82867"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.1881189"
 Parameter: YPOS -> "0.919691517"
 Parameter: ZPOS -> "34.7459306"
 Parameter: XPHI -> "279.780164"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.169868   -0.985467
    0.000000    0.985467    0.169868

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.1881189"
 Parameter: YPOS -> "0.919691517"
 Parameter: ZPOS -> "34.7459306"
 Parameter: YPHI -> "36.3323952"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.805593    0.000000   -0.592469
    0.000000    1.000000    0.000000
    0.592469    0.000000    0.805593

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.1881189"
 Parameter: YPOS -> "0.919691517"
 Parameter: ZPOS -> "34.7459306"
 Parameter: ZPHI -> "315.82867"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.717259   -0.696806    0.000000
    0.696806    0.717259    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.188119 XMAX =   11.188119 XAVE =   11.188119
    YMIN =    0.919692 YMAX =    0.919692 YAVE =    0.919692
    ZMIN =   34.745931 ZMAX =   34.745931 ZAVE =   34.745931
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.1881189"
Evaluating: 11.1881189+3.5
 Parameter: XMAX <- "14.6881189"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.919691527"
Evaluating: 0.919691527+3.5
 Parameter: YMAX <- "4.41969153"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.7459306"
Evaluating: 34.7459306+3.5
 Parameter: ZMAX <- "38.2459306"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.1881189"
Evaluating: 11.1881189-3.5
 Parameter: XMIN <- "7.6881189"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.919691527"
Evaluating: 0.919691527-3.5
 Parameter: YMIN <- "-2.58030847"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.7459306"
Evaluating: 34.7459306-3.5
 Parameter: ZMIN <- "31.2459306"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.6881189"
 Parameter: XMIN -> "7.6881189"
 Parameter: YMAX -> "4.41969153"
 Parameter: YMIN -> "-2.58030847"
 Parameter: ZMAX -> "38.2459306"
 Parameter: ZMIN -> "31.2459306"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39314 NEG      CLA      38       CLA     -4690 PROA     GLU      351      OE2           4.5817
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "109" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "71"
Evaluating: 109-71
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.567109294"
Evaluating: 100.116666*(0.567109294-0.5)
 Parameter: XPOS <- "6.71875877"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.363777258"
Evaluating: 100.116666*(0.363777258-0.5)
 Parameter: YPOS <- "-13.6381668"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.96351665"
Evaluating: 127.138691*(0.96351665-0.5)+4.2778237
 Parameter: ZPOS <- "63.2087238"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.2087238" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.2087238" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.188119 XMAX =   11.188119 XAVE =   11.188119
    YMIN =    0.919692 YMAX =    0.919692 YAVE =    0.919692
    ZMIN =   34.745931 ZMAX =   34.745931 ZAVE =   34.745931
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.71875877"
 RDCMND substituted energy or value "?XAVE" to "11.1881189"
Evaluating: 6.71875877-11.1881189
 Parameter: XTRAN <- "-4.46936013"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.6381668"
 RDCMND substituted energy or value "?YAVE" to "0.919691527"
Evaluating: -13.6381668-0.919691527
 Parameter: YTRAN <- "-14.5578583"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.2087238"
 RDCMND substituted energy or value "?ZAVE" to "34.7459306"
Evaluating: 63.2087238-34.7459306
 Parameter: ZTRAN <- "28.4627932"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.46936013"
 Parameter: YTRAN -> "-14.5578583"
 Parameter: ZTRAN -> "28.4627932"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -4.469360  -14.557858   28.462793
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.290339027"
Evaluating: 0.290339027*360.0
 Parameter: XPHI <- "104.52205"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487638073"
Evaluating: 0.487638073*360.0
 Parameter: YPHI <- "175.549706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858979891"
Evaluating: 0.858979891*360.0
 Parameter: ZPHI <- "309.232761"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.71875877"
 Parameter: YPOS -> "-13.6381668"
 Parameter: ZPOS -> "63.2087238"
 Parameter: XPHI -> "104.52205"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.250753    0.968051
    0.000000   -0.968051   -0.250753

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.71875877"
 Parameter: YPOS -> "-13.6381668"
 Parameter: ZPOS -> "63.2087238"
 Parameter: YPHI -> "175.549706"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.996985    0.000000   -0.077594
    0.000000    1.000000    0.000000
    0.077594    0.000000   -0.996985

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.71875877"
 Parameter: YPOS -> "-13.6381668"
 Parameter: ZPOS -> "63.2087238"
 Parameter: ZPHI -> "309.232761"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.632472   -0.774583    0.000000
    0.774583    0.632472    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   50.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.718759 XMAX =    6.718759 XAVE =    6.718759
    YMIN =  -13.638167 YMAX =  -13.638167 YAVE =  -13.638167
    ZMIN =   63.208724 ZMAX =   63.208724 ZAVE =   63.208724
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.71875876"
Evaluating: 6.71875876+3.5
 Parameter: XMAX <- "10.2187588"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.6381668"
Evaluating: -13.6381668+3.5
 Parameter: YMAX <- "-10.1381668"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.2087238"
Evaluating: 63.2087238+3.5
 Parameter: ZMAX <- "66.7087238"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.71875876"
Evaluating: 6.71875876-3.5
 Parameter: XMIN <- "3.21875876"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.6381668"
Evaluating: -13.6381668-3.5
 Parameter: YMIN <- "-17.1381668"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.2087238"
Evaluating: 63.2087238-3.5
 Parameter: ZMIN <- "59.7087238"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.2187588"
 Parameter: XMIN -> "3.21875876"
 Parameter: YMAX -> "-10.1381668"
 Parameter: YMIN -> "-17.1381668"
 Parameter: ZMAX -> "66.7087238"
 Parameter: ZMIN -> "59.7087238"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "110" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "110" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "71"
Evaluating: 110-71
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.998711318"
Evaluating: 100.116666*(0.998711318-0.5)
 Parameter: XPOS <- "49.9293145"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "2.628064861E-02"
Evaluating: 100.116666*(2.628064861E-02-0.5)
 Parameter: YPOS <- "-47.4272021"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.717141074E-02"
Evaluating: 127.138691*(2.717141074E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-55.8369842"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.8369842" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.9293145"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.9293145-0
 Parameter: XTRAN <- "49.9293145"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-47.4272021"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -47.4272021-0
 Parameter: YTRAN <- "-47.4272021"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.8369842"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.8369842-0
 Parameter: ZTRAN <- "-55.8369842"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.9293145"
 Parameter: YTRAN -> "-47.4272021"
 Parameter: ZTRAN -> "-55.8369842"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    49.929314  -47.427202  -55.836984
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524018298"
Evaluating: 0.524018298*360.0
 Parameter: XPHI <- "188.646587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.589852538"
Evaluating: 0.589852538*360.0
 Parameter: YPHI <- "212.346914"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400423706"
Evaluating: 0.400423706*360.0
 Parameter: ZPHI <- "144.152534"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.9293145"
 Parameter: YPOS -> "-47.4272021"
 Parameter: ZPOS -> "-55.8369842"
 Parameter: XPHI -> "188.646587"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.988634   -0.150339
    0.000000    0.150339   -0.988634

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  171.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.9293145"
 Parameter: YPOS -> "-47.4272021"
 Parameter: ZPOS -> "-55.8369842"
 Parameter: YPHI -> "212.346914"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.844824    0.000000    0.535044
    0.000000    1.000000    0.000000
   -0.535044    0.000000   -0.844824

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  147.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.9293145"
 Parameter: YPOS -> "-47.4272021"
 Parameter: ZPOS -> "-55.8369842"
 Parameter: ZPHI -> "144.152534"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.810579    0.585629    0.000000
   -0.585629   -0.810579    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.929314 XMAX =   49.929314 XAVE =   49.929314
    YMIN =  -47.427202 YMAX =  -47.427202 YAVE =  -47.427202
    ZMIN =  -55.836984 ZMAX =  -55.836984 ZAVE =  -55.836984
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.9293145"
Evaluating: 49.9293145+3.5
 Parameter: XMAX <- "53.4293145"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-47.4272021"
Evaluating: -47.4272021+3.5
 Parameter: YMAX <- "-43.9272021"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.8369842"
Evaluating: -55.8369842+3.5
 Parameter: ZMAX <- "-52.3369842"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.9293145"
Evaluating: 49.9293145-3.5
 Parameter: XMIN <- "46.4293145"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-47.4272021"
Evaluating: -47.4272021-3.5
 Parameter: YMIN <- "-50.9272021"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.8369842"
Evaluating: -55.8369842-3.5
 Parameter: ZMIN <- "-59.3369842"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "53.4293145"
 Parameter: XMIN -> "46.4293145"
 Parameter: YMAX -> "-43.9272021"
 Parameter: YMIN -> "-50.9272021"
 Parameter: ZMAX -> "-52.3369842"
 Parameter: ZMIN -> "-59.3369842"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "111" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "111" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "71"
Evaluating: 111-71
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.417551351"
Evaluating: 100.116666*(0.417551351-0.5)
 Parameter: XPOS <- "-8.25448385"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.724392691"
Evaluating: 100.116666*(0.724392691-0.5)
 Parameter: YPOS <- "22.4654481"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.600962467"
Evaluating: 127.138691*(0.600962467-0.5)+4.2778237
 Parameter: ZPOS <- "17.1140596"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.1140596" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.1140596" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.25448385"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.25448385-0
 Parameter: XTRAN <- "-8.25448385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.4654481"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.4654481-0
 Parameter: YTRAN <- "22.4654481"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.1140596"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 17.1140596-0
 Parameter: ZTRAN <- "17.1140596"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.25448385"
 Parameter: YTRAN -> "22.4654481"
 Parameter: ZTRAN -> "17.1140596"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -8.254484   22.465448   17.114060
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847611686"
Evaluating: 0.847611686*360.0
 Parameter: XPHI <- "305.140207"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616248573"
Evaluating: 0.616248573*360.0
 Parameter: YPHI <- "221.849486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.999979634"
Evaluating: 0.999979634*360.0
 Parameter: ZPHI <- "359.992668"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.25448385"
 Parameter: YPOS -> "22.4654481"
 Parameter: ZPOS -> "17.1140596"
 Parameter: XPHI -> "305.140207"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.575579   -0.817746
    0.000000    0.817746    0.575579

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.25448385"
 Parameter: YPOS -> "22.4654481"
 Parameter: ZPOS -> "17.1140596"
 Parameter: YPHI -> "221.849486"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.744900    0.000000    0.667176
    0.000000    1.000000    0.000000
   -0.667176    0.000000   -0.744900

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  138.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.25448385"
 Parameter: YPOS -> "22.4654481"
 Parameter: ZPOS -> "17.1140596"
 Parameter: ZPHI -> "359.992668"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000   -0.000128    0.000000
    0.000128    1.000000    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.254484 XMAX =   -8.254484 XAVE =   -8.254484
    YMIN =   22.465448 YMAX =   22.465448 YAVE =   22.465448
    ZMIN =   17.114060 ZMAX =   17.114060 ZAVE =   17.114060
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.25448385"
Evaluating: -8.25448385+3.5
 Parameter: XMAX <- "-4.75448385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.4654481"
Evaluating: 22.4654481+3.5
 Parameter: YMAX <- "25.9654481"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.1140596"
Evaluating: 17.1140596+3.5
 Parameter: ZMAX <- "20.6140596"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.25448385"
Evaluating: -8.25448385-3.5
 Parameter: XMIN <- "-11.7544838"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.4654481"
Evaluating: 22.4654481-3.5
 Parameter: YMIN <- "18.9654481"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.1140596"
Evaluating: 17.1140596-3.5
 Parameter: ZMIN <- "13.6140596"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.75448385"
 Parameter: XMIN -> "-11.7544838"
 Parameter: YMAX -> "25.9654481"
 Parameter: YMIN -> "18.9654481"
 Parameter: ZMAX -> "20.6140596"
 Parameter: ZMIN -> "13.6140596"
 SELRPN>     38 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      2 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39316 NEG      CLA      40       CLA     -3137 PROA     LEU      259      CD2           4.3680
39316 NEG      CLA      40       CLA     -3199 PROA     LYS      262      CE            4.3155
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "111" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "71"
Evaluating: 111-71
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.637877276E-02"
Evaluating: 100.116666*(7.637877276E-02-0.5)
 Parameter: XPOS <- "-42.4115449"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.768758955"
Evaluating: 100.116666*(0.768758955-0.5)
 Parameter: YPOS <- "26.9072505"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.880185464"
Evaluating: 127.138691*(0.880185464-0.5)+4.2778237
 Parameter: ZPOS <- "52.6141059"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.6141059" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.6141059" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.254484 XMAX =   -8.254484 XAVE =   -8.254484
    YMIN =   22.465448 YMAX =   22.465448 YAVE =   22.465448
    ZMIN =   17.114060 ZMAX =   17.114060 ZAVE =   17.114060
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.4115449"
 RDCMND substituted energy or value "?XAVE" to "-8.25448385"
Evaluating: -42.4115449--8.25448385
 Parameter: XTRAN <- "-34.1570611"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.9072505"
 RDCMND substituted energy or value "?YAVE" to "22.4654481"
Evaluating: 26.9072505-22.4654481
 Parameter: YTRAN <- "4.4418024"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.6141059"
 RDCMND substituted energy or value "?ZAVE" to "17.1140596"
Evaluating: 52.6141059-17.1140596
 Parameter: ZTRAN <- "35.5000463"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.1570611"
 Parameter: YTRAN -> "4.4418024"
 Parameter: ZTRAN -> "35.5000463"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -34.157061    4.441802   35.500046
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451345224"
Evaluating: 0.451345224*360.0
 Parameter: XPHI <- "162.484281"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.191253205"
Evaluating: 0.191253205*360.0
 Parameter: YPHI <- "68.8511538"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.508854975"
Evaluating: 0.508854975*360.0
 Parameter: ZPHI <- "183.187791"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.4115449"
 Parameter: YPOS -> "26.9072505"
 Parameter: ZPOS -> "52.6141059"
 Parameter: XPHI -> "162.484281"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.953634    0.300967
    0.000000   -0.300967   -0.953634

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  162.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.4115449"
 Parameter: YPOS -> "26.9072505"
 Parameter: ZPOS -> "52.6141059"
 Parameter: YPHI -> "68.8511538"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.360792    0.000000   -0.932646
    0.000000    1.000000    0.000000
    0.932646    0.000000    0.360792

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.4115449"
 Parameter: YPOS -> "26.9072505"
 Parameter: ZPOS -> "52.6141059"
 Parameter: ZPHI -> "183.187791"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.998453   -0.055609    0.000000
    0.055609   -0.998453    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  176.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.411545 XMAX =  -42.411545 XAVE =  -42.411545
    YMIN =   26.907250 YMAX =   26.907250 YAVE =   26.907250
    ZMIN =   52.614106 ZMAX =   52.614106 ZAVE =   52.614106
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.4115449"
Evaluating: -42.4115449+3.5
 Parameter: XMAX <- "-38.9115449"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.9072505"
Evaluating: 26.9072505+3.5
 Parameter: YMAX <- "30.4072505"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.6141059"
Evaluating: 52.6141059+3.5
 Parameter: ZMAX <- "56.1141059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.4115449"
Evaluating: -42.4115449-3.5
 Parameter: XMIN <- "-45.9115449"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.9072505"
Evaluating: 26.9072505-3.5
 Parameter: YMIN <- "23.4072505"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.6141059"
Evaluating: 52.6141059-3.5
 Parameter: ZMIN <- "49.1141059"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.9115449"
 Parameter: XMIN -> "-45.9115449"
 Parameter: YMAX -> "30.4072505"
 Parameter: YMIN -> "23.4072505"
 Parameter: ZMAX -> "56.1141059"
 Parameter: ZMIN -> "49.1141059"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "112" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "112" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "112"
 Parameter: NPOS -> "71"
Evaluating: 112-71
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.239067225"
Evaluating: 100.116666*(0.239067225-0.5)
 Parameter: XPOS <- "-26.1237195"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.355068972"
Evaluating: 100.116666*(0.355068972-0.5)
 Parameter: YPOS <- "-14.5100113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.526746282"
Evaluating: 127.138691*(0.526746282-0.5)+4.2778237
 Parameter: ZPOS <- "7.67831098"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.67831098" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.67831098" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "112" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "112"
 Parameter: NPOS -> "71"
Evaluating: 112-71
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.354952074"
Evaluating: 100.116666*(0.354952074-0.5)
 Parameter: XPOS <- "-14.5217148"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.360596218"
Evaluating: 100.116666*(0.360596218-0.5)
 Parameter: YPOS <- "-13.9566419"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.804866203"
Evaluating: 127.138691*(0.804866203-0.5)+4.2778237
 Parameter: ZPOS <- "43.0381137"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.0381137" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.0381137" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.5217148"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.5217148-0
 Parameter: XTRAN <- "-14.5217148"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.9566419"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.9566419-0
 Parameter: YTRAN <- "-13.9566419"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.0381137"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.0381137-0
 Parameter: ZTRAN <- "43.0381137"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.5217148"
 Parameter: YTRAN -> "-13.9566419"
 Parameter: ZTRAN -> "43.0381137"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -14.521715  -13.956642   43.038114
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.813280628"
Evaluating: 0.813280628*360.0
 Parameter: XPHI <- "292.781026"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906058647"
Evaluating: 0.906058647*360.0
 Parameter: YPHI <- "326.181113"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201694237"
Evaluating: 0.201694237*360.0
 Parameter: ZPHI <- "72.6099253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.5217148"
 Parameter: YPOS -> "-13.9566419"
 Parameter: ZPOS -> "43.0381137"
 Parameter: XPHI -> "292.781026"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.387210   -0.921991
    0.000000    0.921991    0.387210

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   67.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.5217148"
 Parameter: YPOS -> "-13.9566419"
 Parameter: ZPOS -> "43.0381137"
 Parameter: YPHI -> "326.181113"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.830801    0.000000    0.556570
    0.000000    1.000000    0.000000
   -0.556570    0.000000    0.830801

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.5217148"
 Parameter: YPOS -> "-13.9566419"
 Parameter: ZPOS -> "43.0381137"
 Parameter: ZPHI -> "72.6099253"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.298875    0.954292    0.000000
   -0.954292    0.298875    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   72.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.521715 XMAX =  -14.521715 XAVE =  -14.521715
    YMIN =  -13.956642 YMAX =  -13.956642 YAVE =  -13.956642
    ZMIN =   43.038114 ZMAX =   43.038114 ZAVE =   43.038114
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.5217148"
Evaluating: -14.5217148+3.5
 Parameter: XMAX <- "-11.0217148"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.9566419"
Evaluating: -13.9566419+3.5
 Parameter: YMAX <- "-10.4566419"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.0381137"
Evaluating: 43.0381137+3.5
 Parameter: ZMAX <- "46.5381137"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.5217148"
Evaluating: -14.5217148-3.5
 Parameter: XMIN <- "-18.0217148"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.9566419"
Evaluating: -13.9566419-3.5
 Parameter: YMIN <- "-17.4566419"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.0381137"
Evaluating: 43.0381137-3.5
 Parameter: ZMIN <- "39.5381137"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.0217148"
 Parameter: XMIN -> "-18.0217148"
 Parameter: YMAX -> "-10.4566419"
 Parameter: YMIN -> "-17.4566419"
 Parameter: ZMAX -> "46.5381137"
 Parameter: ZMIN -> "39.5381137"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "113" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "113" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "113"
 Parameter: NPOS -> "71"
Evaluating: 113-71
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.371275382"
Evaluating: 100.116666*(0.371275382-0.5)
 Parameter: XPOS <- "-12.8874796"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.273109153"
Evaluating: 100.116666*(0.273109153-0.5)
 Parameter: YPOS <- "-22.7155551"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.700068536"
Evaluating: 127.138691*(0.700068536-0.5)+4.2778237
 Parameter: ZPOS <- "29.7142755"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.7142755" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.7142755" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.8874796"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.8874796-0
 Parameter: XTRAN <- "-12.8874796"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.7155551"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.7155551-0
 Parameter: YTRAN <- "-22.7155551"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.7142755"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 29.7142755-0
 Parameter: ZTRAN <- "29.7142755"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.8874796"
 Parameter: YTRAN -> "-22.7155551"
 Parameter: ZTRAN -> "29.7142755"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -12.887480  -22.715555   29.714275
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95291801"
Evaluating: 0.95291801*360.0
 Parameter: XPHI <- "343.050484"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225006017"
Evaluating: 0.225006017*360.0
 Parameter: YPHI <- "81.0021661"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440288298"
Evaluating: 0.440288298*360.0
 Parameter: ZPHI <- "158.503787"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.8874796"
 Parameter: YPOS -> "-22.7155551"
 Parameter: ZPOS -> "29.7142755"
 Parameter: XPHI -> "343.050484"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.956562   -0.291529
    0.000000    0.291529    0.956562

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   16.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.8874796"
 Parameter: YPOS -> "-22.7155551"
 Parameter: ZPOS -> "29.7142755"
 Parameter: YPHI -> "81.0021661"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.156397    0.000000   -0.987694
    0.000000    1.000000    0.000000
    0.987694    0.000000    0.156397

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.8874796"
 Parameter: YPOS -> "-22.7155551"
 Parameter: ZPOS -> "29.7142755"
 Parameter: ZPHI -> "158.503787"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.930442    0.366440    0.000000
   -0.366440   -0.930442    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.887480 XMAX =  -12.887480 XAVE =  -12.887480
    YMIN =  -22.715555 YMAX =  -22.715555 YAVE =  -22.715555
    ZMIN =   29.714275 ZMAX =   29.714275 ZAVE =   29.714275
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.8874796"
Evaluating: -12.8874796+3.5
 Parameter: XMAX <- "-9.3874796"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.7155551"
Evaluating: -22.7155551+3.5
 Parameter: YMAX <- "-19.2155551"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.7142755"
Evaluating: 29.7142755+3.5
 Parameter: ZMAX <- "33.2142755"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.8874796"
Evaluating: -12.8874796-3.5
 Parameter: XMIN <- "-16.3874796"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.7155551"
Evaluating: -22.7155551-3.5
 Parameter: YMIN <- "-26.2155551"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.7142755"
Evaluating: 29.7142755-3.5
 Parameter: ZMIN <- "26.2142755"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.3874796"
 Parameter: XMIN -> "-16.3874796"
 Parameter: YMAX -> "-19.2155551"
 Parameter: YMIN -> "-26.2155551"
 Parameter: ZMAX -> "33.2142755"
 Parameter: ZMIN -> "26.2142755"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "114" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "114" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "114"
 Parameter: NPOS -> "71"
Evaluating: 114-71
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.905100657"
Evaluating: 100.116666*(0.905100657-0.5)
 Parameter: XPOS <- "40.5573272"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.65487484"
Evaluating: 100.116666*(0.65487484-0.5)
 Parameter: YPOS <- "15.5055526"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.528123809"
Evaluating: 127.138691*(0.528123809-0.5)+4.2778237
 Parameter: ZPOS <- "7.85344796"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.85344796" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.85344796" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "114" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "114"
 Parameter: NPOS -> "71"
Evaluating: 114-71
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.584188678"
Evaluating: 100.116666*(0.584188678-0.5)
 Parameter: XPOS <- "8.42868976"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.621632143"
Evaluating: 100.116666*(0.621632143-0.5)
 Parameter: YPOS <- "12.1774046"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.771145451"
Evaluating: 127.138691*(0.771145451-0.5)+4.2778237
 Parameter: ZPOS <- "38.7509014"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.7509014" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.7509014" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.42868976"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.42868976-0
 Parameter: XTRAN <- "8.42868976"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.1774046"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.1774046-0
 Parameter: YTRAN <- "12.1774046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.7509014"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.7509014-0
 Parameter: ZTRAN <- "38.7509014"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.42868976"
 Parameter: YTRAN -> "12.1774046"
 Parameter: ZTRAN -> "38.7509014"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     8.428690   12.177405   38.750901
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.051382204E-02"
Evaluating: 3.051382204E-02*360.0
 Parameter: XPHI <- "10.9849759"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.743017177"
Evaluating: 0.743017177*360.0
 Parameter: YPHI <- "267.486184"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20838242"
Evaluating: 0.20838242*360.0
 Parameter: ZPHI <- "75.0176712"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.42868976"
 Parameter: YPOS -> "12.1774046"
 Parameter: ZPOS -> "38.7509014"
 Parameter: XPHI -> "10.9849759"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.981677    0.190552
    0.000000   -0.190552    0.981677

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   10.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.42868976"
 Parameter: YPOS -> "12.1774046"
 Parameter: ZPOS -> "38.7509014"
 Parameter: YPHI -> "267.486184"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.043860    0.000000    0.999038
    0.000000    1.000000    0.000000
   -0.999038    0.000000   -0.043860

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   92.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.42868976"
 Parameter: YPOS -> "12.1774046"
 Parameter: ZPOS -> "38.7509014"
 Parameter: ZPHI -> "75.0176712"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.258521    0.966006    0.000000
   -0.966006    0.258521    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.428690 XMAX =    8.428690 XAVE =    8.428690
    YMIN =   12.177405 YMAX =   12.177405 YAVE =   12.177405
    ZMIN =   38.750901 ZMAX =   38.750901 ZAVE =   38.750901
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.42868976"
Evaluating: 8.42868976+3.5
 Parameter: XMAX <- "11.9286898"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.1774046"
Evaluating: 12.1774046+3.5
 Parameter: YMAX <- "15.6774046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.7509014"
Evaluating: 38.7509014+3.5
 Parameter: ZMAX <- "42.2509014"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.42868976"
Evaluating: 8.42868976-3.5
 Parameter: XMIN <- "4.92868976"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.1774046"
Evaluating: 12.1774046-3.5
 Parameter: YMIN <- "8.6774046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.7509014"
Evaluating: 38.7509014-3.5
 Parameter: ZMIN <- "35.2509014"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.9286898"
 Parameter: XMIN -> "4.92868976"
 Parameter: YMAX -> "15.6774046"
 Parameter: YMIN -> "8.6774046"
 Parameter: ZMAX -> "42.2509014"
 Parameter: ZMIN -> "35.2509014"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "115" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "115" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "115"
 Parameter: NPOS -> "71"
Evaluating: 115-71
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.386053722"
Evaluating: 100.116666*(0.386053722-0.5)
 Parameter: XPOS <- "-11.4079215"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.524918704"
Evaluating: 100.116666*(0.524918704-0.5)
 Parameter: YPOS <- "2.49477757"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.171187181"
Evaluating: 127.138691*(0.171187181-0.5)+4.2778237
 Parameter: ZPOS <- "-37.5270077"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-37.5270077" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.4079215"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.4079215-0
 Parameter: XTRAN <- "-11.4079215"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.49477757"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.49477757-0
 Parameter: YTRAN <- "2.49477757"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.5270077"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -37.5270077-0
 Parameter: ZTRAN <- "-37.5270077"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.4079215"
 Parameter: YTRAN -> "2.49477757"
 Parameter: ZTRAN -> "-37.5270077"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -11.407922    2.494778  -37.527008
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.292845679"
Evaluating: 0.292845679*360.0
 Parameter: XPHI <- "105.424444"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277462814"
Evaluating: 0.277462814*360.0
 Parameter: YPHI <- "99.886613"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905270024"
Evaluating: 0.905270024*360.0
 Parameter: ZPHI <- "325.897209"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.4079215"
 Parameter: YPOS -> "2.49477757"
 Parameter: ZPOS -> "-37.5270077"
 Parameter: XPHI -> "105.424444"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.265967    0.963982
    0.000000   -0.963982   -0.265967

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.4079215"
 Parameter: YPOS -> "2.49477757"
 Parameter: ZPOS -> "-37.5270077"
 Parameter: YPHI -> "99.886613"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.171699    0.000000   -0.985149
    0.000000    1.000000    0.000000
    0.985149    0.000000   -0.171699

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   99.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.4079215"
 Parameter: YPOS -> "2.49477757"
 Parameter: ZPOS -> "-37.5270077"
 Parameter: ZPHI -> "325.897209"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.828033   -0.560679    0.000000
    0.560679    0.828033    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.407922 XMAX =  -11.407922 XAVE =  -11.407922
    YMIN =    2.494778 YMAX =    2.494778 YAVE =    2.494778
    ZMIN =  -37.527008 ZMAX =  -37.527008 ZAVE =  -37.527008
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.4079215"
Evaluating: -11.4079215+3.5
 Parameter: XMAX <- "-7.9079215"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.49477757"
Evaluating: 2.49477757+3.5
 Parameter: YMAX <- "5.99477757"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.5270077"
Evaluating: -37.5270077+3.5
 Parameter: ZMAX <- "-34.0270077"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.4079215"
Evaluating: -11.4079215-3.5
 Parameter: XMIN <- "-14.9079215"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.49477757"
Evaluating: 2.49477757-3.5
 Parameter: YMIN <- "-1.00522243"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.5270077"
Evaluating: -37.5270077-3.5
 Parameter: ZMIN <- "-41.0270077"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.9079215"
 Parameter: XMIN -> "-14.9079215"
 Parameter: YMAX -> "5.99477757"
 Parameter: YMIN -> "-1.00522243"
 Parameter: ZMAX -> "-34.0270077"
 Parameter: ZMIN -> "-41.0270077"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "116" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "116" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "116"
 Parameter: NPOS -> "71"
Evaluating: 116-71
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.866525667"
Evaluating: 100.116666*(0.866525667-0.5)
 Parameter: XPOS <- "36.6953278"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.191384623"
Evaluating: 100.116666*(0.191384623-0.5)
 Parameter: YPOS <- "-30.8975426"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.932896342"
Evaluating: 127.138691*(0.932896342-0.5)+4.2778237
 Parameter: ZPOS <- "59.315698"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.315698" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.315698" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.6953278"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.6953278-0
 Parameter: XTRAN <- "36.6953278"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.8975426"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.8975426-0
 Parameter: YTRAN <- "-30.8975426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.315698"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.315698-0
 Parameter: ZTRAN <- "59.315698"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.6953278"
 Parameter: YTRAN -> "-30.8975426"
 Parameter: ZTRAN -> "59.315698"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    36.695328  -30.897543   59.315698
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.271940395"
Evaluating: 0.271940395*360.0
 Parameter: XPHI <- "97.8985422"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123536382"
Evaluating: 0.123536382*360.0
 Parameter: YPHI <- "44.4730975"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641103595"
Evaluating: 0.641103595*360.0
 Parameter: ZPHI <- "230.797294"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.6953278"
 Parameter: YPOS -> "-30.8975426"
 Parameter: ZPOS -> "59.315698"
 Parameter: XPHI -> "97.8985422"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.137419    0.990513
    0.000000   -0.990513   -0.137419

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.6953278"
 Parameter: YPOS -> "-30.8975426"
 Parameter: ZPOS -> "59.315698"
 Parameter: YPHI -> "44.4730975"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.713579    0.000000   -0.700574
    0.000000    1.000000    0.000000
    0.700574    0.000000    0.713579

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.6953278"
 Parameter: YPOS -> "-30.8975426"
 Parameter: ZPOS -> "59.315698"
 Parameter: ZPHI -> "230.797294"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.632066   -0.774915    0.000000
    0.774915   -0.632066    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.695328 XMAX =   36.695328 XAVE =   36.695328
    YMIN =  -30.897543 YMAX =  -30.897543 YAVE =  -30.897543
    ZMIN =   59.315698 ZMAX =   59.315698 ZAVE =   59.315698
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.6953278"
Evaluating: 36.6953278+3.5
 Parameter: XMAX <- "40.1953278"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.8975426"
Evaluating: -30.8975426+3.5
 Parameter: YMAX <- "-27.3975426"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.315698"
Evaluating: 59.315698+3.5
 Parameter: ZMAX <- "62.815698"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.6953278"
Evaluating: 36.6953278-3.5
 Parameter: XMIN <- "33.1953278"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.8975426"
Evaluating: -30.8975426-3.5
 Parameter: YMIN <- "-34.3975426"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.315698"
Evaluating: 59.315698-3.5
 Parameter: ZMIN <- "55.815698"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.1953278"
 Parameter: XMIN -> "33.1953278"
 Parameter: YMAX -> "-27.3975426"
 Parameter: YMIN -> "-34.3975426"
 Parameter: ZMAX -> "62.815698"
 Parameter: ZMIN -> "55.815698"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "117" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "117" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "71"
Evaluating: 117-71
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.905543433"
Evaluating: 100.116666*(0.905543433-0.5)
 Parameter: XPOS <- "40.6016564"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.650586081"
Evaluating: 100.116666*(0.650586081-0.5)
 Parameter: YPOS <- "15.0761764"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.676251165"
Evaluating: 127.138691*(0.676251165-0.5)+4.2778237
 Parameter: ZPOS <- "26.6861661"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.6861661" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.6861661" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.6016564"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.6016564-0
 Parameter: XTRAN <- "40.6016564"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.0761764"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.0761764-0
 Parameter: YTRAN <- "15.0761764"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.6861661"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.6861661-0
 Parameter: ZTRAN <- "26.6861661"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.6016564"
 Parameter: YTRAN -> "15.0761764"
 Parameter: ZTRAN -> "26.6861661"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    40.601656   15.076176   26.686166
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.457847251"
Evaluating: 0.457847251*360.0
 Parameter: XPHI <- "164.82501"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.791421298"
Evaluating: 0.791421298*360.0
 Parameter: YPHI <- "284.911667"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.446462158"
Evaluating: 0.446462158*360.0
 Parameter: ZPHI <- "160.726377"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.6016564"
 Parameter: YPOS -> "15.0761764"
 Parameter: ZPOS -> "26.6861661"
 Parameter: XPHI -> "164.82501"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.965131    0.261768
    0.000000   -0.261768   -0.965131

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  164.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.6016564"
 Parameter: YPOS -> "15.0761764"
 Parameter: ZPOS -> "26.6861661"
 Parameter: YPHI -> "284.911667"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.257330    0.000000    0.966324
    0.000000    1.000000    0.000000
   -0.966324    0.000000    0.257330

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   75.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.6016564"
 Parameter: YPOS -> "15.0761764"
 Parameter: ZPOS -> "26.6861661"
 Parameter: ZPHI -> "160.726377"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.943953    0.330080    0.000000
   -0.330080   -0.943953    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  160.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.601656 XMAX =   40.601656 XAVE =   40.601656
    YMIN =   15.076176 YMAX =   15.076176 YAVE =   15.076176
    ZMIN =   26.686166 ZMAX =   26.686166 ZAVE =   26.686166
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.6016564"
Evaluating: 40.6016564+3.5
 Parameter: XMAX <- "44.1016564"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.0761764"
Evaluating: 15.0761764+3.5
 Parameter: YMAX <- "18.5761764"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.6861661"
Evaluating: 26.6861661+3.5
 Parameter: ZMAX <- "30.1861661"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.6016564"
Evaluating: 40.6016564-3.5
 Parameter: XMIN <- "37.1016564"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.0761764"
Evaluating: 15.0761764-3.5
 Parameter: YMIN <- "11.5761764"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.6861661"
Evaluating: 26.6861661-3.5
 Parameter: ZMIN <- "23.1861661"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.1016564"
 Parameter: XMIN -> "37.1016564"
 Parameter: YMAX -> "18.5761764"
 Parameter: YMIN -> "11.5761764"
 Parameter: ZMAX -> "30.1861661"
 Parameter: ZMIN -> "23.1861661"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      1 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "118" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "118" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "71"
Evaluating: 118-71
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.241957907"
Evaluating: 100.116666*(0.241957907-0.5)
 Parameter: XPOS <- "-25.834314"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.285301777"
Evaluating: 100.116666*(0.285301777-0.5)
 Parameter: YPOS <- "-21.4948703"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.59305727"
Evaluating: 127.138691*(0.59305727-0.5)+4.2778237
 Parameter: ZPOS <- "16.1090032"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.1090032" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.1090032" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.834314"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.834314-0
 Parameter: XTRAN <- "-25.834314"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.4948703"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.4948703-0
 Parameter: YTRAN <- "-21.4948703"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.1090032"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 16.1090032-0
 Parameter: ZTRAN <- "16.1090032"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.834314"
 Parameter: YTRAN -> "-21.4948703"
 Parameter: ZTRAN -> "16.1090032"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -25.834314  -21.494870   16.109003
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748004069"
Evaluating: 0.748004069*360.0
 Parameter: XPHI <- "269.281465"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.681502012"
Evaluating: 0.681502012*360.0
 Parameter: YPHI <- "245.340724"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674017232"
Evaluating: 0.674017232*360.0
 Parameter: ZPHI <- "242.646204"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.834314"
 Parameter: YPOS -> "-21.4948703"
 Parameter: ZPOS -> "16.1090032"
 Parameter: XPHI -> "269.281465"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.012540   -0.999921
    0.000000    0.999921   -0.012540

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.834314"
 Parameter: YPOS -> "-21.4948703"
 Parameter: ZPOS -> "16.1090032"
 Parameter: YPHI -> "245.340724"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.417221    0.000000    0.908805
    0.000000    1.000000    0.000000
   -0.908805    0.000000   -0.417221

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  114.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.834314"
 Parameter: YPOS -> "-21.4948703"
 Parameter: ZPOS -> "16.1090032"
 Parameter: ZPHI -> "242.646204"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.459484   -0.888186    0.000000
    0.888186   -0.459484    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.834314 XMAX =  -25.834314 XAVE =  -25.834314
    YMIN =  -21.494870 YMAX =  -21.494870 YAVE =  -21.494870
    ZMIN =   16.109003 ZMAX =   16.109003 ZAVE =   16.109003
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.834314"
Evaluating: -25.834314+3.5
 Parameter: XMAX <- "-22.334314"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.4948703"
Evaluating: -21.4948703+3.5
 Parameter: YMAX <- "-17.9948703"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.1090032"
Evaluating: 16.1090032+3.5
 Parameter: ZMAX <- "19.6090032"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.834314"
Evaluating: -25.834314-3.5
 Parameter: XMIN <- "-29.334314"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.4948703"
Evaluating: -21.4948703-3.5
 Parameter: YMIN <- "-24.9948703"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.1090032"
Evaluating: 16.1090032-3.5
 Parameter: ZMIN <- "12.6090032"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.334314"
 Parameter: XMIN -> "-29.334314"
 Parameter: YMAX -> "-17.9948703"
 Parameter: YMIN -> "-24.9948703"
 Parameter: ZMAX -> "19.6090032"
 Parameter: ZMIN -> "12.6090032"
 SELRPN>     30 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     20 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39323 NEG      CLA      47       CLA     -7603 MEMB     POPC     22       O14           3.5011
39323 NEG      CLA      47       CLA     -7605 MEMB     POPC     22       O11           3.7327
39323 NEG      CLA      47       CLA     -7606 MEMB     POPC     22       C1            3.5340
39323 NEG      CLA      47       CLA     -7609 MEMB     POPC     22       C2            3.8711
39323 NEG      CLA      47       CLA     -7611 MEMB     POPC     22       O21           3.1316
39323 NEG      CLA      47       CLA     -7612 MEMB     POPC     22       C21           2.1727
39323 NEG      CLA      47       CLA     -7613 MEMB     POPC     22       O22           1.6895
39323 NEG      CLA      47       CLA     -7614 MEMB     POPC     22       C22           2.8539
39323 NEG      CLA      47       CLA     -7626 MEMB     POPC     22       C23           3.7008
39323 NEG      CLA      47       CLA     -8675 MEMB     POPC     30       O14           3.7547
39323 NEG      CLA      47       CLA     -8677 MEMB     POPC     30       O11           3.6982
39323 NEG      CLA      47       CLA     -8678 MEMB     POPC     30       C1            3.6629
39323 NEG      CLA      47       CLA     -8681 MEMB     POPC     30       C2            3.7436
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "118" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "71"
Evaluating: 118-71
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.419887461"
Evaluating: 100.116666*(0.419887461-0.5)
 Parameter: XPOS <- "-8.02060031"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.296752485"
Evaluating: 100.116666*(0.296752485-0.5)
 Parameter: YPOS <- "-20.3484636"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.883473174E-02"
Evaluating: 127.138691*(2.883473174E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-55.6255118"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.6255118" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.834314 XMAX =  -25.834314 XAVE =  -25.834314
    YMIN =  -21.494870 YMAX =  -21.494870 YAVE =  -21.494870
    ZMIN =   16.109003 ZMAX =   16.109003 ZAVE =   16.109003
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.02060031"
 RDCMND substituted energy or value "?XAVE" to "-25.834314"
Evaluating: -8.02060031--25.834314
 Parameter: XTRAN <- "17.8137137"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.3484636"
 RDCMND substituted energy or value "?YAVE" to "-21.4948703"
Evaluating: -20.3484636--21.4948703
 Parameter: YTRAN <- "1.1464067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.6255118"
 RDCMND substituted energy or value "?ZAVE" to "16.1090032"
Evaluating: -55.6255118-16.1090032
 Parameter: ZTRAN <- "-71.734515"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.8137137"
 Parameter: YTRAN -> "1.1464067"
 Parameter: ZTRAN -> "-71.734515"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    17.813714    1.146407  -71.734515
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.849167972"
Evaluating: 0.849167972*360.0
 Parameter: XPHI <- "305.70047"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909793875"
Evaluating: 0.909793875*360.0
 Parameter: YPHI <- "327.525795"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.311794197"
Evaluating: 0.311794197*360.0
 Parameter: ZPHI <- "112.245911"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.02060031"
 Parameter: YPOS -> "-20.3484636"
 Parameter: ZPOS -> "-55.6255118"
 Parameter: XPHI -> "305.70047"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.583548   -0.812079
    0.000000    0.812079    0.583548

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.02060031"
 Parameter: YPOS -> "-20.3484636"
 Parameter: ZPOS -> "-55.6255118"
 Parameter: YPHI -> "327.525795"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.843633    0.000000    0.536920
    0.000000    1.000000    0.000000
   -0.536920    0.000000    0.843633

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.02060031"
 Parameter: YPOS -> "-20.3484636"
 Parameter: ZPOS -> "-55.6255118"
 Parameter: ZPHI -> "112.245911"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.378583    0.925568    0.000000
   -0.925568   -0.378583    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.020600 XMAX =   -8.020600 XAVE =   -8.020600
    YMIN =  -20.348464 YMAX =  -20.348464 YAVE =  -20.348464
    ZMIN =  -55.625512 ZMAX =  -55.625512 ZAVE =  -55.625512
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.02060031"
Evaluating: -8.02060031+3.5
 Parameter: XMAX <- "-4.52060031"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.3484636"
Evaluating: -20.3484636+3.5
 Parameter: YMAX <- "-16.8484636"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.6255118"
Evaluating: -55.6255118+3.5
 Parameter: ZMAX <- "-52.1255118"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.02060031"
Evaluating: -8.02060031-3.5
 Parameter: XMIN <- "-11.5206003"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.3484636"
Evaluating: -20.3484636-3.5
 Parameter: YMIN <- "-23.8484636"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.6255118"
Evaluating: -55.6255118-3.5
 Parameter: ZMIN <- "-59.1255118"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.52060031"
 Parameter: XMIN -> "-11.5206003"
 Parameter: YMAX -> "-16.8484636"
 Parameter: YMIN -> "-23.8484636"
 Parameter: ZMAX -> "-52.1255118"
 Parameter: ZMIN -> "-59.1255118"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "119" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "119" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "119"
 Parameter: NPOS -> "71"
Evaluating: 119-71
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.317993606"
Evaluating: 100.116666*(0.317993606-0.5)
 Parameter: XPOS <- "-18.2218734"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.941684294E-02"
Evaluating: 100.116666*(7.941684294E-02-0.5)
 Parameter: YPOS <- "-42.1073835"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.143929895"
Evaluating: 127.138691*(0.143929895-0.5)+4.2778237
 Parameter: ZPOS <- "-40.9924634"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.9924634" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.2218734"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.2218734-0
 Parameter: XTRAN <- "-18.2218734"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.1073835"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.1073835-0
 Parameter: YTRAN <- "-42.1073835"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.9924634"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.9924634-0
 Parameter: ZTRAN <- "-40.9924634"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.2218734"
 Parameter: YTRAN -> "-42.1073835"
 Parameter: ZTRAN -> "-40.9924634"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -18.221873  -42.107383  -40.992463
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.237346944E-02"
Evaluating: 9.237346944E-02*360.0
 Parameter: XPHI <- "33.254449"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909326598"
Evaluating: 0.909326598*360.0
 Parameter: YPHI <- "327.357575"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18929134"
Evaluating: 0.18929134*360.0
 Parameter: ZPHI <- "68.1448824"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.2218734"
 Parameter: YPOS -> "-42.1073835"
 Parameter: ZPOS -> "-40.9924634"
 Parameter: XPHI -> "33.254449"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.836244    0.548358
    0.000000   -0.548358    0.836244

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.2218734"
 Parameter: YPOS -> "-42.1073835"
 Parameter: ZPOS -> "-40.9924634"
 Parameter: YPHI -> "327.357575"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.842053    0.000000    0.539394
    0.000000    1.000000    0.000000
   -0.539394    0.000000    0.842053

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.2218734"
 Parameter: YPOS -> "-42.1073835"
 Parameter: ZPOS -> "-40.9924634"
 Parameter: ZPHI -> "68.1448824"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.372261    0.928128    0.000000
   -0.928128    0.372261    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   68.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.221873 XMAX =  -18.221873 XAVE =  -18.221873
    YMIN =  -42.107383 YMAX =  -42.107383 YAVE =  -42.107383
    ZMIN =  -40.992463 ZMAX =  -40.992463 ZAVE =  -40.992463
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.2218734"
Evaluating: -18.2218734+3.5
 Parameter: XMAX <- "-14.7218734"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.1073835"
Evaluating: -42.1073835+3.5
 Parameter: YMAX <- "-38.6073835"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.9924634"
Evaluating: -40.9924634+3.5
 Parameter: ZMAX <- "-37.4924634"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.2218734"
Evaluating: -18.2218734-3.5
 Parameter: XMIN <- "-21.7218734"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.1073835"
Evaluating: -42.1073835-3.5
 Parameter: YMIN <- "-45.6073835"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.9924634"
Evaluating: -40.9924634-3.5
 Parameter: ZMIN <- "-44.4924634"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.7218734"
 Parameter: XMIN -> "-21.7218734"
 Parameter: YMAX -> "-38.6073835"
 Parameter: YMIN -> "-45.6073835"
 Parameter: ZMAX -> "-37.4924634"
 Parameter: ZMIN -> "-44.4924634"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "120" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "120" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "120"
 Parameter: NPOS -> "71"
Evaluating: 120-71
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.688210943"
Evaluating: 100.116666*(0.688210943-0.5)
 Parameter: XPOS <- "18.8430521"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.468180051"
Evaluating: 100.116666*(0.468180051-0.5)
 Parameter: YPOS <- "-3.18570721"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.938152161"
Evaluating: 127.138691*(0.938152161-0.5)+4.2778237
 Parameter: ZPOS <- "59.9839159"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.9839159" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.9839159" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.8430521"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.8430521-0
 Parameter: XTRAN <- "18.8430521"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.18570721"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -3.18570721-0
 Parameter: YTRAN <- "-3.18570721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.9839159"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.9839159-0
 Parameter: ZTRAN <- "59.9839159"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.8430521"
 Parameter: YTRAN -> "-3.18570721"
 Parameter: ZTRAN -> "59.9839159"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    18.843052   -3.185707   59.983916
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.540182039"
Evaluating: 0.540182039*360.0
 Parameter: XPHI <- "194.465534"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133995852"
Evaluating: 0.133995852*360.0
 Parameter: YPHI <- "48.2385067"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835685492"
Evaluating: 0.835685492*360.0
 Parameter: ZPHI <- "300.846777"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.8430521"
 Parameter: YPOS -> "-3.18570721"
 Parameter: ZPOS -> "59.9839159"
 Parameter: XPHI -> "194.465534"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.968298   -0.249798
    0.000000    0.249798   -0.968298

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.8430521"
 Parameter: YPOS -> "-3.18570721"
 Parameter: ZPOS -> "59.9839159"
 Parameter: YPHI -> "48.2385067"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.666031    0.000000   -0.745924
    0.000000    1.000000    0.000000
    0.745924    0.000000    0.666031

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   48.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.8430521"
 Parameter: YPOS -> "-3.18570721"
 Parameter: ZPOS -> "59.9839159"
 Parameter: ZPHI -> "300.846777"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.512744   -0.858542    0.000000
    0.858542    0.512744    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   59.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.843052 XMAX =   18.843052 XAVE =   18.843052
    YMIN =   -3.185707 YMAX =   -3.185707 YAVE =   -3.185707
    ZMIN =   59.983916 ZMAX =   59.983916 ZAVE =   59.983916
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.8430521"
Evaluating: 18.8430521+3.5
 Parameter: XMAX <- "22.3430521"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.18570721"
Evaluating: -3.18570721+3.5
 Parameter: YMAX <- "0.31429279"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.9839159"
Evaluating: 59.9839159+3.5
 Parameter: ZMAX <- "63.4839159"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.8430521"
Evaluating: 18.8430521-3.5
 Parameter: XMIN <- "15.3430521"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.18570721"
Evaluating: -3.18570721-3.5
 Parameter: YMIN <- "-6.68570721"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.9839159"
Evaluating: 59.9839159-3.5
 Parameter: ZMIN <- "56.4839159"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.3430521"
 Parameter: XMIN -> "15.3430521"
 Parameter: YMAX -> "0.31429279"
 Parameter: YMIN -> "-6.68570721"
 Parameter: ZMAX -> "63.4839159"
 Parameter: ZMIN -> "56.4839159"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "121" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "121" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "71"
Evaluating: 121-71
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.455355627"
Evaluating: 100.116666*(0.455355627-0.5)
 Parameter: XPOS <- "-4.46964578"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.357299749"
Evaluating: 100.116666*(0.357299749-0.5)
 Parameter: YPOS <- "-14.2866734"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.222824662"
Evaluating: 127.138691*(0.222824662-0.5)+4.2778237
 Parameter: ZPOS <- "-30.961886"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.961886" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.46964578"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.46964578-0
 Parameter: XTRAN <- "-4.46964578"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.2866734"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.2866734-0
 Parameter: YTRAN <- "-14.2866734"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.961886"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.961886-0
 Parameter: ZTRAN <- "-30.961886"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.46964578"
 Parameter: YTRAN -> "-14.2866734"
 Parameter: ZTRAN -> "-30.961886"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -4.469646  -14.286673  -30.961886
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471029171"
Evaluating: 0.471029171*360.0
 Parameter: XPHI <- "169.570502"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335332933"
Evaluating: 0.335332933*360.0
 Parameter: YPHI <- "120.719856"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.622007925"
Evaluating: 0.622007925*360.0
 Parameter: ZPHI <- "223.922853"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.46964578"
 Parameter: YPOS -> "-14.2866734"
 Parameter: ZPOS -> "-30.961886"
 Parameter: XPHI -> "169.570502"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.983478    0.181026
    0.000000   -0.181026   -0.983478

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  169.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.46964578"
 Parameter: YPOS -> "-14.2866734"
 Parameter: ZPOS -> "-30.961886"
 Parameter: YPHI -> "120.719856"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.510841    0.000000   -0.859675
    0.000000    1.000000    0.000000
    0.859675    0.000000   -0.510841

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.46964578"
 Parameter: YPOS -> "-14.2866734"
 Parameter: ZPOS -> "-30.961886"
 Parameter: ZPHI -> "223.922853"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.720274   -0.693689    0.000000
    0.693689   -0.720274    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.469646 XMAX =   -4.469646 XAVE =   -4.469646
    YMIN =  -14.286673 YMAX =  -14.286673 YAVE =  -14.286673
    ZMIN =  -30.961886 ZMAX =  -30.961886 ZAVE =  -30.961886
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.46964578"
Evaluating: -4.46964578+3.5
 Parameter: XMAX <- "-0.96964578"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.2866734"
Evaluating: -14.2866734+3.5
 Parameter: YMAX <- "-10.7866734"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.961886"
Evaluating: -30.961886+3.5
 Parameter: ZMAX <- "-27.461886"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.46964578"
Evaluating: -4.46964578-3.5
 Parameter: XMIN <- "-7.96964578"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.2866734"
Evaluating: -14.2866734-3.5
 Parameter: YMIN <- "-17.7866734"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.961886"
Evaluating: -30.961886-3.5
 Parameter: ZMIN <- "-34.461886"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.96964578"
 Parameter: XMIN -> "-7.96964578"
 Parameter: YMAX -> "-10.7866734"
 Parameter: YMIN -> "-17.7866734"
 Parameter: ZMAX -> "-27.461886"
 Parameter: ZMIN -> "-34.461886"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "122" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "122" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "71"
Evaluating: 122-71
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.459424894"
Evaluating: 100.116666*(0.459424894-0.5)
 Parameter: XPOS <- "-4.06224434"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "9.715625191E-02"
Evaluating: 100.116666*(9.715625191E-02-0.5)
 Parameter: YPOS <- "-40.331373"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.638672747"
Evaluating: 127.138691*(0.638672747-0.5)+4.2778237
 Parameter: ZPOS <- "21.9084952"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.9084952" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.9084952" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.06224434"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.06224434-0
 Parameter: XTRAN <- "-4.06224434"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.331373"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.331373-0
 Parameter: YTRAN <- "-40.331373"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.9084952"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.9084952-0
 Parameter: ZTRAN <- "21.9084952"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.06224434"
 Parameter: YTRAN -> "-40.331373"
 Parameter: ZTRAN -> "21.9084952"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -4.062244  -40.331373   21.908495
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.90837586"
Evaluating: 0.90837586*360.0
 Parameter: XPHI <- "327.01531"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418543659"
Evaluating: 0.418543659*360.0
 Parameter: YPHI <- "150.675717"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197004054"
Evaluating: 0.197004054*360.0
 Parameter: ZPHI <- "70.9214594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.06224434"
 Parameter: YPOS -> "-40.331373"
 Parameter: ZPOS -> "21.9084952"
 Parameter: XPHI -> "327.01531"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.838816   -0.544415
    0.000000    0.544415    0.838816

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.06224434"
 Parameter: YPOS -> "-40.331373"
 Parameter: ZPOS -> "21.9084952"
 Parameter: YPHI -> "150.675717"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.871862    0.000000   -0.489752
    0.000000    1.000000    0.000000
    0.489752    0.000000   -0.871862

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  150.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.06224434"
 Parameter: YPOS -> "-40.331373"
 Parameter: ZPOS -> "21.9084952"
 Parameter: ZPHI -> "70.9214594"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.326864    0.945071    0.000000
   -0.945071    0.326864    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.062244 XMAX =   -4.062244 XAVE =   -4.062244
    YMIN =  -40.331373 YMAX =  -40.331373 YAVE =  -40.331373
    ZMIN =   21.908495 ZMAX =   21.908495 ZAVE =   21.908495
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.06224434"
Evaluating: -4.06224434+3.5
 Parameter: XMAX <- "-0.56224434"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.331373"
Evaluating: -40.331373+3.5
 Parameter: YMAX <- "-36.831373"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.9084952"
Evaluating: 21.9084952+3.5
 Parameter: ZMAX <- "25.4084952"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.06224434"
Evaluating: -4.06224434-3.5
 Parameter: XMIN <- "-7.56224434"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.331373"
Evaluating: -40.331373-3.5
 Parameter: YMIN <- "-43.831373"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.9084952"
Evaluating: 21.9084952-3.5
 Parameter: ZMIN <- "18.4084952"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.56224434"
 Parameter: XMIN -> "-7.56224434"
 Parameter: YMAX -> "-36.831373"
 Parameter: YMIN -> "-43.831373"
 Parameter: ZMAX -> "25.4084952"
 Parameter: ZMIN -> "18.4084952"
 SELRPN>      8 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      4 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39327 NEG      CLA      51       CLA     -**** MEMB     POPC     76       O14           3.7432
39327 NEG      CLA      51       CLA     -**** MEMB     POPC     76       O12           3.8964
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "122" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "71"
Evaluating: 122-71
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "5.907630234E-02"
Evaluating: 100.116666*(5.907630234E-02-0.5)
 Parameter: XPOS <- "-44.1438106"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.548997012"
Evaluating: 100.116666*(0.548997012-0.5)
 Parameter: YPOS <- "4.90541749"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.985217276"
Evaluating: 127.138691*(0.985217276-0.5)+4.2778237
 Parameter: ZPOS <- "65.967713"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.967713" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.967713" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.062244 XMAX =   -4.062244 XAVE =   -4.062244
    YMIN =  -40.331373 YMAX =  -40.331373 YAVE =  -40.331373
    ZMIN =   21.908495 ZMAX =   21.908495 ZAVE =   21.908495
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.1438106"
 RDCMND substituted energy or value "?XAVE" to "-4.06224434"
Evaluating: -44.1438106--4.06224434
 Parameter: XTRAN <- "-40.0815663"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.90541749"
 RDCMND substituted energy or value "?YAVE" to "-40.331373"
Evaluating: 4.90541749--40.331373
 Parameter: YTRAN <- "45.2367905"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.967713"
 RDCMND substituted energy or value "?ZAVE" to "21.9084952"
Evaluating: 65.967713-21.9084952
 Parameter: ZTRAN <- "44.0592178"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.0815663"
 Parameter: YTRAN -> "45.2367905"
 Parameter: ZTRAN -> "44.0592178"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -40.081566   45.236790   44.059218
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821612807"
Evaluating: 0.821612807*360.0
 Parameter: XPHI <- "295.780611"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588643905"
Evaluating: 0.588643905*360.0
 Parameter: YPHI <- "211.911806"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.282826987"
Evaluating: 0.282826987*360.0
 Parameter: ZPHI <- "101.817715"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.1438106"
 Parameter: YPOS -> "4.90541749"
 Parameter: ZPOS -> "65.967713"
 Parameter: XPHI -> "295.780611"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.434926   -0.900466
    0.000000    0.900466    0.434926

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   64.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.1438106"
 Parameter: YPOS -> "4.90541749"
 Parameter: ZPOS -> "65.967713"
 Parameter: YPHI -> "211.911806"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.848863    0.000000    0.528613
    0.000000    1.000000    0.000000
   -0.528613    0.000000   -0.848863

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.1438106"
 Parameter: YPOS -> "4.90541749"
 Parameter: ZPOS -> "65.967713"
 Parameter: ZPHI -> "101.817715"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.204799    0.978804    0.000000
   -0.978804   -0.204799    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.143811 XMAX =  -44.143811 XAVE =  -44.143811
    YMIN =    4.905417 YMAX =    4.905417 YAVE =    4.905417
    ZMIN =   65.967713 ZMAX =   65.967713 ZAVE =   65.967713
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.1438106"
Evaluating: -44.1438106+3.5
 Parameter: XMAX <- "-40.6438106"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.90541745"
Evaluating: 4.90541745+3.5
 Parameter: YMAX <- "8.40541745"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.967713"
Evaluating: 65.967713+3.5
 Parameter: ZMAX <- "69.467713"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.1438106"
Evaluating: -44.1438106-3.5
 Parameter: XMIN <- "-47.6438106"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.90541745"
Evaluating: 4.90541745-3.5
 Parameter: YMIN <- "1.40541745"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.967713"
Evaluating: 65.967713-3.5
 Parameter: ZMIN <- "62.467713"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.6438106"
 Parameter: XMIN -> "-47.6438106"
 Parameter: YMAX -> "8.40541745"
 Parameter: YMIN -> "1.40541745"
 Parameter: ZMAX -> "69.467713"
 Parameter: ZMIN -> "62.467713"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "123" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "123" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "71"
Evaluating: 123-71
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.536429324"
Evaluating: 100.116666*(0.536429324-0.5)
 Parameter: XPOS <- "3.64718246"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "1.159936512E-02"
Evaluating: 100.116666*(1.159936512E-02-0.5)
 Parameter: YPOS <- "-48.8970432"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.357594781"
Evaluating: 127.138691*(0.357594781-0.5)+4.2778237
 Parameter: ZPOS <- "-13.8273894"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-13.8273894" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-13.8273894" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "123" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "71"
Evaluating: 123-71
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.541290482"
Evaluating: 100.116666*(0.541290482-0.5)
 Parameter: XPOS <- "4.1338654"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.748529837"
Evaluating: 100.116666*(0.748529837-0.5)
 Parameter: YPOS <- "24.8819787"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.521546853"
Evaluating: 127.138691*(0.521546853-0.5)+4.2778237
 Parameter: ZPOS <- "7.01726239"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "7.01726239" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "7.01726239" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "123" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "71"
Evaluating: 123-71
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.870625352"
Evaluating: 100.116666*(0.870625352-0.5)
 Parameter: XPOS <- "37.1057746"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.771491807"
Evaluating: 100.116666*(0.771491807-0.5)
 Parameter: YPOS <- "27.1808546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.833346049"
Evaluating: 127.138691*(0.833346049-0.5)+4.2778237
 Parameter: ZPOS <- "46.659004"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.659004" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.659004" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.1057746"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.1057746-0
 Parameter: XTRAN <- "37.1057746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.1808546"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.1808546-0
 Parameter: YTRAN <- "27.1808546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.659004"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.659004-0
 Parameter: ZTRAN <- "46.659004"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.1057746"
 Parameter: YTRAN -> "27.1808546"
 Parameter: ZTRAN -> "46.659004"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    37.105775   27.180855   46.659004
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.099946033E-02"
Evaluating: 1.099946033E-02*360.0
 Parameter: XPHI <- "3.95980572"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420841409"
Evaluating: 0.420841409*360.0
 Parameter: YPHI <- "151.502907"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7839239"
Evaluating: 0.7839239*360.0
 Parameter: ZPHI <- "282.212604"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.1057746"
 Parameter: YPOS -> "27.1808546"
 Parameter: ZPOS -> "46.659004"
 Parameter: XPHI -> "3.95980572"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997613    0.069057
    0.000000   -0.069057    0.997613

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.1057746"
 Parameter: YPOS -> "27.1808546"
 Parameter: ZPOS -> "46.659004"
 Parameter: YPHI -> "151.502907"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.878841    0.000000   -0.477114
    0.000000    1.000000    0.000000
    0.477114    0.000000   -0.878841

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.1057746"
 Parameter: YPOS -> "27.1808546"
 Parameter: ZPOS -> "46.659004"
 Parameter: ZPHI -> "282.212604"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.211540   -0.977369    0.000000
    0.977369    0.211540    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   77.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.105775 XMAX =   37.105775 XAVE =   37.105775
    YMIN =   27.180855 YMAX =   27.180855 YAVE =   27.180855
    ZMIN =   46.659004 ZMAX =   46.659004 ZAVE =   46.659004
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.1057746"
Evaluating: 37.1057746+3.5
 Parameter: XMAX <- "40.6057746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.1808546"
Evaluating: 27.1808546+3.5
 Parameter: YMAX <- "30.6808546"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.659004"
Evaluating: 46.659004+3.5
 Parameter: ZMAX <- "50.159004"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.1057746"
Evaluating: 37.1057746-3.5
 Parameter: XMIN <- "33.6057746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.1808546"
Evaluating: 27.1808546-3.5
 Parameter: YMIN <- "23.6808546"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.659004"
Evaluating: 46.659004-3.5
 Parameter: ZMIN <- "43.159004"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.6057746"
 Parameter: XMIN -> "33.6057746"
 Parameter: YMAX -> "30.6808546"
 Parameter: YMIN -> "23.6808546"
 Parameter: ZMAX -> "50.159004"
 Parameter: ZMIN -> "43.159004"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "124" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "124" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "71"
Evaluating: 124-71
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.826970187"
Evaluating: 100.116666*(0.826970187-0.5)
 Parameter: XPOS <- "32.735165"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.850649071"
Evaluating: 100.116666*(0.850649071-0.5)
 Parameter: YPOS <- "35.1058159"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.83638746"
Evaluating: 127.138691*(0.83638746-0.5)+4.2778237
 Parameter: ZPOS <- "47.045685"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.045685" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.045685" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.735165"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.735165-0
 Parameter: XTRAN <- "32.735165"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.1058159"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.1058159-0
 Parameter: YTRAN <- "35.1058159"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.045685"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.045685-0
 Parameter: ZTRAN <- "47.045685"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.735165"
 Parameter: YTRAN -> "35.1058159"
 Parameter: ZTRAN -> "47.045685"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    32.735165   35.105816   47.045685
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.339493474"
Evaluating: 0.339493474*360.0
 Parameter: XPHI <- "122.217651"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.061273367E-02"
Evaluating: 8.061273367E-02*360.0
 Parameter: YPHI <- "29.0205841"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73811618"
Evaluating: 0.73811618*360.0
 Parameter: ZPHI <- "265.721825"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.735165"
 Parameter: YPOS -> "35.1058159"
 Parameter: ZPOS -> "47.045685"
 Parameter: XPHI -> "122.217651"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.533137    0.846029
    0.000000   -0.846029   -0.533137

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  122.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.735165"
 Parameter: YPOS -> "35.1058159"
 Parameter: ZPOS -> "47.045685"
 Parameter: YPHI -> "29.0205841"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.874445    0.000000   -0.485124
    0.000000    1.000000    0.000000
    0.485124    0.000000    0.874445

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   29.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.735165"
 Parameter: YPOS -> "35.1058159"
 Parameter: ZPOS -> "47.045685"
 Parameter: ZPHI -> "265.721825"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.074599   -0.997214    0.000000
    0.997214   -0.074599    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.735165 XMAX =   32.735165 XAVE =   32.735165
    YMIN =   35.105816 YMAX =   35.105816 YAVE =   35.105816
    ZMIN =   47.045685 ZMAX =   47.045685 ZAVE =   47.045685
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.735165"
Evaluating: 32.735165+3.5
 Parameter: XMAX <- "36.235165"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.1058159"
Evaluating: 35.1058159+3.5
 Parameter: YMAX <- "38.6058159"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.045685"
Evaluating: 47.045685+3.5
 Parameter: ZMAX <- "50.545685"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.735165"
Evaluating: 32.735165-3.5
 Parameter: XMIN <- "29.235165"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.1058159"
Evaluating: 35.1058159-3.5
 Parameter: YMIN <- "31.6058159"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.045685"
Evaluating: 47.045685-3.5
 Parameter: ZMIN <- "43.545685"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "36.235165"
 Parameter: XMIN -> "29.235165"
 Parameter: YMAX -> "38.6058159"
 Parameter: YMIN -> "31.6058159"
 Parameter: ZMAX -> "50.545685"
 Parameter: ZMIN -> "43.545685"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "125" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "125" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "71"
Evaluating: 125-71
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.779940237"
Evaluating: 100.116666*(0.779940237-0.5)
 Parameter: XPOS <- "28.0266832"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.620716955"
Evaluating: 100.116666*(0.620716955-0.5)
 Parameter: YPOS <- "12.0857791"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.970665346"
Evaluating: 127.138691*(0.970665346-0.5)+4.2778237
 Parameter: ZPOS <- "64.1175997"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "64.1175997" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "64.1175997" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.0266832"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.0266832-0
 Parameter: XTRAN <- "28.0266832"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0857791"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.0857791-0
 Parameter: YTRAN <- "12.0857791"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "64.1175997"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 64.1175997-0
 Parameter: ZTRAN <- "64.1175997"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.0266832"
 Parameter: YTRAN -> "12.0857791"
 Parameter: ZTRAN -> "64.1175997"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    28.026683   12.085779   64.117600
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817485248"
Evaluating: 0.817485248*360.0
 Parameter: XPHI <- "294.294689"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.941695241"
Evaluating: 0.941695241*360.0
 Parameter: YPHI <- "339.010287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133633696"
Evaluating: 0.133633696*360.0
 Parameter: ZPHI <- "48.1081306"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.0266832"
 Parameter: YPOS -> "12.0857791"
 Parameter: ZPOS -> "64.1175997"
 Parameter: XPHI -> "294.294689"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.411430   -0.911441
    0.000000    0.911441    0.411430

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.0266832"
 Parameter: YPOS -> "12.0857791"
 Parameter: ZPOS -> "64.1175997"
 Parameter: YPHI -> "339.010287"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.933645    0.000000    0.358200
    0.000000    1.000000    0.000000
   -0.358200    0.000000    0.933645

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   20.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.0266832"
 Parameter: YPOS -> "12.0857791"
 Parameter: ZPOS -> "64.1175997"
 Parameter: ZPHI -> "48.1081306"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.667727    0.744406    0.000000
   -0.744406    0.667727    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   48.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.026683 XMAX =   28.026683 XAVE =   28.026683
    YMIN =   12.085779 YMAX =   12.085779 YAVE =   12.085779
    ZMIN =   64.117600 ZMAX =   64.117600 ZAVE =   64.117600
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.0266832"
Evaluating: 28.0266832+3.5
 Parameter: XMAX <- "31.5266832"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0857791"
Evaluating: 12.0857791+3.5
 Parameter: YMAX <- "15.5857791"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "64.1175997"
Evaluating: 64.1175997+3.5
 Parameter: ZMAX <- "67.6175997"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.0266832"
Evaluating: 28.0266832-3.5
 Parameter: XMIN <- "24.5266832"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0857791"
Evaluating: 12.0857791-3.5
 Parameter: YMIN <- "8.5857791"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "64.1175997"
Evaluating: 64.1175997-3.5
 Parameter: ZMIN <- "60.6175997"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.5266832"
 Parameter: XMIN -> "24.5266832"
 Parameter: YMAX -> "15.5857791"
 Parameter: YMIN -> "8.5857791"
 Parameter: ZMAX -> "67.6175997"
 Parameter: ZMIN -> "60.6175997"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "126" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "126" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "71"
Evaluating: 126-71
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.552102734"
Evaluating: 100.116666*(0.552102734-0.5)
 Parameter: XPOS <- "5.21635202"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.85053451"
Evaluating: 100.116666*(0.85053451-0.5)
 Parameter: YPOS <- "35.0943465"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.611446276"
Evaluating: 127.138691*(0.611446276-0.5)+4.2778237
 Parameter: ZPOS <- "18.4469573"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.4469573" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.4469573" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.21635202"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.21635202-0
 Parameter: XTRAN <- "5.21635202"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.0943465"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.0943465-0
 Parameter: YTRAN <- "35.0943465"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.4469573"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.4469573-0
 Parameter: ZTRAN <- "18.4469573"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.21635202"
 Parameter: YTRAN -> "35.0943465"
 Parameter: ZTRAN -> "18.4469573"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR     5.216352   35.094347   18.446957
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.131938623"
Evaluating: 0.131938623*360.0
 Parameter: XPHI <- "47.4979043"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.798128933"
Evaluating: 0.798128933*360.0
 Parameter: YPHI <- "287.326416"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387880513"
Evaluating: 0.387880513*360.0
 Parameter: ZPHI <- "139.636985"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.21635202"
 Parameter: YPOS -> "35.0943465"
 Parameter: ZPOS -> "18.4469573"
 Parameter: XPHI -> "47.4979043"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.675617    0.737253
    0.000000   -0.737253    0.675617

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.21635202"
 Parameter: YPOS -> "35.0943465"
 Parameter: ZPOS -> "18.4469573"
 Parameter: YPHI -> "287.326416"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.297815    0.000000    0.954624
    0.000000    1.000000    0.000000
   -0.954624    0.000000    0.297815

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.21635202"
 Parameter: YPOS -> "35.0943465"
 Parameter: ZPOS -> "18.4469573"
 Parameter: ZPHI -> "139.636985"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.761957    0.647628    0.000000
   -0.647628   -0.761957    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.216352 XMAX =    5.216352 XAVE =    5.216352
    YMIN =   35.094347 YMAX =   35.094347 YAVE =   35.094347
    ZMIN =   18.446957 ZMAX =   18.446957 ZAVE =   18.446957
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.21635202"
Evaluating: 5.21635202+3.5
 Parameter: XMAX <- "8.71635202"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.0943465"
Evaluating: 35.0943465+3.5
 Parameter: YMAX <- "38.5943465"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.4469573"
Evaluating: 18.4469573+3.5
 Parameter: ZMAX <- "21.9469573"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.21635202"
Evaluating: 5.21635202-3.5
 Parameter: XMIN <- "1.71635202"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.0943465"
Evaluating: 35.0943465-3.5
 Parameter: YMIN <- "31.5943465"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.4469573"
Evaluating: 18.4469573-3.5
 Parameter: ZMIN <- "14.9469573"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.71635202"
 Parameter: XMIN -> "1.71635202"
 Parameter: YMAX -> "38.5943465"
 Parameter: YMIN -> "31.5943465"
 Parameter: ZMAX -> "21.9469573"
 Parameter: ZMIN -> "14.9469573"
 SELRPN>     19 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     10 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       N             3.7780
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       C12           2.9509
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       C14           3.4590
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       C11           2.2834
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       P             2.3914
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       O13           3.6525
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       O14           2.7556
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       O12           1.1234
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       O11           3.0849
39331 NEG      CLA      55       CLA     -**** MEMB     POPC     44       C1            3.0419
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "126" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "71"
Evaluating: 126-71
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.546931186E-02"
Evaluating: 100.116666*(7.546931186E-02-0.5)
 Parameter: XPOS <- "-42.5025971"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.592485331"
Evaluating: 100.116666*(0.592485331-0.5)
 Parameter: YPOS <- "9.25932299"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.512299656"
Evaluating: 127.138691*(0.512299656-0.5)+4.2778237
 Parameter: ZPOS <- "5.84158586"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.84158586" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.84158586" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "126" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "71"
Evaluating: 126-71
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.299131729"
Evaluating: 100.116666*(0.299131729-0.5)
 Parameter: XPOS <- "-20.1102616"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.724318327"
Evaluating: 100.116666*(0.724318327-0.5)
 Parameter: YPOS <- "22.458003"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.705946946"
Evaluating: 127.138691*(0.705946946-0.5)+4.2778237
 Parameter: ZPOS <- "30.4616488"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.4616488" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.4616488" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.216352 XMAX =    5.216352 XAVE =    5.216352
    YMIN =   35.094347 YMAX =   35.094347 YAVE =   35.094347
    ZMIN =   18.446957 ZMAX =   18.446957 ZAVE =   18.446957
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.1102616"
 RDCMND substituted energy or value "?XAVE" to "5.21635202"
Evaluating: -20.1102616-5.21635202
 Parameter: XTRAN <- "-25.3266136"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.458003"
 RDCMND substituted energy or value "?YAVE" to "35.0943465"
Evaluating: 22.458003-35.0943465
 Parameter: YTRAN <- "-12.6363435"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.4616488"
 RDCMND substituted energy or value "?ZAVE" to "18.4469573"
Evaluating: 30.4616488-18.4469573
 Parameter: ZTRAN <- "12.0146915"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.3266136"
 Parameter: YTRAN -> "-12.6363435"
 Parameter: ZTRAN -> "12.0146915"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -25.326614  -12.636344   12.014691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.829279637E-02"
Evaluating: 7.829279637E-02*360.0
 Parameter: XPHI <- "28.1854067"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710556793"
Evaluating: 0.710556793*360.0
 Parameter: YPHI <- "255.800445"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.282412427"
Evaluating: 0.282412427*360.0
 Parameter: ZPHI <- "101.668474"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.1102616"
 Parameter: YPOS -> "22.458003"
 Parameter: ZPOS -> "30.4616488"
 Parameter: XPHI -> "28.1854067"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.881424    0.472326
    0.000000   -0.472326    0.881424

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.1102616"
 Parameter: YPOS -> "22.458003"
 Parameter: ZPOS -> "30.4616488"
 Parameter: YPHI -> "255.800445"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.245300    0.000000    0.969447
    0.000000    1.000000    0.000000
   -0.969447    0.000000   -0.245300

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.1102616"
 Parameter: YPOS -> "22.458003"
 Parameter: ZPOS -> "30.4616488"
 Parameter: ZPHI -> "101.668474"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.202248    0.979334    0.000000
   -0.979334   -0.202248    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.110262 XMAX =  -20.110262 XAVE =  -20.110262
    YMIN =   22.458003 YMAX =   22.458003 YAVE =   22.458003
    ZMIN =   30.461649 ZMAX =   30.461649 ZAVE =   30.461649
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.1102616"
Evaluating: -20.1102616+3.5
 Parameter: XMAX <- "-16.6102616"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.458003"
Evaluating: 22.458003+3.5
 Parameter: YMAX <- "25.958003"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.4616488"
Evaluating: 30.4616488+3.5
 Parameter: ZMAX <- "33.9616488"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.1102616"
Evaluating: -20.1102616-3.5
 Parameter: XMIN <- "-23.6102616"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.458003"
Evaluating: 22.458003-3.5
 Parameter: YMIN <- "18.958003"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.4616488"
Evaluating: 30.4616488-3.5
 Parameter: ZMIN <- "26.9616488"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.6102616"
 Parameter: XMIN -> "-23.6102616"
 Parameter: YMAX -> "25.958003"
 Parameter: YMIN -> "18.958003"
 Parameter: ZMAX -> "33.9616488"
 Parameter: ZMIN -> "26.9616488"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "127" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "127" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "71"
Evaluating: 127-71
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.890324679E-02"
Evaluating: 100.116666*(7.890324679E-02-0.5)
 Parameter: XPOS <- "-42.158803"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.748810098"
Evaluating: 100.116666*(0.748810098-0.5)
 Parameter: YPOS <- "24.9100375"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.153723367"
Evaluating: 127.138691*(0.153723367-0.5)+4.2778237
 Parameter: ZPOS <- "-39.7473341"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.7473341" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.158803"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.158803-0
 Parameter: XTRAN <- "-42.158803"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.9100375"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.9100375-0
 Parameter: YTRAN <- "24.9100375"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.7473341"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.7473341-0
 Parameter: ZTRAN <- "-39.7473341"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.158803"
 Parameter: YTRAN -> "24.9100375"
 Parameter: ZTRAN -> "-39.7473341"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -42.158803   24.910038  -39.747334
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.703546311"
Evaluating: 0.703546311*360.0
 Parameter: XPHI <- "253.276672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.613022097"
Evaluating: 0.613022097*360.0
 Parameter: YPHI <- "220.687955"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.196381873"
Evaluating: 0.196381873*360.0
 Parameter: ZPHI <- "70.6974743"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.158803"
 Parameter: YPOS -> "24.9100375"
 Parameter: ZPOS -> "-39.7473341"
 Parameter: XPHI -> "253.276672"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.287750   -0.957705
    0.000000    0.957705   -0.287750

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.158803"
 Parameter: YPOS -> "24.9100375"
 Parameter: ZPOS -> "-39.7473341"
 Parameter: YPHI -> "220.687955"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.758271    0.000000    0.651939
    0.000000    1.000000    0.000000
   -0.651939    0.000000   -0.758271

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.158803"
 Parameter: YPOS -> "24.9100375"
 Parameter: ZPOS -> "-39.7473341"
 Parameter: ZPHI -> "70.6974743"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.330556    0.943786    0.000000
   -0.943786    0.330556    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.158803 XMAX =  -42.158803 XAVE =  -42.158803
    YMIN =   24.910038 YMAX =   24.910038 YAVE =   24.910038
    ZMIN =  -39.747334 ZMAX =  -39.747334 ZAVE =  -39.747334
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.158803"
Evaluating: -42.158803+3.5
 Parameter: XMAX <- "-38.658803"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.9100375"
Evaluating: 24.9100375+3.5
 Parameter: YMAX <- "28.4100375"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.7473341"
Evaluating: -39.7473341+3.5
 Parameter: ZMAX <- "-36.2473341"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.158803"
Evaluating: -42.158803-3.5
 Parameter: XMIN <- "-45.658803"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.9100375"
Evaluating: 24.9100375-3.5
 Parameter: YMIN <- "21.4100375"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.7473341"
Evaluating: -39.7473341-3.5
 Parameter: ZMIN <- "-43.2473341"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.658803"
 Parameter: XMIN -> "-45.658803"
 Parameter: YMAX -> "28.4100375"
 Parameter: YMIN -> "21.4100375"
 Parameter: ZMAX -> "-36.2473341"
 Parameter: ZMIN -> "-43.2473341"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "128" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "128" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "71"
Evaluating: 128-71
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.845522696"
Evaluating: 100.116666*(0.845522696-0.5)
 Parameter: XPOS <- "34.5925804"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "6.134410865E-02"
Evaluating: 100.116666*(6.134410865E-02-0.5)
 Parameter: YPOS <- "-43.9167654"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.721861483"
Evaluating: 127.138691*(0.721861483-0.5)+4.2778237
 Parameter: ZPOS <- "32.4850022"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.4850022" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.4850022" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.5925804"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.5925804-0
 Parameter: XTRAN <- "34.5925804"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.9167654"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.9167654-0
 Parameter: YTRAN <- "-43.9167654"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.4850022"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.4850022-0
 Parameter: ZTRAN <- "32.4850022"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.5925804"
 Parameter: YTRAN -> "-43.9167654"
 Parameter: ZTRAN -> "32.4850022"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    34.592580  -43.916765   32.485002
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.894785891"
Evaluating: 0.894785891*360.0
 Parameter: XPHI <- "322.122921"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303422872"
Evaluating: 0.303422872*360.0
 Parameter: YPHI <- "109.232234"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.261171804"
Evaluating: 0.261171804*360.0
 Parameter: ZPHI <- "94.0218494"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.5925804"
 Parameter: YPOS -> "-43.9167654"
 Parameter: ZPOS -> "32.4850022"
 Parameter: XPHI -> "322.122921"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.789330   -0.613969
    0.000000    0.613969    0.789330

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   37.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.5925804"
 Parameter: YPOS -> "-43.9167654"
 Parameter: ZPOS -> "32.4850022"
 Parameter: YPHI -> "109.232234"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.329398    0.000000   -0.944191
    0.000000    1.000000    0.000000
    0.944191    0.000000   -0.329398

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  109.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.5925804"
 Parameter: YPOS -> "-43.9167654"
 Parameter: ZPOS -> "32.4850022"
 Parameter: ZPHI -> "94.0218494"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.070137    0.997537    0.000000
   -0.997537   -0.070137    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.592580 XMAX =   34.592580 XAVE =   34.592580
    YMIN =  -43.916765 YMAX =  -43.916765 YAVE =  -43.916765
    ZMIN =   32.485002 ZMAX =   32.485002 ZAVE =   32.485002
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.5925804"
Evaluating: 34.5925804+3.5
 Parameter: XMAX <- "38.0925804"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.9167654"
Evaluating: -43.9167654+3.5
 Parameter: YMAX <- "-40.4167654"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.4850022"
Evaluating: 32.4850022+3.5
 Parameter: ZMAX <- "35.9850022"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.5925804"
Evaluating: 34.5925804-3.5
 Parameter: XMIN <- "31.0925804"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.9167654"
Evaluating: -43.9167654-3.5
 Parameter: YMIN <- "-47.4167654"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.4850022"
Evaluating: 32.4850022-3.5
 Parameter: ZMIN <- "28.9850022"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.0925804"
 Parameter: XMIN -> "31.0925804"
 Parameter: YMAX -> "-40.4167654"
 Parameter: YMIN -> "-47.4167654"
 Parameter: ZMAX -> "35.9850022"
 Parameter: ZMIN -> "28.9850022"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "129" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "129" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "71"
Evaluating: 129-71
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.240834245"
Evaluating: 100.116666*(0.240834245-0.5)
 Parameter: XPOS <- "-25.9468113"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.749528549"
Evaluating: 100.116666*(0.749528549-0.5)
 Parameter: YPOS <- "24.9819664"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "1.332817838E-02"
Evaluating: 127.138691*(1.332817838E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-57.5969946"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.5969946" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.9468113"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.9468113-0
 Parameter: XTRAN <- "-25.9468113"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.9819664"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 24.9819664-0
 Parameter: YTRAN <- "24.9819664"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.5969946"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.5969946-0
 Parameter: ZTRAN <- "-57.5969946"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.9468113"
 Parameter: YTRAN -> "24.9819664"
 Parameter: ZTRAN -> "-57.5969946"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -25.946811   24.981966  -57.596995
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397506067"
Evaluating: 0.397506067*360.0
 Parameter: XPHI <- "143.102184"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.792995357"
Evaluating: 0.792995357*360.0
 Parameter: YPHI <- "285.478329"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950673867"
Evaluating: 0.950673867*360.0
 Parameter: ZPHI <- "342.242592"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.9468113"
 Parameter: YPOS -> "24.9819664"
 Parameter: ZPOS -> "-57.5969946"
 Parameter: XPHI -> "143.102184"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.799708    0.600390
    0.000000   -0.600390   -0.799708

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.9468113"
 Parameter: YPOS -> "24.9819664"
 Parameter: ZPOS -> "-57.5969946"
 Parameter: YPHI -> "285.478329"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.266874    0.000000    0.963731
    0.000000    1.000000    0.000000
   -0.963731    0.000000    0.266874

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.9468113"
 Parameter: YPOS -> "24.9819664"
 Parameter: ZPOS -> "-57.5969946"
 Parameter: ZPHI -> "342.242592"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.952356   -0.304987    0.000000
    0.304987    0.952356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.946811 XMAX =  -25.946811 XAVE =  -25.946811
    YMIN =   24.981966 YMAX =   24.981966 YAVE =   24.981966
    ZMIN =  -57.596995 ZMAX =  -57.596995 ZAVE =  -57.596995
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.9468113"
Evaluating: -25.9468113+3.5
 Parameter: XMAX <- "-22.4468113"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.9819664"
Evaluating: 24.9819664+3.5
 Parameter: YMAX <- "28.4819664"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.5969946"
Evaluating: -57.5969946+3.5
 Parameter: ZMAX <- "-54.0969946"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.9468113"
Evaluating: -25.9468113-3.5
 Parameter: XMIN <- "-29.4468113"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.9819664"
Evaluating: 24.9819664-3.5
 Parameter: YMIN <- "21.4819664"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.5969946"
Evaluating: -57.5969946-3.5
 Parameter: ZMIN <- "-61.0969946"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.4468113"
 Parameter: XMIN -> "-29.4468113"
 Parameter: YMAX -> "28.4819664"
 Parameter: YMIN -> "21.4819664"
 Parameter: ZMAX -> "-54.0969946"
 Parameter: ZMIN -> "-61.0969946"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "130" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "130" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "130"
 Parameter: NPOS -> "71"
Evaluating: 130-71
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.279516105"
Evaluating: 100.116666*(0.279516105-0.5)
 Parameter: XPOS <- "-22.0741125"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.842878773"
Evaluating: 100.116666*(0.842878773-0.5)
 Parameter: YPOS <- "34.3278796"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.900699806"
Evaluating: 127.138691*(0.900699806-0.5)+4.2778237
 Parameter: ZPOS <- "55.2222725"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.2222725" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.2222725" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.0741125"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.0741125-0
 Parameter: XTRAN <- "-22.0741125"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.3278796"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.3278796-0
 Parameter: YTRAN <- "34.3278796"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.2222725"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 55.2222725-0
 Parameter: ZTRAN <- "55.2222725"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.0741125"
 Parameter: YTRAN -> "34.3278796"
 Parameter: ZTRAN -> "55.2222725"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -22.074112   34.327880   55.222273
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209628416"
Evaluating: 0.209628416*360.0
 Parameter: XPHI <- "75.4662298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.119275925E-02"
Evaluating: 9.119275925E-02*360.0
 Parameter: YPHI <- "32.8293933"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.224900182"
Evaluating: 0.224900182*360.0
 Parameter: ZPHI <- "80.9640655"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.0741125"
 Parameter: YPOS -> "34.3278796"
 Parameter: ZPOS -> "55.2222725"
 Parameter: XPHI -> "75.4662298"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.250951    0.968000
    0.000000   -0.968000    0.250951

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   75.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.0741125"
 Parameter: YPOS -> "34.3278796"
 Parameter: ZPOS -> "55.2222725"
 Parameter: YPHI -> "32.8293933"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.840289    0.000000   -0.542139
    0.000000    1.000000    0.000000
    0.542139    0.000000    0.840289

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   32.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.0741125"
 Parameter: YPOS -> "34.3278796"
 Parameter: ZPOS -> "55.2222725"
 Parameter: ZPHI -> "80.9640655"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.157054    0.987590    0.000000
   -0.987590    0.157054    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.074112 XMAX =  -22.074112 XAVE =  -22.074112
    YMIN =   34.327880 YMAX =   34.327880 YAVE =   34.327880
    ZMIN =   55.222273 ZMAX =   55.222273 ZAVE =   55.222273
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.0741125"
Evaluating: -22.0741125+3.5
 Parameter: XMAX <- "-18.5741125"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.3278796"
Evaluating: 34.3278796+3.5
 Parameter: YMAX <- "37.8278796"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.2222725"
Evaluating: 55.2222725+3.5
 Parameter: ZMAX <- "58.7222725"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.0741125"
Evaluating: -22.0741125-3.5
 Parameter: XMIN <- "-25.5741125"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.3278796"
Evaluating: 34.3278796-3.5
 Parameter: YMIN <- "30.8278796"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.2222725"
Evaluating: 55.2222725-3.5
 Parameter: ZMIN <- "51.7222725"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.5741125"
 Parameter: XMIN -> "-25.5741125"
 Parameter: YMAX -> "37.8278796"
 Parameter: YMIN -> "30.8278796"
 Parameter: ZMAX -> "58.7222725"
 Parameter: ZMIN -> "51.7222725"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "131" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "131" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "71"
Evaluating: 131-71
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.90519145"
Evaluating: 100.116666*(0.90519145-0.5)
 Parameter: XPOS <- "40.5664171"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.141469514"
Evaluating: 100.116666*(0.141469514-0.5)
 Parameter: YPOS <- "-35.8948769"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "1.991155278E-02"
Evaluating: 127.138691*(1.991155278E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-56.759993"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.759993" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.5664171"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.5664171-0
 Parameter: XTRAN <- "40.5664171"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.8948769"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.8948769-0
 Parameter: YTRAN <- "-35.8948769"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.759993"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.759993-0
 Parameter: ZTRAN <- "-56.759993"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.5664171"
 Parameter: YTRAN -> "-35.8948769"
 Parameter: ZTRAN -> "-56.759993"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    40.566417  -35.894877  -56.759993
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67362944"
Evaluating: 0.67362944*360.0
 Parameter: XPHI <- "242.506598"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731396384"
Evaluating: 0.731396384*360.0
 Parameter: YPHI <- "263.302698"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232257207"
Evaluating: 0.232257207*360.0
 Parameter: ZPHI <- "83.6125945"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.5664171"
 Parameter: YPOS -> "-35.8948769"
 Parameter: ZPOS -> "-56.759993"
 Parameter: XPHI -> "242.506598"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.461646   -0.887064
    0.000000    0.887064   -0.461646

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.5664171"
 Parameter: YPOS -> "-35.8948769"
 Parameter: ZPOS -> "-56.759993"
 Parameter: YPHI -> "263.302698"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.116624    0.000000    0.993176
    0.000000    1.000000    0.000000
   -0.993176    0.000000   -0.116624

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.5664171"
 Parameter: YPOS -> "-35.8948769"
 Parameter: ZPOS -> "-56.759993"
 Parameter: ZPHI -> "83.6125945"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.111250    0.993792    0.000000
   -0.993792    0.111250    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   83.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.566417 XMAX =   40.566417 XAVE =   40.566417
    YMIN =  -35.894877 YMAX =  -35.894877 YAVE =  -35.894877
    ZMIN =  -56.759993 ZMAX =  -56.759993 ZAVE =  -56.759993
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.5664171"
Evaluating: 40.5664171+3.5
 Parameter: XMAX <- "44.0664171"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.8948769"
Evaluating: -35.8948769+3.5
 Parameter: YMAX <- "-32.3948769"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.759993"
Evaluating: -56.759993+3.5
 Parameter: ZMAX <- "-53.259993"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.5664171"
Evaluating: 40.5664171-3.5
 Parameter: XMIN <- "37.0664171"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.8948769"
Evaluating: -35.8948769-3.5
 Parameter: YMIN <- "-39.3948769"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.759993"
Evaluating: -56.759993-3.5
 Parameter: ZMIN <- "-60.259993"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.0664171"
 Parameter: XMIN -> "37.0664171"
 Parameter: YMAX -> "-32.3948769"
 Parameter: YMIN -> "-39.3948769"
 Parameter: ZMAX -> "-53.259993"
 Parameter: ZMIN -> "-60.259993"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "132" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "132" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "71"
Evaluating: 132-71
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.989260762"
Evaluating: 100.116666*(0.989260762-0.5)
 Parameter: XPOS <- "48.9831563"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.617647585"
Evaluating: 100.116666*(0.617647585-0.5)
 Parameter: YPOS <- "11.778484"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.621176245"
Evaluating: 127.138691*(0.621176245-0.5)+4.2778237
 Parameter: ZPOS <- "19.6840129"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.6840129" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.6840129" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "48.9831563"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 48.9831563-0
 Parameter: XTRAN <- "48.9831563"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.778484"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.778484-0
 Parameter: YTRAN <- "11.778484"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.6840129"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.6840129-0
 Parameter: ZTRAN <- "19.6840129"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "48.9831563"
 Parameter: YTRAN -> "11.778484"
 Parameter: ZTRAN -> "19.6840129"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    48.983156   11.778484   19.684013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.998967617"
Evaluating: 0.998967617*360.0
 Parameter: XPHI <- "359.628342"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.450574589"
Evaluating: 0.450574589*360.0
 Parameter: YPHI <- "162.206852"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638062067"
Evaluating: 0.638062067*360.0
 Parameter: ZPHI <- "229.702344"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "48.9831563"
 Parameter: YPOS -> "11.778484"
 Parameter: ZPOS -> "19.6840129"
 Parameter: XPHI -> "359.628342"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999979   -0.006487
    0.000000    0.006487    0.999979

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    0.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "48.9831563"
 Parameter: YPOS -> "11.778484"
 Parameter: ZPOS -> "19.6840129"
 Parameter: YPHI -> "162.206852"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.952166    0.000000   -0.305581
    0.000000    1.000000    0.000000
    0.305581    0.000000   -0.952166

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "48.9831563"
 Parameter: YPOS -> "11.778484"
 Parameter: ZPOS -> "19.6840129"
 Parameter: ZPHI -> "229.702344"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.646759   -0.762695    0.000000
    0.762695   -0.646759    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  130.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.983156 XMAX =   48.983156 XAVE =   48.983156
    YMIN =   11.778484 YMAX =   11.778484 YAVE =   11.778484
    ZMIN =   19.684013 ZMAX =   19.684013 ZAVE =   19.684013
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "48.9831563"
Evaluating: 48.9831563+3.5
 Parameter: XMAX <- "52.4831563"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.778484"
Evaluating: 11.778484+3.5
 Parameter: YMAX <- "15.278484"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.6840129"
Evaluating: 19.6840129+3.5
 Parameter: ZMAX <- "23.1840129"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "48.9831563"
Evaluating: 48.9831563-3.5
 Parameter: XMIN <- "45.4831563"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.778484"
Evaluating: 11.778484-3.5
 Parameter: YMIN <- "8.278484"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.6840129"
Evaluating: 19.6840129-3.5
 Parameter: ZMIN <- "16.1840129"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.4831563"
 Parameter: XMIN -> "45.4831563"
 Parameter: YMAX -> "15.278484"
 Parameter: YMIN -> "8.278484"
 Parameter: ZMAX -> "23.1840129"
 Parameter: ZMIN -> "16.1840129"
 SELRPN>      5 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      4 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39337 NEG      CLA      61       CLA     -**** MEMB     POPC     97       P             3.3034
39337 NEG      CLA      61       CLA     -**** MEMB     POPC     97       O13           2.9900
39337 NEG      CLA      61       CLA     -**** MEMB     POPC     97       O14           2.9119
39337 NEG      CLA      61       CLA     -**** MEMB     POPC     97       O12           3.8006
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "132" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "71"
Evaluating: 132-71
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.139207557"
Evaluating: 100.116666*(0.139207557-0.5)
 Parameter: XPOS <- "-36.1213365"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.501300613"
Evaluating: 100.116666*(0.501300613-0.5)
 Parameter: YPOS <- "0.130213037"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.912230443"
Evaluating: 127.138691*(0.912230443-0.5)+4.2778237
 Parameter: ZPOS <- "56.6882626"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.6882626" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.6882626" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   48.983156 XMAX =   48.983156 XAVE =   48.983156
    YMIN =   11.778484 YMAX =   11.778484 YAVE =   11.778484
    ZMIN =   19.684013 ZMAX =   19.684013 ZAVE =   19.684013
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.1213365"
 RDCMND substituted energy or value "?XAVE" to "48.9831563"
Evaluating: -36.1213365-48.9831563
 Parameter: XTRAN <- "-85.1044928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.130213037"
 RDCMND substituted energy or value "?YAVE" to "11.778484"
Evaluating: 0.130213037-11.778484
 Parameter: YTRAN <- "-11.648271"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.6882626"
 RDCMND substituted energy or value "?ZAVE" to "19.6840129"
Evaluating: 56.6882626-19.6840129
 Parameter: ZTRAN <- "37.0042497"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-85.1044928"
 Parameter: YTRAN -> "-11.648271"
 Parameter: ZTRAN -> "37.0042497"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -85.104493  -11.648271   37.004250
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714988945"
Evaluating: 0.714988945*360.0
 Parameter: XPHI <- "257.39602"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.268887638"
Evaluating: 0.268887638*360.0
 Parameter: YPHI <- "96.7995497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.165912094"
Evaluating: 0.165912094*360.0
 Parameter: ZPHI <- "59.7283538"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.1213365"
 Parameter: YPOS -> "0.130213037"
 Parameter: ZPOS -> "56.6882626"
 Parameter: XPHI -> "257.39602"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.218211   -0.975902
    0.000000    0.975902   -0.218211

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  102.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.1213365"
 Parameter: YPOS -> "0.130213037"
 Parameter: ZPOS -> "56.6882626"
 Parameter: YPHI -> "96.7995497"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.118396    0.000000   -0.992966
    0.000000    1.000000    0.000000
    0.992966    0.000000   -0.118396

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   96.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.1213365"
 Parameter: YPOS -> "0.130213037"
 Parameter: ZPOS -> "56.6882626"
 Parameter: ZPHI -> "59.7283538"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.504100    0.863645    0.000000
   -0.863645    0.504100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.121336 XMAX =  -36.121336 XAVE =  -36.121336
    YMIN =    0.130213 YMAX =    0.130213 YAVE =    0.130213
    ZMIN =   56.688263 ZMAX =   56.688263 ZAVE =   56.688263
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.1213365"
Evaluating: -36.1213365+3.5
 Parameter: XMAX <- "-32.6213365"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.13021301"
Evaluating: 0.13021301+3.5
 Parameter: YMAX <- "3.63021301"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.6882626"
Evaluating: 56.6882626+3.5
 Parameter: ZMAX <- "60.1882626"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.1213365"
Evaluating: -36.1213365-3.5
 Parameter: XMIN <- "-39.6213365"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.13021301"
Evaluating: 0.13021301-3.5
 Parameter: YMIN <- "-3.36978699"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.6882626"
Evaluating: 56.6882626-3.5
 Parameter: ZMIN <- "53.1882626"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.6213365"
 Parameter: XMIN -> "-39.6213365"
 Parameter: YMAX -> "3.63021301"
 Parameter: YMIN -> "-3.36978699"
 Parameter: ZMAX -> "60.1882626"
 Parameter: ZMIN -> "53.1882626"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "133" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "133" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "71"
Evaluating: 133-71
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "9.034857151E-02"
Evaluating: 100.116666*(9.034857151E-02-0.5)
 Parameter: XPOS <- "-41.0129352"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.806238101"
Evaluating: 100.116666*(0.806238101-0.5)
 Parameter: YPOS <- "30.6595377"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.160502835"
Evaluating: 127.138691*(0.160502835-0.5)+4.2778237
 Parameter: ZPOS <- "-38.8854015"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.8854015" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.0129352"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.0129352-0
 Parameter: XTRAN <- "-41.0129352"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.6595377"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.6595377-0
 Parameter: YTRAN <- "30.6595377"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.8854015"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.8854015-0
 Parameter: ZTRAN <- "-38.8854015"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.0129352"
 Parameter: YTRAN -> "30.6595377"
 Parameter: ZTRAN -> "-38.8854015"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -41.012935   30.659538  -38.885402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67666946"
Evaluating: 0.67666946*360.0
 Parameter: XPHI <- "243.601006"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429132456"
Evaluating: 0.429132456*360.0
 Parameter: YPHI <- "154.487684"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.892619851"
Evaluating: 0.892619851*360.0
 Parameter: ZPHI <- "321.343146"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.0129352"
 Parameter: YPOS -> "30.6595377"
 Parameter: ZPOS -> "-38.8854015"
 Parameter: XPHI -> "243.601006"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.444619   -0.895720
    0.000000    0.895720   -0.444619

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.0129352"
 Parameter: YPOS -> "30.6595377"
 Parameter: ZPOS -> "-38.8854015"
 Parameter: YPHI -> "154.487684"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.902493    0.000000   -0.430705
    0.000000    1.000000    0.000000
    0.430705    0.000000   -0.902493

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.0129352"
 Parameter: YPOS -> "30.6595377"
 Parameter: ZPOS -> "-38.8854015"
 Parameter: ZPHI -> "321.343146"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.780901   -0.624655    0.000000
    0.624655    0.780901    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.012935 XMAX =  -41.012935 XAVE =  -41.012935
    YMIN =   30.659538 YMAX =   30.659538 YAVE =   30.659538
    ZMIN =  -38.885402 ZMAX =  -38.885402 ZAVE =  -38.885402
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.0129352"
Evaluating: -41.0129352+3.5
 Parameter: XMAX <- "-37.5129352"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.6595377"
Evaluating: 30.6595377+3.5
 Parameter: YMAX <- "34.1595377"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.8854015"
Evaluating: -38.8854015+3.5
 Parameter: ZMAX <- "-35.3854015"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.0129352"
Evaluating: -41.0129352-3.5
 Parameter: XMIN <- "-44.5129352"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.6595377"
Evaluating: 30.6595377-3.5
 Parameter: YMIN <- "27.1595377"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.8854015"
Evaluating: -38.8854015-3.5
 Parameter: ZMIN <- "-42.3854015"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.5129352"
 Parameter: XMIN -> "-44.5129352"
 Parameter: YMAX -> "34.1595377"
 Parameter: YMIN -> "27.1595377"
 Parameter: ZMAX -> "-35.3854015"
 Parameter: ZMIN -> "-42.3854015"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "134" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "134" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "71"
Evaluating: 134-71
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.254570996"
Evaluating: 100.116666*(0.254570996-0.5)
 Parameter: XPOS <- "-24.5715336"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.151395936"
Evaluating: 100.116666*(0.151395936-0.5)
 Parameter: YPOS <- "-34.9010766"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "2.508177792E-02"
Evaluating: 127.138691*(2.508177792E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-56.1026574"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.1026574" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.5715336"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.5715336-0
 Parameter: XTRAN <- "-24.5715336"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.9010766"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.9010766-0
 Parameter: YTRAN <- "-34.9010766"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.1026574"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.1026574-0
 Parameter: ZTRAN <- "-56.1026574"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.5715336"
 Parameter: YTRAN -> "-34.9010766"
 Parameter: ZTRAN -> "-56.1026574"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -24.571534  -34.901077  -56.102657
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.730750923"
Evaluating: 0.730750923*360.0
 Parameter: XPHI <- "263.070332"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366839444"
Evaluating: 0.366839444*360.0
 Parameter: YPHI <- "132.0622"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.108939102"
Evaluating: 0.108939102*360.0
 Parameter: ZPHI <- "39.2180767"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.5715336"
 Parameter: YPOS -> "-34.9010766"
 Parameter: ZPOS -> "-56.1026574"
 Parameter: XPHI -> "263.070332"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.120651   -0.992695
    0.000000    0.992695   -0.120651

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   96.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.5715336"
 Parameter: YPOS -> "-34.9010766"
 Parameter: ZPOS -> "-56.1026574"
 Parameter: YPHI -> "132.0622"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.669937    0.000000   -0.742418
    0.000000    1.000000    0.000000
    0.742418    0.000000   -0.669937

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.5715336"
 Parameter: YPOS -> "-34.9010766"
 Parameter: ZPOS -> "-56.1026574"
 Parameter: ZPHI -> "39.2180767"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.774745    0.632274    0.000000
   -0.632274    0.774745    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   39.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.571534 XMAX =  -24.571534 XAVE =  -24.571534
    YMIN =  -34.901077 YMAX =  -34.901077 YAVE =  -34.901077
    ZMIN =  -56.102657 ZMAX =  -56.102657 ZAVE =  -56.102657
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.5715336"
Evaluating: -24.5715336+3.5
 Parameter: XMAX <- "-21.0715336"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.9010766"
Evaluating: -34.9010766+3.5
 Parameter: YMAX <- "-31.4010766"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.1026574"
Evaluating: -56.1026574+3.5
 Parameter: ZMAX <- "-52.6026574"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.5715336"
Evaluating: -24.5715336-3.5
 Parameter: XMIN <- "-28.0715336"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.9010766"
Evaluating: -34.9010766-3.5
 Parameter: YMIN <- "-38.4010766"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.1026574"
Evaluating: -56.1026574-3.5
 Parameter: ZMIN <- "-59.6026574"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.0715336"
 Parameter: XMIN -> "-28.0715336"
 Parameter: YMAX -> "-31.4010766"
 Parameter: YMIN -> "-38.4010766"
 Parameter: ZMAX -> "-52.6026574"
 Parameter: ZMIN -> "-59.6026574"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "135" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "135" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "71"
Evaluating: 135-71
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.416830363"
Evaluating: 100.116666*(0.416830363-0.5)
 Parameter: XPOS <- "-8.32666677"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.833909774"
Evaluating: 100.116666*(0.833909774-0.5)
 Parameter: YPOS <- "33.4299333"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.486240821"
Evaluating: 127.138691*(0.486240821-0.5)+4.2778237
 Parameter: ZPOS <- "2.52849969"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.52849969" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.52849969" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "135" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "71"
Evaluating: 135-71
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.989871294"
Evaluating: 100.116666*(0.989871294-0.5)
 Parameter: XPOS <- "49.0442807"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "4.985764068E-02"
Evaluating: 100.116666*(4.985764068E-02-0.5)
 Parameter: YPOS <- "-45.0667522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.129845073"
Evaluating: 127.138691*(0.129845073-0.5)+4.2778237
 Parameter: ZPOS <- "-42.7831892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.7831892" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "49.0442807"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 49.0442807-0
 Parameter: XTRAN <- "49.0442807"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-45.0667522"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -45.0667522-0
 Parameter: YTRAN <- "-45.0667522"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.7831892"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.7831892-0
 Parameter: ZTRAN <- "-42.7831892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.0442807"
 Parameter: YTRAN -> "-45.0667522"
 Parameter: ZTRAN -> "-42.7831892"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    49.044281  -45.066752  -42.783189
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.41283015"
Evaluating: 0.41283015*360.0
 Parameter: XPHI <- "148.618854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803733576"
Evaluating: 0.803733576*360.0
 Parameter: YPHI <- "289.344087"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19434773"
Evaluating: 0.19434773*360.0
 Parameter: ZPHI <- "69.9651828"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "49.0442807"
 Parameter: YPOS -> "-45.0667522"
 Parameter: ZPOS -> "-42.7831892"
 Parameter: XPHI -> "148.618854"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.853722    0.520729
    0.000000   -0.520729   -0.853722

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  148.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "49.0442807"
 Parameter: YPOS -> "-45.0667522"
 Parameter: ZPOS -> "-42.7831892"
 Parameter: YPHI -> "289.344087"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.331241    0.000000    0.943546
    0.000000    1.000000    0.000000
   -0.943546    0.000000    0.331241

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   70.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "49.0442807"
 Parameter: YPOS -> "-45.0667522"
 Parameter: ZPOS -> "-42.7831892"
 Parameter: ZPHI -> "69.9651828"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.342591    0.939485    0.000000
   -0.939485    0.342591    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   49.044281 XMAX =   49.044281 XAVE =   49.044281
    YMIN =  -45.066752 YMAX =  -45.066752 YAVE =  -45.066752
    ZMIN =  -42.783189 ZMAX =  -42.783189 ZAVE =  -42.783189
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "49.0442807"
Evaluating: 49.0442807+3.5
 Parameter: XMAX <- "52.5442807"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-45.0667522"
Evaluating: -45.0667522+3.5
 Parameter: YMAX <- "-41.5667522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.7831892"
Evaluating: -42.7831892+3.5
 Parameter: ZMAX <- "-39.2831892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "49.0442807"
Evaluating: 49.0442807-3.5
 Parameter: XMIN <- "45.5442807"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-45.0667522"
Evaluating: -45.0667522-3.5
 Parameter: YMIN <- "-48.5667522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.7831892"
Evaluating: -42.7831892-3.5
 Parameter: ZMIN <- "-46.2831892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "52.5442807"
 Parameter: XMIN -> "45.5442807"
 Parameter: YMAX -> "-41.5667522"
 Parameter: YMIN -> "-48.5667522"
 Parameter: ZMAX -> "-39.2831892"
 Parameter: ZMIN -> "-46.2831892"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "136" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "136" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "71"
Evaluating: 136-71
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.339193664"
Evaluating: 100.116666*(0.339193664-0.5)
 Parameter: XPOS <- "-16.0993942"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.61944473"
Evaluating: 100.116666*(0.61944473-0.5)
 Parameter: YPOS <- "11.9584081"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.618516905"
Evaluating: 127.138691*(0.618516905-0.5)+4.2778237
 Parameter: ZPOS <- "19.3459079"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.3459079" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.3459079" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.0993942"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -16.0993942-0
 Parameter: XTRAN <- "-16.0993942"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.9584081"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.9584081-0
 Parameter: YTRAN <- "11.9584081"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.3459079"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.3459079-0
 Parameter: ZTRAN <- "19.3459079"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.0993942"
 Parameter: YTRAN -> "11.9584081"
 Parameter: ZTRAN -> "19.3459079"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -16.099394   11.958408   19.345908
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7364274"
Evaluating: 0.7364274*360.0
 Parameter: XPHI <- "265.113864"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.517709761"
Evaluating: 0.517709761*360.0
 Parameter: YPHI <- "186.375514"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299849744"
Evaluating: 0.299849744*360.0
 Parameter: ZPHI <- "107.945908"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.0993942"
 Parameter: YPOS -> "11.9584081"
 Parameter: ZPOS -> "19.3459079"
 Parameter: XPHI -> "265.113864"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.085176   -0.996366
    0.000000    0.996366   -0.085176

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.0993942"
 Parameter: YPOS -> "11.9584081"
 Parameter: ZPOS -> "19.3459079"
 Parameter: YPHI -> "186.375514"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.993815    0.000000    0.111044
    0.000000    1.000000    0.000000
   -0.111044    0.000000   -0.993815

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.0993942"
 Parameter: YPOS -> "11.9584081"
 Parameter: ZPOS -> "19.3459079"
 Parameter: ZPHI -> "107.945908"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.308119    0.951348    0.000000
   -0.951348   -0.308119    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  107.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.099394 XMAX =  -16.099394 XAVE =  -16.099394
    YMIN =   11.958408 YMAX =   11.958408 YAVE =   11.958408
    ZMIN =   19.345908 ZMAX =   19.345908 ZAVE =   19.345908
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.0993942"
Evaluating: -16.0993942+3.5
 Parameter: XMAX <- "-12.5993942"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.9584081"
Evaluating: 11.9584081+3.5
 Parameter: YMAX <- "15.4584081"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.3459079"
Evaluating: 19.3459079+3.5
 Parameter: ZMAX <- "22.8459079"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.0993942"
Evaluating: -16.0993942-3.5
 Parameter: XMIN <- "-19.5993942"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.9584081"
Evaluating: 11.9584081-3.5
 Parameter: YMIN <- "8.4584081"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.3459079"
Evaluating: 19.3459079-3.5
 Parameter: ZMIN <- "15.8459079"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.5993942"
 Parameter: XMIN -> "-19.5993942"
 Parameter: YMAX -> "15.4584081"
 Parameter: YMIN -> "8.4584081"
 Parameter: ZMAX -> "22.8459079"
 Parameter: ZMIN -> "15.8459079"
 SELRPN>     16 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      6 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39341 NEG      CLA      65       CLA     -1645 PROA     TYR      168      CE1           4.2184
39341 NEG      CLA      65       CLA     -1647 PROA     TYR      168      CZ            4.2922
39341 NEG      CLA      65       CLA     -1648 PROA     TYR      168      OH            3.6209
39341 NEG      CLA      65       CLA     -1705 PROA     CYS      172      CB            3.8686
39341 NEG      CLA      65       CLA     -1708 PROA     CYS      172      SG            3.3383
39341 NEG      CLA      65       CLA     -3073 PROA     LEU      256      CB            4.2365
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "136" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "71"
Evaluating: 136-71
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.933642105"
Evaluating: 100.116666*(0.933642105-0.5)
 Parameter: XPOS <- "43.4148018"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.528258754"
Evaluating: 100.116666*(0.528258754-0.5)
 Parameter: YPOS <- "2.82917224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.61566201"
Evaluating: 127.138691*(0.61566201-0.5)+4.2778237
 Parameter: ZPOS <- "18.9829402"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.9829402" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.9829402" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.099394 XMAX =  -16.099394 XAVE =  -16.099394
    YMIN =   11.958408 YMAX =   11.958408 YAVE =   11.958408
    ZMIN =   19.345908 ZMAX =   19.345908 ZAVE =   19.345908
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.4148018"
 RDCMND substituted energy or value "?XAVE" to "-16.0993942"
Evaluating: 43.4148018--16.0993942
 Parameter: XTRAN <- "59.514196"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.82917224"
 RDCMND substituted energy or value "?YAVE" to "11.9584081"
Evaluating: 2.82917224-11.9584081
 Parameter: YTRAN <- "-9.12923586"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.9829402"
 RDCMND substituted energy or value "?ZAVE" to "19.3459079"
Evaluating: 18.9829402-19.3459079
 Parameter: ZTRAN <- "-0.3629677"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "59.514196"
 Parameter: YTRAN -> "-9.12923586"
 Parameter: ZTRAN -> "-0.3629677"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    59.514196   -9.129236   -0.362968
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415421305"
Evaluating: 0.415421305*360.0
 Parameter: XPHI <- "149.55167"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125699884"
Evaluating: 0.125699884*360.0
 Parameter: YPHI <- "45.2519582"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.239840787"
Evaluating: 0.239840787*360.0
 Parameter: ZPHI <- "86.3426833"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.4148018"
 Parameter: YPOS -> "2.82917224"
 Parameter: ZPOS -> "18.9829402"
 Parameter: XPHI -> "149.55167"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.862087    0.506761
    0.000000   -0.506761   -0.862087

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.4148018"
 Parameter: YPOS -> "2.82917224"
 Parameter: ZPOS -> "18.9829402"
 Parameter: YPHI -> "45.2519582"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.703990    0.000000   -0.710209
    0.000000    1.000000    0.000000
    0.710209    0.000000    0.703990

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.4148018"
 Parameter: YPOS -> "2.82917224"
 Parameter: ZPOS -> "18.9829402"
 Parameter: ZPHI -> "86.3426833"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.063789    0.997963    0.000000
   -0.997963    0.063789    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   86.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.414802 XMAX =   43.414802 XAVE =   43.414802
    YMIN =    2.829172 YMAX =    2.829172 YAVE =    2.829172
    ZMIN =   18.982940 ZMAX =   18.982940 ZAVE =   18.982940
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.4148018"
Evaluating: 43.4148018+3.5
 Parameter: XMAX <- "46.9148018"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.82917224"
Evaluating: 2.82917224+3.5
 Parameter: YMAX <- "6.32917224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.9829402"
Evaluating: 18.9829402+3.5
 Parameter: ZMAX <- "22.4829402"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.4148018"
Evaluating: 43.4148018-3.5
 Parameter: XMIN <- "39.9148018"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.82917224"
Evaluating: 2.82917224-3.5
 Parameter: YMIN <- "-0.67082776"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.9829402"
Evaluating: 18.9829402-3.5
 Parameter: ZMIN <- "15.4829402"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.9148018"
 Parameter: XMIN -> "39.9148018"
 Parameter: YMAX -> "6.32917224"
 Parameter: YMIN -> "-0.67082776"
 Parameter: ZMAX -> "22.4829402"
 Parameter: ZMIN -> "15.4829402"
 SELRPN>     24 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     12 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       N             2.8628
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C12           2.9789
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C13           1.9709
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C14           3.9557
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C15           3.7191
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C11           3.4008
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       P             2.4070
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       O13           1.5587
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       O12           2.8143
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       O11           2.5877
39341 NEG      CLA      65       CLA     -**** MEMB     POPC     84       C1            2.4156
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "136" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "71"
Evaluating: 136-71
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.825918428"
Evaluating: 100.116666*(0.825918428-0.5)
 Parameter: XPOS <- "32.6298664"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.25312998"
Evaluating: 100.116666*(0.25312998-0.5)
 Parameter: YPOS <- "-24.7158033"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.42191821"
Evaluating: 127.138691*(0.42191821-0.5)+4.2778237
 Parameter: ZPOS <- "-5.64939287"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.64939287" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.64939287" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "136" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "71"
Evaluating: 136-71
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.424453458"
Evaluating: 100.116666*(0.424453458-0.5)
 Parameter: XPOS <- "-7.56346791"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.509301073"
Evaluating: 100.116666*(0.509301073-0.5)
 Parameter: YPOS <- "0.931192419"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.687415684"
Evaluating: 127.138691*(0.687415684-0.5)+4.2778237
 Parameter: ZPOS <- "28.1056084"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.1056084" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.1056084" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.414802 XMAX =   43.414802 XAVE =   43.414802
    YMIN =    2.829172 YMAX =    2.829172 YAVE =    2.829172
    ZMIN =   18.982940 ZMAX =   18.982940 ZAVE =   18.982940
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.56346791"
 RDCMND substituted energy or value "?XAVE" to "43.4148018"
Evaluating: -7.56346791-43.4148018
 Parameter: XTRAN <- "-50.9782697"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.931192419"
 RDCMND substituted energy or value "?YAVE" to "2.82917224"
Evaluating: 0.931192419-2.82917224
 Parameter: YTRAN <- "-1.89797982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.1056084"
 RDCMND substituted energy or value "?ZAVE" to "18.9829402"
Evaluating: 28.1056084-18.9829402
 Parameter: ZTRAN <- "9.1226682"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.9782697"
 Parameter: YTRAN -> "-1.89797982"
 Parameter: ZTRAN -> "9.1226682"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -50.978270   -1.897980    9.122668
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.959515755"
Evaluating: 0.959515755*360.0
 Parameter: XPHI <- "345.425672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24143131"
Evaluating: 0.24143131*360.0
 Parameter: YPHI <- "86.9152716"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.71670493E-02"
Evaluating: 4.71670493E-02*360.0
 Parameter: ZPHI <- "16.9801377"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.56346791"
 Parameter: YPOS -> "0.931192419"
 Parameter: ZPOS -> "28.1056084"
 Parameter: XPHI -> "345.425672"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.967822   -0.251636
    0.000000    0.251636    0.967822

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   14.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.56346791"
 Parameter: YPOS -> "0.931192419"
 Parameter: ZPOS -> "28.1056084"
 Parameter: YPHI -> "86.9152716"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.053813    0.000000   -0.998551
    0.000000    1.000000    0.000000
    0.998551    0.000000    0.053813

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.56346791"
 Parameter: YPOS -> "0.931192419"
 Parameter: ZPOS -> "28.1056084"
 Parameter: ZPHI -> "16.9801377"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.956406    0.292040    0.000000
   -0.292040    0.956406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.563468 XMAX =   -7.563468 XAVE =   -7.563468
    YMIN =    0.931192 YMAX =    0.931192 YAVE =    0.931192
    ZMIN =   28.105608 ZMAX =   28.105608 ZAVE =   28.105608
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.56346791"
Evaluating: -7.56346791+3.5
 Parameter: XMAX <- "-4.06346791"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.93119242"
Evaluating: 0.93119242+3.5
 Parameter: YMAX <- "4.43119242"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.1056084"
Evaluating: 28.1056084+3.5
 Parameter: ZMAX <- "31.6056084"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.56346791"
Evaluating: -7.56346791-3.5
 Parameter: XMIN <- "-11.0634679"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.93119242"
Evaluating: 0.93119242-3.5
 Parameter: YMIN <- "-2.56880758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.1056084"
Evaluating: 28.1056084-3.5
 Parameter: ZMIN <- "24.6056084"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.06346791"
 Parameter: XMIN -> "-11.0634679"
 Parameter: YMAX -> "4.43119242"
 Parameter: YMIN -> "-2.56880758"
 Parameter: ZMAX -> "31.6056084"
 Parameter: ZMIN -> "24.6056084"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "137" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "137" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "71"
Evaluating: 137-71
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.483060848"
Evaluating: 100.116666*(0.483060848-0.5)
 Parameter: XPOS <- "-1.69589142"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.823517823"
Evaluating: 100.116666*(0.823517823-0.5)
 Parameter: YPOS <- "32.3895258"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.531087682"
Evaluating: 127.138691*(0.531087682-0.5)+4.2778237
 Parameter: ZPOS <- "8.2302709"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.2302709" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.2302709" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "137" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "71"
Evaluating: 137-71
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.256087447"
Evaluating: 100.116666*(0.256087447-0.5)
 Parameter: XPOS <- "-24.4197116"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.633113282"
Evaluating: 100.116666*(0.633113282-0.5)
 Parameter: YPOS <- "13.326858"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.856130191"
Evaluating: 127.138691*(0.856130191-0.5)+4.2778237
 Parameter: ZPOS <- "49.55575"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.55575" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.55575" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.4197116"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.4197116-0
 Parameter: XTRAN <- "-24.4197116"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.326858"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.326858-0
 Parameter: YTRAN <- "13.326858"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.55575"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 49.55575-0
 Parameter: ZTRAN <- "49.55575"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.4197116"
 Parameter: YTRAN -> "13.326858"
 Parameter: ZTRAN -> "49.55575"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -24.419712   13.326858   49.555750
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898448059"
Evaluating: 0.898448059*360.0
 Parameter: XPHI <- "323.441301"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.695592848"
Evaluating: 0.695592848*360.0
 Parameter: YPHI <- "250.413425"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.752578289E-02"
Evaluating: 8.752578289E-02*360.0
 Parameter: ZPHI <- "31.5092818"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.4197116"
 Parameter: YPOS -> "13.326858"
 Parameter: ZPOS -> "49.55575"
 Parameter: XPHI -> "323.441301"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.803247   -0.595646
    0.000000    0.595646    0.803247

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.4197116"
 Parameter: YPOS -> "13.326858"
 Parameter: ZPOS -> "49.55575"
 Parameter: YPHI -> "250.413425"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.335231    0.000000    0.942136
    0.000000    1.000000    0.000000
   -0.942136    0.000000   -0.335231

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  109.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.4197116"
 Parameter: YPOS -> "13.326858"
 Parameter: ZPOS -> "49.55575"
 Parameter: ZPHI -> "31.5092818"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.852556    0.522637    0.000000
   -0.522637    0.852556    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.419712 XMAX =  -24.419712 XAVE =  -24.419712
    YMIN =   13.326858 YMAX =   13.326858 YAVE =   13.326858
    ZMIN =   49.555750 ZMAX =   49.555750 ZAVE =   49.555750
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.4197116"
Evaluating: -24.4197116+3.5
 Parameter: XMAX <- "-20.9197116"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.326858"
Evaluating: 13.326858+3.5
 Parameter: YMAX <- "16.826858"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.55575"
Evaluating: 49.55575+3.5
 Parameter: ZMAX <- "53.05575"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.4197116"
Evaluating: -24.4197116-3.5
 Parameter: XMIN <- "-27.9197116"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.326858"
Evaluating: 13.326858-3.5
 Parameter: YMIN <- "9.826858"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.55575"
Evaluating: 49.55575-3.5
 Parameter: ZMIN <- "46.05575"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.9197116"
 Parameter: XMIN -> "-27.9197116"
 Parameter: YMAX -> "16.826858"
 Parameter: YMIN -> "9.826858"
 Parameter: ZMAX -> "53.05575"
 Parameter: ZMIN -> "46.05575"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "138" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "138" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "71"
Evaluating: 138-71
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.483463153"
Evaluating: 100.116666*(0.483463153-0.5)
 Parameter: XPOS <- "-1.65561399"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.414895368"
Evaluating: 100.116666*(0.414895368-0.5)
 Parameter: YPOS <- "-8.52039202"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.308008652"
Evaluating: 127.138691*(0.308008652-0.5)+4.2778237
 Parameter: ZPOS <- "-20.131705"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.131705" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.65561399"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -1.65561399-0
 Parameter: XTRAN <- "-1.65561399"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.52039202"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.52039202-0
 Parameter: YTRAN <- "-8.52039202"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.131705"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -20.131705-0
 Parameter: ZTRAN <- "-20.131705"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-1.65561399"
 Parameter: YTRAN -> "-8.52039202"
 Parameter: ZTRAN -> "-20.131705"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -1.655614   -8.520392  -20.131705
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.455149631"
Evaluating: 0.455149631*360.0
 Parameter: XPHI <- "163.853867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961126427"
Evaluating: 0.961126427*360.0
 Parameter: YPHI <- "346.005514"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.379135101"
Evaluating: 0.379135101*360.0
 Parameter: ZPHI <- "136.488636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.65561399"
 Parameter: YPOS -> "-8.52039202"
 Parameter: ZPOS -> "-20.131705"
 Parameter: XPHI -> "163.853867"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.960556    0.278088
    0.000000   -0.278088   -0.960556

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.65561399"
 Parameter: YPOS -> "-8.52039202"
 Parameter: ZPOS -> "-20.131705"
 Parameter: YPHI -> "346.005514"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.970319    0.000000    0.241829
    0.000000    1.000000    0.000000
   -0.241829    0.000000    0.970319

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   13.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.65561399"
 Parameter: YPOS -> "-8.52039202"
 Parameter: ZPOS -> "-20.131705"
 Parameter: ZPHI -> "136.488636"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.725238    0.688498    0.000000
   -0.688498   -0.725238    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  136.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.655614 XMAX =   -1.655614 XAVE =   -1.655614
    YMIN =   -8.520392 YMAX =   -8.520392 YAVE =   -8.520392
    ZMIN =  -20.131705 ZMAX =  -20.131705 ZAVE =  -20.131705
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.65561399"
Evaluating: -1.65561399+3.5
 Parameter: XMAX <- "1.84438601"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.52039202"
Evaluating: -8.52039202+3.5
 Parameter: YMAX <- "-5.02039202"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.131705"
Evaluating: -20.131705+3.5
 Parameter: ZMAX <- "-16.631705"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.65561399"
Evaluating: -1.65561399-3.5
 Parameter: XMIN <- "-5.15561399"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.52039202"
Evaluating: -8.52039202-3.5
 Parameter: YMIN <- "-12.020392"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.131705"
Evaluating: -20.131705-3.5
 Parameter: ZMIN <- "-23.631705"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.84438601"
 Parameter: XMIN -> "-5.15561399"
 Parameter: YMAX -> "-5.02039202"
 Parameter: YMIN -> "-12.020392"
 Parameter: ZMAX -> "-16.631705"
 Parameter: ZMIN -> "-23.631705"
 SELRPN>     24 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     12 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39343 NEG      CLA      67       CLA     -2322 PROA     LYS      211      CB            5.0815
39343 NEG      CLA      67       CLA     -2325 PROA     LYS      211      CG            4.2095
39343 NEG      CLA      67       CLA     -2465 PROA     THR      220      CB            3.6157
39343 NEG      CLA      67       CLA     -2467 PROA     THR      220      OG1           3.6095
39343 NEG      CLA      67       CLA     -2469 PROA     THR      220      CG2           2.5059
39343 NEG      CLA      67       CLA     -2474 PROA     THR      220      O             4.0392
39343 NEG      CLA      67       CLA     -2492 PROA     LEU      221      C             3.3362
39343 NEG      CLA      67       CLA     -2493 PROA     LEU      221      O             2.4143
39343 NEG      CLA      67       CLA     -2494 PROA     THR      222      N             4.0152
39343 NEG      CLA      67       CLA     -2496 PROA     THR      222      CA            4.0520
39343 NEG      CLA      67       CLA     -2498 PROA     THR      222      CB            4.4777
39343 NEG      CLA      67       CLA     -2500 PROA     THR      222      OG1           3.7113
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "138" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "71"
Evaluating: 138-71
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.34249133"
Evaluating: 100.116666*(0.34249133-0.5)
 Parameter: XPOS <- "-15.7692429"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.703430271"
Evaluating: 100.116666*(0.703430271-0.5)
 Parameter: YPOS <- "20.3667605"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.944574545"
Evaluating: 127.138691*(0.944574545-0.5)+4.2778237
 Parameter: ZPOS <- "60.8004494"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.8004494" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.8004494" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.655614 XMAX =   -1.655614 XAVE =   -1.655614
    YMIN =   -8.520392 YMAX =   -8.520392 YAVE =   -8.520392
    ZMIN =  -20.131705 ZMAX =  -20.131705 ZAVE =  -20.131705
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.7692429"
 RDCMND substituted energy or value "?XAVE" to "-1.65561399"
Evaluating: -15.7692429--1.65561399
 Parameter: XTRAN <- "-14.1136289"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.3667605"
 RDCMND substituted energy or value "?YAVE" to "-8.52039202"
Evaluating: 20.3667605--8.52039202
 Parameter: YTRAN <- "28.8871525"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.8004494"
 RDCMND substituted energy or value "?ZAVE" to "-20.131705"
Evaluating: 60.8004494--20.131705
 Parameter: ZTRAN <- "80.9321544"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.1136289"
 Parameter: YTRAN -> "28.8871525"
 Parameter: ZTRAN -> "80.9321544"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -14.113629   28.887152   80.932154
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.427610334"
Evaluating: 0.427610334*360.0
 Parameter: XPHI <- "153.93972"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284986362"
Evaluating: 0.284986362*360.0
 Parameter: YPHI <- "102.59509"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.805045584"
Evaluating: 0.805045584*360.0
 Parameter: ZPHI <- "289.81641"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.7692429"
 Parameter: YPOS -> "20.3667605"
 Parameter: ZPOS -> "60.8004494"
 Parameter: XPHI -> "153.93972"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.898332    0.439317
    0.000000   -0.439317   -0.898332

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.7692429"
 Parameter: YPOS -> "20.3667605"
 Parameter: ZPOS -> "60.8004494"
 Parameter: YPHI -> "102.59509"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.218060    0.000000   -0.975935
    0.000000    1.000000    0.000000
    0.975935    0.000000   -0.218060

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  102.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.7692429"
 Parameter: YPOS -> "20.3667605"
 Parameter: ZPOS -> "60.8004494"
 Parameter: ZPHI -> "289.81641"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.339007   -0.940784    0.000000
    0.940784    0.339007    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.769243 XMAX =  -15.769243 XAVE =  -15.769243
    YMIN =   20.366760 YMAX =   20.366760 YAVE =   20.366760
    ZMIN =   60.800449 ZMAX =   60.800449 ZAVE =   60.800449
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.7692429"
Evaluating: -15.7692429+3.5
 Parameter: XMAX <- "-12.2692429"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.3667605"
Evaluating: 20.3667605+3.5
 Parameter: YMAX <- "23.8667605"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.8004494"
Evaluating: 60.8004494+3.5
 Parameter: ZMAX <- "64.3004494"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.7692429"
Evaluating: -15.7692429-3.5
 Parameter: XMIN <- "-19.2692429"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.3667605"
Evaluating: 20.3667605-3.5
 Parameter: YMIN <- "16.8667605"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.8004494"
Evaluating: 60.8004494-3.5
 Parameter: ZMIN <- "57.3004494"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.2692429"
 Parameter: XMIN -> "-19.2692429"
 Parameter: YMAX -> "23.8667605"
 Parameter: YMIN -> "16.8667605"
 Parameter: ZMAX -> "64.3004494"
 Parameter: ZMIN -> "57.3004494"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "139" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "139" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "71"
Evaluating: 139-71
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.466007646"
Evaluating: 100.116666*(0.466007646-0.5)
 Parameter: XPOS <- "-3.40320115"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.594822153"
Evaluating: 100.116666*(0.594822153-0.5)
 Parameter: YPOS <- "9.49327782"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.136263523"
Evaluating: 127.138691*(0.136263523-0.5)+4.2778237
 Parameter: ZPOS <- "-41.9671559"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.9671559" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.40320115"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -3.40320115-0
 Parameter: XTRAN <- "-3.40320115"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.49327782"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.49327782-0
 Parameter: YTRAN <- "9.49327782"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.9671559"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -41.9671559-0
 Parameter: ZTRAN <- "-41.9671559"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.40320115"
 Parameter: YTRAN -> "9.49327782"
 Parameter: ZTRAN -> "-41.9671559"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    -3.403201    9.493278  -41.967156
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.51972448E-03"
Evaluating: 7.51972448E-03*360.0
 Parameter: XPHI <- "2.70710081"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.707111718"
Evaluating: 0.707111718*360.0
 Parameter: YPHI <- "254.560218"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745687625"
Evaluating: 0.745687625*360.0
 Parameter: ZPHI <- "268.447545"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.40320115"
 Parameter: YPOS -> "9.49327782"
 Parameter: ZPOS -> "-41.9671559"
 Parameter: XPHI -> "2.70710081"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998884    0.047230
    0.000000   -0.047230    0.998884

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    2.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.40320115"
 Parameter: YPOS -> "9.49327782"
 Parameter: ZPOS -> "-41.9671559"
 Parameter: YPHI -> "254.560218"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.266225    0.000000    0.963911
    0.000000    1.000000    0.000000
   -0.963911    0.000000   -0.266225

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.40320115"
 Parameter: YPOS -> "9.49327782"
 Parameter: ZPOS -> "-41.9671559"
 Parameter: ZPHI -> "268.447545"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.027092   -0.999633    0.000000
    0.999633   -0.027092    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.403201 XMAX =   -3.403201 XAVE =   -3.403201
    YMIN =    9.493278 YMAX =    9.493278 YAVE =    9.493278
    ZMIN =  -41.967156 ZMAX =  -41.967156 ZAVE =  -41.967156
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.40320115"
Evaluating: -3.40320115+3.5
 Parameter: XMAX <- "9.679885E-02"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.49327782"
Evaluating: 9.49327782+3.5
 Parameter: YMAX <- "12.9932778"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.9671559"
Evaluating: -41.9671559+3.5
 Parameter: ZMAX <- "-38.4671559"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.40320115"
Evaluating: -3.40320115-3.5
 Parameter: XMIN <- "-6.90320115"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.49327782"
Evaluating: 9.49327782-3.5
 Parameter: YMIN <- "5.99327782"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.9671559"
Evaluating: -41.9671559-3.5
 Parameter: ZMIN <- "-45.4671559"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.679885E-02"
 Parameter: XMIN -> "-6.90320115"
 Parameter: YMAX -> "12.9932778"
 Parameter: YMIN -> "5.99327782"
 Parameter: ZMAX -> "-38.4671559"
 Parameter: ZMIN -> "-45.4671559"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "140" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "140" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "71"
Evaluating: 140-71
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.898356531"
Evaluating: 100.116666*(0.898356531-0.5)
 Parameter: XPOS <- "39.8821278"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.534743445"
Evaluating: 100.116666*(0.534743445-0.5)
 Parameter: YPOS <- "3.47839788"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.954263409"
Evaluating: 127.138691*(0.954263409-0.5)+4.2778237
 Parameter: ZPOS <- "62.0322789"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.0322789" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.0322789" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8821278"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8821278-0
 Parameter: XTRAN <- "39.8821278"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.47839788"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.47839788-0
 Parameter: YTRAN <- "3.47839788"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.0322789"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 62.0322789-0
 Parameter: ZTRAN <- "62.0322789"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8821278"
 Parameter: YTRAN -> "3.47839788"
 Parameter: ZTRAN -> "62.0322789"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    39.882128    3.478398   62.032279
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.691580847"
Evaluating: 0.691580847*360.0
 Parameter: XPHI <- "248.969105"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336971483"
Evaluating: 0.336971483*360.0
 Parameter: YPHI <- "121.309734"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136685698"
Evaluating: 0.136685698*360.0
 Parameter: ZPHI <- "49.2068513"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8821278"
 Parameter: YPOS -> "3.47839788"
 Parameter: ZPOS -> "62.0322789"
 Parameter: XPHI -> "248.969105"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.358871   -0.933387
    0.000000    0.933387   -0.358871

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  111.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8821278"
 Parameter: YPOS -> "3.47839788"
 Parameter: ZPOS -> "62.0322789"
 Parameter: YPHI -> "121.309734"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.519664    0.000000   -0.854371
    0.000000    1.000000    0.000000
    0.854371    0.000000   -0.519664

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8821278"
 Parameter: YPOS -> "3.47839788"
 Parameter: ZPOS -> "62.0322789"
 Parameter: ZPHI -> "49.2068513"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.653330    0.757073    0.000000
   -0.757073    0.653330    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   49.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.882128 XMAX =   39.882128 XAVE =   39.882128
    YMIN =    3.478398 YMAX =    3.478398 YAVE =    3.478398
    ZMIN =   62.032279 ZMAX =   62.032279 ZAVE =   62.032279
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8821278"
Evaluating: 39.8821278+3.5
 Parameter: XMAX <- "43.3821278"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.47839788"
Evaluating: 3.47839788+3.5
 Parameter: YMAX <- "6.97839788"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.0322789"
Evaluating: 62.0322789+3.5
 Parameter: ZMAX <- "65.5322789"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8821278"
Evaluating: 39.8821278-3.5
 Parameter: XMIN <- "36.3821278"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.47839788"
Evaluating: 3.47839788-3.5
 Parameter: YMIN <- "-2.160212E-02"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.0322789"
Evaluating: 62.0322789-3.5
 Parameter: ZMIN <- "58.5322789"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3821278"
 Parameter: XMIN -> "36.3821278"
 Parameter: YMAX -> "6.97839788"
 Parameter: YMIN -> "-2.160212E-02"
 Parameter: ZMAX -> "65.5322789"
 Parameter: ZMIN -> "58.5322789"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "141" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "141" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "71"
Evaluating: 141-71
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.272104791"
Evaluating: 100.116666*(0.272104791-0.5)
 Parameter: XPOS <- "-22.8161085"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.438943146"
Evaluating: 100.116666*(0.438943146-0.5)
 Parameter: YPOS <- "-6.11280866"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.935643422"
Evaluating: 127.138691*(0.935643422-0.5)+4.2778237
 Parameter: ZPOS <- "59.6649581"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.6649581" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.6649581" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.8161085"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.8161085-0
 Parameter: XTRAN <- "-22.8161085"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.11280866"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.11280866-0
 Parameter: YTRAN <- "-6.11280866"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.6649581"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 59.6649581-0
 Parameter: ZTRAN <- "59.6649581"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.8161085"
 Parameter: YTRAN -> "-6.11280866"
 Parameter: ZTRAN -> "59.6649581"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -22.816108   -6.112809   59.664958
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.903155718"
Evaluating: 0.903155718*360.0
 Parameter: XPHI <- "325.136058"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441981744"
Evaluating: 0.441981744*360.0
 Parameter: YPHI <- "159.113428"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864296636"
Evaluating: 0.864296636*360.0
 Parameter: ZPHI <- "311.146789"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.8161085"
 Parameter: YPOS -> "-6.11280866"
 Parameter: ZPOS -> "59.6649581"
 Parameter: XPHI -> "325.136058"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.820512   -0.571630
    0.000000    0.571630    0.820512

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.8161085"
 Parameter: YPOS -> "-6.11280866"
 Parameter: ZPOS -> "59.6649581"
 Parameter: YPHI -> "159.113428"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.934288    0.000000   -0.356519
    0.000000    1.000000    0.000000
    0.356519    0.000000   -0.934288

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.8161085"
 Parameter: YPOS -> "-6.11280866"
 Parameter: ZPOS -> "59.6649581"
 Parameter: ZPHI -> "311.146789"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.657990   -0.753026    0.000000
    0.753026    0.657990    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.816108 XMAX =  -22.816108 XAVE =  -22.816108
    YMIN =   -6.112809 YMAX =   -6.112809 YAVE =   -6.112809
    ZMIN =   59.664958 ZMAX =   59.664958 ZAVE =   59.664958
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.8161085"
Evaluating: -22.8161085+3.5
 Parameter: XMAX <- "-19.3161085"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.11280866"
Evaluating: -6.11280866+3.5
 Parameter: YMAX <- "-2.61280866"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.6649581"
Evaluating: 59.6649581+3.5
 Parameter: ZMAX <- "63.1649581"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.8161085"
Evaluating: -22.8161085-3.5
 Parameter: XMIN <- "-26.3161085"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.11280866"
Evaluating: -6.11280866-3.5
 Parameter: YMIN <- "-9.61280866"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.6649581"
Evaluating: 59.6649581-3.5
 Parameter: ZMIN <- "56.1649581"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.3161085"
 Parameter: XMIN -> "-26.3161085"
 Parameter: YMAX -> "-2.61280866"
 Parameter: YMIN -> "-9.61280866"
 Parameter: ZMAX -> "63.1649581"
 Parameter: ZMIN -> "56.1649581"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "142" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "142" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "71"
Evaluating: 142-71
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.11632512"
Evaluating: 100.116666*(0.11632512-0.5)
 Parameter: XPOS <- "-38.4122498"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.368025337"
Evaluating: 100.116666*(0.368025337-0.5)
 Parameter: YPOS <- "-13.2128633"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.194603238"
Evaluating: 127.138691*(0.194603238-0.5)+4.2778237
 Parameter: ZPOS <- "-34.5499209"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.5499209" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.4122498"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.4122498-0
 Parameter: XTRAN <- "-38.4122498"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.2128633"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -13.2128633-0
 Parameter: YTRAN <- "-13.2128633"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.5499209"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -34.5499209-0
 Parameter: ZTRAN <- "-34.5499209"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.4122498"
 Parameter: YTRAN -> "-13.2128633"
 Parameter: ZTRAN -> "-34.5499209"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -38.412250  -13.212863  -34.549921
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392369129"
Evaluating: 0.392369129*360.0
 Parameter: XPHI <- "141.252886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720947994"
Evaluating: 0.720947994*360.0
 Parameter: YPHI <- "259.541278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60867462"
Evaluating: 0.60867462*360.0
 Parameter: ZPHI <- "219.122863"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.4122498"
 Parameter: YPOS -> "-13.2128633"
 Parameter: ZPOS -> "-34.5499209"
 Parameter: XPHI -> "141.252886"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.779916    0.625884
    0.000000   -0.625884   -0.779916

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.4122498"
 Parameter: YPOS -> "-13.2128633"
 Parameter: ZPOS -> "-34.5499209"
 Parameter: YPHI -> "259.541278"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.181527    0.000000    0.983386
    0.000000    1.000000    0.000000
   -0.983386    0.000000   -0.181527

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  100.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.4122498"
 Parameter: YPOS -> "-13.2128633"
 Parameter: ZPOS -> "-34.5499209"
 Parameter: ZPHI -> "219.122863"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.775795   -0.630985    0.000000
    0.630985   -0.775795    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  140.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.412250 XMAX =  -38.412250 XAVE =  -38.412250
    YMIN =  -13.212863 YMAX =  -13.212863 YAVE =  -13.212863
    ZMIN =  -34.549921 ZMAX =  -34.549921 ZAVE =  -34.549921
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.4122498"
Evaluating: -38.4122498+3.5
 Parameter: XMAX <- "-34.9122498"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.2128633"
Evaluating: -13.2128633+3.5
 Parameter: YMAX <- "-9.7128633"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.5499209"
Evaluating: -34.5499209+3.5
 Parameter: ZMAX <- "-31.0499209"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.4122498"
Evaluating: -38.4122498-3.5
 Parameter: XMIN <- "-41.9122498"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.2128633"
Evaluating: -13.2128633-3.5
 Parameter: YMIN <- "-16.7128633"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.5499209"
Evaluating: -34.5499209-3.5
 Parameter: ZMIN <- "-38.0499209"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.9122498"
 Parameter: XMIN -> "-41.9122498"
 Parameter: YMAX -> "-9.7128633"
 Parameter: YMIN -> "-16.7128633"
 Parameter: ZMAX -> "-31.0499209"
 Parameter: ZMIN -> "-38.0499209"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "143" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "143" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "71"
Evaluating: 143-71
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.612766527"
Evaluating: 100.116666*(0.612766527-0.5)
 Parameter: XPOS <- "11.2898087"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.50597344"
Evaluating: 100.116666*(0.50597344-0.5)
 Parameter: YPOS <- "0.598040897"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.873733056"
Evaluating: 127.138691*(0.873733056-0.5)+4.2778237
 Parameter: ZPOS <- "51.7937552"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "51.7937552" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "51.7937552" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.2898087"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.2898087-0
 Parameter: XTRAN <- "11.2898087"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.598040897"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.598040897-0
 Parameter: YTRAN <- "0.598040897"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "51.7937552"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 51.7937552-0
 Parameter: ZTRAN <- "51.7937552"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.2898087"
 Parameter: YTRAN -> "0.598040897"
 Parameter: ZTRAN -> "51.7937552"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    11.289809    0.598041   51.793755
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919212336"
Evaluating: 0.919212336*360.0
 Parameter: XPHI <- "330.916441"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481643449"
Evaluating: 0.481643449*360.0
 Parameter: YPHI <- "173.391642"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420460516"
Evaluating: 0.420460516*360.0
 Parameter: ZPHI <- "151.365786"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.2898087"
 Parameter: YPOS -> "0.598040897"
 Parameter: ZPOS -> "51.7937552"
 Parameter: XPHI -> "330.916441"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.873912   -0.486085
    0.000000    0.486085    0.873912

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.2898087"
 Parameter: YPOS -> "0.598040897"
 Parameter: ZPOS -> "51.7937552"
 Parameter: YPHI -> "173.391642"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.993356    0.000000   -0.115082
    0.000000    1.000000    0.000000
    0.115082    0.000000   -0.993356

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  173.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.2898087"
 Parameter: YPOS -> "0.598040897"
 Parameter: ZPOS -> "51.7937552"
 Parameter: ZPHI -> "151.365786"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.877697    0.479216    0.000000
   -0.479216   -0.877697    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.289809 XMAX =   11.289809 XAVE =   11.289809
    YMIN =    0.598041 YMAX =    0.598041 YAVE =    0.598041
    ZMIN =   51.793755 ZMAX =   51.793755 ZAVE =   51.793755
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.2898087"
Evaluating: 11.2898087+3.5
 Parameter: XMAX <- "14.7898087"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.598040897"
Evaluating: 0.598040897+3.5
 Parameter: YMAX <- "4.0980409"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "51.7937552"
Evaluating: 51.7937552+3.5
 Parameter: ZMAX <- "55.2937552"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.2898087"
Evaluating: 11.2898087-3.5
 Parameter: XMIN <- "7.7898087"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.598040897"
Evaluating: 0.598040897-3.5
 Parameter: YMIN <- "-2.9019591"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "51.7937552"
Evaluating: 51.7937552-3.5
 Parameter: ZMIN <- "48.2937552"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.7898087"
 Parameter: XMIN -> "7.7898087"
 Parameter: YMAX -> "4.0980409"
 Parameter: YMIN -> "-2.9019591"
 Parameter: ZMAX -> "55.2937552"
 Parameter: ZMIN -> "48.2937552"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "144" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "144" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "71"
Evaluating: 144-71
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.681071765"
Evaluating: 100.116666*(0.681071765-0.5)
 Parameter: XPOS <- "18.1283014"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.940712564"
Evaluating: 100.116666*(0.940712564-0.5)
 Parameter: YPOS <- "44.1226726"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "9.770307815E-02"
Evaluating: 127.138691*(9.770307815E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-46.8696803"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.8696803" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.1283014"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.1283014-0
 Parameter: XTRAN <- "18.1283014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.1226726"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.1226726-0
 Parameter: YTRAN <- "44.1226726"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.8696803"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.8696803-0
 Parameter: ZTRAN <- "-46.8696803"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.1283014"
 Parameter: YTRAN -> "44.1226726"
 Parameter: ZTRAN -> "-46.8696803"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    18.128301   44.122673  -46.869680
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.338396965"
Evaluating: 0.338396965*360.0
 Parameter: XPHI <- "121.822907"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225156891"
Evaluating: 0.225156891*360.0
 Parameter: YPHI <- "81.0564808"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668454359"
Evaluating: 0.668454359*360.0
 Parameter: ZPHI <- "240.643569"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.1283014"
 Parameter: YPOS -> "44.1226726"
 Parameter: ZPOS -> "-46.8696803"
 Parameter: XPHI -> "121.822907"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.527296    0.849682
    0.000000   -0.849682   -0.527296

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.1283014"
 Parameter: YPOS -> "44.1226726"
 Parameter: ZPOS -> "-46.8696803"
 Parameter: YPHI -> "81.0564808"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.155461    0.000000   -0.987842
    0.000000    1.000000    0.000000
    0.987842    0.000000    0.155461

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.1283014"
 Parameter: YPOS -> "44.1226726"
 Parameter: ZPOS -> "-46.8696803"
 Parameter: ZPHI -> "240.643569"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.490241   -0.871587    0.000000
    0.871587   -0.490241    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.128301 XMAX =   18.128301 XAVE =   18.128301
    YMIN =   44.122673 YMAX =   44.122673 YAVE =   44.122673
    ZMIN =  -46.869680 ZMAX =  -46.869680 ZAVE =  -46.869680
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.1283014"
Evaluating: 18.1283014+3.5
 Parameter: XMAX <- "21.6283014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.1226726"
Evaluating: 44.1226726+3.5
 Parameter: YMAX <- "47.6226726"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.8696803"
Evaluating: -46.8696803+3.5
 Parameter: ZMAX <- "-43.3696803"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.1283014"
Evaluating: 18.1283014-3.5
 Parameter: XMIN <- "14.6283014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.1226726"
Evaluating: 44.1226726-3.5
 Parameter: YMIN <- "40.6226726"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.8696803"
Evaluating: -46.8696803-3.5
 Parameter: ZMIN <- "-50.3696803"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.6283014"
 Parameter: XMIN -> "14.6283014"
 Parameter: YMAX -> "47.6226726"
 Parameter: YMIN -> "40.6226726"
 Parameter: ZMAX -> "-43.3696803"
 Parameter: ZMIN -> "-50.3696803"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "145" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "145" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "71"
Evaluating: 145-71
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.595504768"
Evaluating: 100.116666*(0.595504768-0.5)
 Parameter: XPOS <- "9.56161896"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.372712554"
Evaluating: 100.116666*(0.372712554-0.5)
 Parameter: YPOS <- "-12.7435947"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.543167052"
Evaluating: 127.138691*(0.543167052-0.5)+4.2778237
 Parameter: ZPOS <- "9.76602619"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.76602619" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.76602619" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "145" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "71"
Evaluating: 145-71
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.542315365"
Evaluating: 100.116666*(0.542315365-0.5)
 Parameter: XPOS <- "4.23647326"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.876265769"
Evaluating: 100.116666*(0.876265769-0.5)
 Parameter: YPOS <- "37.6704743"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.365526395"
Evaluating: 127.138691*(0.365526395-0.5)+4.2778237
 Parameter: ZPOS <- "-12.8189744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.8189744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.8189744" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "145" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "71"
Evaluating: 145-71
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.866404873"
Evaluating: 100.116666*(0.866404873-0.5)
 Parameter: XPOS <- "36.6832343"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.660193117"
Evaluating: 100.116666*(0.660193117-0.5)
 Parameter: YPOS <- "16.0380008"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.730363736"
Evaluating: 127.138691*(0.730363736-0.5)+4.2778237
 Parameter: ZPOS <- "33.5659675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.5659675" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.5659675" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.6832343"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.6832343-0
 Parameter: XTRAN <- "36.6832343"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.0380008"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.0380008-0
 Parameter: YTRAN <- "16.0380008"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.5659675"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.5659675-0
 Parameter: ZTRAN <- "33.5659675"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.6832343"
 Parameter: YTRAN -> "16.0380008"
 Parameter: ZTRAN -> "33.5659675"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    36.683234   16.038001   33.565967
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.328155331"
Evaluating: 0.328155331*360.0
 Parameter: XPHI <- "118.135919"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70001487"
Evaluating: 0.70001487*360.0
 Parameter: YPHI <- "252.005353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.634339171"
Evaluating: 0.634339171*360.0
 Parameter: ZPHI <- "228.362102"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.6832343"
 Parameter: YPOS -> "16.0380008"
 Parameter: ZPOS -> "33.5659675"
 Parameter: XPHI -> "118.135919"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.471565    0.881831
    0.000000   -0.881831   -0.471565

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  118.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.6832343"
 Parameter: YPOS -> "16.0380008"
 Parameter: ZPOS -> "33.5659675"
 Parameter: YPHI -> "252.005353"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.308928    0.000000    0.951085
    0.000000    1.000000    0.000000
   -0.951085    0.000000   -0.308928

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.6832343"
 Parameter: YPOS -> "16.0380008"
 Parameter: ZPOS -> "33.5659675"
 Parameter: ZPHI -> "228.362102"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.664421   -0.747359    0.000000
    0.747359   -0.664421    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  131.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.683234 XMAX =   36.683234 XAVE =   36.683234
    YMIN =   16.038001 YMAX =   16.038001 YAVE =   16.038001
    ZMIN =   33.565967 ZMAX =   33.565967 ZAVE =   33.565967
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.6832343"
Evaluating: 36.6832343+3.5
 Parameter: XMAX <- "40.1832343"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.0380008"
Evaluating: 16.0380008+3.5
 Parameter: YMAX <- "19.5380008"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.5659675"
Evaluating: 33.5659675+3.5
 Parameter: ZMAX <- "37.0659675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.6832343"
Evaluating: 36.6832343-3.5
 Parameter: XMIN <- "33.1832343"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.0380008"
Evaluating: 16.0380008-3.5
 Parameter: YMIN <- "12.5380008"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.5659675"
Evaluating: 33.5659675-3.5
 Parameter: ZMIN <- "30.0659675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.1832343"
 Parameter: XMIN -> "33.1832343"
 Parameter: YMAX -> "19.5380008"
 Parameter: YMIN -> "12.5380008"
 Parameter: ZMAX -> "37.0659675"
 Parameter: ZMIN -> "30.0659675"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "146" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "146" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "71"
Evaluating: 146-71
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.688439856"
Evaluating: 100.116666*(0.688439856-0.5)
 Parameter: XPOS <- "18.8659701"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.883156494"
Evaluating: 100.116666*(0.883156494-0.5)
 Parameter: YPOS <- "38.3603507"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.761578778"
Evaluating: 127.138691*(0.761578778-0.5)+4.2778237
 Parameter: ZPOS <- "37.5346071"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "37.5346071" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "37.5346071" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.8659701"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.8659701-0
 Parameter: XTRAN <- "18.8659701"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.3603507"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.3603507-0
 Parameter: YTRAN <- "38.3603507"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.5346071"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 37.5346071-0
 Parameter: ZTRAN <- "37.5346071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.8659701"
 Parameter: YTRAN -> "38.3603507"
 Parameter: ZTRAN -> "37.5346071"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    18.865970   38.360351   37.534607
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980244076"
Evaluating: 0.980244076*360.0
 Parameter: XPHI <- "352.887867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346630064"
Evaluating: 0.346630064*360.0
 Parameter: YPHI <- "124.786823"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.050305724E-03"
Evaluating: 8.050305724E-03*360.0
 Parameter: ZPHI <- "2.89811006"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.8659701"
 Parameter: YPOS -> "38.3603507"
 Parameter: ZPOS -> "37.5346071"
 Parameter: XPHI -> "352.887867"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.992306   -0.123812
    0.000000    0.123812    0.992306

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    7.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.8659701"
 Parameter: YPOS -> "38.3603507"
 Parameter: ZPOS -> "37.5346071"
 Parameter: YPHI -> "124.786823"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.570525    0.000000   -0.821280
    0.000000    1.000000    0.000000
    0.821280    0.000000   -0.570525

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.8659701"
 Parameter: YPOS -> "38.3603507"
 Parameter: ZPOS -> "37.5346071"
 Parameter: ZPHI -> "2.89811006"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.998721    0.050560    0.000000
   -0.050560    0.998721    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    2.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.865970 XMAX =   18.865970 XAVE =   18.865970
    YMIN =   38.360351 YMAX =   38.360351 YAVE =   38.360351
    ZMIN =   37.534607 ZMAX =   37.534607 ZAVE =   37.534607
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.8659701"
Evaluating: 18.8659701+3.5
 Parameter: XMAX <- "22.3659701"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.3603507"
Evaluating: 38.3603507+3.5
 Parameter: YMAX <- "41.8603507"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.5346071"
Evaluating: 37.5346071+3.5
 Parameter: ZMAX <- "41.0346071"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.8659701"
Evaluating: 18.8659701-3.5
 Parameter: XMIN <- "15.3659701"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.3603507"
Evaluating: 38.3603507-3.5
 Parameter: YMIN <- "34.8603507"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.5346071"
Evaluating: 37.5346071-3.5
 Parameter: ZMIN <- "34.0346071"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.3659701"
 Parameter: XMIN -> "15.3659701"
 Parameter: YMAX -> "41.8603507"
 Parameter: YMIN -> "34.8603507"
 Parameter: ZMAX -> "41.0346071"
 Parameter: ZMIN -> "34.0346071"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "147" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "147" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "71"
Evaluating: 147-71
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.259574348"
Evaluating: 100.116666*(0.259574348-0.5)
 Parameter: XPOS <- "-24.0706147"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "1.173132213E-02"
Evaluating: 100.116666*(1.173132213E-02-0.5)
 Parameter: YPOS <- "-48.8838321"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.151772025"
Evaluating: 127.138691*(0.151772025-0.5)+4.2778237
 Parameter: ZPOS <- "-39.9954252"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.9954252" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.0706147"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.0706147-0
 Parameter: XTRAN <- "-24.0706147"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-48.8838321"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -48.8838321-0
 Parameter: YTRAN <- "-48.8838321"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9954252"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.9954252-0
 Parameter: ZTRAN <- "-39.9954252"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.0706147"
 Parameter: YTRAN -> "-48.8838321"
 Parameter: ZTRAN -> "-39.9954252"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -24.070615  -48.883832  -39.995425
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121900839"
Evaluating: 0.121900839*360.0
 Parameter: XPHI <- "43.884302"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.437534628"
Evaluating: 0.437534628*360.0
 Parameter: YPHI <- "157.512466"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943068613"
Evaluating: 0.943068613*360.0
 Parameter: ZPHI <- "339.504701"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.0706147"
 Parameter: YPOS -> "-48.8838321"
 Parameter: ZPOS -> "-39.9954252"
 Parameter: XPHI -> "43.884302"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.720741    0.693204
    0.000000   -0.693204    0.720741

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.0706147"
 Parameter: YPOS -> "-48.8838321"
 Parameter: ZPOS -> "-39.9954252"
 Parameter: YPHI -> "157.512466"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.923963    0.000000   -0.382482
    0.000000    1.000000    0.000000
    0.382482    0.000000   -0.923963

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  157.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.0706147"
 Parameter: YPOS -> "-48.8838321"
 Parameter: ZPOS -> "-39.9954252"
 Parameter: ZPHI -> "339.504701"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.936701   -0.350131    0.000000
    0.350131    0.936701    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.070615 XMAX =  -24.070615 XAVE =  -24.070615
    YMIN =  -48.883832 YMAX =  -48.883832 YAVE =  -48.883832
    ZMIN =  -39.995425 ZMAX =  -39.995425 ZAVE =  -39.995425
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.0706147"
Evaluating: -24.0706147+3.5
 Parameter: XMAX <- "-20.5706147"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-48.8838321"
Evaluating: -48.8838321+3.5
 Parameter: YMAX <- "-45.3838321"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9954252"
Evaluating: -39.9954252+3.5
 Parameter: ZMAX <- "-36.4954252"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.0706147"
Evaluating: -24.0706147-3.5
 Parameter: XMIN <- "-27.5706147"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-48.8838321"
Evaluating: -48.8838321-3.5
 Parameter: YMIN <- "-52.3838321"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9954252"
Evaluating: -39.9954252-3.5
 Parameter: ZMIN <- "-43.4954252"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.5706147"
 Parameter: XMIN -> "-27.5706147"
 Parameter: YMAX -> "-45.3838321"
 Parameter: YMIN -> "-52.3838321"
 Parameter: ZMAX -> "-36.4954252"
 Parameter: ZMIN -> "-43.4954252"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "148" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "148" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "71"
Evaluating: 148-71
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.677434337"
Evaluating: 100.116666*(0.677434337-0.5)
 Parameter: XPOS <- "17.7641343"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.586687272E-02"
Evaluating: 100.116666*(7.586687272E-02-0.5)
 Parameter: YPOS <- "-42.4627946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.278666396"
Evaluating: 127.138691*(0.278666396-0.5)+4.2778237
 Parameter: ZPOS <- "-23.862241"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.862241" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.7641343"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 17.7641343-0
 Parameter: XTRAN <- "17.7641343"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.4627946"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.4627946-0
 Parameter: YTRAN <- "-42.4627946"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.862241"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.862241-0
 Parameter: ZTRAN <- "-23.862241"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.7641343"
 Parameter: YTRAN -> "-42.4627946"
 Parameter: ZTRAN -> "-23.862241"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    17.764134  -42.462795  -23.862241
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678278083"
Evaluating: 0.678278083*360.0
 Parameter: XPHI <- "244.18011"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.57133326"
Evaluating: 0.57133326*360.0
 Parameter: YPHI <- "205.679974"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.166805387"
Evaluating: 0.166805387*360.0
 Parameter: ZPHI <- "60.0499393"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.7641343"
 Parameter: YPOS -> "-42.4627946"
 Parameter: ZPOS -> "-23.862241"
 Parameter: XPHI -> "244.18011"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.435544   -0.900168
    0.000000    0.900168   -0.435544

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.7641343"
 Parameter: YPOS -> "-42.4627946"
 Parameter: ZPOS -> "-23.862241"
 Parameter: YPHI -> "205.679974"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.901229    0.000000    0.433344
    0.000000    1.000000    0.000000
   -0.433344    0.000000   -0.901229

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.7641343"
 Parameter: YPOS -> "-42.4627946"
 Parameter: ZPOS -> "-23.862241"
 Parameter: ZPHI -> "60.0499393"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.499245    0.866461    0.000000
   -0.866461    0.499245    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.764134 XMAX =   17.764134 XAVE =   17.764134
    YMIN =  -42.462795 YMAX =  -42.462795 YAVE =  -42.462795
    ZMIN =  -23.862241 ZMAX =  -23.862241 ZAVE =  -23.862241
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.7641343"
Evaluating: 17.7641343+3.5
 Parameter: XMAX <- "21.2641343"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.4627946"
Evaluating: -42.4627946+3.5
 Parameter: YMAX <- "-38.9627946"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.862241"
Evaluating: -23.862241+3.5
 Parameter: ZMAX <- "-20.362241"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.7641343"
Evaluating: 17.7641343-3.5
 Parameter: XMIN <- "14.2641343"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.4627946"
Evaluating: -42.4627946-3.5
 Parameter: YMIN <- "-45.9627946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.862241"
Evaluating: -23.862241-3.5
 Parameter: ZMIN <- "-27.362241"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.2641343"
 Parameter: XMIN -> "14.2641343"
 Parameter: YMAX -> "-38.9627946"
 Parameter: YMIN -> "-45.9627946"
 Parameter: ZMAX -> "-20.362241"
 Parameter: ZMIN -> "-27.362241"
 SELRPN>      6 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      5 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39353 NEG      CLA      77       CLA     -**** MEMB     POPC     208      P             2.9713
39353 NEG      CLA      77       CLA     -**** MEMB     POPC     208      O13           2.3221
39353 NEG      CLA      77       CLA     -**** MEMB     POPC     208      O14           2.8841
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "148" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "71"
Evaluating: 148-71
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.837669984"
Evaluating: 100.116666*(0.837669984-0.5)
 Parameter: XPOS <- "33.806393"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.761210736"
Evaluating: 100.116666*(0.761210736-0.5)
 Parameter: YPOS <- "26.151548"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.728234725"
Evaluating: 127.138691*(0.728234725-0.5)+4.2778237
 Parameter: ZPOS <- "33.2952879"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.2952879" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.2952879" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.764134 XMAX =   17.764134 XAVE =   17.764134
    YMIN =  -42.462795 YMAX =  -42.462795 YAVE =  -42.462795
    ZMIN =  -23.862241 ZMAX =  -23.862241 ZAVE =  -23.862241
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.806393"
 RDCMND substituted energy or value "?XAVE" to "17.7641343"
Evaluating: 33.806393-17.7641343
 Parameter: XTRAN <- "16.0422587"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.151548"
 RDCMND substituted energy or value "?YAVE" to "-42.4627946"
Evaluating: 26.151548--42.4627946
 Parameter: YTRAN <- "68.6143426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.2952879"
 RDCMND substituted energy or value "?ZAVE" to "-23.862241"
Evaluating: 33.2952879--23.862241
 Parameter: ZTRAN <- "57.1575289"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.0422587"
 Parameter: YTRAN -> "68.6143426"
 Parameter: ZTRAN -> "57.1575289"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    16.042259   68.614343   57.157529
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.861069593"
Evaluating: 0.861069593*360.0
 Parameter: XPHI <- "309.985053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802591379"
Evaluating: 0.802591379*360.0
 Parameter: YPHI <- "288.932896"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.859026139"
Evaluating: 0.859026139*360.0
 Parameter: ZPHI <- "309.24941"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.806393"
 Parameter: YPOS -> "26.151548"
 Parameter: ZPOS -> "33.2952879"
 Parameter: XPHI -> "309.985053"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.642588   -0.766212
    0.000000    0.766212    0.642588

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   50.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.806393"
 Parameter: YPOS -> "26.151548"
 Parameter: ZPOS -> "33.2952879"
 Parameter: YPHI -> "288.932896"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.324461    0.000000    0.945899
    0.000000    1.000000    0.000000
   -0.945899    0.000000    0.324461

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.806393"
 Parameter: YPOS -> "26.151548"
 Parameter: ZPOS -> "33.2952879"
 Parameter: ZPHI -> "309.24941"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.632697   -0.774399    0.000000
    0.774399    0.632697    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   50.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.806393 XMAX =   33.806393 XAVE =   33.806393
    YMIN =   26.151548 YMAX =   26.151548 YAVE =   26.151548
    ZMIN =   33.295288 ZMAX =   33.295288 ZAVE =   33.295288
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.806393"
Evaluating: 33.806393+3.5
 Parameter: XMAX <- "37.306393"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.151548"
Evaluating: 26.151548+3.5
 Parameter: YMAX <- "29.651548"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.2952879"
Evaluating: 33.2952879+3.5
 Parameter: ZMAX <- "36.7952879"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.806393"
Evaluating: 33.806393-3.5
 Parameter: XMIN <- "30.306393"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.151548"
Evaluating: 26.151548-3.5
 Parameter: YMIN <- "22.651548"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.2952879"
Evaluating: 33.2952879-3.5
 Parameter: ZMIN <- "29.7952879"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.306393"
 Parameter: XMIN -> "30.306393"
 Parameter: YMAX -> "29.651548"
 Parameter: YMIN -> "22.651548"
 Parameter: ZMAX -> "36.7952879"
 Parameter: ZMIN -> "29.7952879"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "149" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "149" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "71"
Evaluating: 149-71
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.749746273"
Evaluating: 100.116666*(0.749746273-0.5)
 Parameter: XPOS <- "25.0037642"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.626133234"
Evaluating: 100.116666*(0.626133234-0.5)
 Parameter: YPOS <- "12.6280389"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "9.987535404E-02"
Evaluating: 127.138691*(9.987535404E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-46.5935"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.5935" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.0037642"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.0037642-0
 Parameter: XTRAN <- "25.0037642"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.6280389"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.6280389-0
 Parameter: YTRAN <- "12.6280389"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.5935"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.5935-0
 Parameter: ZTRAN <- "-46.5935"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.0037642"
 Parameter: YTRAN -> "12.6280389"
 Parameter: ZTRAN -> "-46.5935"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    25.003764   12.628039  -46.593500
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976541175"
Evaluating: 0.976541175*360.0
 Parameter: XPHI <- "351.554823"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325733374"
Evaluating: 0.325733374*360.0
 Parameter: YPHI <- "117.264015"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598491734"
Evaluating: 0.598491734*360.0
 Parameter: ZPHI <- "215.457024"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.0037642"
 Parameter: YPOS -> "12.6280389"
 Parameter: ZPOS -> "-46.5935"
 Parameter: XPHI -> "351.554823"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.989157   -0.146863
    0.000000    0.146863    0.989157

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.0037642"
 Parameter: YPOS -> "12.6280389"
 Parameter: ZPOS -> "-46.5935"
 Parameter: YPHI -> "117.264015"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.458091    0.000000   -0.888905
    0.000000    1.000000    0.000000
    0.888905    0.000000   -0.458091

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.0037642"
 Parameter: YPOS -> "12.6280389"
 Parameter: ZPOS -> "-46.5935"
 Parameter: ZPHI -> "215.457024"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.814551   -0.580092    0.000000
    0.580092   -0.814551    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.003764 XMAX =   25.003764 XAVE =   25.003764
    YMIN =   12.628039 YMAX =   12.628039 YAVE =   12.628039
    ZMIN =  -46.593500 ZMAX =  -46.593500 ZAVE =  -46.593500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.0037642"
Evaluating: 25.0037642+3.5
 Parameter: XMAX <- "28.5037642"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.6280389"
Evaluating: 12.6280389+3.5
 Parameter: YMAX <- "16.1280389"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.5935"
Evaluating: -46.5935+3.5
 Parameter: ZMAX <- "-43.0935"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.0037642"
Evaluating: 25.0037642-3.5
 Parameter: XMIN <- "21.5037642"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.6280389"
Evaluating: 12.6280389-3.5
 Parameter: YMIN <- "9.1280389"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.5935"
Evaluating: -46.5935-3.5
 Parameter: ZMIN <- "-50.0935"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.5037642"
 Parameter: XMIN -> "21.5037642"
 Parameter: YMAX -> "16.1280389"
 Parameter: YMIN -> "9.1280389"
 Parameter: ZMAX -> "-43.0935"
 Parameter: ZMIN -> "-50.0935"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "150"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "150" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "150" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "71"
Evaluating: 150-71
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.314731375"
Evaluating: 100.116666*(0.314731375-0.5)
 Parameter: XPOS <- "-18.548477"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.24761006"
Evaluating: 100.116666*(0.24761006-0.5)
 Parameter: YPOS <- "-25.2684393"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.100890534"
Evaluating: 127.138691*(0.100890534-0.5)+4.2778237
 Parameter: ZPOS <- "-46.4644314"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-46.4644314" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.548477"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.548477-0
 Parameter: XTRAN <- "-18.548477"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.2684393"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.2684393-0
 Parameter: YTRAN <- "-25.2684393"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-46.4644314"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -46.4644314-0
 Parameter: ZTRAN <- "-46.4644314"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.548477"
 Parameter: YTRAN -> "-25.2684393"
 Parameter: ZTRAN -> "-46.4644314"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -18.548477  -25.268439  -46.464431
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696608985"
Evaluating: 0.696608985*360.0
 Parameter: XPHI <- "250.779235"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406796612"
Evaluating: 0.406796612*360.0
 Parameter: YPHI <- "146.44678"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997042314"
Evaluating: 0.997042314*360.0
 Parameter: ZPHI <- "358.935233"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.548477"
 Parameter: YPOS -> "-25.2684393"
 Parameter: ZPOS -> "-46.4644314"
 Parameter: XPHI -> "250.779235"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.329209   -0.944257
    0.000000    0.944257   -0.329209

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  109.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.548477"
 Parameter: YPOS -> "-25.2684393"
 Parameter: ZPOS -> "-46.4644314"
 Parameter: YPHI -> "146.44678"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.833373    0.000000   -0.552711
    0.000000    1.000000    0.000000
    0.552711    0.000000   -0.833373

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.548477"
 Parameter: YPOS -> "-25.2684393"
 Parameter: ZPOS -> "-46.4644314"
 Parameter: ZPHI -> "358.935233"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.999827   -0.018583    0.000000
    0.018583    0.999827    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.548477 XMAX =  -18.548477 XAVE =  -18.548477
    YMIN =  -25.268439 YMAX =  -25.268439 YAVE =  -25.268439
    ZMIN =  -46.464431 ZMAX =  -46.464431 ZAVE =  -46.464431
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.548477"
Evaluating: -18.548477+3.5
 Parameter: XMAX <- "-15.048477"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.2684393"
Evaluating: -25.2684393+3.5
 Parameter: YMAX <- "-21.7684393"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-46.4644314"
Evaluating: -46.4644314+3.5
 Parameter: ZMAX <- "-42.9644314"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.548477"
Evaluating: -18.548477-3.5
 Parameter: XMIN <- "-22.048477"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.2684393"
Evaluating: -25.2684393-3.5
 Parameter: YMIN <- "-28.7684393"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-46.4644314"
Evaluating: -46.4644314-3.5
 Parameter: ZMIN <- "-49.9644314"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.048477"
 Parameter: XMIN -> "-22.048477"
 Parameter: YMAX -> "-21.7684393"
 Parameter: YMIN -> "-28.7684393"
 Parameter: ZMAX -> "-42.9644314"
 Parameter: ZMIN -> "-49.9644314"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "151"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "151" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "151" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "71"
Evaluating: 151-71
 Parameter: J <- "80"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.908776358"
Evaluating: 100.116666*(0.908776358-0.5)
 Parameter: XPOS <- "40.9253261"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.872578882"
Evaluating: 100.116666*(0.872578882-0.5)
 Parameter: YPOS <- "37.3013555"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.986845661"
Evaluating: 127.138691*(0.986845661-0.5)+4.2778237
 Parameter: ZPOS <- "66.1747438"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "66.1747438" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "66.1747438" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.9253261"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.9253261-0
 Parameter: XTRAN <- "40.9253261"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.3013555"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 37.3013555-0
 Parameter: YTRAN <- "37.3013555"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "66.1747438"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 66.1747438-0
 Parameter: ZTRAN <- "66.1747438"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.9253261"
 Parameter: YTRAN -> "37.3013555"
 Parameter: ZTRAN -> "66.1747438"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    40.925326   37.301355   66.174744
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.516005731"
Evaluating: 0.516005731*360.0
 Parameter: XPHI <- "185.762063"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452389566"
Evaluating: 0.452389566*360.0
 Parameter: YPHI <- "162.860244"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192179793"
Evaluating: 0.192179793*360.0
 Parameter: ZPHI <- "69.1847255"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.9253261"
 Parameter: YPOS -> "37.3013555"
 Parameter: ZPOS -> "66.1747438"
 Parameter: XPHI -> "185.762063"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994947   -0.100398
    0.000000    0.100398   -0.994947

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  174.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.9253261"
 Parameter: YPOS -> "37.3013555"
 Parameter: ZPOS -> "66.1747438"
 Parameter: YPHI -> "162.860244"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.955589    0.000000   -0.294703
    0.000000    1.000000    0.000000
    0.294703    0.000000   -0.955589

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  162.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.9253261"
 Parameter: YPOS -> "37.3013555"
 Parameter: ZPOS -> "66.1747438"
 Parameter: ZPHI -> "69.1847255"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.355356    0.934731    0.000000
   -0.934731    0.355356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.925326 XMAX =   40.925326 XAVE =   40.925326
    YMIN =   37.301355 YMAX =   37.301355 YAVE =   37.301355
    ZMIN =   66.174744 ZMAX =   66.174744 ZAVE =   66.174744
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.9253261"
Evaluating: 40.9253261+3.5
 Parameter: XMAX <- "44.4253261"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.3013555"
Evaluating: 37.3013555+3.5
 Parameter: YMAX <- "40.8013555"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "66.1747438"
Evaluating: 66.1747438+3.5
 Parameter: ZMAX <- "69.6747438"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.9253261"
Evaluating: 40.9253261-3.5
 Parameter: XMIN <- "37.4253261"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.3013555"
Evaluating: 37.3013555-3.5
 Parameter: YMIN <- "33.8013555"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "66.1747438"
Evaluating: 66.1747438-3.5
 Parameter: ZMIN <- "62.6747438"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.4253261"
 Parameter: XMIN -> "37.4253261"
 Parameter: YMAX -> "40.8013555"
 Parameter: YMIN -> "33.8013555"
 Parameter: ZMAX -> "69.6747438"
 Parameter: ZMIN -> "62.6747438"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "152"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "152" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "152" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "71"
Evaluating: 152-71
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.187886503"
Evaluating: 100.116666*(0.187886503-0.5)
 Parameter: XPOS <- "-31.2477627"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.593590431"
Evaluating: 100.116666*(0.593590431-0.5)
 Parameter: YPOS <- "9.36996192"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.146992316"
Evaluating: 127.138691*(0.146992316-0.5)+4.2778237
 Parameter: ZPOS <- "-40.6031112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.6031112" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2477627"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.2477627-0
 Parameter: XTRAN <- "-31.2477627"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.36996192"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.36996192-0
 Parameter: YTRAN <- "9.36996192"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.6031112"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.6031112-0
 Parameter: ZTRAN <- "-40.6031112"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.2477627"
 Parameter: YTRAN -> "9.36996192"
 Parameter: ZTRAN -> "-40.6031112"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -31.247763    9.369962  -40.603111
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.929979841"
Evaluating: 0.929979841*360.0
 Parameter: XPHI <- "334.792743"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.432521583"
Evaluating: 0.432521583*360.0
 Parameter: YPHI <- "155.70777"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.668334361"
Evaluating: 0.668334361*360.0
 Parameter: ZPHI <- "240.60037"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2477627"
 Parameter: YPOS -> "9.36996192"
 Parameter: ZPOS -> "-40.6031112"
 Parameter: XPHI -> "334.792743"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.904773   -0.425894
    0.000000    0.425894    0.904773

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2477627"
 Parameter: YPOS -> "9.36996192"
 Parameter: ZPOS -> "-40.6031112"
 Parameter: YPHI -> "155.70777"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.911459    0.000000   -0.411391
    0.000000    1.000000    0.000000
    0.411391    0.000000   -0.911459

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2477627"
 Parameter: YPOS -> "9.36996192"
 Parameter: ZPOS -> "-40.6031112"
 Parameter: ZPHI -> "240.60037"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.490898   -0.871217    0.000000
    0.871217   -0.490898    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  119.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.247763 XMAX =  -31.247763 XAVE =  -31.247763
    YMIN =    9.369962 YMAX =    9.369962 YAVE =    9.369962
    ZMIN =  -40.603111 ZMAX =  -40.603111 ZAVE =  -40.603111
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2477627"
Evaluating: -31.2477627+3.5
 Parameter: XMAX <- "-27.7477627"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.36996192"
Evaluating: 9.36996192+3.5
 Parameter: YMAX <- "12.8699619"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.6031112"
Evaluating: -40.6031112+3.5
 Parameter: ZMAX <- "-37.1031112"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2477627"
Evaluating: -31.2477627-3.5
 Parameter: XMIN <- "-34.7477627"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.36996192"
Evaluating: 9.36996192-3.5
 Parameter: YMIN <- "5.86996192"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.6031112"
Evaluating: -40.6031112-3.5
 Parameter: ZMIN <- "-44.1031112"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7477627"
 Parameter: XMIN -> "-34.7477627"
 Parameter: YMAX -> "12.8699619"
 Parameter: YMIN -> "5.86996192"
 Parameter: ZMAX -> "-37.1031112"
 Parameter: ZMIN -> "-44.1031112"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "153"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "153" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "153" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "71"
Evaluating: 153-71
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.130394353"
Evaluating: 100.116666*(0.130394353-0.5)
 Parameter: XPOS <- "-37.0036851"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.11935906"
Evaluating: 100.116666*(0.11935906-0.5)
 Parameter: YPOS <- "-38.1085019"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "3.589377932E-02"
Evaluating: 127.138691*(3.589377932E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-54.7280337"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.7280337" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.0036851"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.0036851-0
 Parameter: XTRAN <- "-37.0036851"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.1085019"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.1085019-0
 Parameter: YTRAN <- "-38.1085019"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.7280337"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.7280337-0
 Parameter: ZTRAN <- "-54.7280337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.0036851"
 Parameter: YTRAN -> "-38.1085019"
 Parameter: ZTRAN -> "-54.7280337"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -37.003685  -38.108502  -54.728034
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428292391"
Evaluating: 0.428292391*360.0
 Parameter: XPHI <- "154.185261"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.287490118"
Evaluating: 0.287490118*360.0
 Parameter: YPHI <- "103.496442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.117091571"
Evaluating: 0.117091571*360.0
 Parameter: ZPHI <- "42.1529656"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.0036851"
 Parameter: YPOS -> "-38.1085019"
 Parameter: ZPOS -> "-54.7280337"
 Parameter: XPHI -> "154.185261"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.900207    0.435463
    0.000000   -0.435463   -0.900207

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.0036851"
 Parameter: YPOS -> "-38.1085019"
 Parameter: ZPOS -> "-54.7280337"
 Parameter: YPHI -> "103.496442"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.233385    0.000000   -0.972384
    0.000000    1.000000    0.000000
    0.972384    0.000000   -0.233385

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.0036851"
 Parameter: YPOS -> "-38.1085019"
 Parameter: ZPOS -> "-54.7280337"
 Parameter: ZPHI -> "42.1529656"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.741356    0.671112    0.000000
   -0.671112    0.741356    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   42.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.003685 XMAX =  -37.003685 XAVE =  -37.003685
    YMIN =  -38.108502 YMAX =  -38.108502 YAVE =  -38.108502
    ZMIN =  -54.728034 ZMAX =  -54.728034 ZAVE =  -54.728034
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.0036851"
Evaluating: -37.0036851+3.5
 Parameter: XMAX <- "-33.5036851"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.1085019"
Evaluating: -38.1085019+3.5
 Parameter: YMAX <- "-34.6085019"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.7280337"
Evaluating: -54.7280337+3.5
 Parameter: ZMAX <- "-51.2280337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.0036851"
Evaluating: -37.0036851-3.5
 Parameter: XMIN <- "-40.5036851"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.1085019"
Evaluating: -38.1085019-3.5
 Parameter: YMIN <- "-41.6085019"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.7280337"
Evaluating: -54.7280337-3.5
 Parameter: ZMIN <- "-58.2280337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.5036851"
 Parameter: XMIN -> "-40.5036851"
 Parameter: YMAX -> "-34.6085019"
 Parameter: YMIN -> "-41.6085019"
 Parameter: ZMAX -> "-51.2280337"
 Parameter: ZMIN -> "-58.2280337"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "154"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "154" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "154" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "71"
Evaluating: 154-71
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.56660303"
Evaluating: 100.116666*(0.56660303-0.5)
 Parameter: XPOS <- "6.66807331"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "8.392086286E-02"
Evaluating: 100.116666*(8.392086286E-02-0.5)
 Parameter: YPOS <- "-41.656456"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.38280942"
Evaluating: 127.138691*(0.38280942-0.5)+4.2778237
 Parameter: ZPOS <- "-10.6216332"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.6216332" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.6216332" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "154"
Evaluating: 154
 Parameter: J <- "154"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "154" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "154"
 Parameter: NPOS -> "71"
Evaluating: 154-71
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.107281448"
Evaluating: 100.116666*(0.107281448-0.5)
 Parameter: XPOS <- "-39.3176721"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.816271388"
Evaluating: 100.116666*(0.816271388-0.5)
 Parameter: YPOS <- "31.6640369"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.246288653"
Evaluating: 127.138691*(0.246288653-0.5)+4.2778237
 Parameter: ZPOS <- "-27.9787048"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-27.9787048" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.3176721"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -39.3176721-0
 Parameter: XTRAN <- "-39.3176721"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.6640369"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.6640369-0
 Parameter: YTRAN <- "31.6640369"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.9787048"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -27.9787048-0
 Parameter: ZTRAN <- "-27.9787048"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.3176721"
 Parameter: YTRAN -> "31.6640369"
 Parameter: ZTRAN -> "-27.9787048"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -39.317672   31.664037  -27.978705
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17835728"
Evaluating: 0.17835728*360.0
 Parameter: XPHI <- "64.2086208"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25213102"
Evaluating: 0.25213102*360.0
 Parameter: YPHI <- "90.7671672"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853620998"
Evaluating: 0.853620998*360.0
 Parameter: ZPHI <- "307.303559"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.3176721"
 Parameter: YPOS -> "31.6640369"
 Parameter: ZPOS -> "-27.9787048"
 Parameter: XPHI -> "64.2086208"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.435096    0.900384
    0.000000   -0.900384    0.435096

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.3176721"
 Parameter: YPOS -> "31.6640369"
 Parameter: ZPOS -> "-27.9787048"
 Parameter: YPHI -> "90.7671672"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.013389    0.000000   -0.999910
    0.000000    1.000000    0.000000
    0.999910    0.000000   -0.013389

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   90.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.3176721"
 Parameter: YPOS -> "31.6640369"
 Parameter: ZPOS -> "-27.9787048"
 Parameter: ZPHI -> "307.303559"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.606038   -0.795436    0.000000
    0.795436    0.606038    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.317672 XMAX =  -39.317672 XAVE =  -39.317672
    YMIN =   31.664037 YMAX =   31.664037 YAVE =   31.664037
    ZMIN =  -27.978705 ZMAX =  -27.978705 ZAVE =  -27.978705
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.3176721"
Evaluating: -39.3176721+3.5
 Parameter: XMAX <- "-35.8176721"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.6640369"
Evaluating: 31.6640369+3.5
 Parameter: YMAX <- "35.1640369"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.9787048"
Evaluating: -27.9787048+3.5
 Parameter: ZMAX <- "-24.4787048"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.3176721"
Evaluating: -39.3176721-3.5
 Parameter: XMIN <- "-42.8176721"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.6640369"
Evaluating: 31.6640369-3.5
 Parameter: YMIN <- "28.1640369"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.9787048"
Evaluating: -27.9787048-3.5
 Parameter: ZMIN <- "-31.4787048"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.8176721"
 Parameter: XMIN -> "-42.8176721"
 Parameter: YMAX -> "35.1640369"
 Parameter: YMIN -> "28.1640369"
 Parameter: ZMAX -> "-24.4787048"
 Parameter: ZMIN -> "-31.4787048"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "155"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "155" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "155" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "71"
Evaluating: 155-71
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.757721385"
Evaluating: 100.116666*(0.757721385-0.5)
 Parameter: XPOS <- "25.8022058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.323372982"
Evaluating: 100.116666*(0.323372982-0.5)
 Parameter: YPOS <- "-17.6833082"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.512501231"
Evaluating: 127.138691*(0.512501231-0.5)+4.2778237
 Parameter: ZPOS <- "5.86721385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.86721385" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.86721385" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "155" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "71"
Evaluating: 155-71
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.366300459"
Evaluating: 100.116666*(0.366300459-0.5)
 Parameter: XPOS <- "-13.3855523"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.415373016"
Evaluating: 100.116666*(0.415373016-0.5)
 Parameter: YPOS <- "-8.47257149"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.668324214"
Evaluating: 127.138691*(0.668324214-0.5)+4.2778237
 Parameter: ZPOS <- "25.6783439"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.6783439" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.6783439" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.3855523"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.3855523-0
 Parameter: XTRAN <- "-13.3855523"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.47257149"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -8.47257149-0
 Parameter: YTRAN <- "-8.47257149"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.6783439"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.6783439-0
 Parameter: ZTRAN <- "25.6783439"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.3855523"
 Parameter: YTRAN -> "-8.47257149"
 Parameter: ZTRAN -> "25.6783439"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -13.385552   -8.472571   25.678344
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369958529"
Evaluating: 0.369958529*360.0
 Parameter: XPHI <- "133.18507"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.930766805E-02"
Evaluating: 2.930766805E-02*360.0
 Parameter: YPHI <- "10.5507605"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.731982473E-02"
Evaluating: 9.731982473E-02*360.0
 Parameter: ZPHI <- "35.0351369"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.3855523"
 Parameter: YPOS -> "-8.47257149"
 Parameter: ZPOS -> "25.6783439"
 Parameter: XPHI -> "133.18507"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.684357    0.729147
    0.000000   -0.729147   -0.684357

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.3855523"
 Parameter: YPOS -> "-8.47257149"
 Parameter: ZPOS -> "25.6783439"
 Parameter: YPHI -> "10.5507605"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.983093    0.000000   -0.183107
    0.000000    1.000000    0.000000
    0.183107    0.000000    0.983093

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   10.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.3855523"
 Parameter: YPOS -> "-8.47257149"
 Parameter: ZPOS -> "25.6783439"
 Parameter: ZPHI -> "35.0351369"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.818800    0.574079    0.000000
   -0.574079    0.818800    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   35.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.385552 XMAX =  -13.385552 XAVE =  -13.385552
    YMIN =   -8.472571 YMAX =   -8.472571 YAVE =   -8.472571
    ZMIN =   25.678344 ZMAX =   25.678344 ZAVE =   25.678344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.3855523"
Evaluating: -13.3855523+3.5
 Parameter: XMAX <- "-9.8855523"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.47257149"
Evaluating: -8.47257149+3.5
 Parameter: YMAX <- "-4.97257149"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.6783439"
Evaluating: 25.6783439+3.5
 Parameter: ZMAX <- "29.1783439"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.3855523"
Evaluating: -13.3855523-3.5
 Parameter: XMIN <- "-16.8855523"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.47257149"
Evaluating: -8.47257149-3.5
 Parameter: YMIN <- "-11.9725715"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.6783439"
Evaluating: 25.6783439-3.5
 Parameter: ZMIN <- "22.1783439"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.8855523"
 Parameter: XMIN -> "-16.8855523"
 Parameter: YMAX -> "-4.97257149"
 Parameter: YMIN -> "-11.9725715"
 Parameter: ZMAX -> "29.1783439"
 Parameter: ZMIN -> "22.1783439"
 SELRPN>     19 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>     11 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
39360 NEG      CLA      84       CLA     -1809 PROA     LEU      178      O             3.5205
39360 NEG      CLA      84       CLA     -1812 PROA     ASP      179      CA            4.6731
39360 NEG      CLA      84       CLA     -1820 PROA     ASP      179      C             4.5441
39360 NEG      CLA      84       CLA     -1821 PROA     ASP      179      O             3.9489
39360 NEG      CLA      84       CLA     -1864 PROA     ARG      181      C             4.6413
39360 NEG      CLA      84       CLA     -1865 PROA     ARG      181      O             4.4656
39360 NEG      CLA      84       CLA     -1866 PROA     THR      182      N             4.2107
39360 NEG      CLA      84       CLA     -1868 PROA     THR      182      CA            3.5698
39360 NEG      CLA      84       CLA     -1870 PROA     THR      182      CB            2.3198
39360 NEG      CLA      84       CLA     -1872 PROA     THR      182      OG1           3.0397
39360 NEG      CLA      84       CLA     -1874 PROA     THR      182      CG2           1.1715
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "155"
Evaluating: 155
 Parameter: J <- "155"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "155" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "155"
 Parameter: NPOS -> "71"
Evaluating: 155-71
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.630691293"
Evaluating: 100.116666*(0.630691293-0.5)
 Parameter: XPOS <- "13.0843765"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.48168471"
Evaluating: 100.116666*(0.48168471-0.5)
 Parameter: YPOS <- "-1.83366577"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "3.11427711E-02"
Evaluating: 127.138691*(3.11427711E-02-0.5)+4.2778237
 Parameter: ZPOS <- "-55.3320706"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.3320706" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.385552 XMAX =  -13.385552 XAVE =  -13.385552
    YMIN =   -8.472571 YMAX =   -8.472571 YAVE =   -8.472571
    ZMIN =   25.678344 ZMAX =   25.678344 ZAVE =   25.678344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.0843765"
 RDCMND substituted energy or value "?XAVE" to "-13.3855523"
Evaluating: 13.0843765--13.3855523
 Parameter: XTRAN <- "26.4699288"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.83366577"
 RDCMND substituted energy or value "?YAVE" to "-8.47257149"
Evaluating: -1.83366577--8.47257149
 Parameter: YTRAN <- "6.63890572"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.3320706"
 RDCMND substituted energy or value "?ZAVE" to "25.6783439"
Evaluating: -55.3320706-25.6783439
 Parameter: ZTRAN <- "-81.0104145"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.4699288"
 Parameter: YTRAN -> "6.63890572"
 Parameter: ZTRAN -> "-81.0104145"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR    26.469929    6.638906  -81.010414
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123721975"
Evaluating: 0.123721975*360.0
 Parameter: XPHI <- "44.539911"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.565957163"
Evaluating: 0.565957163*360.0
 Parameter: YPHI <- "203.744579"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179186903"
Evaluating: 0.179186903*360.0
 Parameter: ZPHI <- "64.5072851"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.0843765"
 Parameter: YPOS -> "-1.83366577"
 Parameter: ZPOS -> "-55.3320706"
 Parameter: XPHI -> "44.539911"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.712762    0.701406
    0.000000   -0.701406    0.712762

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.0843765"
 Parameter: YPOS -> "-1.83366577"
 Parameter: ZPOS -> "-55.3320706"
 Parameter: YPHI -> "203.744579"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.915350    0.000000    0.402660
    0.000000    1.000000    0.000000
   -0.402660    0.000000   -0.915350

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.0843765"
 Parameter: YPOS -> "-1.83366577"
 Parameter: ZPOS -> "-55.3320706"
 Parameter: ZPHI -> "64.5072851"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.430396    0.902640    0.000000
   -0.902640    0.430396    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.084377 XMAX =   13.084377 XAVE =   13.084377
    YMIN =   -1.833666 YMAX =   -1.833666 YAVE =   -1.833666
    ZMIN =  -55.332071 ZMAX =  -55.332071 ZAVE =  -55.332071
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.0843765"
Evaluating: 13.0843765+3.5
 Parameter: XMAX <- "16.5843765"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.83366577"
Evaluating: -1.83366577+3.5
 Parameter: YMAX <- "1.66633423"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.3320706"
Evaluating: -55.3320706+3.5
 Parameter: ZMAX <- "-51.8320706"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.0843765"
Evaluating: 13.0843765-3.5
 Parameter: XMIN <- "9.5843765"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.83366577"
Evaluating: -1.83366577-3.5
 Parameter: YMIN <- "-5.33366577"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.3320706"
Evaluating: -55.3320706-3.5
 Parameter: ZMIN <- "-58.8320706"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.5843765"
 Parameter: XMIN -> "9.5843765"
 Parameter: YMAX -> "1.66633423"
 Parameter: YMIN -> "-5.33366577"
 Parameter: ZMAX -> "-51.8320706"
 Parameter: ZMIN -> "-58.8320706"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "156"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "156" and "156".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "156"
Evaluating: 156
 Parameter: J <- "156"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "71"
 Comparing "156" and "71".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "156"
 Parameter: NPOS -> "71"
Evaluating: 156-71
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "7.281636245E-02"
Evaluating: 100.116666*(7.281636245E-02-0.5)
 Parameter: XPOS <- "-42.7682016"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "100.116666"
 RDCMND substituted energy or value "?RANDOM" to "0.354786331"
Evaluating: 100.116666*(0.354786331-0.5)
 Parameter: YPOS <- "-14.5383084"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "127.138691"
 Parameter: ZCEN -> "4.2778237"
 RDCMND substituted energy or value "?RANDOM" to "0.121933038"
Evaluating: 127.138691*(0.121933038-0.5)+4.2778237
 Parameter: ZPOS <- "-43.789115"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-43.789115" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.7682016"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.7682016-0
 Parameter: XTRAN <- "-42.7682016"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.5383084"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.5383084-0
 Parameter: YTRAN <- "-14.5383084"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.789115"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -43.789115-0
 Parameter: ZTRAN <- "-43.789115"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.7682016"
 Parameter: YTRAN -> "-14.5383084"
 Parameter: ZTRAN -> "-43.789115"
 SELRPN>      1 atoms have been selected out of  39361
 TRANSLATION VECTOR   -42.768202  -14.538308  -43.789115
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126794381"
Evaluating: 0.126794381*360.0
 Parameter: XPHI <- "45.6459772"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538477454"
Evaluating: 0.538477454*360.0
 Parameter: YPHI <- "193.851883"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8013982"
Evaluating: 0.8013982*360.0
 Parameter: ZPHI <- "288.503352"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.7682016"
 Parameter: YPOS -> "-14.5383084"
 Parameter: ZPOS -> "-43.789115"
 Parameter: XPHI -> "45.6459772"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.699090    0.715034
    0.000000   -0.715034    0.699090

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.7682016"
 Parameter: YPOS -> "-14.5383084"
 Parameter: ZPOS -> "-43.789115"
 Parameter: YPHI -> "193.851883"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
   -0.970918    0.000000    0.239413
    0.000000    1.000000    0.000000
   -0.239413    0.000000   -0.970918

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.7682016"
 Parameter: YPOS -> "-14.5383084"
 Parameter: ZPOS -> "-43.789115"
 Parameter: ZPHI -> "288.503352"
 SELRPN>      1 atoms have been selected out of  39361
 ROTATION MATRIX
    0.317360   -0.948305    0.000000
    0.948305    0.317360    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  39361
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.768202 XMAX =  -42.768202 XAVE =  -42.768202
    YMIN =  -14.538308 YMAX =  -14.538308 YAVE =  -14.538308
    ZMIN =  -43.789115 ZMAX =  -43.789115 ZAVE =  -43.789115
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.7682016"
Evaluating: -42.7682016+3.5
 Parameter: XMAX <- "-39.2682016"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.5383084"
Evaluating: -14.5383084+3.5
 Parameter: YMAX <- "-11.0383084"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.789115"
Evaluating: -43.789115+3.5
 Parameter: ZMAX <- "-40.289115"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.7682016"
Evaluating: -42.7682016-3.5
 Parameter: XMIN <- "-46.2682016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.5383084"
Evaluating: -14.5383084-3.5
 Parameter: YMIN <- "-18.0383084"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.789115"
Evaluating: -43.789115-3.5
 Parameter: ZMIN <- "-47.289115"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.2682016"
 Parameter: XMIN -> "-46.2682016"
 Parameter: YMAX -> "-11.0383084"
 Parameter: YMIN -> "-18.0383084"
 Parameter: ZMAX -> "-40.289115"
 Parameter: ZMIN -> "-47.289115"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   4767 atoms have been selected out of  39361
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4767"
 Comparing "4767" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  53785
 SELRPN>      0 atoms have been selected out of  53785

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "157"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "156"
 Comparing "157" and "156".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "SOD"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "71"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "85"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     71 atoms have been selected out of  39361
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "39206"
 Parameter: POSAT <- "39206"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     85 atoms have been selected out of  39361
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "39277"
 Parameter: NEGAT <- "39277"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "39277" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "39277"
 Comparing "39206" and "39277".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  39361
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     71 atoms have been selected out of  39361
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "71"
 Parameter: NPOSATOMS <- "71"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     85 atoms have been selected out of  39361
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "85"
 Parameter: NNEGATOMS <- "85"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     71 atoms have been selected out of  39361
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     71 atoms have been selected out of  39361
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "71"
 Parameter: NIONATOMS <- "71"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "71" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "85" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =      701
         Number of atoms         =    39361   Number of groups     =    10346
         Number of bonds         =    39010   Number of angles     =    74532
         Number of dihedrals     =   104294   Number of impropers  =     1240
         Number of cross-terms   =      285   Number of autogens   =        0
         Number of HB acceptors  =      388   Number of HB donors  =      488
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAY, 28. 2025. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:     5/28/25     10:42:53      CREATED BY USER: CHARMM-GUI
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 39205 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-1.421085472E-14"
Evaluating: -1.421085472E-14
 Parameter: CGTOTINIT <- "-1.421085472E-14"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-1.421085472E-14"
Evaluating: INT(-1.421085472E-14)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-1.421085472E-14"
Evaluating: ABS(0--1.421085472E-14)
 Parameter: CGDIFF <- "1.421085472E-14"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "1.421085472E-14" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  39205 atoms have been selected out of  39361

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        545 residues deleted.

 Message from MAPIC:          3 segments deleted.
 DELTIC:     39010 bonds deleted
 DELTIC:     74532 angles deleted
 DELTIC:    104294 dihedrals deleted
 DELTIC:      1240 improper dihedrals deleted
 DELTIC:       285 crossterm maps deleted
 DELTIC:       488 donors deleted
 DELTIC:       388 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      156
         Number of atoms         =      156   Number of groups     =      156
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -14.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 71
 RDTITL> * SET NNEGTOT = 85
 RDTITL> * SET NIONTOT = 156
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     40.17 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    40.17  SECONDS 
                         CPU TIME:    18.67  SECONDS 
