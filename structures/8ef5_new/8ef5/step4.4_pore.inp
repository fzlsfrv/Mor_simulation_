* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.7 on May, 28. 2025. JOBID=4844180528
* REFINES WATER MOLECULES OUT OF THE PORE REGION
* 

DIMENS CHSIZE 5000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

!Read the system information
stream step3_size.str

!Read Protein & Water
stream step2.1_pore.str

open read card unit 10 name step2.1_porewat.crd
read coor card unit 10 append


coor stat sele type OH2 end
set nwater ?nsel

open write card unit 10 name step4.4_pore.pdb
write coor pdb  unit 10 
* Equilibrated water 
*

open write unit 10 card name step4.4_pore.crd
write coor unit 10 card
* Equilibrated water 
*

open write unit 10 card name step4.4_pore.str
write title unit 10
* read sequence TIP3 @nwater
* generate PWAT setup noangle nodihedral
*

delete atom

! Read PSF
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card
 
! Read COOR
open read unit 10 card name step2_orient.crd
read coor unit 10 card

stream step4.4_pore.str

open read card unit 10 name step4.4_pore.crd
read coor unit 10 card append

open write card unit 10 name step2.1_pore_refined.pdb
write coor pdb  unit 10 

stop
